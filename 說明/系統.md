# XS 內建函數參考

### DiffUpDownVolume

**說明:**

量能相關
傳回「分時漲跌成交量」的數值
回傳數值 = DiffUpDownVolume
僅支援分鐘與日頻率（含還原）
支援台股與期權商品。
DiffUpDownVolume為分時漲跌成交量的函數，
該函數運算出來的數值，與XS指標的「分時漲跌成交量」指標相同。
---
### DiffTradeVolumeAtAskBid

**說明:**

量能相關
傳回「分時買賣力」的數值
回傳數值 = DiffTradeVolumeAtAskBid
僅支援分鐘與日頻率（含還原）
支援台股與期權商品。
DiffTradeVolumeAtAskBid為分時買賣力的函數，
該函數運算出來的數值，與XS指標的「分時買賣力」指標相同。
---
### DiffBidAskVolumeXL

**說明:**

量能相關
傳回「近15分鐘特大單買賣超」的張數
回傳數值 = DiffBidAskVolumeXL
僅支援1分鐘頻率與台股商品。
DiffBidAskVolumeXL為近15分鐘特大單買賣超張數的函數。

**範例:**

```xs
// ```xs
value1 = DiffBidAskVolumeXL;
// ```
plot1(value1); //value1為近15分鐘特大單買賣超張數
```
---
### DiffBidAskVolumeLxL

**說明:**

量能相關
傳回「近15分鐘大戶買賣超」的數值
回傳數值 = DiffBidAskVolumeLxL
僅支援1分鐘頻率與台股商品。
DiffBidAskVolumeLxL為近15分鐘大戶買賣超的函數，
該函數運算出來的數值，與XS指標的「流動大戶買賣力」指標相同。
---
### ArrayXDaySeries

**說明:**

以陣列儲存跨頻率的序列值。
傳入三個參數:
- 第一個參數是序列。
- 第二個參數是最大引用筆數。
- 第三個參數是陣列。

**範例:**

```xs
以Array儲存跨頻率的序列值，傳入一個序列。
// ```xs
Array: CloseArray[](0);
ArrayXDaySeries(GetField("收盤價","D"),SBB_length,_DayValue);
// ```
```
---
### ArraySeries

**說明:**

將數值序列轉成陣列。
傳入三個參數:
- 第一個參數是數列。
- 第二個參數是數列期數。
- 第三個參數是陣列。
將某個數值序列轉成陣列型態。
---
### ArrayMASeries

**說明:**

將均線數值序列轉成陣列。
傳入三個參數:
- 第一個參數是數列。
- 第二個參數是數列期數。
- 第三個參數是陣列。
將某個數值序列的均線轉成陣列型態。
---
### ArrayLinearRegSlope

回傳陣列=ArrayLinearRegSlope(陣列,期數)

**說明:**

利用陣列來計算的線性迴歸的斜率。
傳入二個參數:
- 第一個參數是陣列。
- 第二個參數是期數。
利用最小平方法計算線性迴歸的斜率。
---
### xfMin_XAverage

**說明:**

跨頻率
計算指定頻率的指數移動平均。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，通常是開高低收的價格數列。
- 第三個參數是期數。
xfMin_XAverage是xf_XAverage 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的XAverage值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_XAverage("30",GetField("Close","30"),5); //計算30分鐘線5期收盤價的指數移動平均
// ```
```
---
### xfMin_WeightedClose

回傳數值=xfMin_WeightedClose(頻率)

**說明:**

跨頻率
計算指定頻率的加權平均收盤價。
傳入一個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
xfMin_WeightedClose是xf_WeightedClose 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的WeightedClose值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
plot1(xfMin_WeightedClose("30"));    //繪製30分鐘線加權平均收盤價的連線
// ```
```
---
### xfMin_Stochastic

**說明:**

跨頻率
計算指定頻率的KD指標。
傳入八個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是資料期數，指定計算的區間長度。
- 第三個參數是K值平滑期數，指定計算K值所用的平滑期數。
- 第四個參數是D值平滑期數，指定計算D值所用的平滑期數。
- 第五個參數是輸出RSV值，回傳計算完的RSV值。
- 第六個參數是輸出K值，回傳計算完的K值。
- 第七個參數是輸出D值，回傳計算完的D值。
xfMin_Stochastic是xf_Stochastic 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的Stochastic值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_Stochastic("30",9,3,3,value2,value3,value4);       //計算30分鐘線KD指標
plot1(value3, "30分K");
plot2(value4, "30分D");
// ```
```
---
### xfMin_RSI

回傳數值=xfMin_RSI(頻率,數列,期數)

**說明:**

跨頻率
計算指定頻率的相對強弱指標數值。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，通常是開高低收的價格數列。
- 第三個參數是期數。
xfMin_RSI是xf_RSI 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的RSI值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_RSI("30",GetField("Close","30"),6);       //計算6期的30分鐘線RSI指標
plot1(value1, "30分RSI");
// ```
```
---
### xfMin_PercentR

回傳數值=xfMin_PercentR(頻率,期數)

**說明:**

跨頻率
計算指定頻率的威廉指標值。
傳入二個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是計算威廉指標的期數。
xfMin_PercentR是xf_PercentR 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的PercentR值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_PercentR("30", 14) - 100;       //計算30分鐘線威廉指標
// ```
Plot1(value1, "30分鐘威廉指標");
```
---
### xfmin_MTM

**說明:**

跨頻率
計算指定頻率的威廉指標值。
回傳數值=xfMin_MTM(頻率,期數)
傳入二個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是計算MTM指標的期數。
xfMin_MTM是MTM 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的MTM值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_MTM("5", 10);       //value1 = 五分鐘MTM
Plot1(value1, "5分鐘MTM");
// ```
```
---
### xfMin_MACD

**說明:**

跨頻率
計算指定頻率的MACD指標值。
傳入八個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，MACD通常是以加權平均收盤價（WeightedClose）來計算。
- 第三個參數是計算快速線（短期）的期數。
- 第四個參數是計算慢速線（長期）的期數。
- 第五個參數是計算MACD使用之平滑期數。
- 第六個參數是輸出計算完的DIF值。
- 第七個參數是輸出計算完的MACD值。
- 第八個參數是輸出計算完的OSC值。
xfMin_MACD是xf_MACD 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的MACD值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_MACD("30",xfMin_weightedclose("30"),12,26,9,value2,value3,value4);    //計算30分鐘線MACD
plot1(value2, "30分鐘DIF");
plot2(value3, "30分鐘MACD");
plot3(value4, "30分鐘OSC");
// ```
```
---
### xfMin_GetValue

回傳數值=xfMin_GetValue(頻率,數列,期別)

**說明:**

跨頻率
引用指定頻率的數值。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列。
- 第三個參數是期別，相對目前而言要往前的筆數。
在同一個頻率時，我們可以直接利用**變數[3]**取得前3期的變數值。當資料頻率不同時（跨頻率），我們就需要使用xfMin_GetValue或xfMin_GetBoolean來取得之前的變數值。若變數是數值時，要用xfMin_GetValue；若變數是布林值時，要用xfMin_GetBoolean。支援跨分鐘頻率。
相關函數：xfMin_GetBoolean。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。
---
### xfMin_GetDTValue

回傳數值=xfMin_GetDTValue(頻率,日期)

**說明:**

跨頻率\n計算指定頻率的序列值。\n傳入二個參數:\n- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。\n- 第二個參數是日期。\n經由傳入的日期判斷指定頻率的期別是否有異動，支援指定分鐘頻率。\nvalue1 = xfMin_getdtvalue("30",date);\nif value1 <> value1[1] then plot1(1) else plot1(0);\n上述範例利用xfMin_GetDTValue來判斷目前是否為新的30分鐘。如果是的話則在圖表上顯示為1。

**注意事項:**

> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

---
### xfMin_GetCurrentBar

K棒編號 = xfMin_GetCurrentBar(頻率)

**說明:**

跨頻率
傳回指定頻率的K棒編號。
傳入一個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
傳回指定頻率（支援分鐘）的K棒序列編號，由1開始，第一筆K棒編號為1，第二筆K棒編號為2，依序遞增。
可以使用這個函數來判斷目前腳本執行的時機點
8    xfMin_XAverage = Series
上述範例利用xfMin_GetCurrentBar來判斷目前是否是第一筆K棒。如果是的話則回傳xfMin_XAverage的初始數值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
else
xfMin_XAverage = lastXAverage + Factor * (Series - lastXAverage);
```
---
### xfMin_GetBoolean

回傳數值=xfMin_GetBoolean(頻率,數列,期別)

**說明:**

跨頻率
引用指定頻率的數值。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是布林數列。
- 第三個參數是期別，相對目前而言要往前的筆數。
在同一個頻率時，我們可以直接利用**變數[3]**取得前3期的變數值。當資料頻率不同時（跨頻率），我們就需要使用xfMin_GetValue或xfMin_GetBoolean來取得之前的變數值。若變數是數值時，要用xfMin_GetValue；若變數是布林值時，要用xfMin_GetBoolean。支援跨分鐘頻率。
相關函數：xfMin_GetValue。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。
---
### xfMin_EMA

回傳數值=xfMin_EMA(頻率,數列,期數)

**說明:**

跨頻率
計算指定頻率的XQ指數移動平均。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，通常是開高低收的價格數列。
- 第三個參數是期數。
xfMin_EMA是xf_EMA函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的EMA值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_EMA("30", GetField("Close", "30"),5); //計算30分鐘線5期收盤價的XQ EMA
// ```
```
---
### xfMin_DirectionMovement

**說明:**

跨頻率
計算跨頻率DMI指標。
傳入五個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是計算期數。
- 第三個參數是輸出計算完的+DI值。
- 第四個參數是輸出計算完的-DI值。
- 第五個參數是輸出計算完的ADX值。
xfMin_DirectionMovement是xf_DirectionMovement 函數的跨頻率加強版本，增加了指定分鐘頻率的參數，可以計算指定分鐘頻率的DMI值。
**注意事項:**
> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

**範例:**

```xs
// ```xs
value1 = xfMin_DirectionMovement("30",14,value2,value3,value4);       //計算14期的30分鐘線DMI指標
plot1(value2, "30分+DI");
plot2(value3, "30分週-DI");
plot3(value4, "30分ADX");
// ```
```
---
### xfMin_CrossUnder

**說明:**

回傳布林值=xfMin_CrossUnder(頻率,數列一,數列二)\n跨頻率\n判斷指定頻率的數列一是否由上往下穿越數列二，又稱死亡交叉。\n傳入三個參數:\n- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。\n- 第二個參數是目標頻率的數列一。\n- 第三個參數是目標頻率的數列二。\n如果出現死亡交叉傳回True，其他狀況傳回False。

**範例:**

```xs
condition1 = xfMin_CrossUnder("30",Average(GetField("close","30"),5),Average(GetField("close","30") ,10) ); //判斷30分鐘線5期均線和10期均線是否死亡交叉
```

**注意事項:**

> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

---
### xfMin_CrossOver

**說明:**

回傳布林值=xfMin_CrossOver(頻率,數列一,數列二)\n跨頻率\n判斷指定頻率的數列一是否由下往上穿越數列二，又稱黃金交叉。\n傳入三個參數:\n- 第一個參數是頻率，指定傳入數列的資料期別，支援"1","5","10","15","30","60","D", "W", "M", "AD", "AW", "AM"。\n- 第二個參數是目標頻率的數列一。\n- 第三個參數是目標頻率的數列二。\n如果出現黃金交叉傳回True，其他狀況傳回False。

**範例:**

```xs
condition1 = xfMin_CrossOver("30",Average(GetField("收盤價","30"),5),Average(GetField("收盤價","30") ,10)); //判斷30分鐘線5期均線和10期均線是否黃金交叉
```

**注意事項:**

> 備註：商品類型僅支援台股與台期權。不支援XS選股、XS選股自訂排行與XS選股回測。

---
### xf_XAverage

回傳數值=xf_XAverage(頻率,數列,期數)

**說明:**

跨頻率
計算指定頻率的指數移動平均。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，通常是開高低收的價格數列。
- 第三個參數是期數。
xf_XAverage是XAverage 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的XAverage值。

**範例:**

```xs
// ```xs
value1 = xf_XAverage("W",GetField("Close","W"),5); //計算週線5期收盤價的指數移動平均
// ```
```
---
### xf_WeightedClose

回傳數值=xf_WeightedClose(頻率)

**說明:**

跨頻率
計算指定頻率的加權平均收盤價。
傳入一個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
xf_WeightedClose是WeightedClose 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的WeightedClose值。

**範例:**

```xs
// ```xs
plot1(xf_WeightedClose("W"));    //繪製週線加權平均收盤價的連線
// ```
```
---
### xf_Stochastic

**說明:**

跨頻率
計算指定頻率的KD指標。
傳入八個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是資料期數，指定計算的區間長度。
- 第三個參數是K值平滑期數，指定計算K值所用的平滑期數。
- 第四個參數是D值平滑期數，指定計算D值所用的平滑期數。
- 第五個參數是輸出RSV值，回傳計算完的RSV值。
- 第六個參數是輸出K值，回傳計算完的K值。
- 第七個參數是輸出D值，回傳計算完的D值。
xf_Stochastic是Stochastic 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的Stochastic值。

**範例:**

```xs
// ```xs
value1 = xf_Stochastic("W",9,3,3,value2,value3,value4);       //計算週KD指標
plot1(value3, "週K");
plot2(value4, "週D");
// ```
```
---
### xf_RSI

回傳數值=xf_RSI(頻率,數列,期數)

**說明:**

跨頻率
計算指定頻率的相對強弱指標數值。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，通常是開高低收的價格數列。
- 第三個參數是期數。
xf_RSI是RSI 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的RSI值。

**範例:**

```xs
// ```xs
value1 = xf_RSI("W",GetField("Close","W"),6);       //計算6期的週RSI指標
plot1(value1, "週RSI");
// ```
```
---
### xf_PercentR

回傳數值=xf_PercentR(頻率,期數)

**說明:**

跨頻率
計算指定頻率的威廉指標值。
傳入二個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是計算威廉指標的期數。
xf_PercentR是PercentR 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的PercentR值。

**範例:**

```xs
// ```xs
value1 = xf_PercentR("W", 14) - 100;       //計算週線威廉指標
// ```
Plot1(value1, "週威廉指標");
```
---
### xf_MACD

**說明:**

跨頻率
計算指定頻率的MACD指標值。
傳入八個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，MACD通常是以加權平均收盤價（WeightedClose）來計算。
- 第三個參數是計算快速線（短期）的期數。
- 第四個參數是計算慢速線（長期）的期數。
- 第五個參數是計算MACD使用之平滑期數。
- 第六個參數是輸出計算完的DIF值。
- 第七個參數是輸出計算完的MACD值。
- 第八個參數是輸出計算完的OSC值。
xf_MACD是MACD 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的MACD值。

**範例:**

```xs
// ```xs
value1 = xf_MACD("W",xf_weightedclose("W"),12,26,9,value2,value3,value4);       //計算週線MACD
plot1(value2, "週DIF");
plot2(value3, "週MACD");
plot3(value4, "週OSC");
// ```
```
---
### xf_GetValue

回傳數值=xf_GetValue(頻率,數列,期別)

**說明:**

跨頻率
引用指定頻率的數值。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列。
- 第三個參數是期別，相對目前而言要往前的筆數。
在同一個頻率時，我們可以直接利用**變數[3]**取得前3期的變數值。當資料頻率不同時（跨頻率），我們就需要使用xf_GetValue或xf_GetBoolean來取得之前的變數值。若變數是數值時，要用xf_GetValue；若變數是布林值時，要用xf_GetBoolean。
相關函數：xf_GetBoolean。
---
### xf_GetDTValue

回傳數值=xf_GetDTValue(頻率,日期)

**說明:**

跨頻率\n計算指定頻率的序列值。\n傳入二個參數:\n- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。\n- 第二個參數是日期。\n經由傳入的日期判斷指定頻率的期別是否有異動\nvalue1 = xf_getdtvalue("W",date);\nif value1 <> value1[1] then plot1(1) else plot1(0);\n上述範例利用xf_GetDTValue來判斷目前是否為新的一週。如果是的話則在圖表上顯示為1。

---
### xf_GetCurrentBar

K棒編號 =  xf_GetCurrentBar(頻率)

**說明:**

跨頻率
傳回指定頻率的K棒編號。
傳入一個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
傳回指定頻率的K棒序列編號，由1開始，第一筆K棒編號為1，第二筆K棒編號為2，依序遞增。
可以使用這個函數來判斷目前腳本執行的時機點
8    xf_XAverage = Series
上述範例利用xf_GetCurrentBar來判斷目前是否是第一筆K棒。如果是的話則回傳xf_XAverage的初始數值。

**範例:**

```xs
else
xf_XAverage = lastXAverage + Factor * (Series - lastXAverage);
```
---
### xf_GetBoolean

回傳數值=xf_GetBoolean(頻率,數列,期別)

**說明:**

跨頻率
引用指定頻率的數值。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的布林數列。
- 第三個參數是期別，相對目前而言要往前的筆數。
在同一個頻率時，我們可以直接利用**變數[3]**取得前3期的變數值。當資料頻率不同時（跨頻率），我們就需要使用xf_GetValue或xf_GetBoolean來取得之前的變數值。若變數是數值時，要用xf_GetValue；若變數是布林值時，要用xf_GetBoolean。
相關函數：xf_GetValue。
---
### xf_EMA

回傳數值=xf_EMA(頻率,數列,期數)

**說明:**

跨頻率
計算指定頻率的XQ指數移動平均。
傳入三個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是目標頻率的數列，通常是開高低收的價格數列。
- 第三個參數是期數。
xf_EMA是EMA函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的EMA值。

**範例:**

```xs
// ```xs
value1 = xf_EMA("W", Close,5); //計算週線5期收盤價的XQ EMA
// ```
```
---
### xf_DirectionMovement

**說明:**

跨頻率
計算跨頻率DMI指標。
傳入五個參數:
- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。
- 第二個參數是計算期數。
- 第三個參數是輸出計算完的+DI值。
- 第四個參數是輸出計算完的-DI值。
- 第五個參數是輸出計算完的ADX值。
xf_DirectionMovement是DirectionMovement 函數的跨頻率版本，增加了指定頻率的參數，可以計算指定頻率的DMI值。

**範例:**

```xs
// ```xs
value1 = xf_DirectionMovement("W",14,value2,value3,value4);       //計算14期的週DMI指標
plot1(value2, "週+DI");
plot2(value3, "週-DI");
plot3(value4, "週ADX");
// ```
```
---
### xf_CrossUnder

**說明:**

回傳布林值=xf_CrossUnder(頻率,數列一,數列二)\n跨頻率\n判斷指定頻率的數列一是否由上往下穿越數列二，又稱死亡交叉。\n傳入三個參數:\n- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。\n- 第二個參數是目標頻率的數列一。\n- 第三個參數是目標頻率的數列二。\n如果出現死亡交叉傳回True，其他狀況傳回False。

**範例:**

```xs
condition1 = xf_CrossUnder("W",Average(GetField("close","W"),5),Average(GetField("close","W") ,10) ); //判斷週線5期均線和10期均線是否死亡交叉
```

---
### xf_CrossOver

**說明:**

回傳布林值=xf_CrossOver(頻率,數列一,數列二)\n跨頻率\n判斷指定頻率的數列一是否由下往上穿越數列二，又稱黃金交叉。\n傳入三個參數:\n- 第一個參數是頻率，指定傳入數列的資料期別，支援"D", "W", "M", "AD", "AW", "AM"。\n- 第二個參數是目標頻率的數列一。\n- 第三個參數是目標頻率的數列二。\n如果出現黃金交叉傳回True，其他狀況傳回False。

**範例:**

```xs
condition1 = xf_CrossOver("W",Average(GetField("收盤價","W"),5),Average(GetField("收盤價","W") ,10)); //判斷週線5期均線和10期均線是否黃金交叉
```

---
### TurnOverRate

回傳數值=TurnOverRate(期數)

**說明:**

跨頻率\n計算股票周轉率（或稱換手率）。\n股票周轉率是在一段時間內的股票交易數量與股票發行總數之比。當週轉率高時，代表股票在投資人之間轉換頻率過高，也表示市場的流動性高；週轉率高也可能是因為市場中充斥太多投機者搶短線所造成的。

**範例:**

```xs
value1 = TurnOverRate(10);	//計算10期的周轉率
plot1(value1, "周轉率");
```

---
### PercentB

**說明:**

回傳數值=PercentB(數列,期數,上通道寬度的標準差倍數,下通道寬度的標準差倍數)\n跨頻率\n計算%b指標（Percent b，PB）。\n傳入四個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是計算均線的期數。\n- 第三個參數是決定上通道寬度的標準差倍數。\n- 第四個參數是決定下通道寬度的標準差倍數。\n%b指標（Percent b，PB），是從布林值演化過來的，了解%B指標前，建議熟悉布林通道(BollingerBand)；%b指標以數值形式呈現收盤價在布林帶中的位置，計算公式通常為：%b 值 = （收盤價 - 布林帶下軌值） ÷ （布林帶上軌值 - 布林帶下軌值）。

**範例:**

```xs
value1 = PercentB(Close,20,2,2);	//計算20期、上下通道寬度的標準差倍數為2
plot1(value1, "%b指標");
```

---
### BollingerBandWidth

**說明:**

回傳數值=BollingerBandWidth(數列,期數,上通道寬度的標準差倍數,下通道寬度的標準差倍數)\n跨頻率\n計算布林帶寬度指標（Bandwidth，BW）。\n傳入四個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是計算均線的期數。\n- 第三個參數是決定上通道寬度的標準差倍數。\n- 第四個參數是決定下通道寬度的標準差倍數。\n布林帶寬度指標（Bandwidth，BW），是由布林帶中軌及上、下軌衍生出的指標，利用股價波動範圍以判斷趨勢的強度與轉折；計算公式通常為：布林帶寬度指標值 = （布林帶上軌值 - 布林帶下軌值）÷ 布林帶中軌值。

**範例:**

```xs
value1 = BollingerBandWidth(Close,20,2,2);	//計算20期、上下通道寬度的標準差倍數為2
plot1(value1, "BollingerBandWidth");
```

---
### NORMSDIST

回傳數值=NORMSDIST(數值)

**說明:**

期權相關
計算數值的標準常態累加分配函數。
傳入一個參數:
- 第一個參數是數值。
計算在平均值為0、標準差為1的標準常態分配下，數值小於傳入值的累計機率。
本函數利用多項式計算近似值，精確度到小數點以下六位。

**範例:**

```xs
// ```xs
value1 = NORMSDIST(1.33);       //1.33的標準常態累加分配函數
plot1(value1);
// ```
```
---
### IVolatility

**說明:**

回傳數值=IVolatility(買賣權,標的價格,履約價,到期天數,無風險利率,持有成本,選擇權現價)\n期權相關\n計算選擇權的隱含波動率\n傳入七個參數:\n- 第一個參數是買賣權，C表買權、P表賣權。\n- 第二個參數是標的價格。\n- 第三個參數是履約價。\n- 第四個參數是到期天數。\n- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。\n- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。\n- 第七個參數是選擇權現價。\n隱含波動率是經由選擇權市場價格反推而得的波動率。隱含波動率的水準顯示了選擇權價格的高低（貴或便宜），也代表了市場參與者對未來的預期。通常會搭配歷史波動率來判斷市場是否出現狂熱或恐慌的狀況。

**範例:**

```xs
value1 = IVolatility("C",8800,9000,20,2,0,40);       //計算8800買權的隱含波動率
```
plot1(value1,"隱含波動率");

---
### IsXOrder

**說明:**

期權相關\n回傳目前的成交金額是否是大單(大單+特大單)。\n回傳布林值=IsXOrder\n級距表請參考：\n台股逐筆功能行情端相關異動

---
### IsXLOrder

**說明:**

期權相關\n判斷成交金額是否是特大單。\n回傳布林值=IsXLOrder\n級距表請參考：\n台股逐筆功能行情端相關異動

---
### HVolatility

回傳數值=HVolatility(數列,期數)

**說明:**

期權相關\n計算序列資料的波動率。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n歷史波動率代表的是價格過往的波動性高低。波動率是影響選擇權價格的重要因子，而歷史波動率會是一個很好的參考。

**範例:**

```xs
value1 = HVolatility(Close,20);       //計算20天的歷史波動率
```
plot1(value1,"20天歷史波動率");

---
### DaysToExpirationTF

**說明:**

期權相關
自動計算台股指數類期貨、選擇權商品的到期天數。
回傳數值=DaysToExpirationTF
自動依目前執行的商品計算對應的到期天數。支援週選擇權。
回傳值為1，表示當天為結算日。回傳值小於1，表示該合約已到期。
注意，此函數並無調整因放假而導致的到期日異動。

**範例:**

```xs
// ```xs
value1 = DaysToExpirationTF;
// ```
plot1(value1); //繪製最新的台股指數類期貨到期天數的連線
```
---
### BSVega

**說明:**

回傳數值=BSVega(買賣權,標的價格,履約價,到期天數,無風險利率,持有成本,波動率)\n期權相關\n以BlackScholes模型計算選擇權Vega\n傳入七個參數:\n- 第一個參數是買賣權，C表買權、P表賣權。\n- 第二個參數是標的價格。\n- 第三個參數是履約價。\n- 第四個參數是到期天數。\n- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。\n- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。\n- 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。\nBS選擇權定價模型為諾貝爾經濟學獎得主Robert Merton和Myron Scholes於1973所發表。依據下列六個參數決定選擇權的理論價：標的價格、履約價、到期天數、無風險利率、持有成本、波動率。其中只有履約價和到期天數是由合約所規定，其餘參數皆會隨市場狀況而變動。

**範例:**

```xs
value1 = BSPrice("C",8800,9000,20,2,0,25);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的理論價
plot1(value1, "理論價");
```
註：更多參數說明請參考BlackScholes公式。

---
### BSTheta

**說明:**

期權相關
以BlackScholes模型計算選擇權Theta
傳入七個參數:
- 第一個參數是買賣權，C表買權、P表賣權。
- 第二個參數是標的價格。
- 第三個參數是履約價。
- 第四個參數是到期天數。
- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。
- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。
- 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。
Theta為選擇權敏感度分析的參數之一，用來衡量時間變化對選擇權價格的影響。
函數回傳值為選擇權剩餘天數每減少一天，選擇權理論價的變化。Theta永遠為負值，表示選擇權的時間價值隨著到期日的接近而消失。如果選擇權的Theta為-2，在所有條件維持不變的情況下，明日選擇權的理論價會由今天的70下降為68（70-1*2=68）。

**範例:**

```xs
// ```xs
value1 = BSTheta("C",8800,9000,20,2,0,25);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的Theta值
plot1(value1, "Theta");
// ```
// 註：更多參數說明請參考BlackScholes公式。
```
---
### BSPrice

**說明:**

回傳數值=BSPrice(買賣權,標的價格,履約價,到期天數,無風險利率,持有成本,波動率)\n期權相關\n以BlackScholes模型計算選擇權理論價\n傳入七個參數:\n- 第一個參數是買賣權，C表買權、P表賣權。\n- 第二個參數是標的價格。\n- 第三個參數是履約價。\n- 第四個參數是到期天數。\n- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。\n- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。\n- 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。\nBS選擇權定價模型為諾貝爾經濟學獎得主Robert Merton和Myron Scholes於1973所發表。依據下列六個參數決定選擇權的理論價：標的價格、履約價、到期天數、無風險利率、持有成本、波動率。其中只有履約價和到期天數是由合約所規定，其餘參數皆會隨市場狀況而變動。

**範例:**

```xs
value1 = BSPrice("C",8800,9000,20,2,0,25);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的理論價
plot1(value1, "理論價");
```
註：更多參數說明請參考BlackScholes公式。

---
### BSGamma

**說明:**

期權相關
以BlackScholes模型計算選擇權Gamma
傳入七個參數:
- 第一個參數是買賣權，C表買權、P表賣權。
- 第二個參數是標的價格。
- 第三個參數是履約價。
- 第四個參數是到期天數。
- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。
- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。
- 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。
Gamma為選擇權敏感度分析的參數之一，用來衡量Delta相對於標的價格變動的敏感度。
函數回傳值為標的價格每變動1％，選擇權Delta變化的百分比。Gamma永遠為正值，選擇權在價平時Gamma值最大。例如，假設選擇權的Delta為0.56、Gamma為0.0015，則表示只要標的價格上漲1點，Delta會由0.56增加至0.5615（0.56+1*0.0015=0.5615）

**範例:**

```xs
// ```xs
value1 = BSGamma("C",8800,9000,20,2,0,25);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的Gamma值
plot1(value1, "Gamma");
// ```
// 註：更多參數說明請參考BlackScholes公式。
```
---
### BSDelta

**說明:**

回傳數值=BSDelta(買賣權,標的價格,履約價,到期天數,無風險利率,持有成本,波動率)\n期權相關\n以BlackScholes模型計算選擇權Delta\n傳入七個參數:\n- 第一個參數是買賣權，C表買權、P表賣權。\n- 第二個參數是標的價格。\n- 第三個參數是履約價。\n- 第四個參數是到期天數。\n- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。\n- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。\n- 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。\nBS選擇權定價模型為諾貝爾經濟學獎得主Robert Merton和Myron Scholes於1973所發表。依據下列六個參數決定選擇權的理論價：標的價格、履約價、到期天數、無風險利率、持有成本、波動率。其中只有履約價和到期天數是由合約所規定，其餘參數皆會隨市場狀況而變動。

**範例:**

```xs
value1 = BSDelta("C",8800,9000,20,2,0,25);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的Delta值
plot1(value1, "Delta");
```
註：更多參數說明請參考BlackScholes公式。

---
### blackscholesmodel

**說明:**

期權相關
利用BlackScholes選擇權評價模型計算理論價及Greeks
回傳數值=BlackScholesModel (買賣權,標的價格,履約價,到期天數,無風險利率,持有成本,波動率,輸出理論價,輸出Delta,輸出Gamma,輸出Vega,輸出Theta,輸出Rho)
傳入十三個參數:
- 第一個參數是買賣權，C表買權、P表賣權。
- 第二個參數是標的價格。
- 第三個參數是履約價。
- 第四個參數是到期天數。
- 第五個參數是無風險利率，百分比值。若無風險利率為2%，請輸入2。
- 第六個參數是持有成本，百分比值。若持有成本為1%，請輸入1。
- 第七個參數是波動率，百分比值。若持有成本為30%，請輸入30。
- 第八個參數為傳址參數，會回傳計算完的選擇權理論價。
- 第九個參數為傳址參數，會回傳計算完的選擇權Delta。
- 第十個參數為傳址參數，會回傳計算完的選擇權Gamma。
- 第十一個參數為傳址參數，會回傳計算完的選擇權Vega。
- 第十二個參數為傳址參數，會回傳計算完的選擇權Theta。
- 第十三個參數為傳址參數，會回傳計算完的選擇權Rho。
BS選擇權定價模型為諾貝爾經濟學獎得主Robert Merton和Myron Scholes於1973所發表。依據下列六個參數決定選擇權的理論價：標的價格、履約價、到期天數、無風險利率、持有成本、波動率。其中只有履約價和到期天數是由合約所規定，其餘參數皆會隨市場狀況而變動。
持有成本會因標的商品的不同而異：
股票選擇權的持有成本為無風險利率（r）-股票殖利率
期貨選擇權的持有成本為0
外匯選擇權的持有成本為無風險利率（r）-外國無風險利率
這個函數可以依照使用者傳入的參數，計算選擇權的理論價、Delta、Gamma、Vega、Theta及Rho。

**範例:**

```xs
// ```xs
value1 = BlackScholesModel("C",8800,9000,20,2,0,25,value2,value3,value4,value5,value6,value7);       //計算波動率25%、20天後到期之台指選擇權9000的Call在指數為8800點的理論價
plot1(value2, "理論價");
plot2(value3, "Delta");
plot3(value4, "Gamma");
plot4(value5, "Vega");
plot5(value6, "Theta");
plot6(value7, "Rho");
// ```
```
---
### TrueCount

回傳數值=TrueCount(條件數列,期數)

**說明:**

邏輯判斷
計算符合條件連續符合的次數。
傳入二個參數:
- 第一個參數是條件數列。
- 第二個參數是期數。
以最新的資料為基準，往前計算連續符合條件的次數。

**範例:**

```xs
// ```xs
value1 = TrueCount(close>close[1],5); //計算過去5天連續收紅的次數
// ```
// 註：TrueCount函數和CountIfARow函數相同。
```
---
### TrueAny

**說明:**

回傳布林值=TrueAny(條件數列,期數)\n邏輯判斷\n判斷條件數列在指定期數內是否有任何一筆成立。\n傳入二個參數:\n- 第一個參數是條件數列。\n- 第二個參數是期數。\n當期間內有一筆以上條件成立時，回傳True；其他狀況則回傳False

**範例:**

```xs
condition1 = TrueAny(Close>Close[1],3); //判斷最近三期是否有任一期K棒上漲
```

---
### TrueAll

**說明:**

回傳布林值=TrueAll(條件數列,期數)\n邏輯判斷\n判斷條件數列在指定期數內是否同時成立。\n傳入二個參數:\n- 第一個參數是條件數列。\n- 第二個參數是期數。\n當期間內所有條件皆成立時，回傳True；其他狀況則回傳False

**範例:**

```xs
condition1 = TrueAll(Close>Close[1],3); //判斷K棒是否連續三期上漲
```

---
### SummationIf

**說明:**

回傳數值=SummationIf(條件數列,資料數列,期數)\n邏輯判斷\n計算符合條件的數值總和。\n傳入三個參數:\n- 第一個參數是條件數列，當條件值為True時，才會納入計算總和。\n- 第二個參數是資料數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n當某期資料符合某項判斷準則時，才將該期資料計入加總。

**範例:**

```xs
value1 = SummationIf(open>close[1],rateofchange(close,1),5); //計算近5期開高時的漲跌幅總和
```

---
### IFF

**說明:**

回傳數值=IFF(條件,條件成立時的回傳值,條件不成立時的回傳值)
邏輯判斷
依條件成立狀況回傳對應的值。
傳入三個參數:
- 第一個參數是條件。
- 第二個參數是條件成立時的回傳值。
- 第三個參數是條件不成立時的回傳值。

**範例:**

```xs
// ```xs
value1 = IFF(Close>Close[1],1,0); //當上漲時value1為1，其他狀況時value1為0
// ```
```
---
### GetBarOffsetForYears

回傳數值=GetBarOffsetForYears(數值)

**說明:**

邏輯判斷\n依年份取得相對K棒位置。\n依傳入的年份計算相對K棒的位置。\n當回傳值為0時，表示傳入年份 ≧K棒根數。

---
### Filter

**說明:**

回傳布林值=Filter(條件布林值,過濾期數)\n邏輯判斷\n過濾指定期數內重複出現的警示。\n傳入二個參數:\n- 第一個參數是代表被過濾條件是否成立的布林值。\n- 第二個參數是要過濾重複出現警示的期數。\n當條件成立後，過濾在指定期數內重複出現的警示。例如：當股價第一次創20日新高時，未來5天再創20日新高就不再警示。\n回傳TRUE，表示過濾後仍然成立的條件，意即原始條件為TRUE且距離原始條件成立的期數大於過濾期數。\n回傳FALSE，表示過濾後不成立的條件，意即原始條件為FALSE，或是距離原始條件成立的期數小於等於過濾期數。

**範例:**

```xs
if condition2 then ret = 1;
```
//警示腳本
condition1 = high = highest(high,20);       //判斷今高是否為20期之高點
condition2 = filter(condition1,5);       //過濾未來5期內重複的創新高警示

---
### DateTime

**說明:**

邏輯判斷\n資料的日期與時間，格式為14碼的數字。\n當日期為西元2015年6月30日，且時間為12點30分00秒時，回傳值為20150630123000。\n資料的日期與時間，格式為14碼的數字。\n當日期為西元2015年6月30日，且時間為12點30分00秒時，回傳值為20150630123000。

---
### CrossUnder

**說明:**

回傳布林值=CrossUnder(數列一,數列二)\n邏輯判斷\n判斷數列一是否由上往下穿越數列二，又稱死亡交叉。\n傳入二個參數:\n- 第一個參數是數列一。\n- 第二個參數是數列二。\n如果出現死亡交叉傳回True，其他狀況傳回False。

**範例:**

```xs
condition1 = CrossUnder(Average(close,5),Average(close,10)); //判斷5期均線和10期均線是否死亡交叉
```

---
### CrossOver

**說明:**

回傳布林值=CrossOver(數列一,數列二)\n邏輯判斷\n判斷數列一是否由下往上穿越數列二，又稱黃金交叉。\n傳入二個參數:\n- 第一個參數是數列一。\n- 第二個參數是數列二。\n如果出現黃金交叉傳回True，其他狀況傳回False。

**範例:**

```xs
condition1 = CrossOver(Average(close,5),Average(close,10)); //判斷5期均線和10期均線是否黃金交叉
```

---
### CountIfARow

回傳數值=CountIfARow(條件數列,期數)

**說明:**

邏輯判斷
計算符合條件連續符合的次數。
傳入二個參數:
- 第一個參數是條件數列。
- 第二個參數是期數。
以最新的資料為基準，往前計算連續符合條件的次數。

**範例:**

```xs
// ```xs
value1 = CountIfARow(close>close[1],5); //計算過去5天連續收紅的次數
// ```
// 註：CountIfARow函數和TrueCount函數相同。
```
---
### CountIf

回傳數值=CountIf(條件數列,期數)

**說明:**

邏輯判斷\n計算符合條件的次數。\n傳入二個參數:\n- 第一個參數是條件數列，當條件值為True時，才會納入計算。\n- 第二個參數是期數。\nCountIF會計算特定期間內符合某些條件的次數。

**範例:**

```xs
value1 = CountIf(open>close[1],5); //計算過去5天開高的次數
```

---
### AverageIF

**說明:**

回傳數值=AverageIF(條件數列,資料數列,期數)\n邏輯判斷\n計算符合條件的數值平均。\n傳入三個參數:\n- 第一個參數是條件數列，當條件值為True時，才會納入計算平均。\n- 第二個參數是資料數列，通常是開高低收的價格數列。\n- 第三個參數是期數。

**範例:**

```xs
value1 = averageif(open>close[1],rateofchange(close,1),5); //計算開高時漲跌幅5期平均
```

---
### UpShadow

**說明:**

趨勢分析\n回傳目前K棒上影線佔整根K棒的比例。\n回傳數值=UpShadow

**範例:**

```xs
value1 =UpShadow; //計算當期K棒之上影線佔整根K棒比例
```
value2 =UpShadow[1]; //計算前一期K棒之上影線佔整根K棒比例

---
### TSEMFI

**說明:**

趨勢分析\n利用大盤的資金流向指標來判斷多空方向\n回傳數值 = TSEMFI\n如果是多頭，回傳1，如果是空頭，回傳0\n利用大盤的資金流向指標來判斷多空方向\n回傳數值 = TSEMFI\n如果是多頭，回傳1，如果是空頭，回傳0

---
### TSELSindex

回傳數值=TSELSindex(期數,標準)

**說明:**

趨勢分析\n利用外資買賣超金額計算大盤的多空狀態。\n傳入二個參數:\n- 第一個參數是期數，指定要計算的區間。\n- 第二個參數是標準，要買超至少幾日才算多頭。\n詳細說明請參考交易的點點滴滴。

---
### TimeSeriesForecast

**說明:**

回傳數值=TimeSeriesForecast(數列,期數,預測值的相對K棒位置)\n趨勢分析\n計算線性迴歸預測資料投影點的位置。\n傳入三個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n- 第三個參數是預測值的相對K棒位置，和序列引用定義相同，0表當期、1表前一期、-1表後一期。\n利用最小平方法計算線性回歸的預測值。

**範例:**

```xs
value1 = TimeSeriesForecast(close,20,-1); //計算收盤價20期的線性迴歸
```
plot1(value1);                            //繪製明天的收盤價線性迴歸預測值連線

---
### SwingLowBar

**說明:**

回傳數值=SwingLowBar(數列,期數,左肩期數,右肩期數,第幾個低點)\n趨勢分析\n計算數列最近N個的轉折低點的相對位置。\n傳入五個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是要尋找轉折點的樣本期數。\n- 第三個參數是高點左側要有幾筆較高的數值。\n- 第四個參數是高點右側要有幾筆較高的數值。\n- 第五個參數是第幾個低點，依圖表由右往左(時間新到舊)，1為最近一次的低點、2為第二近的低點。\n若某一筆資料的左右二側數值在指定的期數內都比該筆資料高的話，則定義為轉折低點。\n當無法找到對應的轉折低點時，回傳值為-1。

**範例:**

```xs
value1 = SwingLowBar(Low,20,3,3,1); //找出過去20期內，第1個轉折低點的相對位置
```

---
### SwingLow

**說明:**

回傳數值=SwingLow(數列,期數,左肩期數,右肩期數,第幾個低點)\n趨勢分析\n計算數列最近N個的轉折低點數值。\n傳入五個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是要尋找轉折點的樣本期數。\n- 第三個參數是高點左側要有幾筆較高的數值。\n- 第四個參數是高點右側要有幾筆較高的數值。\n- 第五個參數是第幾個低點，依圖表由右往左(時間新到舊)，1為最近一次的低點、2為第二近的低點。\n若某一筆資料的左右二側數值在指定的期數內都比該筆資料高的話，則定義為轉折低點。\n當無法找到對應的轉折低點時，回傳值為-1。

**範例:**

```xs
value1 = SwingLow(Low,20,3,3,1); //找出過去20期內，第1個轉折低點
```

---
### SwingHighBar

**說明:**

回傳數值=SwingHighBar(數列,期數,左肩期數,右肩期數,第幾個高點)\n趨勢分析\n計算數列最近N個的轉折高點的相對位置。\n傳入五個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是要尋找轉折點的樣本期數。\n- 第三個參數是高點左側要有幾筆較低的數值。\n- 第四個參數是高點右側要有幾筆較低的數值。\n- 第五個參數是第幾個高點，依圖表由右往左(時間新到舊)，1為最近一次的高點、2為第二近的高點。\n若某一筆資料的左右二側數值在指定的期數內都比該筆資料低的話，則定義為轉折高點。\n當無法找到對應的轉折高點時，回傳值為-1。

**範例:**

```xs
value1 = SwingHighBar(High,20,3,3,2); //找出過去20期內，第2個轉折高點的相對位置
```

---
### SwingHigh

**說明:**

回傳數值=SwingHigh(數列,期數,左肩期數,右肩期數,第幾個高點)\n趨勢分析\n計算數列最近N個的轉折高點數值。\n傳入五個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是要尋找轉折點的樣本期數。\n- 第三個參數是高點左側要有幾筆較低的數值。\n- 第四個參數是高點右側要有幾筆較低的數值。\n- 第五個參數是第幾個高點，依圖表由右往左(時間新到舊)，1為最近一次的高點、2為第二近的高點。\n若某一筆資料的左右二側數值在指定的期數內都比該筆資料低的話，則定義為轉折高點。\n當無法找到對應的轉折高點時，回傳值為-1。

**範例:**

```xs
value1 = SwingHigh(High,20,3,3,2); //找出過去20期內，第2個轉折高點
```

---
### LinearRegSlope

回傳數值=LinearRegSlope(數列,期數)

**說明:**

趨勢分析\n計算線性迴歸的斜率。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n利用最小平方法計算線性回歸的斜率。

**範例:**

```xs
value1 = LinearRegSlope(close,20); //計算收盤價20期的線性迴歸線斜率
```

---
### LinearRegAngle

回傳數值=LinearRegAngle(數列,期數)

**說明:**

趨勢分析\n計算線性迴歸的弧度。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n利用最小平方法計算線性回歸的角度。

**範例:**

```xs
value1 = LinearRegAngle(close,20); //計算收盤價20期的線性迴歸線角度
```

---
### LinearReg

**說明:**

趨勢分析
計算線性迴歸的斜率與角度，以及預測資料投影點的位置。
傳入七個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
- 第三個參數是預測值的相對K棒位置，和序列引用定義相同，0表當期、1表前一期、-1表後一期。
- 第四個參數是輸出計算完的線性回歸線斜率。
- 第五個參數是輸出計算完的線性回歸線弧度。
- 第六個參數是輸出計算完的線性回歸線X軸截距。
- 第七個參數是輸出計算完的線性回歸線預測值。

**範例:**

```xs
LinearReg函數回傳1時，代表計算成功。斜率、弧度、X軸截距及預測值是回傳在第4、5、6、7個參數。
// ```xs
value1 = linearreg(close,20,-1,value2,value3,value4,value5); //計算收盤價20期的線性迴歸
// ```
plot1(value5);                                               //繪製明天的收盤價線性迴歸預測值連線
```
---
### Angle

回傳數值=Angle(日期1,日期2)

**說明:**

趨勢分析\n計算任意二個日期的走勢角度。\n傳入二個參數:\n- 第一個參數是日期1。\n- 第二個參數是日期2，需大於日期1。\n任意二個日期間的價格角度可以代表趨勢的強度。我們利用第一個日期的開盤價及第二個日期的收盤價計算整段走勢的角度。\n當回傳數值大於0時，代表趨勢向上；當回傳數值小於0時，代表趨勢向下。

**範例:**

```xs
value1 = Angle(date[3],date); //計算近四期走勢的角度
```

---
### VariancePS

**說明:**

回傳數值=VariancePS(數列,期數,母體或樣本)\n統計分析\n計算數列的變異數。\n傳入三個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n- 第三個參數是指定計算是母體變異數(1)或樣本變異數(2)。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的變異數。\n提供母體（Population）或樣本（Sample）二種計算方式。

**範例:**

```xs
value1 = VariancePS(close,20,2); //計算收盤價的變異數
plot1(value1);
```

---
### StandardDev

**說明:**

回傳數值=StandardDev(數列,期數,母體或樣本)\n統計分析\n計算數列的標準差。\n傳入三個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n- 第三個參數是指定計算是母體標準差(1)或樣本標準差(2)。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的標準差。\n提供母體（Population）或樣本（Sample）二種計算方式。

**範例:**

```xs
value1 = StandardDev(close,20,2); //計算收盤價的標準差
plot1(value1);
```

---
### RSquare

**說明:**

回傳數值=RSquare(數列一,數列二,期數)\n統計分析\n計算兩個數列的R平方值。\n傳入三個參數:\n- 第一個參數是第一個數列，通常是開高低收的價格數列。\n- 第二個參數是第二個數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的R平方值。

**範例:**

```xs
value1 = GetField("外資買賣超金額");
value3 = RSquare(value1,value2,20); //計算外資買賣超金額與大盤漲跌幅的R平方值
plot1(value3);
```
value2 = rateofchange(close,1);          //計算當日漲跌幅

---
### Covariance

**說明:**

回傳數值=Covariance(數列一,數列二,期數)\n統計分析\n計算兩個數列的共變異數。\n傳入三個參數:\n- 第一個參數是第一個數列，通常是開高低收的價格數列。\n- 第二個參數是第二個數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的共變異數。

**範例:**

```xs
value1 = GetField("外資買賣超金額");
value3 = Covariance(value1,value2,20); //計算外資買賣超金額與大盤漲跌幅的共變異數
plot1(value3);
```
value2 = rateofchange(close,1);        //計算當日漲跌幅

---
### Correlation

**說明:**

回傳數值=Correlation(數列一,數列二,期數)\n統計分析\n計算兩個數列的相關係數。\n傳入三個參數:\n- 第一個參數是第一個數列，通常是開高低收的價格數列。\n- 第二個參數是第二個數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的相關係數。\n回傳數值會介於-1到1之間。如果無法計算，會傳回-2。

**範例:**

```xs
value1 = GetField("外資買賣超金額");
value3 = Correlation(value1,value2,20); //計算外資買賣超金額與大盤漲跌幅的相關係數
plot1(value3);
```
value2 = rateofchange(close,1);          //計算當日漲跌幅

---
### CoefficientR

**說明:**

回傳數值=CoefficientR(數列一,數列二,期數)\n統計分析\n計算兩個數列的Pearson積差相關係數。\n傳入三個參數:\n- 第一個參數是第一個數列，通常是開高低收的價格數列。\n- 第二個參數是第二個數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的相關係數。\n回傳數值會介於-1到1之間。如果無法計算，會傳回-2。

**範例:**

```xs
value1 = GetField("外資買賣超金額");
plot1(value3);
```
value2 = rateofchange(close,1);          //計算當日漲跌幅
value3 = coefficientr(value1,value2,20); //計算外資買賣超金額與大盤漲跌幅的相關係數

---
### EnterMarketCloseTime

**說明:**

交易相關
回傳布林值。
判斷是否已經進入收盤階段：用來判斷不再進場 or 平倉當日部位。
使用時須傳入N，代表在最後可以送單前N分鐘就認定進入收盤階段，
例如如果傳1，而且是台股的話, 那在13:24:00就會回傳True，代表已經進入收盤階段。
※請注意：這個函數只支援台股, 以及台灣期貨市場內的常用商品, 也不考慮部分外匯期貨 or 其他市場期貨, 例如東証指。

**範例:**

```xs
// 可至 XQ 系統的 XScrip 編輯器，開啟「系統-交易相關」資料夾底下的 EnterMarketCloseTime 函數腳本，查看詳細函數語法撰寫邏輯。
```
---
### calcvwapdistribution

**說明:**

calcvwapdistribution(計算天數，開始時間，結束時間，一個array)\n交易相關\n計算過去N日的VWAP分佈。\n計算過去N日的VWAP分佈\n請傳入\n計算天數\n開始時間, 例如091000\n結束時間, 例如095900 (請注意請以1分K的Time為基準)\n一個array, 用來儲存上述指定區間內每分鐘的累積成交量分佈%,\nCalcVWAPDistribution會自動設定array的大小,\narray[1]是從開始時間後第1分鐘的累計成交量%, array[2]是從開始時間到後第2分鐘的累計成交量%, etc.\n請注意這是一個累積的數值, 例如array[1] = 2.5, array[2] = 5.4, array[3] = 7.0, ... array[最後一個]=100.0,

---
### UpTrend

回傳布林值=UpTrend(數列,期數)

**說明:**

日期相關\n判斷某個數列是否趨勢向上。\n傳入二個參數:\n- 第一個參數是數列，可以是GetField("欄位名稱")。\n- 第二個參數是期數。\n計算序列資料是否趨勢向上。回傳布林值。\n若為趨勢向上，則回傳「True」\n若不為趨勢向上，則回傳「False」

---
### NthDayofMonth

**說明:**

日期相關\n取得指定日期後第N個星期幾的日期。\n回傳數值=NthDayOfMonth(參考日期,第幾個,星期幾)\n傳入三個參數:\n- 第一個參數是日期，格式為YYYYMMDD的數值。\n- 第二個參數是第幾個，可以是正數(表示往後找), 也可以是負數(表示往前找)。\n- 第三個參數是星期幾：0為星期日，1為星期一，2為星期二，3為星期三，4為星期四，5為星期五，6為星期六\nNthDayOfMonth回傳的數值是YYYYMMDD的日期格式。

**範例:**

```xs
value1 = NthDayOfMonth(date,3,1)); //取得未來第3個星期一的日期
```

---
### NDaysAngle

回傳數值=NDaysAngle(期數)

**說明:**

日期相關\n計算股價N期走勢的角度\n計算股價N期走勢的角度。回傳數值。\n若為上漲趨勢，則回傳「0 ~ 90」度\n若為下跌趨勢，則回傳「0 ~ -90」度

**範例:**

```xs
plot1(NDaysAngle(_Length),"走勢角度");
```
input:_Length(10,"期數");        //計算10期走勢的角度

---
### LastDayOfMonth

回傳數值=LastDayOfMonth(月份)

**說明:**

日期相關\n取得指定月份的天數。\n傳入一個參數:\n- 第一個參數是月份，1為1月、2為2月...依此類推。\n傳回指定月份的天數。\n例如：一月有31天、二月只有28天、四月有30天。

**範例:**

```xs
value1 = LastDayOfMonth(month(date)); //取得當月的天數
```

---
### GetLastTradeDate

**說明:**

日期相關
取得台股指數類期貨商品的到期日期（該月第三個星期三）。
傳入二個參數:
- 第一個參數是商品月份。
- 第二個參數是商品年份。
依台灣期貨交易所規定台股指數類期貨商品的到期日期為該月的第三個星期三。
函數回傳值的格式為8碼數字: YYYYMMDD。
注意，此函數並無調整因放假而導致的到期日異動。

**範例:**

```xs
// ```xs
value1 = GetLastTradeDate(7,2015); //取得台股指數類期貨2015年7月合約的到期日
// ```
```
---
### formatMQY

回傳字串=formatMQY(參考日期)

**說明:**

日期相關\n依目前資料頻率取得代表日期字串。\n傳入一個參數:\n- 第一個參數是日期，格式為YYYYMMDD的數值。\nformatMQY回傳的字串為：\n當頻率為年時，回傳格式為YYYY的字串；例如：2015。\n當頻率為季時，回傳格式為YYYYQQ的字串；例如：2015Q1。\n當頻率為月時，回傳格式為YYYYMM的字串；例如：201501。\n當其他頻率時，回傳格式為YYYYMMDD的字串；例如：20150103。

**範例:**

```xs
var: string1("");
string1 = formatMQY(date); //將日期轉換為MQY格式的字串
print(date," ",string1);
```

---
### DownTrend

回傳布林值=DownTrend(數列,期數)

**說明:**

日期相關\n判斷某個序列是否趨勢向下。\n傳入二個參數:\n- 第一個參數是數列，可以是GetField("欄位名稱")。\n- 第二個參數是期數。\n計算序列資料是否趨勢向下。回傳布林值。\n若為趨勢向上，則回傳「True」\n若不為趨勢向上，則回傳「False」

---
### DaysToExpiration

**說明:**

日期相關
計算台股指數類期貨商品的到期天數。
傳入二個參數:
- 第一個參數是商品月份。
- 第二個參數是商品年份。
台股指數類期貨商品的到期日期為該月的第三個星期三。此函數會計算特定合約距當期K棒的天數。
回傳值為1，表示當天為結算日。回傳值小於1，表示該合約已到期。
注意，此函數並無調整因放假而導致的到期日異動。

**範例:**

```xs
// ```xs
value1 = DaysToExpiration(month(date),year(date));
value2 = dateadd(date,"M",1);
value2 = encodedate(year(value2),month(value2),1);
value1 = DaysToExpiration(month(value2),year(value2));
// ```
if value1 <= 1 then begin
end;
plot1(value1); //繪製最新的台股指數類期貨到期天數的連線
```
---
### BarsLast

回傳數值=BarsLast(條件數列)

**說明:**

日期相關\n取得上一次條件成立到當前的K棒數\n計算目前K棒與上次條件成立K棒的期數差。例如，上次KD黃金交叉是幾天前。\n回傳值為0表示條件成立當期，回傳值為1表示前1期條件成立，依此類推。

**範例:**

```xs
value1 = average(C,5);
value2 = average(C,20);
```
value3 = barslast(value1 cross over value2);       //計算上次5日均線和20日均線黃金交叉的期數差
value4 = low[value3];       //取得上次均線黃金交叉時的最低價做為支撐價
plot1(value4);       //繪製支撐價的連線

---
### angleprice

**說明:**

日期相關\n傳回「N期至今的角度的趨勢線價格」\n回傳數值=Angleprice(期數,角度)\n傳入二個參數:\n- 第一個參數是期數。\n- 第二個參數是角度。\n用前N期到現在的角度，運算出趨勢線的價格。

**範例:**

```xs
value1 = angleprice(5,0);
```
plot1(value1); //Value1為前五期的開盤價，因為第二個參數是0度，所以會等於前五期的開盤價。
更多的資訊，請參考常用語法匯總

---
### WAD

**說明:**

技術指標\n計算威廉多空力度線(Williams Accumulation/Distribution)。\n回傳數值=WAD\n由Larry Williams所發明的指標，屬於累積型的指標，指標值會因計算的起始點不同而有所差異。

**範例:**

```xs
value1 = WAD;              //計算威廉多空力度線
plot1(value1, "WA/D");
```

---
### VVA

**說明:**

OBV的變形累算方法，除了VA成交量累散佈指標以外，還有另外一種的變化方式，即VVA指標(Variable Volume Accumulation/Distribution)。\n技術指標\n計算VVA指標。\n回傳數值=VVA\nVVA屬於累積型的指標，指標值會因計算的起始點不同而有所差異。

**範例:**

```xs
value1 = VVA;       //計算VVA指標
plot1(value1, "VVA");
```

---
### VR

回傳數值=VR(期數)

**說明:**

技術指標\n計算成交量比率指標。\nVR(Volume Ratio)中文譯為「容量比率」，或者又稱為「成交量比率指標」。其計算方式為針對特定期間內，累加上漲日的成交量作為分子，以及累加下跌日的成交量作為分母，然後將此兩數相除即得。\nVR指標的設計原意，是要利用量價關係的基本原理，來作為研判股價的可能變動方向。\n如果VR公式中的分子與分母大小相同，則VR的數值會剛好等於100，表示計算期間內的上漲成交量等於下跌成交量。當VR大於100，表示上漲成交量大於下跌成交量；而VR小於100，則表示上漲成交量小於下跌成交量。\n不過，由於在股巿中，股價上漲時成交量的擴增比較沒有上限，可以擴增到數倍（甚或數十倍）之多；而股價下跌時成交量的下降反而比較有限，頂多只降個幾十個百分點（最多不會超過100%）。所以VR指標不會出現剛好以100為中心，上下波動幅度相同的情況。而是VR的高點會明顯大於100很多，低點則小於100的程度不大。

**範例:**

```xs
value1 = VR(26);       //計算26期的VR指標
plot1(value1, "VR");
```

---
### VPT

**說明:**

技術指標\n計算量價趨勢指標。\n回傳數值=VPT\nVPT（Volume Price Trend）量價趨勢指標，或被稱為PVT指標，也是一種類似於OBV的技術指標。而它所累算的是價格漲跌幅與成交量的乘積。

**範例:**

```xs
value1 = VPT;       //計算量價趨勢指標
plot1(value1, "VPT");
```

---
### VHF

回傳數值=VHF(期數)

**說明:**

技術指標\n計算垂直水平過濾指標。\n本指標由亞當．懷特（Adam White）所發明，用來確定價格的變動是處於水平變動（區間橫向整理期），或是垂直變動（固定趨勢的大幅漲跌期）的階段。然後投資人可依此選用趨勢指標或震盪指標，來決定買賣的時機。

**範例:**

```xs
value1 = VHF(42);       //計算42期的VHF指標
plot1(value1, "VHF");
```

---
### VAO

**說明:**

技術指標\n計算成交量累散佈擺盪指標。\n回傳數值=VAO\nVAO指標的原文是Volume Accumulation／Distribution Oscillator指標，按照原文的意思直譯為「成交量累積散佈擺盪」指標。累積指的自然是籌碼集中累積到少數人手上的現象，而散佈自然是指籌碼散佈分散到多數人手上的現象。這個指標與VA指標（即修正OBV指標）幾乎雷同，唯一的差別是VA指標要逐日累加，VAO不累加而已。

**範例:**

```xs
value1 = VAO;       //計算成交量累散佈擺盪指標
plot1(value1, "VAO");
```

---
### VA

**說明:**

技術指標\n計算成交量累散佈指標。\n回傳數值=VA\nVA指標的原文是Volume Accumulation／Distribution指標，原文的意思直譯的話，稱為「成交量累積散佈」指標。它的公式與修正OBV公式完全相同，沒有兩樣。\nVA屬於累積型的指標，指標值會因計算的起始點不同而有所差異。

**範例:**

```xs
value1 = VA;       //計算成交量累散佈指標
plot1(value1, "VA");
```

---
### TRIX

回傳數值=TRIX(數列,期數)

**說明:**

技術指標\n三重指數平滑移動平均指標。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\nTRIX是在1980年代由Jack Hutson所發明的指標。TRIX指的是對股價X取TRIPLE （三次） 平滑的意思。將數值計算三次指數移動平均（EMA，也就是MACD式平滑法）之後的數列，再計算其變動率而得。

**範例:**

```xs
value1 = TRIX(Close, 9);       //計算9期TRIX指標
plot1(value1, "TRIX");
```

---
### TechScore

**說明:**

技術指標\n計算多空判斷分數。\n回傳數值=TechScore\n利用多種指標計算多空分數，綜合研判後續走勢。使用的指標包括：Arron指標、隨機漫步指標、順勢指標、CMO錢德動量擺動指標、RSI、MACD、MTM、KD、DMI、AR、ACC、TRIX、SAR及均線計14種。\n多空判斷分數會介於0~14之間，12以上是超買區、3以下是超賣區。

**範例:**

```xs
value1 = TechScore;       //計算多空判斷分數
plot1(value1, "多空指標");
```

---
### Stochastic

**說明:**

技術指標
計算KD指標。
傳入六個參數:
- 第一個參數是資料期數，指定計算的區間長度。
- 第二個參數是K值平滑期數，指定計算K值所用的平滑期數。
- 第三個參數是D值平滑期數，指定計算D值所用的平滑期數。
- 第四個參數是輸出RSV值，回傳計算完的RSV值。
- 第五個參數是輸出K值，回傳計算完的K值。
- 第六個參數是輸出D值，回傳計算完的D值。
KD指標為美國交易員George Lane所創，原名為Stochastic Oscillator。
Stochastic函數可計算KD指標的RSV、K及D三個數值。Stochastic函數回傳1時，代表計算成功。RSV、K及D的值是回傳在第4、5、6個參數。

**範例:**

```xs
// ```xs
value1 = Stochastic(9,3,3,value2,value3,value4);       //計算KD指標
plot1(value3, "K");
plot2(value4, "D");
// ```
```
---
### SAR

**說明:**

回傳數值=SAR(加速因子初始值,加速因子遞增值,加速因子最大值)\n技術指標\nSAR停損點轉向指標，或稱為拋物線型指標，為一種設定停損點相當有效力的指標。\n傳入三個參數:\n- 第一個參數是加速因子初始值。\n- 第二個參數是加速因子遞增值。\n- 第三個參數是加速因子最大值。\n由威爾德（Wilder）發明的停損點轉向操作系統（SAR, Stop And Reverse）或者稱之為拋物線型指標（Parabolic Time/Price），是一種隨著時間的延續，用類似於拋物曲線的追趕方式，來追趕價位行情，以便設定出買賣操作時的停損點反轉值，使得一旦行情觸及停損反轉時，可以依照訊號進行買賣的動作。

**範例:**

```xs
value1 = SAR(0.02, 0.02, 0.2);       //計算SAR指標
plot1(value1, "SAR");
```

---
### RSV

回傳數值=RSV(期數)

**說明:**

技術指標\n未成熟隨機值\n計算收盤價在指定期間內的區間最高價與最低價之間位置，以百分比表示。後續可用來計算KD指標的K值與D值。\n計算公式：\nRSV=(收盤價－n日之最低價)／(n日內最高價－n日最低價)＊100

**範例:**

```xs
value1 = RSV(9);       //計算9期的RSV指標
plot1(value1, "RSV");
```

---
### RSI

回傳數值=RSI(數列,期數)

**說明:**

技術指標\n計算相對強弱指標數值。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\nRSI是相對強弱指標（Relative Strength Index）用於衡量一個資產的過去價格變動，並評估其是否處於超買或超賣的狀態。\nRSI的計算基於資產的價格變動幅度，通常在一段時間內（例如14個交易日）內進行計算。指標的值位於0到100之間，通常被分成以下幾個區域：\n80以上：表示該資產可能處於超買狀態，可能會有回調或調整的風險。\n20以下：表示該資產可能處於超賣狀態，可能會有反彈或上漲的機會。\n投資者可以利用RSI指標來識別潛在的轉折點，例如在RSI進入超買或超賣區域時，可能預示著價格反轉的機會。

**範例:**

```xs
value1 = RSI(Close,6);       //計算6期的RSI指標
plot1(value1, "RSI");
```

---
### RC

回傳數值=RC(期數)

**說明:**

技術指標\n計算價格變動率。\n計算當期對N期前的變動幅度。\n計算公式：\nRC = （當期收盤價／前N期收盤價）／前N期收盤價

**範例:**

```xs
value1 = RC(12);       //計算12期的RC指標
plot1(value1, "RC");
```

---
### Q指標

**說明:**

回傳數值=callfunction("Q指標",期數,平滑期數,雜訊平滑期數);\n技術指標\n計算技術分析的Q值。\n傳入三個參數:\n- 第一個參數是期數，指定要計算累積價格變化的區間。\n- 第二個參數是平滑期數，計算累積價格變化的簡單移動平均。\n- 第三個參數是雜訊平滑期數，計算雜訊的簡單移動平均。\n詳細說明請參考交易的點點滴滴。

---
### PSY

回傳數值=PSY(期數)

**說明:**

技術指標\n人氣指標心理線。\n計算特定期間內，行情上漲期數的比例。\n計算公式：\nPSY = 100 * 上漲次數／總次數

**範例:**

```xs
value1 = PSY(12);       //計算12期的心理線指標
plot1(value1, "PSY");
```

---
### PercentR

回傳數值=PercentR(期數)

**說明:**

技術指標\n計算威廉指標（或稱百分比R、%R）。\n由Larry Williams所提出，將當前收盤價在指定期間內的區間最高價與最低價之間位置，以百分比表示。

**範例:**

```xs
value1 = PercentR(12) - 100;       //計算12期的威廉指標
plot1(value1, "%R");
```

---
### MTM_MA

回傳數值=MTM_MA(期數)

**說明:**

技術指標\n平均運動量指標，計算運動量指標的簡單移動平均。\n計算公式：\nMTM_MA = （當期收盤價 - 前N期收盤價）的N期平均

**範例:**

```xs
value1 = MTM_MA(10);       //計算收盤價10期的平均運動量指標
plot1(value1, "MTM_MA");
```

---
### MTM

回傳數值=MTM(期數)

**說明:**

技術指標
計算收盤價的變動量。
以收盤價計算目前K棒與N根K棒之前的差值。
計算公式：

**範例:**

```xs
// ```xs
value1 = MTM(10);       //計算收盤價10期的運動量指標
plot1(value1, "MTM");
// ```
// 與Momentum函數相同。
```
---
### Momentum

回傳數值=Momentum(數列,期數)

**說明:**

技術指標\n計算數列指定期間的變動量。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n計算目前K棒與N根K棒之前的差值。\n計算公式：\nMomentum = 當期價格 - 前N期價格

**範例:**

```xs
value1 = Momentum(Close,10);       //計算收盤價10期的運動量指標
plot1(value1, "MTM");
```

---
### MO

回傳數值=MO(期數)

**說明:**

技術指標\n計算收盤價變動的百分比。\n動量震盪指標（Momentum Oscillator）和MTM相類似，都是測量收盤價的變動量。\n差別在於MTM指標是計算變動絕對值，而MO為變動的百分比來衡量變動量。\n計算公式：\nMO = ( 當期收盤價 ／ 前N期收盤價 ) * 100

**範例:**

```xs
value1 = MO(10);       //計算收盤價10期的運動量指標
plot1(value1, "MO");
```

---
### MI

回傳數值=MI(期數1,期數2)

**說明:**

技術指標\n計算質量指標。\n傳入二個參數:\n- 第一個參數是計算指數移動平均的期數。\n- 第二個參數是計算總和的期數。\nMI指標（Mass Index）是由Donald Dorsey所發明。質量指標是觀察高低價範圍的變化，試圖找出趨勢的反轉點。\n計算公式：\nEMA1 = (最高價－最低價)的9日EMA\nEMA2 = EMA1 的9日EMA\nMI = ( EMA1 ／ EMA2 ) 的N2日簡單加總

**範例:**

```xs
value1 = MI(9,25);       //計算收盤價10期的質量指標
plot1(value1, "MI");
```

---
### MAM

**說明:**

回傳數值=MAM(移動平均期數,動量期數)\n技術指標\n計算MAM指標。\n傳入二個參數:\n- 第一個參數是用來計算移動平均的期數。\n- 第二個參數是用來計算動量的期數。\n移動平均動量指標（Moving Average Momentum）的用法、概念和Momentum相同，但計算方式改為計算移動平均的動量。\n計算公式：當期移動平均值，減去n期前的移動平均值。

**範例:**

```xs
value1 = MAM(10,10);       //計算MAM指標
plot1(value1, "MAM");
```

---
### MACD

**說明:**

技術指標
計算MACD指標值。
傳入七個參數:
- 第一個參數是數列，MACD通常是以加權平均收盤價（WeightedClose）來計算。
- 第二個參數是計算快速線（短期）的期數。
- 第三個參數是計算慢速線（長期）的期數。
- 第四個參數是計算MACD使用之平滑期數。
- 第五個參數是輸出計算完的DIF值。
- 第六個參數是輸出計算完的MACD值。
- 第七個參數是輸出計算完的OSC值。
MACD是由Gerald Appel於1970年代所發明的指標。利用二條快速與慢速指數移動平均線的收斂或發散來判斷價格走勢。
MACD指標包含了DIF、MACD及OSC三個數值。MACD函數回傳1時，代表計算成功。DIF、MACD及OSC的值是回傳在第5、6、7個參數。

**範例:**

```xs
// ```xs
value1 = MACD(WeightedClose,12,26,9,value2,value3,value4);       //計算MACD
plot1(value2, "DIF");
plot2(value3, "MACD");
plot3(value4, "OSC");
// ```
```
---
### MA_Osc

回傳數值=MA_Osc(短期數,長期數)

**說明:**

技術指標\n計算移動平均線擺盪指標。\n傳入二個參數:\n- 第一個參數是計算快速線（短期）的期數。\n- 第二個參數是計算慢速線（長期）的期數。\nMA_Osc是計算二條不同期數的簡單移動平均線差值而得。

**範例:**

```xs
value1 = MA_Osc(5,10);       //計算MA-Osc
plot1(value1, "MA_Osc");
```

---
### KST確認指標

回傳數值=callfunction("KST確認指標");

**說明:**

技術指標\n計算KST確認指標值。\n詳細說明請參考交易的點點滴滴。

**範例:**

```xs
value1=callfunction("KST確認指標");
```

---
### KO成交量擺盪指標

**說明:**

回傳數值=callfunction("KO成交量擺盪指標",短期數,長期數,雜訊平滑期數);\n技術指標\n計算KO成交量擺盪值。\n傳入三個參數:\n- 第一個參數是短期數，計算短期KO成交量的簡單移動平均。\n- 第二個參數是長期數，計算長期KO成交量的簡單移動平均。

**範例:**

```xs
value1 =callfunction("KO成交量擺盪指標", Length1, Length2);
```

---
### KeltnerUB

回傳數值=KeltnerUB(通道倍數)

**說明:**

技術指標\n計算肯特納通道的上通道線（壓力線）。\n肯特納通道是原始概念是由Chester W. Keltner於1960年代所發明。但現在較常用的版本是由Linda Bradford Raschke於1980年代所出的修正版本。\n原始版本的肯特納通道是以10期的典型價移動平均線為中心線，然後以10期的當日高低價差平均為通道寬度。\n新版的肯特納通道是以20期的收盤價指數移動平均線為中心線，然後以2.5倍的20期真實範圍平均做通道寬度。我們提供的是較新版本的肯特納通道。

**範例:**

```xs
value1 = KeltnerUB(2.5);       //計算肯特納通道的上通道線
plot1(value1, "KeltnerUpperBand");
```

---
### KeltnerMA

回傳數值=KeltnerMA(期數)

**說明:**

技術指標\n計算肯特納通道的中心線。\n肯特納通道是原始概念是由Chester W. Keltner於1960年代所發明。但現在較常用的版本是由Linda Bradford Raschke於1980年代所出的修正版本。\n原始版本的肯特納通道是以10期的典型價移動平均線為中心線，然後以10期的當日高低價差平均為通道寬度。\n新版的肯特納通道是以20期的收盤價指數移動平均線為中心線，然後以2.5倍的20期真實範圍平均做通道寬度。我們提供的是較新版本的肯特納通道。

**範例:**

```xs
value1 = KeltnerMA(20);       //計算肯特納通道的中心線
plot1(value1, "KeltnerMid");
```

---
### KeltnerLB

回傳數值=KeltnerLB(通道倍數)

**說明:**

技術指標\n計算肯特納通道的下通道線（支撐線）。\n肯特納通道是原始概念是由Chester W. Keltner於1960年代所發明。但現在較常用的版本是由Linda Bradford Raschke於1980年代所出的修正版本。\n原始版本的肯特納通道是以10期的典型價移動平均線為中心線，然後以10期的當日高低價差平均為通道寬度。\n新版的肯特納通道是以20期的收盤價指數移動平均線為中心線，然後以2.5倍的20期真實範圍平均做通道寬度。我們提供的是較新版本的肯特納通道。

**範例:**

```xs
value1 = KeltnerLB(2.5);       //計算肯特納通道的下通道線
plot1(value1, "KeltnerLowerBand");
```

---
### K_Value

**說明:**

回傳數值=K_Value(資料期數,K值平滑期數)\n技術指標\n計算KD指標中的K值。\n傳入二個參數:\n- 第一個參數是資料期數，指定計算的區間長度。\n- 第二個參數是K值平滑期數，指定計算K值所用的平滑期數。\nKD指標為美國交易員George Lane所創，原名為Stochastic Oscillator。\nK_Value即隨機指標中的快速線（%K）。

**範例:**

```xs
value1 = K_Value(9,3);       //計算KD指標中的K值
plot1(value1, "K");
```

---
### HL_Osc

**說明:**

技術指標\n計算HL-Osc指標。\n回傳數值=HL_Osc\n高低價擺盪指標（High Low Oscillator）是以當日高點至昨收這段價差佔真實區間的比例來判斷強弱勢。

**範例:**

```xs
value1 = HL_Osc;       //計算HL-Osc指標
plot1(value1, "HL-Osc");
```

---
### ERC

**說明:**

回傳數值=ERC(資料期數,平滑期數)\n技術指標\n計算價格變動率的指數移動平均。\n傳入二個參數:\n- 第一個參數是計算RC的資料期數。\n- 第二個參數是計算ERC的平滑期數。\n計算當期對N期前的變動幅度，再對此數值取指數移動平均。

**範例:**

```xs
value1 = ERC(12,12);       //計算12期的ERC指標
plot1(value1, "ERC");
```

---
### EMP

**說明:**

技術指標\n計算Empty Line指標值\n回傳數值=EMP\nEmpty Line是移動平均線的一種變化，它的數值的計算方式是用3期、6期、12期與24期的移動平均線值取平均後產生的。\n計算公式：\nEMP = （3期收盤價平均 + 6期收盤價平均 + 12期收盤價平均 + 24期收盤價平均）／4

**範例:**

```xs
value1 = EMP;       //計算EMP指標
plot1(value1, "EMP");
```

---
### DPO

回傳數值=DPO(期數)

**說明:**

技術指標\n計算DPO指標。\n非趨勢價格擺盪指標（Detrended Price Oscillator）是Walt Bressert所發明的指標。他研究商品的循環後發現，一個長期波動中包含了多個短期波動。因此，觀察短期波動的變化規律，可以估計長期波動高低點出現的時機。例如：二個短期循環底部，形成一個長期循環底部。因此，DPO指標刻意忽略較長期的波動，一方面可以減少週期干擾的混淆，也可以凸顯個別週期的波動。

**範例:**

```xs
value1 = DPO(10);       //計算10期的DPO指標
plot1(value1, "DPO");
```

---
### DMO

回傳數值=DMO(期數)

**說明:**

技術指標\n計算DMO指標。\nDMO指標（Directional Movement Oscillator）是利用DMI趨向指標指標中的正負DI線計算，以此二條線的差值做為新的指標線。

**範例:**

```xs
value1 = DMO(14);       //計算14期的DMO指標
plot1(value1, "DMO");
```

---
### DirectionMovement

**說明:**

技術指標
計算DMI指標。
傳入四個參數:
- 第一個參數是計算期數。
- 第二個參數是輸出計算完的+DI值。
- 第三個參數是輸出計算完的-DI值。
- 第四個參數是輸出計算完的ADX值。
DMI趨向指標是威爾德（Wilder）所發明。主要的用途在於作趨勢成立的判斷，因此是屬於較為長期交易的技術指標。
DMI指標包含了+DI、-DI及ADX三個數值。DirectionMovement函數回傳1時，代表計算成功。+DI、-DI及ADX的值是回傳在第2、3、4個參數。

**範例:**

```xs
// ```xs
value1 = DirectionMovement(14,value2,value3,value4);       //計算14期的DMI指標
plot1(value2, "+DI");
plot2(value3, "-DI");
plot3(value4, "ADX");
// ```
```
---
### DIF

回傳數值=DIF(短期數,長期數)

**說明:**

技術指標\n計算MACD中的DIF值。\n傳入二個參數:\n- 第一個參數是計算快速線（短期）的期數。\n- 第二個參數是計算慢速線（長期）的期數。\nMACD是由Gerald Appel於1970年代所發明的指標。利用二條快速與慢速指數移動平均線的收斂或發散來判斷價格走勢。\nDIF是快速線與慢速線的差值。

**範例:**

```xs
value1 = DIF(12,26);       //計算MACD中的DIF值
plot1(value1, "DIF");
```

---
### D_Value

**說明:**

回傳數值=D_Value(資料期數,D值平滑期數)\n技術指標\n計算KD指標中的D值。\n傳入二個參數:\n- 第一個參數是資料期數，指定計算的區間長度。\n- 第二個參數是D值平滑期數，指定計算D值所用的平滑期數。\nKD指標為美國交易員George Lane所創，原名為Stochastic Oscillator。\nD_Value即隨機指標中的慢速線（%D）。

**範例:**

```xs
value1 = D_Value(9,3);       //計算KD指標中的D值
plot1(value1, "D");
```

---
### CommodityChannel

回傳數值=CommodityChannel(期數)

**說明:**

技術指標
計算CCI技術指標值。
CCI順勢指標為Donald Lambert在1980年代發明的指標。CCI大多時間會落在+100到-100之間，主要的功能在於針對商品本身所具有的週期循環特性，來尋找出行情的高低價位區來。
若CCI值從一高點急速往下降時，可視為是賣出的訊號；同理若CCI值從一低點快速往上升時，可視之為買進的訊號。

**範例:**

```xs
// ```xs
value1 = CommodityChannel(14);       //計算14期的CCI
plot1(value1, "CCI");
// ```
// 註：CommodityChannel函數和CCI函數相同。
```
---
### CCI

回傳數值=CCI(期數)

**說明:**

技術指標
計算CCI技術指標值。
CCI順勢指標為Donald Lambert在1980年代發明的指標。CCI大多時間會落在+100到-100之間，主要的功能在於針對商品本身所具有的週期循環特性，來尋找出行情的高低價位區來。
若CCI值從一高點急速往下降時，可視為是賣出的訊號；同理若CCI值從一低點快速往上升時，可視之為買進的訊號。

**範例:**

```xs
// ```xs
value1 = CCI(14);       //計算14期的CCI
plot1(value1, "CCI");
// ```
// 註：CCI函數和CommodityChannel函數相同。
```
---
### BR

回傳數值=BR(期數)

**說明:**

技術指標\n計算意願指標值，用來觀察開盤前對股價的預期心理。\nBR買賣意願指標是一種被用來配合AR買賣人氣指標作分析的技術指標。它的公式推算原理方式也相當的類似於AR指標，利用統計某一段時日內，前一日收盤價位分別與當日最高價及當日最低價位二者的差距和的比值，以此來作為該段期間內，買賣行情雙方力道強弱的參考指標。\n計算公式：\nBR ＝ (今日最高價－昨日收盤價) N日內總合 ／ (昨日收盤價－今日最低價)絕對值的N日內總合

**範例:**

```xs
value1 = BR(26);       //計算26期的BR指標
plot1(value1, "BR");
```

---
### BollingerBand

**說明:**

回傳數值=BollingerBand(數列,期數,標準差倍數)\n技術指標\n計算包寧傑通道線。\n傳入三個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是計算均線的期數。\n- 第三個參數是決定通道寬度的標準差倍數，輸入正值時為計算上通道，輸入負值時為計算下通道。\n包寧傑通道為John Bollinger在1980年代發明的指標。以價格均線為中心點，往上N個標準差為通道上限（壓力線）；往下減去N個標準差，為通道下限（支撐線）。

**範例:**

```xs
value1 = BollingerBand(Close,20,2);       //計算20期、2個標準差寬的包寧傑通道上限
plot1(value1, "BollingerUpperBand");
```

---
### BiasDiff

**說明:**

回傳數值=BiasDiff(短期期數,長期期數)\n技術指標\n計算長短期乖離率的差值。\n傳入二個參數:\n- 第一個參數是較短的期數。\n- 第二個參數是較長的期數。\n除了價格數列和均線間會出現均線回歸的現象外，長短期的均線也會反復出現發散、收斂的循環現象。乖離率差是用來觀察長短期均線相對關係。

**範例:**

```xs
value1 = BiasDiff(3,6);       //計算3期與6期的乖離率差
plot1(value1, "BiasDiff");
```

---
### Bias

回傳數值=Bias(期數)

**說明:**

技術指標\n計算一段時間內的收盤價與均線的乖離程度。\n以百分比幅度值表示移動平均線到底離股票價位有多遠。如果我們把移動平均線值當成是市場的平均買入成本的話，則乖離率可以想像成是目前市場上平均的獲利率。\n另外，乖離率用來觀察均線回歸的現象。當乖離率來到歷史的極大值或極小值附近時，可能會是趨勢的反轉點。

**範例:**

```xs
value1 = Bias(5);       //計算5期的乖離率
plot1(value1, "Bias");
```

---
### ATR

回傳數值=ATR(期數)

**說明:**

技術指標\n計算平均真實區間指標值。\n平均真實區間是真實區間（True Range）的平均。\n真實區間是韋爾達（J. W. Wilder）於1978年發表於New Concepts in Technical Trading Systems中測量價格波動性的方法。\n根據韋爾達的定義，真實區間為下列三項中的最大值：\n當期最高價至最低價的幅度。\n當期最低價與前期收盤價的幅度。\n當期最高價至前期收盤價的幅度。

**範例:**

```xs
value1 = ATR(14);       //計算14期的ATR指標
plot1(value1, "ATR");
```

---
### AR

回傳數值=AR(期數)

**說明:**

技術指標\n計算人氣指標值，買賣氣勢強度的測試指標，觀察開盤後對股價的現實反應。\nAR值高時，代表行情很活潑，當AR值介於0.25至1.85(25%至185%)間時，屬於盤整行情。\nAR值低時，表示人氣不足。\n計算公式如下：\nAR ＝ (今日最高價－今日開盤價) N日內總合 ／ (今日開盤價－今日最低價) N日內總合

**範例:**

```xs
value1 = AR(26);       //計算26期的AR指標
plot1(value1, "AR");
```

---
### ADO

ADO＝( BP + SP ) ／ ( 2 * ( 最高價 － 最低價 ) ) * 100

**說明:**

技術指標\n計算聚散擺盪指標值。\n回傳數值=ADO\nADO指標的原文是Accumulation／Distribution Oscillator，直譯為「聚散擺盪」指標。\n計算公式如下：\n其中\nBP = 最高價－開盤價\nSP = 收盤盤－最低價

**範例:**

```xs
value1 = ADO;              //計算聚散擺盪指標
plot1(value1, "A/D-Osc");
```

---
### ADI

**說明:**

技術指標\n計算累積分配指標值。\n回傳數值=ADI\nADI指標的原文是Accumulation Distribution Index，按原文直譯的名稱是「累積分配指標」，其實它真正的意思是「漲跌力道聚散指標」，Accumulation指的是上漲力道在累積，而Distribution指的是上漲力道在消散之意，所以是「聚散指標」。\n當日價格上漲時，表示上升力道戰勝，將此上升力道累積起來。\n若當日是下跌，便從上升累積力道中減去下降的力道。

**範例:**

```xs
value1 = ADI;           //計算累積分配指標
plot1(value1, "A/DI");
```

---
### ACC

**說明:**

ACC加速量指標(Acceleration)。用來觀察行情價格變化的加速度幅度。\n技術指標\n回傳數值=ACC(期數)\nACC是將MTM運動量指標再做一次動量運算的指標。

**範例:**

```xs
value1 = ACC(10);       //計算收盤價10期的加速量指標
plot1(value1, "ACC");
```

---
### YoY

回傳數值=YoY(數列)

**說明:**

價格關係\n計算序列資料的年變化率(換算成百分比)\n限用於年頻率資料。

**範例:**

```xs
plot1(YoY(close));    //繪製收盤價的年變化率連線
```

---
### SimpleLowest

回傳數值=SimpleLowest(數列,期數)

**說明:**

價格關係
計算序列資料的最小值。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極小值。
每次呼叫SimpleLowest時，腳本都會依照指定期別，往前抓取期別內的每一筆資料來計算。
系統另外提供Lowest函數，也可以用來計算過去期數的最大值，兩者的差異請參考Lowest函數的說明。

**範例:**

```xs
// ```xs
plot1(SimpleLowest(low,5));    //繪製5期最低價的最小值的連線
// ```
```
---
### SimpleHighest

回傳數值=SimpleHighest(數列,期數)

**說明:**

價格關係
計算序列資料的最大值。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極大值。
每次呼叫SimpleHighest時，腳本都會依照指定期別，往前抓取期別內的每一筆資料來計算。
系統另外提供Highest函數，也可以用來計算過去期數的最大值，兩者的差異請參考Highest函數的說明。

**範例:**

```xs
// ```xs
plot1(SimpleHighest(high,5));    //繪製5期最高價的最大值的連線
// ```
```
---
### ReadTicks

**說明:**

ReadTicks(傳入要儲存tick資料的array, 上次讀到的Tick編號SeqNo)\n價格關係\n回測在1分鐘頻率時，不支援模擬逐筆洗價。\n讀取從上次洗價到這次洗價之間的Tick資料。\n需要宣告一個2維陣列來儲存Tick資料。\nvar: intrabarpersist readtick_cookie(0);// ReadTicks內部使用, 每次呼叫時請照實傳入\narray: tick_array[100, 11](0);// 需要宣告一個2維陣列來儲存Tick資料\n// 陣列的第一維是最大讀取筆數,\n// 陣列的第二維是每一筆的欄位數, 目前必須是10\nvalue1 = ReadTicks(tick_array, readtick_cookie);// value1會是tick_array內所讀到的筆數\n// tick_array[1, ..] 是洗價當時最新的一筆\n// tick_array[2, ..] 是前一筆(往前算第2筆)\n// tick_array[value1, ..] 是往前讀到的最後一筆\n請參考 台股逐筆撮合的連續成交Tick序列 此篇文章介紹。

---
### QoQ

回傳數值=QoQ(數列)

**說明:**

價格關係\n計算序列資料的季變化率(換算成百分比)\n限用於季頻率資料。

**範例:**

```xs
plot1(QoQ(close));    //繪製收盤價的季變化率連線
```

---
### OHLCPeriodsAgo

**說明:**

回傳數值=OHLCPeriodsAgo(頻率,K棒相對位置,輸出之開盤價,輸出之最高價,輸出之最低價,輸出之收盤價,)\n價格關係\n計算指定頻率K棒的開盤價，最高價，最低價，收盤價。\n僅能取得目前計算數列較高頻率之K棒資料\n傳入六個參數:\n- 第一個參數是頻率，1:日線、2:週線、3:月線、3.25:季、3.5 半年、4:年線\n- 第二個參數是K棒相對位置，和序列引用定義相同，0表當期、1表前一期...依此類推。\n- 第三個參數為傳址參數，會回傳指定頻率的開盤價。\n- 第四個參數為傳址參數，會回傳指定頻率的最高價。\n- 第五個參數為傳址參數，會回傳指定頻率的最低價。\n- 第六個參數為傳址參數，會回傳指定頻率的收盤價。\n取得特定頻率、特定K棒的開盤價、最高價、最低價和收盤價\n計算成功時回傳值為1，結果會回傳在第3~6個參數。

**範例:**

```xs
value1 = OHLCPeriodsAgo(2,1,value2,value3,value4,value5); //計算前期週線的開高低收價
```
plot1(value4);                                            //繪製前期週線最低價的連線

---
### NthLowestBar

**說明:**

回傳數值=NthLowestBar(第幾個極小值,數列,期數)\n價格關係\n計算序列資料的第N個極小值距當期K棒的相對位置。\n傳入三個參數:\n- 第一個參數是要計算極小值的序號。\n- 第二個參數是數列，通常是開高低收的價格數列。\n- 第三個參數是期數。

**範例:**

```xs
value1 = NthLowestBar(2,low,5); //計算近5期次低的最低價的相對位置
```
plot1(value1);                  //繪製近5期次低的最低價相對位置的連線

---
### NthLowestArray

**說明:**

價格關係
計算陣列資料的第N個極小值。
傳入三個參數:
- 第一個參數是要計算的陣列。
- 第二個參數是陣列大小。
- 第三個參數是要計算極小值的序號。

**範例:**

```xs
// ```xs
arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
value1 = NthLowestArray(arrA,5,3); //計算陣列arrA的第三個極小值
// ```
Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
plot1(value1);                      //繪製陣列arrA的第三個極小值的連線
```
---
### NthLowest

**說明:**

回傳數值=NthLowest(第幾個極小值,數列,期數)\n價格關係\n計算序列資料的第N個極小值。\n傳入三個參數:\n- 第一個參數是要計算極小值的序號。\n- 第二個參數是數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的第N個極小值。

**範例:**

```xs
value1 = NthLowest(2,low,5); //計算近5期次低的最低價
```
plot1(value1);               //繪製近5期次低的最低價的連線

---
### NthHighestBar

**說明:**

回傳數值=NthHighestBar(第幾個極大值,數列,期數)\n價格關係\n計算序列資料的第N個極大值距當期K棒的相對位置。\n傳入三個參數:\n- 第一個參數是要計算極大值的序號。\n- 第二個參數是數列，通常是開高低收的價格數列。\n- 第三個參數是期數。

**範例:**

```xs
value1 = NthHighestBar(2,high,5); //計算近5期次高的最高價的相對位置
```
plot1(value1);                    //繪製近5期次高的最高價相對位置的連線

---
### NthHighestArray

**說明:**

價格關係
計算陣列資料的第N個極大值。
傳入三個參數:
- 第一個參數是要計算的陣列。
- 第二個參數是陣列大小。
- 第三個參數是要計算極大值的序號。

**範例:**

```xs
// ```xs
arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
value1 = NthHighestArray(arrA,5,3); //計算陣列arrA的第三個極大值
// ```
Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
plot1(value1);                      //繪製陣列arrA的第三個極大值的連線
```
---
### NthHighest

**說明:**

回傳數值=NthHighest(第幾個極大值,數列,期數)\n價格關係\n計算序列資料的第N個極大值。\n傳入三個參數:\n- 第一個參數是要計算極大值的序號。\n- 第二個參數是數列，通常是開高低收的價格數列。\n- 第三個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的第N個極大值。

**範例:**

```xs
value1 = NthHighest(2,high,5); //計算近5期次高的最高價
```
plot1(value1);                 //繪製近5期次高的最高價的連線

---
### NthExtremesArray

**說明:**

價格關係
計算陣列資料的第N個極大值或極小值。
傳入六個參數:
- 第一個參數是要計算的陣列。
- 第二個參數是陣列大小。
- 第三個參數是要計算極值的序號。
- 第四個參數是要計算極大值或極小值；1為極大值、-1為極小值。
- 第五個參數為傳址參數，會回傳計算完的極值。
- 第六個參數是傳址參數，會回傳極值的陣列索引值。
計算成功時回傳值為1，結果會回傳在第5、6個參數。

**範例:**

```xs
// ```xs
arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
value1 = NthExtremesArray(arrA,5,3,-1,value2,value3); //計算陣列arrA的第三個極小值
// ```
Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
plot1(value2);                                   //繪製陣列arrA的第三個極小值的連線
```
---
### NthExtremes

**說明:**

回傳數值=NthExtremes(數列,期數,第幾個極值,要計算極大值或極小值,輸出極值,輸出極值K棒相對位置)\n價格關係\n計算序列資料的第N個極大值或極小值。\n傳入六個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n- 第三個參數是要計算極值的序號。\n- 第四個參數是要計算極大值或極小值；1為極大值、-1為極小值。\n- 第五個參數為傳址參數，會回傳計算完的極值。\n- 第六個參數是傳址參數，會回傳極值K棒相對於當期K棒的期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的第N個極值。\n計算成功時回傳值為1，結果會回傳在第5、6個參數。

**範例:**

```xs
value1 = nthextremes(high,10,2,1,value2,value3); //計算10期內第二個最高價
```
plot1(value2);                                   //繪製10期內第二個最高價的連線

---
### MoM

回傳數值=MoM(數列)

**說明:**

價格關係\n計算序列資料的月變化率(換算成百分比)\n限用於月頻率資料。

**範例:**

```xs
plot1(MoM(close));    //繪製收盤價的月變化率連線
```

---
### LowestBar

回傳數值=LowestBar(數列,期數)

**說明:**

價格關係\n計算序列資料的最小值的相對位置。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極小值的相對位置。\n如果有同樣兩個以上的極小值，則傳回離現在最近的那個。

**範例:**

```xs
plot1(LowestBar(low,5));    //繪製近5期最低的最低價相對位置的連線
```

---
### LowestArray

回傳數值=LowestArray(陣列,陣列大小)

**說明:**

價格關係
計算陣列資料的最小值。
傳入二個參數:
- 第一個參數是要計算的陣列。
- 第二個參數是陣列大小。

**範例:**

```xs
// ```xs
arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
value1 = LowestArray(arrA,5);  //計算陣列arrA的極小值
// ```
Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
plot1(value1);                 //繪製陣列arrA的極小值的連線
```
---
### LowDays

回傳數值=LowDays(期數)

**說明:**

價格關係
計算指定期間內創新低的次數。
傳入一個參數:
- 第一個參數是期數。期數含當期，最小值為1。

**範例:**

```xs
// ```xs
plot1(LowDays(10)); //繪製近10期創新低次數的連線
// ```
// 請參考HighDays函數。
```
---
### HighestBar

回傳數值=HighestBar(數列,期數)

**說明:**

價格關係\n計算序列資料的最大值的相對位置。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極大值的相對位置。\n如果有同樣兩個以上的極大值，則傳回離現在最近的那個。

**範例:**

```xs
plot1(HighestBar(high,5));    //繪製近5期最高的最高價相對位置的連線
```

---
### HighestArray

回傳數值=HighestArray(陣列,陣列大小)

**說明:**

價格關係
計算陣列資料的最大值。
傳入二個參數:
- 第一個參數是要計算的陣列。
- 第二個參數是陣列大小。

**範例:**

```xs
// ```xs
arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
value1 = HighestArray(arrA,5); //計算陣列arrA的極大值
// ```
Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
plot1(value1);                 //繪製陣列arrA的極大值的連線
```
---
### HighDays

回傳數值=HighDays(期數)

**說明:**

價格關係
計算指定期間內創新高的次數。
傳入一個參數:
- 第一個參數是期數。期數含當期，最小值為1。

**範例:**

```xs
// ```xs
plot1(HighDays(10)); //繪製近10期創新高次數的連線
// ```
// 請參考LowDays函數。
```
---
### FastLowestBar

回傳數值=FastLowestBar(數列,期數)

**說明:**

價格關係
計算序列資料的最小值的相對位置。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極小值的相對位置。
如果有同樣兩個以上的極小值，則傳回離現在最近的那個。
FastLowestBar函數為LowestBar函數的快速計算版本。

**範例:**

```xs
// ```xs
plot1(FastLowestBar(low,5));    //繪製近5期最低的最低價相對位置的連線
// ```
```
---
### FastHighestBar

回傳數值=FastHighestBar(數列,期數)

**說明:**

價格關係
計算序列資料的最大值的相對位置。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極大值的相對位置。
如果有同樣兩個以上的極大值，則傳回離現在最近的那個。
FastHighestBar函數為HighestBar函數的快速計算版本。

**範例:**

```xs
// ```xs
plot1(FastHighestBar(high,5));    //繪製近5期最高的最高價相對位置的連線
// ```
```
---
### ExtremesArray

**說明:**

價格關係
計算陣列資料的極大值或極小值。
傳入五個參數:
- 第一個參數是要計算的陣列。
- 第二個參數是陣列大小。
- 第三個參數是要計算極大值或極小值；1為極大值、-1為極小值。
- 第四個參數為傳址參數，會回傳計算完的極值。
- 第五個參數是傳址參數，會回傳極值的陣列索引值。
計算成功時回傳值為1，結果會回傳在第4、5個參數。

**範例:**

```xs
// ```xs
arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
value1 = extremesarray(arrA,5,-1,value2,value3); //計算陣列arrA的極小值
// ```
Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
plot1(value2);                                   //繪製陣列arrA的極小值的連線
```
---
### Extremes

**說明:**

回傳數值=Extremes(數列,期數,要計算極大值或極小值,輸出極值,輸出極值K棒相對位置)\n價格關係\n計算序列資料的極大值或極小值。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極值。\n傳入五個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n- 第三個參數是要計算極大值或極小值；1為極大值、-1為極小值。\n- 第四個參數為傳址參數，會回傳計算完的極值。\n- 第五個參數是傳址參數，會回傳極值K棒相對於當期K棒的期數。\n計算成功時回傳值為1，結果會回傳在第4、5個參數。

**範例:**

```xs
value1 = extremes(high,5,1,value2,value3); //計算5期最高價的極大值
```
plot1(value2);                             //繪製5期最高價的極大值的連線

---
### XAverage

回傳數值=XAverage(數列,期數)

**說明:**

價格計算\n計算序列資料的指數移動平均。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的指數移動平均值。\n計算公式：\n當期均價 = (2/(n+1))*當期價格 + (n-1)/(n+1)*前期均價

**範例:**

```xs
value1 = XAverage(Close,5); //計算5期收盤價的指數移動平均
```

---
### WMA

回傳數值=WMA(數列,期數)

**說明:**

價格計算\n計算序列資料的加權移動平均。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的加權移動平均值。\n計算公式：\nWMAt=(Pt * n + Pt-1 * (n-1) + Pt-2 * (n-2) + ... + Pt-n+1) / (n + (n-1) + (n-2) + ... + 1)

**範例:**

```xs
value1 = WMA(Close,5); //計算5期收盤價的加權移動平均
```

---
### UpLimit

回傳數值=UpLimit(參考價)

**說明:**

價格計算\n依傳入之參考價計算漲停價。

**範例:**

```xs
value1 = UpLimit(CloseD(1)); //計算當期之漲停價
```

---
### TrueRange

**說明:**

價格計算\n傳回當根K棒的真實區間。\n回傳數值=TrueRange\n真實區間是韋爾達（J. W. Wilder）於1978年發表於New Concepts in Technical Trading Systems中測量價格波動性的方法。\n根據韋爾達的定義，真實區間為下列三項中的最大值：\n當期最高價至最低價的幅度。\n當期最低價與前期收盤價的幅度。\n當期最高價至前期收盤價的幅度。

**範例:**

```xs
plot1(TrueRange);    //繪製當期K棒真實區間的連線
plot2(TrueRange[1]); //繪製前一期K棒真實區間的連線
```

---
### Summation

回傳數值=Summation(數列,期數)

**說明:**

價格計算\n計算序列資料的總和。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的數值總和。

**範例:**

```xs
value1 = Summation(Close,5); //計算5期收盤價的總和
```

---
### SimpleLowestBar

回傳數值=SimpleLowestBar(數列,期數)

**說明:**

價格計算
取得區間內數列最小值的K棒位置。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
取得區間內數列最小值的K棒位置。
可以使用這個函數來取得欄位區間內新低的位置。
---
### SimpleHighestBar

回傳數值=SimpleHighestBar(數列,期數)

**說明:**

價格計算
取得區間內數列最大值的K棒位置。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
取得區間內數列最大值的K棒位置。
可以使用這個函數來取得欄位區間內新高的位置。
---
### RateOfChange

回傳數值=RateOfChange(數列,期數)

**說明:**

價格計算\n計算序列資料的變化率。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以前N根K棒資料為基準點，計算至當根K棒的的數值變化率。\n計算公式：\nRateOfChange = ( 當期價格 ／ N期前價格 - 1 ) * 100

**範例:**

```xs
value1 = RateOfChange(Close,5); //計算5期收盤價的變化率
```

---
### Range

Range = (當期最高價 - 當期最低價)

**說明:**

價格計算\n傳回當根K棒的高低價差。\n回傳數值=Range\n計算公式：

**範例:**

```xs
plot1(Range);    //繪製當期K棒高低價差的連線
plot2(Range[1]); //繪製前一期K棒高低價差的連線
```

---
### EMA

回傳數值=EMA(數列,期數)

**說明:**

價格計算\n計算序列資料的XQ指數移動平均。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的XQ指數移動平均值。\nXQ指數移動平均和一般指數移動平均（XAverage）的計算差異在於最前面幾期（小於平均期數）時的計算公式不同。\n當K棒編號 ≦ 期數時：\n當期均價 = (當期價格 + (前期均價*(K棒編號-1)))/K棒編號  (換句話說，當期均價 = 這幾期的算數平均)\n當K棒編號 > 期數時：\n當期均價 = (2/(n+1))*當期價格 + (n-1)/(n+1)*前期均價

**範例:**

```xs
value1 = EMA(Close,5); //計算5期收盤價的XQ EMA
```

---
### DwLimit

回傳數值=DwLimit(參考價)

**說明:**

價格計算\n依傳入之參考價計算跌停價。

**範例:**

```xs
value1 = DwLimit(CloseD(1)); //計算當期之跌停價
```

---
### AvgDeviation

回傳數值=AvgDeviation(數列,期數)

**說明:**

價格計算\n計算序列資料的平均差。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的平均差。

**範例:**

```xs
value1 = AvgDeviation(Close,5); //計算5期收盤價的平均差
```

---
### Average

回傳數值=Average(數列,期數)

**說明:**

價格計算\n計算序列資料的移動平均。\n傳入二個參數:\n- 第一個參數是數列，通常是開高低收的價格數列。\n- 第二個參數是期數。\n計算序列資料的移動平均。\n以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的序列平均值。

**範例:**

```xs
value1 = Average(Close,5); //計算5期收盤價的移動平均
```

---
### WeightedClose

**說明:**

WeightedClose = (當期最高價 + 當期最低價 + 2*當期收盤價)/4\n價格取得\n計算技術分析的加權平均收盤價。\n回傳數值=WeightedClose\n加權平均價給予收盤價較大的權重，著名的MACD指標即是利用加權平均價做計算。\n計算公式：

**範例:**

```xs
plot1(WeightedClose);    //繪製當期加權平均收盤價的連線
plot2(WeightedClose[1]); //繪製前一期加權平均收盤價的連線
```

---
### TypicalPrice

**說明:**

價格取得\n傳回技術分析的典型價。\n回傳數值=TypicalPrice\n計算公式：\n典型價 = (當期最高價 + 當期最低價 + 當期收盤價)/3

**範例:**

```xs
plot1(TypicalPrice);    //繪製當期典型價的連線
plot2(TypicalPrice[1]); //繪製前一期典型價的連線
```

---
### TrueLow

**說明:**

價格取得
取得價格真實區間(TrueRange)的低點。
回傳數值=TrueLow
計算方法為比較當根K棒的低點與前根K棒的收盤價，取數值較小者。

**範例:**

```xs
// ```xs
plot1(TrueLow);    //繪製當期真實區間低點的連線
plot2(TrueLow[1]); //繪製前一期真實區間低點的連線
// ```
// 請參考 TrueHigh函數以及TrueRange函數。
```
---
### TrueHigh

**說明:**

價格取得
取得價格真實區間(TrueRange)的高點。
回傳數值=TrueHigh
計算方法為比較當根K棒的高點與前根K棒的收盤價，取數值較大者。

**範例:**

```xs
// ```xs
plot1(TrueHigh);    //繪製當期真實區間高點的連線
plot2(TrueHigh[1]); //繪製前一期真實區間高點的連線
// ```
// 請參考 TrueLow函數以及TrueRange函數。
```
---
### OpenY

回傳數值=OpenY(期別)

**說明:**

價格取得
取得年線的開盤價。
僅限使用於年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於年線時，用OpenY可以找到某期的年開盤價。

**範例:**

```xs
// ```xs
plot1(OpenY(0)); //繪製當年開盤價的連線
plot2(OpenY(1)); //繪製前一年開盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### OpenW

回傳數值=OpenW(期別)

**說明:**

價格取得
取得週線的開盤價。
僅限使用於週線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於週線時，用OpenW可以找到某期的週開盤價。

**範例:**

```xs
// ```xs
plot1(OpenW(0)); //繪製當週開盤價的連線
plot2(OpenW(1)); //繪製前一週開盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### OpenQ

回傳數值=OpenQ(期別)

**說明:**

價格取得
取得季線的開盤價。
僅限使用於季線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於季線時，用OpenQ可以找到某期的季開盤價。

**範例:**

```xs
// ```xs
plot1(OpenQ(0)); //繪製當季開盤價的連線
plot2(OpenQ(1)); //繪製前一季開盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### OpenM

回傳數值=OpenM(期別)

**說明:**

價格取得
取得月線的開盤價。
僅限使用於月線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於月線時，用OpenM可以找到某期的月開盤價。

**範例:**

```xs
// ```xs
plot1(OpenM(0)); //繪製當月開盤價的連線
plot2(OpenM(1)); //繪製前一月開盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### OpenH

回傳數值=OpenH(期別)

**說明:**

價格取得
取得半年線的開盤價。
僅限使用於半年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於半年線時，用OpenH可以找到某期的半年開盤價。

**範例:**

```xs
// ```xs
plot1(OpenH(0)); //繪製當期半年線開盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### OpenD

回傳數值=OpenD(期別)

**說明:**

價格取得
取得日線的開盤價。
僅限使用於日線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。

**範例:**

```xs
// ```xs
plot1(OpenD(0)); //繪製當日開盤價的連線
plot2(OpenD(1)); //繪製前一日開盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### LowY

回傳數值=LowY(期別)

**說明:**

價格取得
取得年線的最低價。
僅限使用於年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於年線時，用LowY可以找到某期的年最低價。

**範例:**

```xs
// ```xs
plot1(LowY(0)); //繪製當年最低價的連線
plot2(LowY(1)); //繪製前一年最低價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### LowW

回傳數值=LowW(期別)

**說明:**

價格取得
取得週線的最低價。
僅限使用於週線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於週線時，用LowW可以找到某期的週最低價。

**範例:**

```xs
// ```xs
plot1(LowW(0)); //繪製當週最低價的連線
plot2(LowW(1)); //繪製前一週最低價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### LowQ

回傳數值=LowQ(期別)

**說明:**

價格取得
取得季線的最低價。
僅限使用於季線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於季線時，用LowQ可以找到某期的季最低價。

**範例:**

```xs
// ```xs
plot1(LowQ(0)); //繪製當季最低價的連線
plot2(LowQ(1)); //繪製前一季最低價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### LowM

回傳數值=LowM(期別)

**說明:**

價格取得
取得月線的最低價。
僅限使用於月線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於月線時，用LowM可以找到某期的月最低價。

**範例:**

```xs
// ```xs
plot1(LowM(0)); //繪製當月最低價的連線
plot2(LowM(1)); //繪製前一月最低價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### LowH

回傳數值=LowH(期別)

**說明:**

價格取得
取得半年線的最低價。
僅限使用於半年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於半年線時，用LowH可以找到某期的半年最低價。

**範例:**

```xs
// ```xs
plot1(LowH(0)); //繪製當期半年線最低價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### Lowest

回傳數值=Lowest(數列,期數)

**說明:**

價格取得
計算序列資料的最小值。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極小值。
Lowest函數與FastLowest函數的運算方式一致，都是用 Extremes 函數抓極小值。

**範例:**

```xs
// ```xs
plot1(Lowest(low,5));    //繪製5期最低價的最小值的連線
// ```
```
---
### LowD

回傳數值=LowD(期別)

**說明:**

價格取得
取得日線的最低價。
僅限使用於日線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於日線時，用LowD可以找到某期的日最低價。

**範例:**

```xs
// ```xs
plot1(LowD(0)); //繪製當日最低價的連線
plot2(LowD(1)); //繪製前一日最低價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### HighY

回傳數值=HighY(期別)

**說明:**

價格取得
取得年線的最高價。
僅限使用於年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於年線時，用HighY可以找到某期的年最高價。

**範例:**

```xs
// ```xs
plot1(HighY(0)); //繪製當年最高價的連線
plot2(HighY(1)); //繪製前一年最高價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### HighW

回傳數值=HighW(期別)

**說明:**

價格取得
取得週線的最高價。
僅限使用於週線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於週線時，用HighW可以找到某期的週最高價。

**範例:**

```xs
// ```xs
plot1(HighW(0)); //繪製當週最高價的連線
plot2(HighW(1)); //繪製前一週最高價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### HighQ

回傳數值=HighQ(期別)

**說明:**

價格取得
取得季線的最高價。
僅限使用於季線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於季線時，用HighQ可以找到某期的季最高價。

**範例:**

```xs
// ```xs
plot1(HighQ(0)); //繪製當季最高價的連線
plot2(HighQ(1)); //繪製前一季最高價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### HighM

回傳數值=HighM(期別)

**說明:**

價格取得
取得月線的最高價。
僅限使用於月線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於月線時，用HighM可以找到某期的月最高價。

**範例:**

```xs
// ```xs
plot1(HighM(0)); //繪製當月最高價的連線
plot2(HighM(1)); //繪製前一月最高價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### HighH

回傳數值=HighH(期別)

**說明:**

價格取得\n取得半年線的最高價。\n僅限使用於半年線以下之頻率。\n傳入一個參數:\n- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。\n當使用頻率小於半年線時，用HighH可以找到某期的半年最高價。

**範例:**

```xs
plot1(HighH(0)); //繪製當期半年線最高價的連線
```

---
### Highest

回傳數值=Highest(數列,期數)

**說明:**

價格取得
計算序列資料的最大值。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極大值。
Highest函數與FastHighest函數的運算方式一致，都是用 Extremes 函數抓極大值。

**範例:**

```xs
// ```xs
plot1(Highest(high,5));    //繪製5期最高價的最大值的連線
// ```
```
---
### HighD

回傳數值=HighD(期別)

**說明:**

價格取得
取得日線的最高價。
僅限使用於日線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於日線時，用HighD可以找到某期的日最高價。

**範例:**

```xs
// ```xs
plot1(HighD(0)); //繪製當日最高價的連線
plot2(HighD(1)); //繪製前一日最高價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### FastLowest

回傳數值=FastLowest(數列,期數)

**說明:**

價格取得
計算序列資料的最小值。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極小值。
FastLowest函數為Lowest函數的快速計算版本。

**範例:**

```xs
// ```xs
plot1(FastLowest(low,5));    //繪製5期最低價的最小值的連線
// ```
```
---
### FastHighest

回傳數值=FastHighest(數列,期數)

**說明:**

價格取得
計算序列資料的最大值。
傳入二個參數:
- 第一個參數是數列，通常是開高低收的價格數列。
- 第二個參數是期數。
以最新一筆資料為基準點，輸入要計算的期數，然後計算過去期數的極大值。
FastHighest函數為Highest函數的快速計算版本。

**範例:**

```xs
// ```xs
plot1(FastHighest(high,5));    //繪製5期最高價的最大值的連線
// ```
```
---
### CloseY

回傳數值=CloseY(期別)

**說明:**

價格取得
取得年線的收盤價。
僅限使用於年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於年線時，用CloseY可以找到某期的年收盤價。

**範例:**

```xs
// ```xs
plot1(CloseY(0)); //繪製當年收盤價的連線
plot2(CloseY(1)); //繪製前一年收盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### CloseW

回傳數值=CloseW(期別)

**說明:**

價格取得
取得週線的收盤價。
僅限使用於週線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於週線時，用CloseW可以找到某期的週收盤價。

**範例:**

```xs
// ```xs
plot1(CloseW(0)); //繪製當週收盤價的連線
plot2(CloseW(1)); //繪製前一週收盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### CloseQ

回傳數值=CloseQ(期別)

**說明:**

價格取得
取得季線的收盤價。
僅限使用於季線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於季線時，用CloseQ可以找到某期的季收盤價。

**範例:**

```xs
// ```xs
plot1(CloseQ(0)); //繪製當季收盤價的連線
plot2(CloseQ(1)); //繪製前一季收盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### CloseM

回傳數值=CloseM(期別)

**說明:**

價格取得
取得月線的收盤價。
僅限使用於月線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於月線時，用CloseM可以找到某期的月收盤價。

**範例:**

```xs
// ```xs
plot1(CloseM(0)); //繪製當月收盤價的連線
plot2(CloseM(1)); //繪製前一月收盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### CloseH

數值=CloseH(期別)

**說明:**

價格取得
取得半年線的收盤價。
僅限使用於半年線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於半年線時，用CloseH可以找到某期的半年收盤價。

**範例:**

```xs
// ```xs
plot1(CloseH(0)); //繪製當期半年線收盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### CloseD

回傳數值=CloseD(期別)

**說明:**

價格取得
取得日線的收盤價。
僅限使用於日線以下之頻率。
傳入一個參數:
- 第一個參數是期別，和序列引用定義相同，0表當期、1表前一期...依此類推。
當使用頻率小於日線時，用CloseD可以找到某期的日收盤價。

**範例:**

```xs
// ```xs
plot1(CloseD(0)); //繪製當日收盤價的連線
plot2(CloseD(1)); //繪製前一日收盤價的連線
// ```
// 相關的函數包含:
OpenD, OpenW, OpenM, OpenQ, OpenH, OpenY
// HighD, HighW, HighM, HighQ, HighH, HighY
// LowD, LowW, LowM, LowQ, LowH, LowY
// CloseD, CloseW, CloseM, CloseQ, CloseH, CloseY
```
---
### AvgPrice

※請注意：AvgPrice 與 getfield("AvgPrice") 是不同的數值，

**說明:**

價格取得\n取得利用K棒的開高低收所計算出的平均價格。\n回傳數值=AvgPrice\n---\ngetfield("AvgPrice") 是今日的平均成交價，也就是「當日每筆的成交金額加總／當日成交量」\n計算公式：\n平均價格 = (當期開盤價 + 當期最高價 + 當期最低價 + 當期收盤價)/4

---
