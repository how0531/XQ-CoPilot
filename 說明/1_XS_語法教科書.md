# XQ 語法教科書 (完整版)



---

# 技術分析的分點指標介紹

Source: https://www.xq.com.tw/lesson/advanced/broker-indicator/

XQ 已將 [個股進階籌碼 ](https://www.xq.com.tw/learn/advanced/majorbrokerage/)中的分點指標，整合到技術分析的「分點」副圖指標。此次新增的「分點進出、分點買賣力、分點成交力」三個指標，必須要購買「籌碼分析模組」才能使用。 分點指標整合到技術分析頁面後，即可方便檢視股票名單上的分點指標數據，例如以下這張圖，是新增一個頁面，切成三個欄框，放上技術分析的分點指標、報價組合、商品盤勢，並用同步功能，就能快速切換商品，掌握各檔股票的分點指標數據狀況。 [
![](/wp-content/uploads/2024/05/240410_1431分點看盤.png)
](/wp-content/uploads/2024/05/240410_1431分點看盤.png)接下來，將依序舉例說明分點指標搭配「系統券商、指定券商、追蹤／自選券商」的使用介紹，首先我們先從「系統券商」開始。 以下是本篇文章的目錄： [**一、分點指標搭配「系統券商」 **](#anchor01)[**二、分點指標搭配「指定券商」 **](#anchor02)[**三、分點指標搭配「追蹤／自選券商」 **](#anchor03)[](#)
---

### **一、分點指標搭配「系統券商」 **
籌碼面的精隨就是跟著主力走，而如何從籌碼面的數據查看這些主力的蛛絲馬跡，可以透過系統券商的內建組合清單來觀察分點指標的數據。 比方說，想知道神達（3706.TW）在 2024 年 03 月的 19 ~ 21 日，查看外資券商收集籌碼的軌跡，可以 

- 在技術分析指標設定，加入分點指標（分點進出／買賣力／成交力） 
- 選擇系統券商，與外資券商。 
[
![](/wp-content/uploads/2024/05/04101429_系統券商外資券商.png)
](/wp-content/uploads/2024/05/04101429_系統券商外資券商.png)就能在技術分析副圖中查看外資券商的分點指標表現，以下三點說明： 

- 分點進出：連續三天買超，每天都達1萬9千張以上，公式如下： 

  - 買賣超＝買進張數－賣出張數。 

- 分點買賣力：連續兩天超過 60 %。表示外資券商買進力道強勁，公式如下： 

  - 買賣力＝買賣超／買賣合。 
  - 買賣合＝買進張數＋賣出張數。 

- 分點成交力：第一天超過 20 %，第二天與第三天超過15%。表示外資券商佔個股成交量 20 ~ 15 %，公式如下： 

  - 成交力＝買賣超／個股成交量 × 100%（取絕對值） 
  - 吃貨比＝買張／個股成交量 × 100% 
  - 出貨比＝賣張／個股成交量 × 100% 

這些分點指標的數據，也許是帶動股價連續三天上揚的因素之一。 [](#)

### **二、分點指標搭配「指定券商」 **
若想觀察特定單一分點券商，對股票的籌碼面影響力為何？則可用分點指標搭配指定券商來觀察。 舉例來說，觀察北極星（6550.TW）在 2022 年 09 月 22 日「凱基-台北」券商分點的表現，我們可以依照以下兩點操作，加入副圖指標觀察： 

- 在技術分析指標設定，加入分點指標（分點進出／買賣力／成交力） 
- 選擇「指定券商」並透過 [
![](/wp-content/uploads/2024/05/放大鏡_小圖示.png)
](/wp-content/uploads/2024/05/放大鏡_小圖示.png)搜尋「凱基-台北」 
[
![](/wp-content/uploads/2024/05/240410_1458_指定券商.png)
](/wp-content/uploads/2024/05/240410_1458_指定券商.png)就能觀察在當時的分點指標數據如下三點： 

- 分點進出：買賣超 535 張 
- 分點買賣力：買賣力 99.63 %，分點一致站在買方。 
- 分點成交力：成交力 37.05 %，分點買方佔個股成交量三成以上。 
當天開盤即漲停，成交量為 1445 張，而凱基-台北就買進了 535 張。由此可知，當天的買進主力分點為凱基-台北。 [
![](/wp-content/uploads/2024/05/2024-4-10-下午-03-03-52_指定券商隔日沖銷.png)
](/wp-content/uploads/2024/05/2024-4-10-下午-03-03-52_指定券商隔日沖銷.png)隔天 09 月 23 日，買賣超與買賣力翻綠變為 -475 張與 -11.18%，表示凱基-台北有一部分的主力開始撤資，出現隔日沖的跡象，若想將此分點券商納入「追蹤」或「自選」券商組合，可以點擊 [
![](/wp-content/uploads/2024/05/加入.png)
](/wp-content/uploads/2024/05/加入.png)將此指定券商加入至追蹤或自選券商清單中。 [](#)

### **三、分點指標搭配「追蹤／自選券商」 **
以北極星（6550.TW）在 2022 年 09 月 22～23 日為例子，發現當下時空背景的凱基-台北為隔日沖大戶，所以我們可以自行建立一個隔日沖的券商組合，將我們認為是隔日沖的分點加入名單，以便追蹤隔日沖的分點券商後續佈局。 (一) 追蹤券商 追蹤券商主要用於查單一股票時，看已設定的追蹤券商有什麼進出變化。 若只鎖定某檔股票，追蹤該股票的分點券商布局，可以依照以下兩步驟，透過「追蹤券商」功能進行設定： 

- 在技術分析指標設定，加入分點指標（分點進出／買賣力／成交力） 
- 選擇「追蹤券商」並透過 [
![](/wp-content/uploads/2024/05/齒輪_小圖示.png)
](/wp-content/uploads/2024/05/齒輪_小圖示.png)設定 [追蹤券商組合 ](https://www.xq.com.tw/learn/advanced/trackbrokerage/)，商品設定北極星（6550.TW）將認為是此檔的隔日沖分點，加入券商組合內容中。 
[
![](/wp-content/uploads/2024/05/2024-4-11-下午-02-57-07_追蹤券商.png)
](/wp-content/uploads/2024/05/2024-4-11-下午-02-57-07_追蹤券商.png)設定完成後，就能在副圖呈現「追蹤券商」的分點指標數據，上圖的追蹤券商就是 5 個券商分點（元富、國票-敦化法人、凱基-虎尾、元大證券、凱基-台北）統計的分點指標數據。 (二) 自選券商 自選券商主要用於大範圍搜尋這些券商在買賣什麼股票。 若大家想觀察口袋名單上的分點券商，在買賣什麼股票，則可依照以下兩步驟，透過「自選券商」進行設定： 

- 在技術分析指標設定，加入分點指標（分點進出／買賣力／成交力） 
- 選擇「追蹤／自選券商」然後下拉式選單，選擇大家的自選券商清單名稱，或者透過 [
![](/wp-content/uploads/2024/05/齒輪_小圖示.png)
](/wp-content/uploads/2024/05/齒輪_小圖示.png)設定 [自選券商組合 ](https://www.xq.com.tw/learn/advanced/trackbrokerage/)
[
![](/wp-content/uploads/2024/05/2024-4-11-下午-03-42-02_自選券商1.png)
](/wp-content/uploads/2024/05/2024-4-11-下午-03-42-02_自選券商1.png)設定完成後，就能在副圖呈現「自選券商」的分點指標數據，上圖的「自選券商1」就是 5 個券商分點（凱基-台北、國泰-敦南、富邦-嘉義、凱基-市政、凱基-虎尾）統計的分點指標數據，切換下個商品時，也會跟著切換顯示統計的數據。 以上就是技術分析頁面的分點指標功能介紹，透過這個功能，希望能幫助大家便利的在技術分析頁面，快速切換商品瀏覽分點指標數據。 若大家使用後，有任何的心得與建議，也歡迎來信至 XQservice@XQ.com.tw 回饋分享。 [

#####


---

# 券商分析

Source: https://www.xq.com.tw/lesson/advanced/brokerage/

### **券商都在進出什麼股票啊？ **
利用【券商分析】就可以逐一檢視券商進出的標的喔！ 除可以查看我們關心的自選券商在買賣什麼股票之外，系統還提供幾種大家可能也會有興趣的券商組合，如官股券商、市場派券商、綜合券商…等, 讓大家瞭解這些券商都在做什麼交易。 所謂的「官股券商」，是指八大行庫（臺銀、臺企銀、土銀、合庫、華南金、兆豐金、第一金、彰銀）所屬的證券商。一般來說，政府會透過這八家券商進出股市，尤其是在股市出現非理性下跌的時候，會啟動國安基金進場護盤。所以多關心官股券商進出， 也可以多瞭解股市風向變化。 至於其他的系統券商組合，應屬「市場派券商」最讓大家好奇了。 這裡提供的「市場派券商」，是系統每月依特定市佔率過濾出來的券商，此券商組合不含外資券商、官股券商及綜合券商總公司。所以常看這些掌握市場主要資金，與擁有重要消息的內外資在買賣什麼，應有助於我們瞭解目前市場資金流向。 在【券商分析】裡，我們除了可以看到這些券商在買什麼及賣什麼外，還可以進一步瞭解這些券商的操作模式，例如：是否熱中當沖、隔日沖等。本單元提供的篩選功能有很多，之後陸續會再介紹，容小編在這裡就先賣個關子啦！ 總之，【券商分析】就是提供多種篩選方式，讓我們透過查看特定券商進出，找出被這些券商關注的商品，然後就看我們是否決定要跟著進出了。 [

#####


---

# 籌碼分析

Source: https://www.xq.com.tw/lesson/advanced/chip/

「籌碼分析」是除了「技術分析」及「基本分析」外，市場普遍用在股票分析的另類顯學。 為什麼「籌碼分析」這麼受大家歡迎呢？原因不外乎：籌碼是錢堆出來的，不會有作假的問題；還有主力資金比較雄厚，有影響股價的能力，所以跟著他們走，勝率會提高。 XQ推出的【籌碼分析模組】，就是秉持研究籌碼，找出主力的思維下，提供各式各樣的分析工具給大家使用。 

#### 
[

#####


---

# 籌碼選股介紹

Source: https://www.xq.com.tw/lesson/advanced/chipselect/

利用「籌碼選股」功能，找到籌碼目前所關注的股票！ 

### **基本操作 **
首先讓我們進入「籌碼選股」的頁面，頁面的左邊就是系統所提供籌碼相關的選股法。如下圖，我們可以依據所要找的籌碼類型，展開其資料夾找尋所要的選股法。 [
![](/wp-content/uploads/2018/12/A1-2.png)
](/wp-content/uploads/2018/12/A1-2.png)找到選股法後，我們可以調整選股法的參數來調成符合自己需要的選股條件，按下「執行」後， 下方的結果區就會顯示符合選股條件的商品。 [
![](/wp-content/uploads/2018/12/A2-2.png)
](/wp-content/uploads/2018/12/A2-2.png)

### 

### **新增自訂選股法說明 **
如果想要在目前選股法下，加入其他選股法來當作篩選條件，可以點擊選股法名稱右邊的「+條件」按鈕，讓系統進入選股法的編輯模式，這時我們就可以點選左邊的選股法來加入新的條件。 例如，我想要在「券商當沖股」這個選股法下，再加入「主力買最多股」一塊篩選，這時我只要先點及「＋條件」，讓選股法進入到編輯模式： [
![](/wp-content/uploads/2018/12/A3-2.png)
](/wp-content/uploads/2018/12/A3-2.png)這時我們在左邊找到「主力買最多股」並用滑鼠左鍵點擊，系統就會將此選股法給加入到右邊的選股條件區，底下就會呈現這兩個選法的交集結果。 [
![](/wp-content/uploads/2018/12/A4-2.png)
](/wp-content/uploads/2018/12/A4-2.png)在多個條件顯示下，每個條件前面會有「勾選」核取方塊 ＆「刪除」鍵： 

- 如果只想要執行部分選股條件，只要勾選要被執行的條件來執行，下方的選股結果區就只會顯示被勾選的條件的選股結果。 
- 而想要移除某個選股條件，只要點擊該條件前面的「刪除」鍵，系統就會將該條件移除。 
[
![](/wp-content/uploads/2018/12/A5.png)
](/wp-content/uploads/2018/12/A5.png)而選股法調整完成後，可以點擊「儲存」來存成自己的選股法；如果不想儲存，也可以點擊「取消」，系統會恢復成編輯前的狀態。 [
![](/wp-content/uploads/2018/12/A6-2.png)
](/wp-content/uploads/2018/12/A6-2.png)另外，對於儲存完成的選股法，我們也可以點擊「複製」按鈕來快速複製： [
![](/wp-content/uploads/2018/12/A7-2.png)
](/wp-content/uploads/2018/12/A7-2.png)

### 

### **我的條件介面說明 **
在完成上述「新增自訂選股法」步驟後，我們就已經建立了一個自訂的選股法。 建立好的選股法，我們可以在左邊的「我的條件」下找到(參考下圖位置)。 而在「我的條件」下，系統也提供了3個預設的自訂選股法「我的選股法1」、「我的選股法2」、「我的選股法3」，讓使用者可以自由編輯。 [
![](/wp-content/uploads/2018/12/A8.png)
](/wp-content/uploads/2018/12/A8.png) 我們也可以利用「編輯我的條件」介面，來「刪除」或是「重新命名」我們的自訂選股法。 [
![](/wp-content/uploads/2018/12/A9.png)
](/wp-content/uploads/2018/12/A9.png)**選股結果說明 **篩選出來的商品，我們可以將其加入自選商品組合觀察，而如果想要進一步看個股的詳細資料，也可以利用右鍵選單選擇想要看到的商品細部資訊。 [
![](/wp-content/uploads/2018/12/3.png)
](/wp-content/uploads/2018/12/3.png)如果要看選股結果中某檔商品的技術分析走勢，可以直接點擊該商品名稱，系統就會顯示該商品技術分析圖。 [
![](/wp-content/uploads/2018/12/A10.png)
](/wp-content/uploads/2018/12/A10.png)選股結果中如果有列出符合的「券商家數」欄位，我們也可以點進去了解該商品的券商買進/賣出資訊(以下圖為例)，「券商當沖股」的選股結果中，華新科(2492)的「當沖券商家數」欄位數值為「28」，代表有「28」家券商對該商品作當沖，我們點擊數值後，系統就會列出這28家券商的當沖資訊) [
![](/wp-content/uploads/2018/12/5-1.png)
](/wp-content/uploads/2018/12/5-1.png)在券商家數列表中，我們也可以利用券商右鍵選單中的「券商分析」，去看該券商更多的詳細資料；或是將該券商加入自選或追蹤券商，方便之後運用分析。 [
![](/wp-content/uploads/2018/12/5-4.png)
](/wp-content/uploads/2018/12/5-4.png)**指定日期回溯 **選股結果預設是會篩選出「最新」一日的篩選結果，如果想要回溯過往日期，可以利用「前一日」、「後一日」或是「日曆工具」來指定要看的日期。 [
![](/wp-content/uploads/2018/12/6.png)
](/wp-content/uploads/2018/12/6.png)當我們在指定過往日期的選股結果後，也可以利用「績效」頁面來確認選股結果的績效表現唷！ [
![](/wp-content/uploads/2018/12/7.png)
](/wp-content/uploads/2018/12/7.png)以上就是「籌碼選股」的簡單介紹，如果使用過程中有任何問題，可以隨時和小編提問。 祝大家投資順利！ [

#####


---

# 籌碼指標新增與異動

Source: https://www.xq.com.tw/lesson/advanced/chipupdate/

因應「籌碼分析」新功能上線，XQ技術分析新增一組指標分類－【主力指標】，將原本與券商分點進出有關指標，例如：主力進出、分公司交易家數…，及計算大小戶單量與持股指標，一併納入此指標分類中。 以下為部份說明。 指標名稱 新增參數設定選擇 新增可勾選畫圖選項選擇 新增不畫圖,查價顯示內容 備註(含公式及資料說明) 融資 大盤: 金額, 張數, 預設值: 金額 融資餘額, 融資增減, 買進, 賣出, 現償 融資使用率 (個股提供) 融券 融券餘額, 融券增減, 買進, 賣出, 券償 融券使用率 (個股提供) 借券 借券餘額市值 借券賣出 借券賣出餘額, 借券賣出增減, 賣出, 還券 借券賣出, 還券, AP: 調整項併入還券項 增減bar=賣出-還券+調整 借券餘額 借券餘額, 借券增減, 借券, 還券 借券, 還券 增減bar=借券-還券 當沖 全部, 資券互抵, 現股當沖, 預設值: 全部 [全部]當沖張數=資券互抵+現股當沖[全部]當沖率=全部當沖張數/成交量\*100% 現股當沖金額 買賣差額, 買進, 賣出 券資比 融券餘額, 融資餘額 融資維持率 融資增減 個股新增 融資維持率=收盤價/(融資成本線\*0.6)\*100%融資增減: 大盤顯示金額, 個股顯示張數 法人 累計買賣超, 買賣超, 買進, 賣出 持股比例 (個股提供) 大盤顯示金額, 個股顯示張數, 興櫃不提供"買進, 賣出"選項 大盤法人比重 交易, 買進, 賣出 法人持股比例 法人持股比例=(外資+投信+自營商)持股比例 外資 累計買賣超, 買賣超, 買進, 賣出 持股比例 (個股提供) 大盤顯示金額, 個股顯示張數, 興櫃不提供"買進, 賣出"選項 投信 累計買賣超, 買賣超, 買進, 賣出 持股比例 (個股提供) 大盤顯示金額, 個股顯示張數, 興櫃不提供"買進, 賣出"選項 自營商 全部, 自行買賣, 避險, 預設值: 全部 累計買賣超, 買賣超, 買進, 賣出 持股比例 (個股提供) 大盤顯示金額, 個股顯示張數, 興櫃不提供 "自行買賣&避險" 選擇, 興櫃不提供"買進, 賣出"選項 主力進出 累計買賣超, 買賣超, 買進, 賣出 大盤改顯示金額, 個股顯示張數 分公司單買單賣家數 買賣家數差, 買進家數, 賣出家數 買賣家數差=賣出-買進 分公司淨買賣金額家數 淨買賣超家數差, 淨買超家數, 淨賣超家數 淨買賣超家數差=淨賣超-淨買超 分公司交易家數 交易家數, 買進家數, 賣出家數, 交易家數參與率 參與率=(分公司)交易家數/市場總分點數\*100% 申報轉讓 申報家數,申報人數 庫藏股指標 申報家數 吉尼系數 交易家數 利用券商家數累積百分比與券商進出累積百分比進行計算，數值介於０與１之間，愈接近零則集中度愈低（即愈平均），愈接近１則集中度愈高（即愈不平均） 實質買賣盤比 買賣差值, 買盤比, 賣盤比 依原實質買盤比&實質賣盤比指標, 分子均增 "現股當沖" 減項 散戶指標(量) 買賣差值, 買進, 賣出 依原散戶買進&散戶賣出指標, "當沖量" 改取用 "資券互抵+現股當沖" 控盤者主動買賣力 交易比重, 主動買力, 主動賣力 大戶持股 [100/200/400/600/800/1000] 張以上 持股張數,持股人數 散戶持股 [100/200/400/600/800/1000] 張以下 持股張數,持股人數 內部人持股 持股張數 計算各商品各月內部人持股資料, 持股比率=持股張數/總股本\*100% 官股券商 累計買賣超, 買賣超, 買進, 賣出 依官股券商計算, 大盤顯示金額 綜合前十大券商 累計買賣超, 買賣超, 買進, 賣出 依前十大綜合券商計算, 大盤顯示金額 自選券商 成交力=買賣超/個股成交量\*100% (取絕對值),吃貨比=買張/個股成交量\*100%,出貨比=賣張/個股成交量\*100% 收集派發指標 OBT=分公司(賣出家數-買進家數) 這次籌碼指標調整， 除新增幾個與券商進出有關的指標外，亦提供可在畫面上直接調整參數設定選擇(如下圖1位置)，及勾選是否要顯示畫圖選項等功能(如下圖2位置)。另外也提供不畫圖查價顯示內容，例如：查個股三大法人指標，有提供三大法人持股比例資訊。 [
![222](/wp-content/uploads/2017/07/222.png)
](/wp-content/uploads/2017/07/222.png)此外， 「分公司單買單賣家數」與「分公司淨買賣金額家數」指標，在「買賣差」的計算上，改成顯示「賣－買」 結果。 改顯示「賣－買」，是為了方便瞭解大戶買賣方向。 因為一般來說，大戶不會分散在太多家分點進出，所以當看到很多分點賣出，而只有幾家分點買進時，此時「賣－買」的結果為正數，即可瞭解大戶是在買進！ 反之，「賣－買」的結果若為負值，就要注意是否是大戶在出貨了。 [

#####


---

# 自設畫面(一)

Source: https://www.xq.com.tw/lesson/advanced/customscreen01/

當預設系統無法滿足自己看盤需求時，該怎麼辦呢？這時候，你就需要用到「自訂頁面」了！ XQ全球贏家的另一項特色「自設頁面」，可以自行設定屬於你個人化的看盤畫面。在自設看盤畫面完成後，可以存檔方便日後使用，還可加入我的最愛，隨時都可輕鬆叫出頁面。 本篇教學重點： 

- 設計畫面樣式，分割欄框 
- 設定欄框同步，使商品連動 
來看看怎麼自訂頁面吧！ 

### **(一) 開啟新頁 **
1. 進入方式： (1) 點選主功能列中「自訂頁面」中的「開啟新頁」。 
![a1-site1](/wp-content/uploads/2016/01/a1-site1.png)
(2) 您可以點選[頁面內容]中的功能項，或是由[系統式樣]中挑選一個由本系統提供的式樣。 [
![a0422-1](/wp-content/uploads/2016/04/a0422-1.jpg)
](/wp-content/uploads/2016/04/a0422-1.jpg)[
![a0422-2](/wp-content/uploads/2016/04/a0422-2.jpg)
](/wp-content/uploads/2016/04/a0422-2.jpg)(3) 例如我們由以上[系統式樣]中，挑選[3\_3]式樣後，按下「開啟」。 [
![a1-site4](/wp-content/uploads/2016/01/a1-site4.jpg)
](/wp-content/uploads/2016/01/a1-site4.jpg)2. 自設看盤畫面： (1) 例如我們想自訂一個看盤畫面為：上方放報價組合，左下放商品走勢圖，右下放商品新聞。先以滑鼠點選上方「請設定欄框內容」，將出現「欄框設定精靈」，選取「報價組合」後按下一步。 [
![a1-site4](/wp-content/uploads/2016/01/a1-site4.png)
](/wp-content/uploads/2016/01/a1-site4.png)(2) 依據選定的顯示內容，可照精靈指示一步步完成設定，或直接按「完成」接受預設值。 [
![a1-site5](/wp-content/uploads/2016/01/a1-site5.png)
](/wp-content/uploads/2016/01/a1-site5.png)(3) 完成上方的欄框內容設定為「報價組合」。 [
![a1-site7](/wp-content/uploads/2016/01/a1-site7.jpg)
](/wp-content/uploads/2016/01/a1-site7.jpg)(4) 再依序設定左下欄框內容為「商品走勢圖」。以滑鼠點選左下方「請設定欄框內容」，選取「商品盤勢」後按下一步。 [
![a1-site6](/wp-content/uploads/2016/01/a1-site6.png)
](/wp-content/uploads/2016/01/a1-site6.png)(5) 商品盤勢的設定顯示參數內，可選擇「顯示方式」，例如只顯示上下兩格，其他各項則依步驟完成內容設定。 [
![a1-site7](/wp-content/uploads/2016/01/a1-site7.png)
](/wp-content/uploads/2016/01/a1-site7.png)(6) 最後設定右下欄框內容為「商品新聞」。以滑鼠點選右下方「請設定欄框內容」，選取「商品盤勢」後按下一步。 [
![a1-site6](/wp-content/uploads/2016/01/a1-site6.png)
](/wp-content/uploads/2016/01/a1-site6.png)(7) 商品盤勢的設定顯示參數內，選擇顯示方式為「單格」，預設相關資訊選擇「新聞」，其他各項則依步驟完成內容設定。 [
![a1-site8](/wp-content/uploads/2016/01/a1-site8.png)
](/wp-content/uploads/2016/01/a1-site8.png)(8) 已完成自設看盤畫面如下圖。 [
![a1-site11](/wp-content/uploads/2016/01/a1-site11.jpg)
](/wp-content/uploads/2016/01/a1-site11.jpg)

### **(二) 分割及刪除欄框、欄框設定精靈 **
1. 分割欄框：如需要再切割畫面，則可利用「自訂頁面」→「分割欄框」→[水平等分]、[水平三等分]、[垂直等分]、[垂直三等分]執行。可利用此功能，任意調整您想要的看盤畫面喔！ (1) 例如：我們將上例的上方視窗(先點選確認為紅色作用視窗)，以[垂直等分]再作切割。 [
![a1-site9](/wp-content/uploads/2016/01/a1-site9.png)
](/wp-content/uploads/2016/01/a1-site9.png)(2) 點選後，上方欄框已新增垂直分割，可再做內容設定。 [
![a1-site10](/wp-content/uploads/2016/01/a1-site10.png)
](/wp-content/uploads/2016/01/a1-site10.png)2. 欄框設定精靈：針對已完成設定的欄框內容若需要調整，則可利用「自訂頁面」→「欄框設定精靈」執行。 (1) 例如：我們調整左下的商品走勢圖，使其只出現走勢圖，無明細資料。 [
![a0422-1](/wp-content/uploads/2016/04/a0422-1.png)
](/wp-content/uploads/2016/04/a0422-1.png)(2) 進入「欄框設定精靈─設定商品盤勢」，在設定顯示參數內，改變顯示方式為「單格」，預設相關資訊選擇「走勢圖」，可直接點選「完成」略過其他設定。 [
![a1-site12](/wp-content/uploads/2016/01/a1-site12.png)
](/wp-content/uploads/2016/01/a1-site12.png)(3) 已完成修改欄框內容如下圖。 [
![a0422-2](/wp-content/uploads/2016/04/a0422-2.png)
](/wp-content/uploads/2016/04/a0422-2.png)3. 刪除欄框：選取欲刪除的欄框(先點選確認為紅色作用視窗)，利用主功能列「自訂頁面」→「刪除欄框」即可完成刪除動作。 (1) 例如：我們先將左上欄框，以「分割欄框→水平等分」再作切割。 [
![a0422-3](/wp-content/uploads/2016/04/a0422-3.png)
](/wp-content/uploads/2016/04/a0422-3.png)(2) 先點選確認剛才所新增的空白欄框為紅色作用視窗，執行「自訂頁面」→「刪除欄框」，便可刪除所選欄框。 [
![a1-site15](/wp-content/uploads/2016/01/a1-site15.png)
](/wp-content/uploads/2016/01/a1-site15.png)

### **(三) 設定/解除同步資料 **
設定同步欄框，是指定那些欄框要和目前的作用欄框成為同一個同步族群，也就是任一個同步族群欄框成為作用欄框時，切換商品，與其同屬同步欄框的畫面，即會同步將內容切換至新商品。解除欄框同步，則是將作用欄框從目前所屬的同步欄框中移除，恢復成獨立欄框。 1. 設定同步欄框： (1) 點選一個欄框成為作用欄框。例如我們先點選左上「報價組合」為作用欄位。 (2) 按下[自訂頁面]中的[設定同步欄框]按鈕，會出現一個對話盒，此時滑鼠游標圖形改變，您可點選要同步的欄框，挑選完畢後按[完成]按鈕即可。 [
![a1-site16](/wp-content/uploads/2016/01/a1-site16.png)
](/wp-content/uploads/2016/01/a1-site16.png)我們將左上及右上欄框設成同一群組，再按下「完成」按鈕即可。 [
![a0422-4](/wp-content/uploads/2016/04/a0422-4.png)
](/wp-content/uploads/2016/04/a0422-4.png)(3) 您可依照需求，自行設定多個不同的同步群組，屬於同一群組的欄框，欄框顏色會一致。我們再將左下及右下欄框設成同一群組。 [
![a0422-5](/wp-content/uploads/2016/04/a0422-5.png)
](/wp-content/uploads/2016/04/a0422-5.png)(4) 重覆此步驟即可建立多組同步欄框。 [
![a0422-6](/wp-content/uploads/2016/04/a0422-6.png)
](/wp-content/uploads/2016/04/a0422-6.png)2. 取消欄框同步： (1) 點選一個欄框成為作用欄框。例如我們點選右上「技術分析」為作用欄位。 (2) 按下[自訂頁面]中的[解除欄框同步]按鈕，如此即完成解除動作，該作用欄框隨即恢復為獨立欄框。 [
![a0422-7](/wp-content/uploads/2016/04/a0422-7.png)
](/wp-content/uploads/2016/04/a0422-7.png)

### **(四) 儲存頁面、開啟舊頁 **
完成所有設定後，記得要儲存下來，方便往後使用。 1. 儲存頁面： (1) 點選主功能列中「自訂頁面」中的「儲存頁面」。 (2) 若此頁面之前並未被命名，則此時會跳出一對話盒，在畫面中輸入自定的頁面名稱，也可同時指定快捷頁碼，再按[儲存]按鍵即完成；若此頁有命名，則系統會直接執行存檔動作。 [
![a0422-8](/wp-content/uploads/2016/04/a0422-8-1.png)
](/wp-content/uploads/2016/04/a0422-8-1.png)2. 開啟舊頁： (1) 點選主功能列中「自訂頁面」中的「開啟舊頁」，您可以點選[最近使用的頁面]、[自定頁面]或[我的最愛]，從中挑選一個頁面。 (2) 可選擇開啟剛才儲存的「報價01」頁面。 [
![a0422-4](/wp-content/uploads/2016/04/a0422-4.jpg)
](/wp-content/uploads/2016/04/a0422-4.jpg)(3) 或是直接在任何頁面上，輸入剛才同步設定的「500」快捷頁碼，也可快速開啟自定頁面。 [
![a1-site28](/wp-content/uploads/2016/01/a1-site28.jpg)
](/wp-content/uploads/2016/01/a1-site28.jpg)3. 我的最愛： 您也可將自訂頁面儲存到「我的最愛」，並加入快速鍵功能(500-999)，以方便往後能快速找到所要頁面。 (1) 開啟剛才的自訂頁面「報價01」，並點選主功能列中「我的最愛」中的「加入我的最愛」。 [
![a0422-9](/wp-content/uploads/2016/04/a0422-9.png)
](/wp-content/uploads/2016/04/a0422-9.png)[
![a1-site30](/wp-content/uploads/2016/01/a1-site30.jpg)
](/wp-content/uploads/2016/01/a1-site30.jpg)(2) 之後便能快速的由「我的最愛」選單中，快速前往自定頁面。 [
![a1-site31](/wp-content/uploads/2016/01/a1-site31.jpg)
](/wp-content/uploads/2016/01/a1-site31.jpg)

### **(五) 另存新頁、另存式樣 **
1. 另存新頁：當既存頁面有任何修改，都可以另存新頁，以方便往後使用。 (1) 我們將剛才建立的自訂頁面「報價01」，以分割欄框再調整畫面為如下所示。 [
![a0422-10](/wp-content/uploads/2016/04/a0422-10.png)
](/wp-content/uploads/2016/04/a0422-10.png)(2) 點選主功能列中「自訂頁面」→「另存新頁」，在畫面中輸入自定的頁面名稱，也可指定快捷頁碼，再按[儲存]按鍵即完成。例如我們將此頁面另儲存名稱為「報價02」，並同時指定快捷頁碼為「501」。 [
![a0422-11](/wp-content/uploads/2016/04/a0422-11.png)
](/wp-content/uploads/2016/04/a0422-11.png)2. 另存式樣：為方便日後使用，可將辛苦設計出的版面儲存起來。 (1) 點選主功能列中[自訂頁面]→[另存式樣]，輸入式樣名稱即可。 [
![a0422-12](/wp-content/uploads/2016/04/a0422-12.png)
](/wp-content/uploads/2016/04/a0422-12.png)(2) 之後在「開啟新頁」時，便可在[我的式樣]從中挑選。 [
![a0422-7](/wp-content/uploads/2016/04/a0422-7.jpg)
](/wp-content/uploads/2016/04/a0422-7.jpg)接下來要介紹自設畫面的其他技巧，我們繼續看下去囉！ [

#####


---

# 自設畫面(二)

Source: https://www.xq.com.tw/lesson/advanced/customscreen02/

接續上篇自設畫面基本功能的介紹，本篇則帶你認識自設畫面的其他技巧，例如多頁籤的使用、快速複製及貼上、如何複製系統頁面為新頁面，以及快捷頁碼維護等。 相信這些小撇步，可以幫助你在使用XQ看盤時更加事半功倍喔！ 

### **(一) 多頁籤的使用 **
可將常查詢的商品組合都在報價組合欄框中切換。 

#### 1. 新增「小頁籤」操作方式： 
(1) 例如我們以上篇的「看盤01」自訂頁面，在左上欄框新增「江波分析」小頁籤。請Click頁籤左方的「▼」Icon，選擇「新增頁籤」。 [
![0426-1](/wp-content/uploads/2016/04/0426-1.jpg)
](/wp-content/uploads/2016/04/0426-1.jpg)(2) 系統會跳出「欄框設定精靈」，再由您自行設定想要安排的內容。我們選擇「江波分析」，不改變顯示內容參數，直接按完成鈕。 [
![0426-2](/wp-content/uploads/2016/04/0426-2.jpg)
](/wp-content/uploads/2016/04/0426-2.jpg)[
![0426-3](/wp-content/uploads/2016/04/0426-3.jpg)
](/wp-content/uploads/2016/04/0426-3.jpg)(3) 設定完成後，左上欄框已新增「上市 江波分析」小頁籤。同一欄框可以有多個頁籤（限制至多16個）。 [
![0426-4](/wp-content/uploads/2016/04/0426-4.jpg)
](/wp-content/uploads/2016/04/0426-4.jpg)

#### 2. 新增「大頁籤」操作方式： 
若有需要也可插入左側空白頁籤（大頁籤，限制至多16個）。 (1) 請Click「未命名1」大頁籤上方的「▼」Icon，選擇「插入空白標籤」。 [
![0426-5](/wp-content/uploads/2016/04/0426-5.jpg)
](/wp-content/uploads/2016/04/0426-5.jpg)(2) 已新增「未命名2」空白頁籤，您可使用「分割欄框」再切割畫面設定為想要的頁面（請參見上一篇教學介紹： [如何自設畫面(一) ](https://www.xq.com.tw/Lesson.aspx?a=742)）。在此我們直接點選「請設定欄框內容」，出現「欄框設定精靈」後，選取「技術分析」後按下一步，並直接按「完成」接受預設值。 [
![0426-6](/wp-content/uploads/2016/04/0426-6.jpg)
](/wp-content/uploads/2016/04/0426-6.jpg)[
![0426-7](/wp-content/uploads/2016/04/0426-7.jpg)
](/wp-content/uploads/2016/04/0426-7.jpg)(3) 設定完成頁面如下圖（左側2個頁籤可自由切換查看）。 [
![0426-8](/wp-content/uploads/2016/04/0426-8.jpg)
](/wp-content/uploads/2016/04/0426-8.jpg)

#### 3. 頁籤重新命名： 
(1) 請先點選「未命名1」大頁籤後，Click頁籤上方的「▼」Icon，選擇「重新命名」。 [
![0426-9](/wp-content/uploads/2016/04/0426-9.jpg)
](/wp-content/uploads/2016/04/0426-9.jpg)(2) 輸入自定名稱即可。例如我們輸入「報價組合」，並按下確定鈕，即可完成頁籤重新命名。 [
![0426-11](/wp-content/uploads/2016/04/0426-11.png)
](/wp-content/uploads/2016/04/0426-11.png)(3) 依同樣方式，我們將「未命名2」大頁籤，重新命名為「技術分析」。 [
![0426-13](/wp-content/uploads/2016/04/0426-13.png)
](/wp-content/uploads/2016/04/0426-13.png)

#### 4. 商品一致： 
在切換商品時，其他頁籤也會跟著同步切換為相同商品。 (1) 請Click頁籤左方的「▼」Icon，選擇「商品一致」。 [
![0426-14](/wp-content/uploads/2016/04/0426-14.jpg)
](/wp-content/uploads/2016/04/0426-14.jpg)(2) 系統提示「頁面內所有作用欄框內容會全部設定成同步模式」，請按下「確認」按鈕。 [
![a2-site15](/wp-content/uploads/2016/01/a2-site15.jpg)
](/wp-content/uploads/2016/01/a2-site15.jpg)(3) 已完成「商品一致」設定，請試著點選報價組合中的「台積電」，並確認「報價組合」及「技術分析」頁籤內容均會切換為「台積電」。 [
![0426-14](/wp-content/uploads/2016/04/0426-14.png)
](/wp-content/uploads/2016/04/0426-14.png)

### **(二) 快速複製及貼上 **
像操作Office一樣簡單，可在想複製的畫面，按滑鼠右鍵，選擇「複製」，然後再於所要設定的欄框內容中，按滑鼠右鍵「貼上」或「選擇性貼上」。 

#### 1. 複製及貼上： 
(1) 我們繼續以「看盤01」自訂頁面進行操作，先切換至「技術分析」頁籤，並使用「分割欄框」垂直等分畫面。 [
![0426-17](/wp-content/uploads/2016/04/0426-17.jpg)
](/wp-content/uploads/2016/04/0426-17.jpg)(2) 請切換至旁邊的「報價3」工作標籤，點選「報價→台股精選報價→上市櫃特別報價」，並進入「創當日新高股」。 [
![0426-15](/wp-content/uploads/2016/04/0426-15.png)
](/wp-content/uploads/2016/04/0426-15.png)(3) 在「創當日新高股頁面」上點按滑鼠右鍵，選擇「複製」，並回到「看盤01」自訂頁面的「技術分析」頁籤，在要設定的欄框內容中，按滑鼠右鍵選擇「貼上」，便可直接貼上內容。 步驟1-複製： [
![0426-19](/wp-content/uploads/2016/04/0426-19.jpg)
](/wp-content/uploads/2016/04/0426-19.jpg)步驟2-貼上： [
![0426-20](/wp-content/uploads/2016/04/0426-20.jpg)
](/wp-content/uploads/2016/04/0426-20.jpg)步驟3-完成頁面： [
![0426-21](/wp-content/uploads/2016/04/0426-21.jpg)
](/wp-content/uploads/2016/04/0426-21.jpg)

#### 2. 選擇性貼上： 
(1) 按滑鼠右鍵也可執行「選擇性貼上」，有四個選項：「1.全部插入」、「2.僅加入單一內容」、「3.全部覆蓋」、「4.僅覆蓋單一內容」，您可依據需要來執行選擇。 [
![a2-site21](/wp-content/uploads/2016/01/a2-site21.jpg)
](/wp-content/uploads/2016/01/a2-site21.jpg)(2) 例如我們以上例，若先點選左側為作用欄框，並點按滑鼠右鍵，選擇「複製」→「選擇性貼上」→「僅加入單一內容」，完成頁面如下所示，會增加一頁於原欄框內容中。 [
![0426-16](/wp-content/uploads/2016/04/0426-16.png)
](/wp-content/uploads/2016/04/0426-16.png)

### **(三) 複製成新頁面 **
為方便您修改系統提供的系統功能頁，運用複製成新頁面的功能，可以免除重新規劃版面的動作，直接進行內容設定即可！ 例如： 1. 您想要修改目前系統提供的報價[綜合看盤]頁面的部份內容安排，但系統頁面是不能編修； [
![a2-site11](/wp-content/uploads/2016/01/a2-site11.png)
](/wp-content/uploads/2016/01/a2-site11.png)2. 此時，點選「自訂頁面」→「複製成新頁面」，螢幕標題列即會由原本的「綜合看盤」變更成「未命名n」，即可進行編修動作。 
![a2-site12](/wp-content/uploads/2016/01/a2-site12.png)
下一篇我們將帶大家再練習一個實作範例，讓你更加熟悉如何自訂看盤頁面喔！ [

#####


---

# 自設畫面(三)

Source: https://www.xq.com.tw/lesson/advanced/customscreen03/

前二篇的自設看盤畫面操作技巧，大家都學會了嗎？ 我們再示範一個實作範例，藉由實作過程，會讓你更加熟悉如何自訂看盤頁面，現在就依照您的實際需求，動手塑造屬於您的個人化界面吧！ 本範例將完成自訂看盤畫面如下圖～ [
![0427-1](/wp-content/uploads/2016/04/0427-1.png)
](/wp-content/uploads/2016/04/0427-1.png)

### 

### **步驟一【開啟新頁】 **
請點選主功能列中「自訂頁面」中的「開啟新頁」，由「系統式樣」中挑選4格式樣使用。 [
![0427-2](/wp-content/uploads/2016/04/0427-2.jpg)
](/wp-content/uploads/2016/04/0427-2.jpg)

### 

### **步驟二【設定左上欄框內容-即時監控】 **
1. 請點選左上欄框，設定顯示內容為「即時監控」。 [
![0427-4](/wp-content/uploads/2016/04/0427-4.png)
](/wp-content/uploads/2016/04/0427-4.png)2. 在「選擇內容」的參數設定，設定顯示內容為「警示記錄」。 [
![0427-4](/wp-content/uploads/2016/04/0427-4.jpg)
](/wp-content/uploads/2016/04/0427-4.jpg)3. 設定欄位可取消「商品代碼」（可視個人喜好自由設定）。 [
![0427-5](/wp-content/uploads/2016/04/0427-5.jpg)
](/wp-content/uploads/2016/04/0427-5.jpg)4. 按完成鈕（接受其他預設值），即完成左上「即時監控」的欄框設定。 [
![0427-5](/wp-content/uploads/2016/04/0427-5.png)
](/wp-content/uploads/2016/04/0427-5.png)

### 

### **步驟三【設定左下欄框內容-報價組合】 **
1. 請點選左下欄框，設定顯示內容為「報價組合」，並直接按完成鈕（接受其他預設值）。 [
![0427-7](/wp-content/uploads/2016/04/0427-7.jpg)
](/wp-content/uploads/2016/04/0427-7.jpg)2. 我們在左下欄框內再新增一個小頁籤，設定為「報價組合」的「每日警示清單」。 [
![0427-8](/wp-content/uploads/2016/04/0427-8.jpg)
](/wp-content/uploads/2016/04/0427-8.jpg)[
![0427-6](/wp-content/uploads/2016/04/0427-6.png)
](/wp-content/uploads/2016/04/0427-6.png)3. 已完成左下欄框「報價組合」兩個頁籤的設定。 [
![0427-10](/wp-content/uploads/2016/04/0427-10.jpg)
](/wp-content/uploads/2016/04/0427-10.jpg)4. 我們再將左上及左下欄框內的頁籤重新命名，以利識別內容： • 左下頁籤1命名為「自選股」 • 左下頁籤2命名為「自動監控」 • 左上欄框內頁籤命名為「即時監控」 [
![0427-8](/wp-content/uploads/2016/04/0427-8.png)
](/wp-content/uploads/2016/04/0427-8.png)[
![0427-7](/wp-content/uploads/2016/04/0427-7.png)
](/wp-content/uploads/2016/04/0427-7.png)

### 

### **步驟四【設定右上欄框內容-商品盤勢】 **
1. 請點選右上欄框，設定顯示內容為「商品盤勢」，並在"設定輪播"參數設定，設定顯示「明細」、「新聞」、「法人」、「資券」四項相關資訊。 [
![0427-14](/wp-content/uploads/2016/04/0427-14.jpg)
](/wp-content/uploads/2016/04/0427-14.jpg)2. 已完成右上「商品盤勢」的欄框設定。 [
![0427-9](/wp-content/uploads/2016/04/0427-9.png)
](/wp-content/uploads/2016/04/0427-9.png)

### 

### **步驟五【設定右下欄框(1)內容-技術分析】 **
1. 先進行分割欄框（垂直分割），將右下欄框分割為兩欄。 [
![0427-16](/wp-content/uploads/2016/04/0427-16.jpg)
](/wp-content/uploads/2016/04/0427-16.jpg)2. 設定左邊欄框內容為「技術分析」，並進行以下設定： (1) 只保留移動平均線三 [
![0427-17](/wp-content/uploads/2016/04/0427-17.jpg)
](/wp-content/uploads/2016/04/0427-17.jpg)(2) 取消所有副圖 [
![0427-18](/wp-content/uploads/2016/04/0427-18.jpg)
](/wp-content/uploads/2016/04/0427-18.jpg)(3) 更改資料頻率為5分鐘K線圖 [
![0427-19](/wp-content/uploads/2016/04/0427-19.jpg)
](/wp-content/uploads/2016/04/0427-19.jpg)(4) 將此頁籤重新命名為「個股5分K」，完成畫面如下： [
![0427-20](/wp-content/uploads/2016/04/0427-20.jpg)
](/wp-content/uploads/2016/04/0427-20.jpg)

### 

### **步驟六【設定右下欄框(2)內容-技術分析】 **
1. 接下來直接在剛才設定好的「個股5分K」頁面上按滑鼠右鍵，選擇「複製」，並在右方空白欄框內，以滑鼠右鍵選擇「貼上」，便可直接貼上內容。 [
![0427-21](/wp-content/uploads/2016/04/0427-21.jpg)
](/wp-content/uploads/2016/04/0427-21.jpg)2. 更改此圖的頻率為日線圖，並重新命名頁籤為「個股日K」。 [
![0427-22](/wp-content/uploads/2016/04/0427-22.jpg)
](/wp-content/uploads/2016/04/0427-22.jpg)3. 以相同方式，我們在此欄框內再新增2個小頁籤，更改資料頻率為週線及月線，並重新命名頁籤為「週K」及「月K」。 可以用「複製」→「 **選擇性貼上 **」→「僅加入單一內容」，達成以上目的喔！ [
![0427-10](/wp-content/uploads/2016/04/0427-10.png)
](/wp-content/uploads/2016/04/0427-10.png)

### 

### **步驟七【設定右上欄框內容-交易功能】 **
1. 我們在右上欄框內也新增3個小頁籤，設定顯示內容均為「XQ交易」，並依序選擇「委託查詢」、「成交查詢」、「即時庫存」這三種類別。 [
![0427-24](/wp-content/uploads/2016/04/0427-24.jpg)
](/wp-content/uploads/2016/04/0427-24.jpg)2.完成畫面如下： [
![0427-25](/wp-content/uploads/2016/04/0427-25.jpg)
](/wp-content/uploads/2016/04/0427-25.jpg)

### 

### **步驟八【設定同步欄框】 **
1. 我們將本頁面中的所有欄框，均設定為同步欄框。 請先點選左上欄框為作用欄位，按下[自訂頁面]中的[設定同步欄框]按鈕，此時滑鼠游標圖形改變，再分別點選所有要同步的欄框，挑選完畢後按[完成]按鈕即可。 [
![0427-11](/wp-content/uploads/2016/04/0427-11.png)
](/wp-content/uploads/2016/04/0427-11.png)2. 設定完成後點選左上方商品，確認各欄框同步的效果。 [
![0427-27](/wp-content/uploads/2016/04/0427-27.jpg)
](/wp-content/uploads/2016/04/0427-27.jpg)3. 右下多頁籤的組合（個股日K/週K/月K），則設定為「商品一致」，當設定完成後，往後在切換商品時，其他頁籤也會跟著同步切換為相同商品。設定完成後也確認同步的效果。 [
![0427-28](/wp-content/uploads/2016/04/0427-28.jpg)
](/wp-content/uploads/2016/04/0427-28.jpg)

### 

### **步驟九【儲存頁面】 **
1. 最後我們將大頁籤重新命名為「警示+K線」，辛苦建立的看盤頁面，要記得儲存起來，請執行「自訂頁面→儲存頁面」，例如我們存檔為"看盤01"。 [
![0427-12](/wp-content/uploads/2016/04/0427-12.png)
](/wp-content/uploads/2016/04/0427-12.png)2. 將自訂頁面也加入至我的最愛中，之後就可以快速前往自定頁面囉! [
![0427-31](/wp-content/uploads/2016/04/0427-31.jpg)
](/wp-content/uploads/2016/04/0427-31.jpg)[

#####


---

# 個股股權分析

Source: https://www.xq.com.tw/lesson/advanced/equity/

想知道我們關心的股票，到底有沒有大戶撐盤，最簡單的方式，就是打開個股技術分析圖，看「大戶持股」指標變化。 若想看更詳細的資料，就去盤後看【股權分散表】吧！ 

### **【股權分散表】：提供各級距持股人數、張數、比率與平均張數資料。 **
如下圖 6/12 台積電跳空下跌，是籌碼鬆動嗎？？ 首先，我們注意到大戶持股比率及張數有掉下來，細看原來是持股1千張以上的大戶啊！ 接著，看人數變化不大，平均持股張數也只有小幅變化，影響應該還好。不過，發現持股400到800兩個級距資料也有發生變化，且是有由持股多往持股少方向移動，這就又讓人有點擔心了。 [
![V1](/wp-content/uploads/2017/07/V1.png)
](/wp-content/uploads/2017/07/V1.png)[
![V2](/wp-content/uploads/2017/07/V2.png)
](/wp-content/uploads/2017/07/V2.png)點選「顯示全部」，把時間拉長一點來分析趨勢。 若大戶持股張數持續減少， 而散戶持股張數持續增加的話，恐怕籌碼就要鬆動，股價有危險了。 [
![V3](/wp-content/uploads/2017/07/V3.png)
](/wp-content/uploads/2017/07/V3.png)[

#####


---

# 族群透視功能

Source: https://www.xq.com.tw/lesson/advanced/group/

類股輪動是掌握盤勢脈動很重要的一環，然而交易所上市櫃的產業類別，因分類範圍太大無法觀察相近性質的個股， 現在，使用族群透視功能，就可以解決這個困擾了！ 【 
![?](https://static.xx.fbcdn.net/images/emoji.php/v9/t1d/1/16/1f4d5.png)
系列閱讀】 【族群透視 功能使用說明】系列1： [https://pse.is/43sq4l ](https://pse.is/43sq4l)【族群透視 功能使用說明】系列2： [https://pse.is/42wl52 ](https://pse.is/42wl52)【族群透視 功能使用說明】系列3： [https://pse.is/43aaql ](https://pse.is/43aaql?fbclid=IwAR2wHYijz0uPYmFhUuqrtADS5_OJ2buiE8PTo4JK0WS7M8o_0pketAh2l1U)【族群透視 功能使用說明】系列4： [https://pse.is/3ujgjz ](https://pse.is/3ujgjz?fbclid=IwAR2M6p7QS1XI4K7wU2kwL9y6FKKerF1Kl-Ue_pSTnwuyxlMa0tYZyd-MizI)【族群透視 功能使用說明】系列5： [https://pse.is/44zbxs ](https://pse.is/44zbxs?fbclid=IwAR2A32FnZW9Ydvq72-WxKmsZJaJuU3bcOc8kuD2kYFxyKDG9nn3Nb9z8rh4)【族群透視 功能使用說明】系列6： [https://reurl.cc/vWVWY1 ](https://reurl.cc/vWVWY1?fbclid=IwAR3bzEO_EFrH6PfzjHYgkYB3JGxAu1gpNWI1f9CixZ8hCsIut6tqJoTsySY)【族群透視 功能使用說明】系列7： [https://reurl.cc/V83GaN ](https://reurl.cc/V83GaN)族群透視，是透過細產業及主題指標，搭配多項大戶欄位，了解盤中資金流向變化 ，什麼類股在走強，什麼類股走弱。 [
![](/wp-content/uploads/2022/03/031601.png)
](/wp-content/uploads/2022/03/031601.png)進入族群透視頁面後， 左側的大分頁，分成「細產業指標」與「主題指標」， 細產業指標，是針對上市櫃公司所處的產業類別，細分出重要的產業與指標個股，作為觀察該產業的代表。 主題指標，是從產品、市場話題或潛力產業作為分析方向。 [
![](/wp-content/uploads/2022/03/032101.png)
](/wp-content/uploads/2022/03/032101.png)盤中的即時排行，透過不同的檢視條件，可以了解族群的熱度變化。 [
![](/wp-content/uploads/2022/03/032102.png)
](/wp-content/uploads/2022/03/032102.png)在欄位上，新增與大戶有關的如下： [
![](/wp-content/uploads/2022/03/031605.png)
](/wp-content/uploads/2022/03/031605.png)每個族群指標，都可以透過成交分佈內的資訊來掌握盤中買賣大戶轉折變化： 

- 大戶買賣比和大戶單：可以告訴我們今天主力進行買進或賣出的力道，同時也也意味著今天主力多空方向是否一致。 
- 單別分析：這個指標反應出今天整體的成交分布，可以關注「特大單」以及「大單」的買賣差額占比。 
[
![](/wp-content/uploads/2022/03/031606.png)
](/wp-content/uploads/2022/03/031606.png)族群商品，在基本分析資訊上，提供營收面、獲利面、籌碼面等分析面向， 了解成份股在各指標上的近期數據，作為選定投資標的輔助決策。 [
![](/wp-content/uploads/2022/03/031607.png)
](/wp-content/uploads/2022/03/031607.png)商品名稱右鍵功能選單的「基本資料」，可以查詢成份股相關面向的歷史數據。 [
![](/wp-content/uploads/2022/03/031608.png)
](/wp-content/uploads/2022/03/031608.png)族群透視功能：XQ(企業版) 7.08.01，XQ(個人版)3.08.01起提供 

#### XQ APP「族群透視」功能介紹? [請見此篇 ](https://www.xq.com.tw/learn/app/group/)
[

#####


---

# 尋找個股主力券商

Source: https://www.xq.com.tw/lesson/advanced/majorbrokerage/

如何找到個股主力，跟著主力進出賺錢，我想這是大家共同的心願！所以接下來就讓我們一起做功課，找出個股主力吧！ 首先，我們可以在技術分析圖上找找過去有行情發生的時間點，不論是一天還是一段時間都可以， 然後看看都是那些券商在進出，以及觀察這些券商進出與股價變化關係。 [
![](/wp-content/uploads/2017/07/S1-1.png)
](/wp-content/uploads/2017/07/S1-1.png)選單區的篩選項目，可協助我們找券商。 例如想找「吃貨券商、出貨券商」，可試試【買賣超張、買賣張】選項。 [
![S2](/wp-content/uploads/2017/07/S2.png)
](/wp-content/uploads/2017/07/S2.png)若要進一步分析券商，則可再調整欄位顯示內容。 如【買賣差比重、買賣比重】，可看這些券商的交易佔個股成交量比重大不大，有沒有影響股價的可能； 或【買賣力道、買賣集中度】欄位，可看有哪些券商是押單邊操作的(即只買或只賣)； 至於券商這樣操作有沒有賺錢，則可看【損益】欄位。 [
![](/wp-content/uploads/2017/07/S3-1.png)
](/wp-content/uploads/2017/07/S3-1.png)然後，我們可點單一券商，或是勾選幾家券商，看看券商過去的交易與個股股價變化。 [
![](/wp-content/uploads/2017/07/S4-1.png)
](/wp-content/uploads/2017/07/S4-1.png)[
![](/wp-content/uploads/2017/07/S5-1.png)
](/wp-content/uploads/2017/07/S5-1.png)如此反覆分析，就可找到我們要追蹤的主力券商了！ [

#####


---

# 市場籌碼分析

Source: https://www.xq.com.tw/lesson/advanced/marketchip/

最近台股好不容易盼來萬點行情，大家在高興的同時，應該也有在擔心不知這次會不會又是曇花一現，手中的股票到底是該賣？還是要加碼進場呢？ 當心中有疑惑時，不妨先來看看整個市場的情形吧！ 首先，打開整體【市場籌碼】分析頁面，看看各籌碼分類多空分布情形。 如下圖，就最近數據來看，外資與各大券商主要都在買，且技術分析圖也在告訴我們，這些券商近期買超居多，所以只要這個趨勢不變，台股行情不會這麼快結束。 [
![TSE1](/wp-content/uploads/2017/07/TSE1.png)
](/wp-content/uploads/2017/07/TSE1.png)[
![TSE2](/wp-content/uploads/2017/07/TSE2.png)
](/wp-content/uploads/2017/07/TSE2.png)想進一步瞭解各是哪些群組或券商在買或賣，可看【券商進出金額分析】頁面。 在[券商]選項選「系統券商」，可看系統提供的券商分類買賣分布情形。選「券商分點」，可細看是那些分點在買或賣。 然後，可再透過技術分析副圖，瞭解券商進出與行情變化，以決定是否要追蹤這些券商。 如下圖，[前十大綜合券商]似乎就是最近應特別注意的族群。 [
![TSE3](/wp-content/uploads/2017/07/TSE3.png)
](/wp-content/uploads/2017/07/TSE3.png)[
![TSE4](/wp-content/uploads/2017/07/TSE4.png)
](/wp-content/uploads/2017/07/TSE4.png)若想知道最近法人與主力同步在進出的股票有什麼，可利用【籌碼排行】功能。 [
![TSE5](/wp-content/uploads/2017/07/TSE5.png)
](/wp-content/uploads/2017/07/TSE5.png)【券商進出股票分析】功能，可分析自選券商及系統券商進出股票。 [
![TSE6](/wp-content/uploads/2017/07/TSE6.png)
](/wp-content/uploads/2017/07/TSE6.png)透過各式的篩選方式，希望能幫到大家早一步找到主力佈單的標的！ [

#####


---

# 如何在「商品盤勢」與「技術分析」頁面顯示交易訊號標記

Source: https://www.xq.com.tw/lesson/advanced/signalmark/

現在 XQ 已經可以在「商品盤勢」「技術分析分鐘與日頻率」頁面，顯示委託與當日成交訊號的標記。 [
![](/wp-content/uploads/2024/04/03_委託與下單.png)
](/wp-content/uploads/2024/04/03_委託與下單.png)有了這個功能，就能在商品盤勢與技術分析頁面上，顯示「未成交委託、成交、MIT」交易訊號標記，爾後看盤時，直接在商品盤勢與技術分析頁面上取得委託與當日成交明細資訊。 以下三點為交易訊號注意事項，先提出來供大家參考： 

- 目前支援商品：台灣市場的證券、期貨、選擇權商品。 
- 未成交委託／成交標記訊號的清除規則是，當券商端已經將當日的委託/成交單刪除，則商品盤勢與技術分析也會清除委託/成交的交易訊號標記。 
- MIT 標記訊號，則是會依據是否開啟「收盤後保留 MIT 委託」來決定存續時間，可以參考「MIT存續時間說明」如下圖。 
[
![](/wp-content/uploads/2024/04/MIT存續時間_00-1024x689.png)
](/wp-content/uploads/2024/04/MIT存續時間_00.png)那麼，要如何在 XQ 中應用呢？我們將以「搭配手動與自動下單」進行說明。 文章目錄如下： [**一、搭配手動下單 **](#anchor01)[**二、搭配自動下單 **](#anchor02)[](#)
---

### 

### **一、搭配手動下單 **
手動下單是透過滑鼠點擊帶入下單的動作，像是透過「下單列」與「閃電下單」送出委託，這兩個功能就是手動下單。 交易訊號標記搭配手動下單的應用，可以用以下 4 個步驟達成。 

- 開啟自己的 [自設畫面 ](https://www.xq.com.tw/learn/advanced/customscreen01/)。如下圖，面向螢幕由左到右為技術分析、商品盤勢、報價組合。 

  - 可以設定同步商品到報價組合，以便點擊報價組合內的自選股，快速切換商品。 [
![](/wp-content/uploads/2024/04/手動下單_01-1.png)
](/wp-content/uploads/2024/04/手動下單_01-1.png)

- 在技術分析與商品盤勢，右鍵選單選擇「交易訊號設定」並開啟「未成交、成交、MIT」交易訊號標記。 [
![](/wp-content/uploads/2024/04/手動下單_02.png)
](/wp-content/uploads/2024/04/手動下單_02.png)
- 手動送出限價與MIT單的委託單，會顯示交易訊號標記，如下圖委託送單協易機（4533.TW）商品。 [
![](/wp-content/uploads/2024/04/手動下單_03.png)
](/wp-content/uploads/2024/04/手動下單_03.png)

  - [
![](/wp-content/uploads/2024/04/手動下單_3_1.png)
](/wp-content/uploads/2024/04/手動下單_3_1.png)限價單，現股買進 1 張，現股價格 38 元的委託。 
  - [
![](/wp-content/uploads/2024/04/手動下單_3_2.png)
](/wp-content/uploads/2024/04/手動下單_3_2.png)限價單，現股當沖先賣 2 張，現股價格 40 元的委託。 
  - [
![](/wp-content/uploads/2024/04/手動下單_3_3.png)
](/wp-content/uploads/2024/04/手動下單_3_3.png)限價單，零股買進 3 股，零股價格 37 元的委託。 
  - [
![](/wp-content/uploads/2024/04/手動下單_3_4.png)
](/wp-content/uploads/2024/04/手動下單_3_4.png)MIT單，現股買進 4 張，MIT價格 39 元的委託。 
  - [
![](/wp-content/uploads/2024/04/手動下單_3_5.png)
](/wp-content/uploads/2024/04/手動下單_3_5.png)MIT單，現股當沖先賣 5 張，MIT價格 42 元的委託。 
  - 若想刪除委託，可以滑鼠點擊標記，有「全刪、刪單」功能。 

- 盤中出現成交，就會顯示當日成交訊號標記。如下圖： [
![](/wp-content/uploads/2024/04/手動下單_04.png)
](/wp-content/uploads/2024/04/手動下單_04.png)由左至右標記分別為： 

  - [
![](/wp-content/uploads/2024/04/手動下單_Buy.png)
](/wp-content/uploads/2024/04/手動下單_Buy.png)11:43:48 買進成交 漢翔（2634.TW）1 張，成交均價 58.80 元 
  - [
![](/wp-content/uploads/2024/04/手動下單_Sell.png)
](/wp-content/uploads/2024/04/手動下單_Sell.png)11:57:42 賣出成交 漢翔（2634.TW）1 張，成交均價 58.60 元 
  - [
![](/wp-content/uploads/2024/04/手動下單_Buy.png)
](/wp-content/uploads/2024/04/手動下單_Buy.png)12:15:26～12:15:28 買進成交 漢翔（2634.TW）100 張，成交均價 58.50 元。 

    - 點擊成交訊號標記，可以查看成交明細。 

- 多個交易帳號在同一個價位委託或成交，則交易訊號會標記在相同的點位上，點擊標記圖示，可以在明細上看見所有委託或成交單與交易帳號。 (1) 多個交易帳號的未成交委託標記，明細呈現如下圖： [
![](/wp-content/uploads/2024/04/手動下單05_未成交委託_單一.png)
](/wp-content/uploads/2024/04/手動下單05_未成交委託_單一.png)

  - [
![](/wp-content/uploads/2024/04/手動下單05_未成交委託_單一_小標記.png)
](/wp-content/uploads/2024/04/手動下單05_未成交委託_單一_小標記.png)模擬交易帳號-01 與 模擬交易帳號-02 限價單，現股買進中工（2515）總共 4 張，現股價格 17.50 元。 

    - 10:06:10 模擬交易帳號-02 限價單 現股買進 1 張。 
    - 10:06:14 模擬交易帳號-02 限價單 現股買進 1 張。 
    - 10:05:56 模擬交易帳號-01 限價單 現股買進 1 張。 
    - 10:06:02 模擬交易帳號-01 限價單 現股買進 1 張。 

(2) 多個交易帳號的 MIT 單標記，明細呈現如下圖： [
![](/wp-content/uploads/2024/04/手動下單05_mit_單一.png)
](/wp-content/uploads/2024/04/手動下單05_mit_單一.png)[
![](/wp-content/uploads/2024/04/手動下單05_mit_單一_小標記.png)
](/wp-content/uploads/2024/04/手動下單05_mit_單一_小標記.png)模擬交易帳號-01 與 模擬交易帳號-02 MIT單，現股買進長榮航（2618），總共有 4 張，現股價格 35 元。 

  - 模擬交易帳號-01 MIT 現股買進 1 張，觸發價 -2 檔。 
  - 模擬交易帳號-01 MIT 現股買進 1 張，觸發價 -2 檔。 
  - 模擬交易帳號-01 MIT 現股買進 1 張，觸發價 -2 檔。 
  - 模擬交易帳號-01 MIT 現股買進 1 張，觸發價 -2 檔。 
(3) 多個交易帳號的成交標記，明細呈現如下圖： [
![](/wp-content/uploads/2024/04/手動下單05_成交_單一.png)
](/wp-content/uploads/2024/04/手動下單05_成交_單一.png)

  - [
![](/wp-content/uploads/2024/04/手動下單_Buy.png)
](/wp-content/uploads/2024/04/手動下單_Buy.png)10:07:00 模擬交易帳號-01 與 模擬交易帳號-02，總共買進成交中石化（1314）4 張，成交均價 10.35 元。 

    - 10:07:25 模擬交易帳號-01 現股買進成交 1 張。 
    - 10:07:29 模擬交易帳號-01 現股買進成交 1 張。 
    - 10:07:11 模擬交易帳號-02 現股買進成交 1 張。 
    - 10:07:19 模擬交易帳號-02 現股買進成交 1 張。 

依照上述步驟操作，透過同步商品到報價組合頁面，滑鼠點擊報價組合頁面的自選股時，技術分析與商品盤勢也會同步切換商品，然後透過滑鼠點擊商品盤勢頁面的五檔買進/賣出價，帶入手動下單，確認送單後，就能在技術分析與商品盤勢看到交易訊號標記，點選標記就能查看到委託與成交明細。 [](#)
---

### 

### **二、搭配自動下單 **
自動下動是透過 [XS自動交易 ](https://www.xq.com.tw/learn/xsat/)與 [策略雷達 ](https://www.xq.com.tw/learn/sensor/)，交易訊號觸發後，自動送出委託。 交易訊號標記設定與 [搭配手動下單 ](#anchor01)設定大同小異，差異是要到自動交易中心與策略雷達開啟下單，如下所述，依照 5 個步驟達成： 

- 開啟自己的 [自設畫面 ](https://www.xq.com.tw/learn/advanced/customscreen01/)。如下圖，面向螢幕由左到右為技術分析、商品盤勢、報價組合。 

  - 可以設定同步商品到報價組合，以便點擊報價組合內的自選股，快速切換商品。 [
![](/wp-content/uploads/2024/05/手動下單_01.png)
](/wp-content/uploads/2024/05/手動下單_01.png)

- 在技術分析與商品盤勢，右鍵選單選擇「交易訊號設定」並開啟「未成交、成交、MIT」交易訊號標記，即完成設定。 [
![](/wp-content/uploads/2024/04/手動下單_02.png)
](/wp-content/uploads/2024/04/手動下單_02.png)
- 執行「XS自動交易與XS策略雷達」開啟下單的策略。 

  - XS自動交易開啟下單的策略是指， [啟動交易帳號 ](https://www.xq.com.tw/learn/xsat/parameters/#learn05)的策略。 
  - XS自動交易開啟下單的策略是指， [啟動交易帳號 ](https://www.xq.com.tw/learn/xsat/parameters/#learn05)的策略。 [
![](/wp-content/uploads/2024/05/自動下單_03.png)
](/wp-content/uploads/2024/05/自動下單_03.png)

- 執行開啟下單的策略，並且盤中觸發自動送出委託單後，就會在技術分析與商品盤勢標記未成交委託的交易訊號標記，如下圖自動下委託單買進／賣出 大亞（1609.TW） [
![](/wp-content/uploads/2024/05/自動下單_04.png)
](/wp-content/uploads/2024/05/自動下單_04.png)

  - [
![](/wp-content/uploads/2024/05/自動下單_4_1.png)
](/wp-content/uploads/2024/05/自動下單_4_1.png)限價單，現股買進 1 張，現股價格 52.2 元的委託。 
  - [
![](/wp-content/uploads/2024/05/自動下單_4_2.png)
](/wp-content/uploads/2024/05/自動下單_4_2.png)限價單，現股當沖先賣 1 張，現股價格 58.1 元的委託。 
  - [
![](/wp-content/uploads/2024/05/自動下單_4_3.png)
](/wp-content/uploads/2024/05/自動下單_4_3.png)限價單，現股買進 2 張，現股價格 54.3 元的委託。 
  - [
![](/wp-content/uploads/2024/05/自動下單_4_4.png)
](/wp-content/uploads/2024/05/自動下單_4_4.png)限價單，現股當沖先賣 2 張，現股價格 56.2 元的委託。 
  - 若想手動刪除委託，可以滑鼠點擊標記，有「全刪、刪單」功能。 

- 盤中出現成交，就會顯示當日成交訊號標記。如下圖，在大同（2371）商品， [
![](/wp-content/uploads/2024/05/自動下單_05.png)
](/wp-content/uploads/2024/05/自動下單_05.png)由左至右 當日成交訊號標記分別為： 

  - [
![](/wp-content/uploads/2024/04/手動下單_Buy.png)
](/wp-content/uploads/2024/04/手動下單_Buy.png)09:40:10 自動交易，買進成交 1 張，成交均價 63.00 元。 
  - [
![](/wp-content/uploads/2024/04/手動下單_Buy.png)
](/wp-content/uploads/2024/04/手動下單_Buy.png)09:46:06 策略雷達，買進成交 2 張，成交均價 63.10 元。 
  - [
![](/wp-content/uploads/2024/04/手動下單_Sell.png)
](/wp-content/uploads/2024/04/手動下單_Sell.png)09:51:07 自動交易，賣出成交 1 張，成交均價 63.00 元。 
  - [
![](/wp-content/uploads/2024/04/手動下單_Sell.png)
](/wp-content/uploads/2024/04/手動下單_Sell.png)09:56:48 策略雷達，賣出成交 2 張，成交均價 62.90 元。 

依照上述五個步驟操作後，大家在XS自動中心與策略雷達中，執行開啟下單的策略，盤中訊號觸發自動下單後，就會顯示未成交委託訊號標記在執行商品的技術分析與商品盤勢頁面中，成交後也會顯示當日成交訊號標記，方便大家在技術分析與商品盤勢速覽委託與成交明細。 以上就是交易訊號標記功能，希望能幫助大家在技術分析與商品盤勢頁面，速覽商品委託與成交明細。若大家使用後，有任何的心得與建議，也歡迎來信至 XQservice@XQ.com.tw 回饋分享。 [

#####


---

# 個股與券商關係

Source: https://www.xq.com.tw/lesson/advanced/stocknbrokerage/

透過【籌碼大數據】功能找到個股主力券商分點後，可以將其加入自選或追蹤券商，方便之後運用分析。 例如在【個股進階籌碼】，券商名稱滑鼠右鍵及券商名稱欄位[+]按鈕，有提供「加入自選券商」&「加入追蹤券商」選擇。 [
![B1](/wp-content/uploads/2017/07/B1.png)
](/wp-content/uploads/2017/07/B1.png)選擇「加入追蹤券商」後，券商進出表「屬性」欄位會顯示是否為「追蹤券商」。 [
![](/wp-content/uploads/2017/07/B2-1.png)
](/wp-content/uploads/2017/07/B2-1.png)透過【券商歷史明細】功能，查看券商買賣此檔股票與損益情形。 選擇依「日期」查詢時，可看每日買進、賣出與損益數值；而依「價格」查詢時，可看進出價位落點，與區間累計損益關係。 [
![B3](/wp-content/uploads/2017/07/B3.png)
](/wp-content/uploads/2017/07/B3.png)[
![B4](/wp-content/uploads/2017/07/B4.png)
](/wp-content/uploads/2017/07/B4.png)另外，我們也可以透過【券商分析】功能，看看我們關注的券商最近還交易什麼股票。 此時，只要點選我們要查的自選券商，就可以進行篩選查詢囉！ [
![](/wp-content/uploads/2017/07/B5-1.png)
](/wp-content/uploads/2017/07/B5-1.png)[

#####


---

# 自選券商與追蹤券商功能

Source: https://www.xq.com.tw/lesson/advanced/trackbrokerage/

XQ全球贏家，在6.30版將原本的自選券商設定做了整調，不再把自選券商與觀察個股綁在一起，拆成【自選券商組合】與【追蹤券商組合】兩個獨立的設定。 

- **【自選券商組合】 : 主要用於大範圍搜尋這些券商在買賣什麼股票。 **
- **【追蹤券商組合】 : 主要用於查單一股票時, 看已設定的追蹤券商有什麼進出變化。 **
升版上來的用戶，原本設定過的資料，系統會自動幫忙移轉。 例如，在6.29版，自選券商組合中的設定如下： [
![061901](/wp-content/uploads/2017/06/061901.png)
](/wp-content/uploads/2017/06/061901.png)升版到6.30，原自選劵商組合內所設定的「追蹤分點」會被存到自選券商組合內，原券商組合名稱不變。 [
![061902a](/wp-content/uploads/2017/06/061902a.png)
](/wp-content/uploads/2017/06/061902a.png)原本的追蹤個股，會存放到【追蹤券商組合】內，每檔個股的追蹤券商就是原先的追蹤分點資料。 [
![061902b](/wp-content/uploads/2017/06/061902b.png)
](/wp-content/uploads/2017/06/061902b.png)除此之外， 原本的追蹤個股清單，是用戶關心的個股，在升級到6.30後， 系統會自動把它新增到自選商品組合中，就不用再一檔一檔輸入！ [
![061902c](/wp-content/uploads/2017/06/061902c.png)
](/wp-content/uploads/2017/06/061902c.png)新版的【自選券商組合】與【追蹤券商組合】編輯畫面，和【自選商品組合】編輯很相似，大家在使用上不陌生，一定很快就能上手。 

### **【自選券商組合】 **

- 左側為使用者已定義的自選劵商群組名稱。 
- 中央依左側點選的自選劵商群組名稱，顯示該組合所有分點資料。 
- 右側提供券商查詢功能，使用者可以瀏覽或搜尋方式，找尋劵商分點。 
[
![061903a](/wp-content/uploads/2017/06/061903a.png)
](/wp-content/uploads/2017/06/061903a.png)

### **【追蹤券商組合】 **

- 左側為使用者已有設定追蹤券商資料的股票名單。 
- 中央依左側點選的股票名稱，顯示該股票設定的所有追蹤券商分點資料。 
- 右側提供券商查詢功能，使用者可以瀏覽或搜尋方式，找尋券商分點。 
[
![061903b](/wp-content/uploads/2017/06/061903b.png)
](/wp-content/uploads/2017/06/061903b.png)希望大家都可以跟著主力賺大錢！ [

#####


---

# 美股商品支援全部時段

Source: https://www.xq.com.tw/lesson/advanced/usstocksupportallperiods/

### 1. 功能概述 

在 **XQ **版本 **7.17.01 / 3.17.01 250923 **中，新增「 **美股商品支援全部時段 **」功能。 

所謂「 **美股全部時段 **」，是指包含 **盤前交易、盤中（常規）交易 **，以及 **盤後交易 **三個時段的合計時間。依照台灣時間（夏令時間）計算，美股全部時段為 **16:00 ～ 翌日 08:00 **。 

---

### 2. 各交易時段對照表 
時段 美國時間（ET） 台灣時間（夏令） 台灣時間（冬令） 盤前交易 04:00 – 09:30 16:00 – 21:30 17:00 – 22:30 常規交易 09:30 – 16:00 21:30 – 翌日 04:00 22:30 – 翌日 05:00 盤後交易 16:00 – 20:00 翌日 04:00 – 08:00 翌日 05:00 – 09:00 
---

### 3. 顯示全部時段的操作說明 

使用者可在以下三個功能介面中切換顯示「全部時段」： 

- **商品盤勢頁面 **
- **分鐘線圖的技術分析頁面 **
- **雲端監控功能 **

啟用後，將可在商品盤勢頁面的 **走勢圖、成交明細、價量表、分價表、分價圖、分量表 **，以及技術分析頁面的 **分鐘線圖 **中，查看美股全部時段的完整交易數據。   
此外，也可在 **雲端監控功能 **中設定監控全部時段的行情變化。 

[
![](/wp-content/uploads/2025/10/01_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/01_美股單商品支援全部時段.png)

---

### 4. 商品盤勢與技術分析頁面操作方式 

在 **商品盤勢頁面 **與 **分鐘線圖的技術分析頁面 **中，可透過點擊「時段切換小圖示」 [
![](/wp-content/uploads/2025/10/03_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/03_美股單商品支援全部時段.png)[
![](/wp-content/uploads/2025/10/02_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/02_美股單商品支援全部時段.png)來切換顯示模式： 

- [
![](/wp-content/uploads/2025/10/03_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/03_美股單商品支援全部時段.png)顯示此圖示時，代表美股商品為「盤中時段」。 
- [
![](/wp-content/uploads/2025/10/02_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/02_美股單商品支援全部時段.png)顯示此圖示時，代表美股商品為「全部時段（盤前＋盤中＋盤後）」。 

小圖示 [
![](/wp-content/uploads/2025/10/03_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/03_美股單商品支援全部時段.png)[
![](/wp-content/uploads/2025/10/02_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/02_美股單商品支援全部時段.png)位於畫面中 **黃色方框處 **，可直接點擊切換顯示時段。 

[
![](/wp-content/uploads/2025/10/04_美股單商品支援全部時段.png.png)
](/wp-content/uploads/2025/10/04_美股單商品支援全部時段.png.png)

---

### 5. 雲端監控設定方式 

在 **雲端監控 **功能中，開啟美股商品的條件設定，使用者可選擇交易時段為： 

- **盤中時段 **
- **全部時段（盤前＋盤中＋盤後） **

此設定選項位於 **紅框處 **。設定完成後，系統將依照所選交易時段進行監控與通知。 

[
![](/wp-content/uploads/2025/10/05_美股單商品支援全部時段.png)
](/wp-content/uploads/2025/10/05_美股單商品支援全部時段.png)

---

### 6. 聯絡方式 

以上為「 **美股商品支援全部時段 **」功能的詳細說明。   
希望能協助使用者更全面掌握美股的盤前、盤中與盤後交易動態。 

若您在使用過程中有任何意見或建議，歡迎來信至客服信箱 **[XQservice@XQ.com.tw ](#)**與我們聯繫。 
[

#####


---

# 【常見情境實戰篇】新手也能懂的期貨策略應用

Source: https://www.xq.com.tw/lesson/beginner/%E3%80%90%E5%B8%B8%E8%A6%8B%E6%83%85%E5%A2%83%E5%AF%A6%E6%88%B0%E7%AF%87%E3%80%91%E6%96%B0%E6%89%8B%E4%B9%9F%E8%83%BD%E6%87%82%E7%9A%84%E6%9C%9F%E8%B2%A8%E7%AD%96%E7%95%A5%E6%87%89%E7%94%A8/

量化積木期貨功能的核心優勢，在於「 A （ 執行商品 ） → B （ 條件判斷 ） → C （ 交易商品 ） 」的三角色設計。本篇將整理三種常見情境並提供實務策略案例，協助使用者快速掌握跨商品策略的應用方式。 

## **情境一：只做股票 **
此為最典型的「單純股票策略」，適合剛入門的使用者。策略邏輯為監控股票，並直接交易該股票本身。 

### **策略設定範例 **

- **執行商品 （ A ） **：上市櫃普通股 
- **條件判斷 （ B ） **：個股條件（例如：收盤價 > 60 日均線） 
- **交易商品 （ C ） **：股票 

### **操作步驟說明 **

- **選擇執行商品 **：在策略設定頁面，將執行商品設為「上市櫃普通股」。交易商品預設為「股票」，無需更動。 [
![](/wp-content/uploads/2026/01/messageImage_1769681555296-1024x492.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681555296.jpg)
- **設定進 / 出場條件 **：設定方式與一般股票策略相同。例如設定「收盤價 > 60 日均線」作為進場條件。 [
![](/wp-content/uploads/2026/01/messageImage_1769681611564-1024x490.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681611564.jpg)[
![](/wp-content/uploads/2026/01/messageImage_1769681652589-1024x494.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681652589.jpg)
- **回測與執行 **：完成設定後進行回測，確認策略績效。 [
![](/wp-content/uploads/2026/01/messageImage_1769681693614-1024x500.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681693614.jpg)

## **情境二：看股票做個股期 **
此情境常見於「槓桿化操作」。透過監控現貨（股票）的價格或籌碼訊號，下單至對應的期貨商品，以放大獲利空間。 

### **策略設定範例 **

- **執行商品 （ A ） **：台指前 100 檔權值股 
- **條件判斷 （ B ） **：個股條件（例如：外資連續 3 天買超 > 1000 張） 
- **交易商品 （ C ） **：小型期貨 > 期貨 > 股票 

### **操作步驟說明 **
**1. 選擇執行商品與交易商品 **： 

- 

  - 執行商品選擇股票清單（如台指前 100 檔權值股）。 
  - 在交易商品欄位點選「自訂」，並依序勾選排序： **1. 小型期貨 → 2. 期貨 → 3. 股票 **。系統將依此順序尋找可交易標的。 

[
![](/wp-content/uploads/2026/01/messageImage_1769681733499-1024x502.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681733499.jpg)**2. 設定進 / 出場條件 **： 

- 

  - 由於交易商品包含期貨，請務必開啟 **「支援期貨與關聯商品」 **開關。 
  - 開啟後，即可根據現貨（股票）的數據來設定進出場條件。 

[
![](/wp-content/uploads/2026/01/messageImage_1769681818716-1024x490.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681818716.jpg)**3. 檢視與回測 **： 

- 

  - 點選「預覽」可確認依據設定順序，最終會交易到的具體商品（例如：台積電 → 小型台積電期貨）。 

[
![](/wp-content/uploads/2026/01/messageImage_1769681897015-1024x451.jpg)
](/wp-content/uploads/2026/01/messageImage_1769681897015.jpg)

## **情境三：看大台指做小台指 **
此策略以大台指（全日盤）判斷市場趨勢，但實際下單使用小台指以控制風險與成本，適合中小資金交易者。 

### **策略設定範例 **

- **執行商品 （ A ） **：連續月份指數期貨（大台指） 
- **條件判斷 （ B ） **：期貨條件（例如：十大交易人淨多單） 
- **交易商品 （ C ） **：小型期貨 

### **操作步驟說明 **
**1. 選擇執行商品與交易商品 **： 

- 

  - 執行商品設定為「連續月份指數期貨」（代表大台）。 
  - 交易商品設定為「小型期貨」。 

[
![](/wp-content/uploads/2026/01/messageImage_1769682564507-1024x495.jpg)
](/wp-content/uploads/2026/01/messageImage_1769682564507.jpg)**2. 設定進 / 出場條件 **： 

- 

  - 開啟 **「支援期貨與關聯商品」 **開關。 
  - 設定期貨專屬條件，例如「期貨 - 十大交易人淨多單」。 

[
![](/wp-content/uploads/2026/01/messageImage_1769682616532-1024x476.jpg)
](/wp-content/uploads/2026/01/messageImage_1769682616532.jpg)**3. 執行回測 **：完成設定後進行回測。此策略能實現「以大趨勢判斷，用小部位進場」的操作邏輯。 [
![](/wp-content/uploads/2026/01/messageImage_1769682646084-1024x477.jpg)
](/wp-content/uploads/2026/01/messageImage_1769682646084.jpg)

## **操作提示與總結 **

### **策略設定三步驟回顧 **

- **設定執行商品 （ A ） **：選擇要監控的標的（股票 / 期貨）。 
- **設定交易商品 （ C ） **：選擇實際下單的標的（股票 / 小台 / 大台），可利用「自訂排序」功能設定優先順序。 
- **設定關聯商品 （ B ） **：設定條件判斷的依據。 

### **應用建議 **

- **股票新手 **：建議從「情境一」開始，單純操作股票。 
- **進階操作 **：可嘗試「情境二」，利用現貨訊號操作個股期貨，靈活運用槓桿。 
- **小資族群 **：適合「情境三」，透過大台指看方向，下單小台指降低門檻。 
- **專業玩家 **：熟練後可混合使用多種商品，打造股票與期貨並行的多元策略。 
[

#####


---

# 警示設定與提示

Source: https://www.xq.com.tw/lesson/beginner/%E8%AD%A6%E7%A4%BA%E8%A8%AD%E5%AE%9A%E8%88%87%E6%8F%90%E7%A4%BA/

Q：如何設定XQ全球贏家的【警示設定與提示】功能? A：進入功能表的「設定→我的設定→警示設定」，選定欲設定警示的商品，設定好條件；當有符合警示的事件發生時，系統會自動警示提示通知。 [

#####


---

# 如何申請XQ帳號

Source: https://www.xq.com.tw/lesson/beginner/apply/

各位在股海作戰的投資朋友們，有一套好的看盤軟體是很重要的， 很高興要向大家介紹XQ全球贏家【個人版】這套看盤軟體！！！ 它是免費下載的哦 ➤ [點我立即免費下載 ](https://utm.to/4s95sp)只要申請帳號與密碼，三分鐘內就可以立即使用，是不是很棒呢~ 來看看怎麼申請帳密吧： 1. 下載並安裝好XQ全球贏家【個人版】。 2. 在登入頁點選申請新帳號，輸入自己設定的帳號與密碼，以手機號作驗證。 3. 在Email信箱做帳號認證(請記得七天內要完成，不然帳號會被暫時停用喔) 溫馨提醒: 帳號設定沒有區分大小寫，但密碼有分大小寫，國內手機註冊請勿使用+886，不然會收不到驗證碼喔! 我們會陸續介紹一些使用小密技，讓這套系統好好發揮，成為大家看盤的好幫手！ [

#####


---

# 如何備份、移轉XQ資料

Source: https://www.xq.com.tw/lesson/beginner/backup/

1. 請先執行功能表的「設定→備份程式」，系統會備份「User」和「XS」資料夾（在XQ程式安裝路徑「C:\SysJust\XQLite\Backup\備份日期\XQ版號\User、XS資料夾）。 2. 在B電腦先安裝XQ全球贏家完成後，再將以上A電腦的備份檔案 「User」folder→覆蓋至B電腦 C:\SysJust\XQLite\User 「XS」folder→覆蓋至B電腦 C:\SysJust\XQLite\XS ※ 註： 「XS」folder 中是 自訂的指標/選股腳本/排程/函數/腳本/ →XS相關都在這 「User」folder 中是 自訂頁面/畫面中的註解和畫線→非XS放在這 3. XQ資料是by帳號儲存，用以上方式備份出來的檔案，可以直接匯入/或還原到B電腦相同帳號內，不同帳號無法使用。 若需提供其他帳號使用，可以依需求使用系統功能「匯出頁面」或「匯出腳本」方式單獨匯出/匯入使用，則無帳號限制。 [

#####


---

# 【新手也能上手】量化積木支援「期貨商品」啦！

Source: https://www.xq.com.tw/lesson/beginner/blockssupportfutures/

大家期待已久的期貨功能，現在 **量化積木 **也能使用囉！ 不論你是想「看股票做期貨」，還是「看大指數期做小指數」，這次新功能都能幫你實現。而且一樣 **不用寫程式，就能完成自動交易 **🚀。這篇文章會用最簡單的方式，帶你一步步了解新功能的使用方法。 
---

## **🧠 三個重要角色，先認識一下！ **
因為支援期貨商品，所以多了一些新的使用情境。在策略裡，我們把商品分成三種角色： **名稱 ****代表什麼？ ****說明 ****✅ 執行商品 A **策略實際執行、洗價的商品 交易股票時「執行商品」＝「交易商品」 **📌 關聯商品 B **條件判斷參考商品 可選「股票 / 期貨 / 執行商品」，像 XS 腳本內的 GetSymbolField 語法 **💥 交易商品 C **條件成立後，實際買賣的商品 決定策略最終下單的標的 👉 如果你只做股票，就只需要關心「執行商品」即可，和過去的使用方式一樣。 [
![](/wp-content/uploads/2026/01/messageImage_1769670007634.jpg)
](/wp-content/uploads/2026/01/messageImage_1769670007634.jpg)
---

## **🔎 執行商品（A）詳細說明 **
在最新版本中，「執行商品」的設定方式和先前大致相同，依然支援： 

- 系統商品組合 
- 自選股 
- 自動選股 

### **➤ 期貨商品新增組合 **
針對期貨商品，額外新增了 4 種連續月份組合： 

- 連續月份指數期貨 
- 連續月份指數期貨（一般） 
- 連續月份股票期貨 
- 連續月份股票期貨（一般） 
**📌 注意事項： **

- 帶有「（一般）」的組合 ＝ 僅支援 **日盤商品 **
- 沒有「（一般）」的組合 ＝ 支援 **全日盤商品 **
- 目前量化積木期貨商品僅支援「連續月份 "近月" 商品」 
[
![](/wp-content/uploads/2026/01/messageImage_1769671817346.jpg)
](/wp-content/uploads/2026/01/messageImage_1769671817346.jpg)

### **➤ 功能定義 **
**執行商品 A **：實際參與策略運算與洗價判斷的商品清單。它會與「關聯商品 B」產生互動，進而影響觸發條件與訊號結果。 

### **➤ 使用範例 **
假設： 

- 執行商品 A ＝ 2330 台積電股票 
- 關聯商品 B ＝ 期貨 
👉 系統會自動抓取「台積電期貨」來做條件判斷。 
---

## **📌 關聯商品（B）– 條件判斷怎麼用？ **
當你先選好 **執行商品（A） **之後，系統會自動配對一個 **關聯商品（B） **，用來判斷進出場條件。 簡單來說： 

- **A **＝ 主要追蹤的標的 
- **B **＝ 拿來判斷條件的依據 
**⚠️ 特別注意 **即使 B 的條件成立，但如果 A 執行商品沒有成交量，系統一樣不會觸發進出場。 👉 **換句話說：A 要先有成交量，B 的條件才會生效。 **

### **🔎 舉例來看 **

- **A ＝ 台積電期貨近月，B ＝ 股票條件 **👉 系統會自動抓 **2330 台積電股票 **的數據來判斷條件，但前提是 **台積電期貨近月要有成交量 **，才會進行 2330 台積電判斷。 
- **A ＝ 小台期，B ＝ 期貨條件 **👉 系統會抓 **大台指期貨（全日盤） **數據來做條件判斷。 
- **B ＝ 執行商品 **👉 就是直接用 **A 執行商品 **本身來判斷。 例如：A ＝ 台指期日盤 → 條件就只會針對「日盤」檢查。 

### **📘 進出場條件設定對照表 **
**條件設定 ****系統怎麼判斷？ ****股票，收盤價 > 300 **只看「台積電股票」收盤價 **期貨，收盤價 > 300 **只看「台積電期貨全日盤」收盤價 **執行商品，收盤價 > 300 **系統會對 A 裡所有商品逐一判斷，任一成立就觸發 👉 台積電股票收盤價 > 300 👉 台積電期貨收盤價 > 300 👉 小型台積電期貨收盤價 > 300 

### **📝 三種選項整理 **

- **股票選項 **系統會抓「執行商品」對應的股票。 例：A ＝ 台積電期貨 → B ＝ 台積電股票（2330） 
- **期貨選項 **系統會抓「執行商品」對應的大型期貨（全日盤，固定是大台）。 例：A ＝ 小台期 → B ＝ 台指期貨全日盤 
- **執行商品 **直接用 A 本身來判斷。 
例：A ＝ 台指期（日盤） → 條件只針對「日盤」判斷 [
![](/wp-content/uploads/2026/01/messageImage_1769671923497.jpg)
](/wp-content/uploads/2026/01/messageImage_1769671923497.jpg)
---

## **💥 交易商品（C）– 最後真的去進出場標的 **
前面我們講到： 

- **A ＝ 執行商品 **→ 系統主要追蹤的標的 
- **B ＝ 關聯商品 **→ 判斷條件的依據 
那麼 **C ＝ 交易商品 **，就是當條件成立後，系統實際會去進出場的商品。 也就是說：👉 **最後真的動用資金買進或賣出的標的，就是交易商品（C）。 **

### **📘 功能說明 **
當進出場條件成立後，系統會依照你設定的「交易商品」來執行買賣。預設值是 **股票 **，這次期貨版本還新增： 

- 期貨 
- 小型期貨 
- 微型期貨 
選擇交易商品後，可以預覽實際會交易到的商品有哪些，也可以 **自訂優先順序 **，系統會依序檢查能不能下單（⚠️ 只會成交一次，不會重複交易）。 [
![](/wp-content/uploads/2026/01/messageImage_1769672101840.jpg)
](/wp-content/uploads/2026/01/messageImage_1769672101840.jpg)[
![](/wp-content/uploads/2026/01/messageImage_1769672177304.jpg)
](/wp-content/uploads/2026/01/messageImage_1769672177304.jpg)

### **📘 設定優先順序範例 **
假設設定： **交易商品（C）＝ 順序：小型期貨 > 期貨 > 股票 ****執行商品（A） ****系統行為 ****台積電 2330 **有小型期貨 → 優先下小台（小型台積電期貨） **興富發 2545 **無小型期貨 → 下期貨 **得力 1464 **下股票（因為無期貨商品，回到預設） 

### **🔎 舉例來看 **

- **A ＝ 台積電股票，交易商品（C）＝ 順序：小型期貨 > 期貨 > 股票 **👉 條件成立後，系統不會下台積電股票，根據交易商品順序，而是去下 **小型台積電期貨 **。 
- **A ＝ 興富發股票，交易商品（C）＝ 順序：小型期貨 > 期貨 > 股票 **👉 如果有小型期貨，就優先下單；沒有小型期貨，就下期貨，此案例會下「興富發期貨」。 
- **A ＝ 得力股票，交易商品（C）＝ 順序：小型期貨 > 期貨 > 股票 **👉 因為沒有期貨商品，系統就直接下「得力股票」本身。 
**⚠️ 小提醒 **

- 交易商品只會 **成交一次 **，不會因為多個條件同時成立就重複下單。 
- 自訂排序很重要，記得把你想要「優先交易」的商品放前面。 
- 股票和期貨混搭也沒問題，策略可以靈活配置。 

---

## **✅ 總結：執行商品 A、關聯商品 B、交易商品 C **
三個角色串起來，就是完整的策略運作流程： 

- **執行商品 A **＝ 要追蹤的商品 
- **關聯商品 B **＝ 用來判斷條件的依據 
- **交易商品 C **＝ 最後真的下單的標的 

### **🔍 常見情境 **
**情境 ****A：執行商品 ****B：條件判斷 ****C：交易商品 ****只做股票 **個股 個股 個股 **看股票做個股期 **上市櫃股票 股票條件（如外資買超） 小型期貨 > 期貨 > 股票 **看大台做小台 **大台期 期貨條件（如未平倉口數） 小台期 **混合策略 **股票 + 個股期 股票 + 期貨 小型期貨 > 期貨 > 股票 **📌 新手提示： **

- 如果只想單純做股票 → 用法和以前一樣，沒變動。 
- 如果要跨商品（看股做期 / 看大做小） → 只要把 A / B / C 設定好，就能實現跨商品邏輯。 

---

## **⚙️ 如何設定？ **
設定策略時，只要依照以下三步驟，就能把 A、B、C 三角色串起來： 

### **第一步：設定執行商品（A） **
可以選擇 **個股 / 期貨 / 小型期貨 / 微型期貨 **。 系統會持續監控這些清單裡的商品。 👉 **小提醒 **：執行商品（A）必須要有成交量，後續條件才會生效。 

### **第二步：設定交易商品（C） **
可選擇 **股票 / 期貨 / 小型期貨 / 微型期貨 **。 支援 **自訂優先順序 **，系統會依序檢查能不能下單（只會成交一次，不會重複交易）。 👉 例如：如果希望先跑「小型期貨」，就把它放在第一個，系統會照順序去找能下單的標的。 

### **第三步：設定關聯商品（B）與進出場條件 **

- 個股（例：外資買超） 
- 期貨（例：未平倉口數） 
- 執行商品本身（直接用 A 判斷） 
**🔧 開關提醒： **有個「支援期貨條件」的開關，可以決定是否使用期貨相關的判斷條件。若策略要用到期貨判斷，記得把它打開。 **✅ 這樣三步驟完成後，你的策略就能清楚地定義： **

- **A **：追蹤誰 
- **B **：用誰來判斷條件 
- **C **：最後真的下單的是誰 

---

## **🛠 即時監控 & 回測差異 **
在使用量化積木時， **監控 **與 **回測 **的行為其實不太一樣，這點要注意，尤其是下全日盤商品時。 

### **🔎 差異說明 **

- **回測 **：用歷史資料模擬，會直接把當天的條件套入計算。 
- **監控 **：盤中即時偵測，只有在資料出來後，才會觸發進場。 

### **📘 舉例 **
假設條件是「看台指期的未平倉量」： 夜盤從 15:00 開始，但未平倉數據要到 15:00 之後才會有資料。 

- 在 **監控模式 **下，系統會等到 **資料真的出現 **（例如 17:00）才會進場。 
- 但在 **回測模式 **下，系統會把條件套用到 15:00 當下，因此會顯示「15:00 就已經進場」。 
**⚠️ 小提醒 **

- 回測的紀錄是「當天條件成立就算成立」，所以時間點會比監控提早。 
- 真實交易會依照監控邏輯 → 資料必須先出來，才會觸發進出場。 
- 這種差異在看「期貨未平倉量、法人買賣超」等需要等待資料更新的條件時特別明顯。 

---
這次量化積木新增的 **期貨支援功能 **，讓你能真正做到： 

- 看股票做期貨 
- 看大台做小台 
- 股票 + 期貨混合策略 
透過 **A（執行商品）→ B（條件判斷）→ C（交易商品） **三角色設計，策略邏輯清楚、靈活又強大： 

- **A **＝ 要追蹤的標的 
- **B **＝ 判斷條件的依據 
- **C **＝ 最後真的下單的商品 
再搭配 **即時監控 vs 回測 **的差異理解，你就能放心驗證並運行策略。現在不需要寫程式，就能在量化積木裡實現 **跨商品交易 **，把專家級的操作邏輯，變成人人都能上手的自動化策略！ 🚀 [

#####


---

# 大單追蹤與成交分佈

Source: https://www.xq.com.tw/lesson/beginner/blocktrades/

自2020/03/23起，台股上市櫃個股盤中時段(9:00-13:25)實施逐筆交易，開收盤時段仍維持集合競價。 

#### 因著新制度推出，自 2020/06/01起，XQ(個人版)系統 **只有付費用戶 **，提供即時的台股逐筆撮合行情，也提供更多針對逐筆撮合所設計的特有功能，例如即時大小單的篩選，大單的價量分佈，以及相關的指標，協助您在瞬息萬變的市場內可以更快速的掌握市場的動向。 
以下內容為付費用戶獨有的大單功能。 

### **商品盤勢之大單追蹤 **

- 台股上市櫃個股，揭示逐筆成交資料，並將成交量作單別分析。 
- 成交：價位較前一筆有上漲、下跌、相同，在數字旁會有向上、向下、等號的箭頭符號。 
- 單別：會以文字揭示中單，大單，特大單。空白表示小單。 

  - 若一筆單吃掉多筆對手單時，同一筆委託成交的單量後方會加上\* 符號表示出來，在單別上會多揭示合計的量。以下圖為例，09:26:09的特大單是300張，是由兩筆成交所組成，分別為單量197與103張。 
  - 紅色是外盤單，藍色是內盤單。 
  - 單別定義，利用單筆成交金額來判斷。 

[
![](/wp-content/uploads/2020/06/032103.png)
](/wp-content/uploads/2020/06/032103.png)

### **單別定義 **
系統依照商品當日的開盤價決定價格區間，然後把每一筆成交金額依照以下表格來做小單，中單，大單，以及特大單的標記。舉例而言，如果某檔商品今天的開盤價是15.0元的話，那麼如果某一筆成交金額小於20萬的話，這一筆就是小單；如果是介於20萬到40萬之間的話，則這一筆算是中單；如果是介於40萬到80萬之間的話，那這一筆算是大單；超過80萬的話則算是特大單。 要特別注意的是，如果這一筆成交不是逐筆撮合所產生的，例如每一日開盤的第一筆成交，收盤的那一筆成交，或是因為異常原因進入處置撮合時的成交，都不會列入統計。 [
![](/wp-content/uploads/2020/02/%E5%96%AE%E5%88%A5%E5%AE%9A%E7%BE%A9.png)
](/wp-content/uploads/2020/02/%E5%96%AE%E5%88%A5%E5%AE%9A%E7%BE%A9.png)我們會定時檢視市場成交的統計資料分佈情形來決定是否需要調整這個級距表，如果有任何異動的話會隨時公告給大家知道。 

### **商品盤勢/即時指標 **

- 大戶買賣力指標：開盤至今主力單的內外盤金額差數字，判斷主力單偏多或偏空。 
- 散戶買賣力指標：開盤至今散戶單的內外盤金額差數字，研究散戶單偏多或偏空。 
[
![](/wp-content/uploads/2020/02/%E5%A4%A7%E6%88%B6%E6%95%A3%E6%88%B6%E8%B2%B7%E8%B3%A3%E5%8A%9B%E6%8C%87%E6%A8%99.png)
](/wp-content/uploads/2020/02/%E5%A4%A7%E6%88%B6%E6%95%A3%E6%88%B6%E8%B2%B7%E8%B3%A3%E5%8A%9B%E6%8C%87%E6%A8%99.png)

- 分時大戶買賣力：每分鐘主力單的內外盤金額差數字。(\*3.02版後提供) 

### **商品盤勢之成交分佈 **
[
![](/wp-content/uploads/2020/06/032104.png)
](/wp-content/uploads/2020/06/032104.png)

- 大戶買賣比，代表主力買進賣出的力道比例 

  - 紅色(買盤)：買進大戶金額/(買進大戶金額 + 賣出大戶金額)\*100% 
  - 綠色(賣盤)：賣出大戶金額/(買進大戶金額 + 賣出大戶金額)\*100% 

- 大戶單 

  - 紅色(買盤)：買進大戶金額/成交值, 買進大戶金額=外盤特大單成交金額+外盤大單成交金額 
  - 綠色(賣盤)：賣出大戶金額/成交值, 賣出大戶金額=內盤特大單成交金額+內盤大單成交金額 

- 散戶單 

  - 紅色(買盤)：外盤小單金額/成交值 
  - 綠色(賣盤)：內盤小單金額/成交值 

- 佔比(%)=單別的成交金額/個股總成交金額\*100%差額(=外盤-內盤)。 

#### 

### **商品盤勢之價量表 **
[
![](/wp-content/uploads/2020/02/%E6%96%B0%E5%83%B9%E9%87%8F%E8%A1%A8.png)
](/wp-content/uploads/2020/02/%E6%96%B0%E5%83%B9%E9%87%8F%E8%A1%A8.png)

- 加上篩選單別功能。可以查看全部價量或是主力單(包括大單與特大單)或非主力單(是指小單與中單)。 

### **商品盤勢之分價圖 **
[
![](/wp-content/uploads/2020/02/%E6%96%B0%E5%88%86%E5%83%B9%E5%9C%96.png)
](/wp-content/uploads/2020/02/%E6%96%B0%E5%88%86%E5%83%B9%E5%9C%96.png)

- 加上篩選單別功能。 
- 柱圖顏色會依內外盤張數比的級距而定。該價位的內盤量佔的越多，柱狀顔色越深綠，外盤量佔的越多會越偏深紅色。 

### 

### **特別報價-大戶排行 **
提供以大戶指標為篩選門檻的盤中即時排行功能。 [
![](/wp-content/uploads/2020/06/032105.png)
](/wp-content/uploads/2020/06/032105.png)

### **報價欄位 **
[
![](/wp-content/uploads/2020/02/022007.png)
](/wp-content/uploads/2020/02/022007.png)

- 在統計欄位類別下，新增單別分析相關欄位。僅支援有台股上市櫃商品。 
[
![](/wp-content/uploads/2020/06/032106.png)
](/wp-content/uploads/2020/06/032106.png)

### **即時選股之大戶買賣力 **

- 新增「大戶買賣力」分類，提供以下條件項 

  - 外盤特大單 
  - 連續外盤大單 
  - 內盤特大單 
  - 連續內盤大單 

- 觸發條件為近5秒內有3筆大單(或特大單) 

### **技術分析指標 **
以下指標支援分鐘頻率，(\*3.02版後提供) 

- 主圖指標：當日成本線 
- 即時籌碼： 

  - 買賣力 
  - 買賣力(分時) 
  - 漲跌成交量 
  - 漲跌成交量(分時) 
  - 大戶買賣力 
  - 大戶買賣力(分時) 
  - 散戶買賣力 
  - 大戶散戶籌碼流向 
  - 自訂大戶買賣力 
  - 自訂散戶買賣力 

- 量能指標：量比 
- 期權指標 

  - 買賣成交筆數 
  - 委買委賣張數 
  - 委買委賣筆數 

[

#####


---

# 技術分析：主圖K棒顏色設定說明

Source: https://www.xq.com.tw/lesson/beginner/candlestick-color/

XQ 支援了主圖K棒的顏色設定功能，大家可以依據自己的使用習慣來調整K棒的顏色。 以下是本篇文章的目錄： [一、自訂K棒顏色的入口 ](#anchor01)[二、如何自訂K棒顏色 ](#anchor02)[三、K棒顏色及樣式的畫面呈現 ](#anchor03)[](#)
---

### **一、自訂K棒顏色的入口 **

- 

  - 

    - 

      - 在技術分析畫面按滑鼠右鍵，選擇「設定」 [
![](/wp-content/uploads/2024/05/1.png)
](/wp-content/uploads/2024/05/1.png)
      - 選擇「主圖指標」頁籤，在「K線」的選項右邊，會顯示目前的預設顏色 [
![](/wp-content/uploads/2024/05/2.jpg)
](/wp-content/uploads/2024/05/2.jpg)
      - 點擊K棒顏色的下拉箭頭，系統就會彈出「自訂K棒顏色」設定 [](#)[
![](/wp-content/uploads/2024/05/3.jpg)
](/wp-content/uploads/2024/05/3.jpg)

### **二、如何自訂K棒顏色 **
在「自訂K棒顏色」設定，我們提供了兩種設定模式： **(一) 利用「系統」提供的預設項目來切換K棒顏色 **在「自訂K棒顏色」設定中，左邊是系統提供的預設顏色項目，項目中陳列了目前各種主流K棒顏色的設定，大家可以用滑鼠點擊來切換，並利用右邊的預覽視窗，來確認顏色及K棒樣式是否為自己喜歡的呈現方式。 [
![](/wp-content/uploads/2024/05/4.jpg)
](/wp-content/uploads/2024/05/4.jpg)**(二) 自訂K棒顏色 **

- 

  - 

    - 

      - 可以自訂陽線及陰線的K棒實體顏色 [
![](/wp-content/uploads/2024/05/5.jpg)
](/wp-content/uploads/2024/05/5.jpg)
      - 可以自訂陽線及陰線的K棒外框顏色 [
![](/wp-content/uploads/2024/05/6.jpg)
](/wp-content/uploads/2024/05/6.jpg)
      - 可以利用勾選「填滿實體」的選項，來決定K棒實體為空心或實心 [](#)[
![](/wp-content/uploads/2024/05/7.jpg)
](/wp-content/uploads/2024/05/7.jpg)

### **三、K棒顏色及樣式的畫面呈現 **
以下是小編利用「自訂K棒顏色」設定調整後的呈現截圖 **(一) 自訂橘藍實體於黑色背景： **[
![](/wp-content/uploads/2024/05/8.jpg)
](/wp-content/uploads/2024/05/8.jpg)[
![](/wp-content/uploads/2024/05/9.jpg)
](/wp-content/uploads/2024/05/9.jpg)**(二) 自訂橘藍空心於藍色背景： **[
![](/wp-content/uploads/2024/05/10.jpg)
](/wp-content/uploads/2024/05/10.jpg)[
![](/wp-content/uploads/2024/05/11.jpg)
](/wp-content/uploads/2024/05/11.jpg)[

#####


---

# 走勢圖設定

Source: https://www.xq.com.tw/lesson/beginner/chartset/

### 

### **(一) 如何加均價線與高低價 **
1. 操作方式：在商品盤勢頁面按滑鼠右鍵，選擇「設定」 ※ 記得嗎？之前小編有提醒過大家，XQ已將常用的功能選項、設定、商品切換功能視窗…等，都放在滑鼠右鍵選單內， **可以說您會按右鍵，XQ已經會了50％ **喔！ [
![10-site1](/wp-content/uploads/2016/01/10-site1.png)
](/wp-content/uploads/2016/01/10-site1.png)2. 點選「主圖設定」頁籤 (1) 勾選 [
![10-site5](/wp-content/uploads/2016/01/10-site5.jpg)
](/wp-content/uploads/2016/01/10-site5.jpg)標示最高與最低價位，按[完成]鍵 [
![](/wp-content/uploads/2025/08/未命名設計.png)
](/wp-content/uploads/2025/08/未命名設計.png)[
![10-site3](/wp-content/uploads/2016/01/10-site3.png)
](/wp-content/uploads/2016/01/10-site3.png)(2) 欲縮小分時價與成交量的距離，可以勾選 [
![10-site5](/wp-content/uploads/2016/01/10-site5.jpg)
](/wp-content/uploads/2016/01/10-site5.jpg)與走勢圖重疊顯示，按[完成]鍵 [
![](/wp-content/uploads/2025/08/未命名設計-1.png)
](/wp-content/uploads/2025/08/未命名設計-1.png)[
![10-site5](/wp-content/uploads/2016/01/10-site5.png)
](/wp-content/uploads/2016/01/10-site5.png)3. 點選「進階」頁籤：相關資訊的頁籤可在進階頁作調整。點選將可選之項目加入至右方欄位。 [
![](/wp-content/uploads/2025/08/未命名設計-2.png)
](/wp-content/uploads/2025/08/未命名設計-2.png)系統預設的相關資訊頁籤如下（畫面右下方）： [
![10-site9](/wp-content/uploads/2016/01/10-site9.jpg)
](/wp-content/uploads/2016/01/10-site9.jpg)調整後的相關資訊頁籤如下，畫面是不是簡潔多了呢！您可以依此方式自行調整頁籤，以便能快速切換至所需資訊。 [
![10-site10](/wp-content/uploads/2016/01/10-site10.jpg)
](/wp-content/uploads/2016/01/10-site10.jpg)

### 

### **(二) 增加參考指標商品 **
1. 操作方式：在商品盤勢頁面按滑鼠右鍵，選擇「參考指標商品」 (1) 勾選欲加入之系統預設指標（例如：預設為加權指數，需選擇至少一個參考指標商品）。 (2) 欲比較其他非預設之商品，可在自訂比較商品之欄位輸入想比較之商品，並加以勾選即可。 [
![10-site7](/wp-content/uploads/2016/01/10-site7.png)
](/wp-content/uploads/2016/01/10-site7.png)例如：增加「日月光(2311)」為自訂比較商品。若增加過多參考指標，畫面會顯的零亂不易觀看，您可再自行調整欲參考之指標商品。 [
![10-site8](/wp-content/uploads/2016/01/10-site8.png)
](/wp-content/uploads/2016/01/10-site8.png)

### 

### **(三) 如何加即時指標 **
1. 操作方式：在商品盤勢頁面按滑鼠右鍵，選擇「即時指標」 (1) 預設為繪製「漲跌成交線」，我們更改為點選「內外盤成交線」，按【完成】鍵。 [
![10-site13](/wp-content/uploads/2016/01/10-site13.jpg)
](/wp-content/uploads/2016/01/10-site13.jpg)[
![10-site9](/wp-content/uploads/2016/01/10-site9.png)
](/wp-content/uploads/2016/01/10-site9.png)[

#####


---

# 固定收益

Source: https://www.xq.com.tw/lesson/beginner/fixedincome/

XQ把投資資訊從股票再往外延伸，新增加了美國固定收益專區資訊， 讓XQ的使用者，在股票空頭市場，資金有新的去處，也讓希望把一部份資金，投資在每年穩定有4%左右報酬的投資人，有一個新的選擇。 [
![](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B901.png)
](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B901.png)

### 

### **什麼是固定收益？ **
我們把會定時領息的金融商品稱為固定收益，這類商品在發行時，就已經載明配息日期及配息利率，可以明確計算出未來現金流量。 在美國固定收益專區內，我們有美國債券與美國特別股ETD這兩類型商品： [
![](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B902.png)
](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B902.png)投資債券的收益主要來自兩部份 1. 是賺利息，投資債券可以給投資者定期帶來利息收入，通常會比銀行定存高。 2. 是投資者可以利用債券價格的變動，買低賣高賺價差。 在美國債券專區，精選百檔全球知名企業公司債，提供債券基本資料、價格走勢圖、配息時程、發行公司分析、也提供近期債券行情表、熱門債券表、投資人也可依照偏好做進階搜尋。 功能畫面參考： 

- 基本資料 
[
![](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B904.png)
](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B904.png)

- 歷史價格 
[
![](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B905.png)
](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B905.png)

- 依條件做篩選 
[
![](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B906.png)
](/wp-content/uploads/2019/04/%E5%9B%BA%E5%AE%9A%E6%94%B6%E7%9B%8A%E4%BB%8B%E7%B4%B906.png)有國泰證券複委託帳號的投資人，可以直接利用複委託帳號進行下單，投資人僅須依照報價資訊進行買賣，無需另外收取手續費、保管費。 

### **ETD又是什麼樣的商品呢？ **
ETD的英文全名是Exchange Traded Debt，直譯為「交易所交易債券」，這類商品是在集中市場掛牌交易的(像NYSE或NASDAQ)。 ETD的面額為美元25，每季配息，投資門檻較債券來得低， 在美股特別股ETD專區， 同樣也提供基本資料、價格走勢圖、配息時程、發行公司分析，投資人也可依照偏好做進階搜尋。 功能畫面參考： 

- 基本資料 
[
![](/wp-content/uploads/2019/04/ETD%E4%BB%8B%E7%B4%B901.png)
](/wp-content/uploads/2019/04/ETD%E4%BB%8B%E7%B4%B901.png)

- 配息紀錄 
[
![](/wp-content/uploads/2019/04/ETD%E4%BB%8B%E7%B4%B902.png)
](/wp-content/uploads/2019/04/ETD%E4%BB%8B%E7%B4%B902.png)

- 自訂篩選條件 
[
![](/wp-content/uploads/2019/04/ETD%E4%BB%8B%E7%B4%B903.png)
](/wp-content/uploads/2019/04/ETD%E4%BB%8B%E7%B4%B903.png)ETD商品，都可透過券商複委託帳號來進行買賣，操盤高手提供多家券商下單服務，讓您挑到好標的就可以直接下單！ 對固定收益有興趣的用戶，請立即前往? [【固定收益專區】 ](https://utm.to/4rn9q2)，尋找好的投資標的！(GO～) [

#####


---

# 如何查詢個股資訊

Source: https://www.xq.com.tw/lesson/beginner/individualstock/

### 

### **(一) 切換個股資訊 **
1. 走勢圖進入方式：走勢圖為顯示商品即時價格變化，以及成交量、參考指標和即時指標等資訊。 (1) 從快捷頁面→個股走勢 [
![9-site1](/wp-content/uploads/2016/01/9-site1.png)
](/wp-content/uploads/2016/01/9-site1.png)(2) 在綜合看盤輸入商品代碼/名稱，再按「Enter」進入。 [
![9-site3](/wp-content/uploads/2016/01/9-site3.jpg)
](/wp-content/uploads/2016/01/9-site3.jpg)(3) 任何頁面的商品右鍵，選擇「商品走勢」。 [
![9-site4](/wp-content/uploads/2016/01/9-site4.jpg)
](/wp-content/uploads/2016/01/9-site4.jpg)或是直接在商品名稱上點二下滑鼠，可快速切換至商品走勢。 [
![9-site4](/wp-content/uploads/2016/01/9-site4.png)
](/wp-content/uploads/2016/01/9-site4.png)以上幾種方式，都可以進入個股的商品盤勢呦！ 2. 畫面說明： [
![9-site2](/wp-content/uploads/2016/01/9-site2.png)
](/wp-content/uploads/2016/01/9-site2.png)3. 當您進入商品盤勢畫面時，可輸入商品代碼/名稱，再按「Enter」切換商品，以查看不同商品盤勢。 [
![9-site3](/wp-content/uploads/2016/01/9-site3.png)
](/wp-content/uploads/2016/01/9-site3.png)

### 

### **(二) 切換走勢/技術分析 **
[
![9-site5](/wp-content/uploads/2016/01/9-site5.png)
](/wp-content/uploads/2016/01/9-site5.png)1. 操作方式： (1) 直接點選頁籤，可在「商品走勢」、「技術分析」進行頁面切換。 (2) 在商品名稱下的一排為該商品所屬之族群類，點選向下箭頭 ↓，即會列出所屬族群類，若想看其成分股可點選進入。 [
![9-site6](/wp-content/uploads/2016/01/9-site6.png)
](/wp-content/uploads/2016/01/9-site6.png)點擊查看相關成分股報價（台灣五十）： [
![9-site8](/wp-content/uploads/2016/01/9-site8.jpg)
](/wp-content/uploads/2016/01/9-site8.jpg)

### 

### **(三) 切換走勢子功能 **
點選商品盤勢畫面右下角向下箭頭 ↓，視商品類型提供不同功能；可直接點選進行子功能頁面切換。 [
![9-site9](/wp-content/uploads/2016/01/9-site9.jpg)
](/wp-content/uploads/2016/01/9-site9.jpg)例如：點選「支撐壓力」頁籤。 [
![9-site10](/wp-content/uploads/2016/01/9-site10.jpg)
](/wp-content/uploads/2016/01/9-site10.jpg)在畫面上直接點選滑鼠右鍵，選擇「切換資訊內容」，也可快速進行頁面切換。 [
![9-site7](/wp-content/uploads/2016/01/9-site7.png)
](/wp-content/uploads/2016/01/9-site7.png)下一篇我們將和各位介紹走勢圖設定，大家跟著小編來看看要怎麼設定，讓走勢圖有更靈活的運用！ [

#####


---

# 資訊功能介紹區

Source: https://www.xq.com.tw/lesson/beginner/information/

XQ內容豐富，許多非即時性資料會透過網頁方式進行呈現，查詢都可透過網頁資料區進行查詢。 有興趣的戰友們可以逐一點選，體驗看看XQ豐富的資料內容吧。 [

#####


---

# XQ線上操作手冊

Source: https://www.xq.com.tw/lesson/beginner/manual/

Q：如何使用 XQ全球贏家 線上操作手冊？ A：有三個方式可以呼叫出線上手冊。 1. 【XQ線上操作手冊】? [網頁版傳送門 ](https://www.xq.com.tw/PCManual.aspx)2. 進入【XQ全球贏家】功能表的「設定→說明→使用說明」，即會跳出【XQ線上手冊】。 3. 於【XQ全球贏家】中，直接於XQ主畫面按F1，也能夠開啟XQ線上手冊。 【XQ線上手冊】功能介紹十分完整，包含報價功能、走勢圖及XQ獨有即時指標，運用上更清楚好上手。 [

#####


---

# 今日財經

Source: https://www.xq.com.tw/lesson/beginner/newsapp/

XQ新推出了【今日財經】， 產品內除了我們自家的即時財經新聞之外，還結合國內一流的政經媒體，讓大家可以透過這個新聞平台，就能掌握全球的財經動向，抓住每個投資機會。 【今日財經】提供四大項功能： 

- 《熱搜新聞》：合作媒體的新聞專區，包括工商時報、中央社、上報、信傳媒、數位時代、商業周刊、關鍵評論、INSIDE、科技新報、鏡週刊、ETToday等優質內容供應商。 
- 《DJ新聞》：是我們自己新聞團隊採訪的新聞內容。 
- 《影音》：除了我們自己新聞團隊的影音新聞外，也收錄台灣證交所與櫃買中心的法說會內容。 
- 《我的收藏》：對於想要記錄的文字與影音新聞，只要按下加入收藏，就可在此區找到。 

#### 在《熱搜新聞》與《DJ新聞》的每則新聞下方可看到新聞提及的相關個股或是相關議題的文章， 
(圖一) [
![](/wp-content/uploads/2019/10/新聞01.png)
](/wp-content/uploads/2019/10/新聞01.png)(圖二) [
![](/wp-content/uploads/2019/10/新聞02.png)
](/wp-content/uploads/2019/10/新聞02.png)點選向上按鈕，可以查看更多相關議題的文字新聞或是影音新聞。 (圖三) [
![](/wp-content/uploads/2019/08/newsapp03b.png)
](/wp-content/uploads/2019/08/newsapp03b.png)點擊透過解析出來的相關個股標籤，可查看更多的相關文字與影音相聞，也可直接去看報價，線型，財務數據等相關內容。 (圖四) [
![](/wp-content/uploads/2019/08/newsapp02.png)
](/wp-content/uploads/2019/08/newsapp02.png)

#### 

#### 在《影音》區，以主播報導之形式，深入淺出的介紹產業趨勢、公司動向、及財經知識線上教學，也提供上市櫃公司法說會直播平台，投資人可迅速掌握公司的經營理念、市場狀況、產品及研發能力、競爭優勢，與未來展望。 
(圖五) [
![](/wp-content/uploads/2019/10/新聞03.png)
](/wp-content/uploads/2019/10/新聞03.png)在瀏覽新聞時，覺得重要的文字與影音內容，可以利用新聞內文右上方的收藏按鈕，點擊它就可以加入收藏， (圖六) [
![](/wp-content/uploads/2019/10/新聞05.png)
](/wp-content/uploads/2019/10/新聞05.png)

#### 《我的收藏》就是屬於你新聞精華專區，讓您尋找資訊更加省時。 

#### (圖七) 
[
![](/wp-content/uploads/2019/10/新聞04.png)
](/wp-content/uploads/2019/10/新聞04.png)我們打造這個服務，希望讓投資人每天都可以在一個平台上，就看到他最感興趣的議題的相關文字內容，看完一則之後可以看到同一個議題的相關內容，還可以馬上連結到相關商品的報價、線圖、相關數據和下單。 歡迎大家多多使用【今日財經】功能，意見與想法，歡迎回饋給我們～ 對了，【今日財經】有APP版本喔，歡迎大家下載，隨時掌握財經大小事。 【今日財經】APP? [立即下載 ](https://utm.to/4s4p8k)[
![](/wp-content/uploads/2019/10/新聞06.png)
](/wp-content/uploads/2019/10/新聞06.png)[

#####


---

# 報價欄位設定

Source: https://www.xq.com.tw/lesson/beginner/quotefield/

設定好自選股之後，我們接下來看如何瀏覽自選股的報價囉！ 在看盤畫面中，您是否會覺得報價組合的欄位太多顯示不易，或者欄位內容不符合需求呢？ 

#### 

#### 圖文介紹： 

### 

### **(一)查看綜合看盤頁面 **
1. 進入方式： [
![5-site1](/wp-content/uploads/2016/01/5-site1.png)
](/wp-content/uploads/2016/01/5-site1.png)2. 畫面說明： [
![5-site3](/wp-content/uploads/2016/01/5-site3.png)
](/wp-content/uploads/2016/01/5-site3.png)

## 

### **(二)切換自選股組合 & 個股連動 **
1. 切換自選股組合：點選左上角▼下拉頁，可選擇設定好的自選股組合。 [
![5-site4](/wp-content/uploads/2016/01/5-site4.jpg)
](/wp-content/uploads/2016/01/5-site4.jpg)2. 個股連動：點選自選股名稱，左下欄框頁將連動顯示相關資訊。例如我們以點選「愛之味」為例。 [
![5-site5](/wp-content/uploads/2016/01/5-site5.jpg)
](/wp-content/uploads/2016/01/5-site5.jpg)

## 

### **(三)報價欄位設定 **
1. 調整報價欄位：您可以自行更改想看到的報價欄位資訊，請點選畫面上的[欄位]，並開啟「自選報價欄位修改」視窗。 [
![5-site6-1-1](/wp-content/uploads/2016/04/5-site6-1-1.png)
](/wp-content/uploads/2016/04/5-site6-1-1.png)2. 刪除欄位：點選欄位後，選擇＂X＂即可刪除該欄位。 [
![5-site7-1](/wp-content/uploads/2016/01/5-site7-1.png)
](/wp-content/uploads/2016/01/5-site7-1.png)3. 加入欄位：可由畫面右側的欄位中，逐一挑選並加入。 由於欄位項目繁多，為方便大家快速找到要加入的欄位，您可以依需求，由下拉選單類別來查詢所需要的欄位，也可以直接輸入關鍵字搜尋欄位。 找到要加入的欄位後，只要直接點選滑鼠左鍵兩下，或點按[加入]按鍵，即可將該欄位加入至左方的大區塊中。挑選完畢後，按[完成]按鈕即新增完成。 [
![5-site8-1](/wp-content/uploads/2016/01/5-site8-1.png)
](/wp-content/uploads/2016/01/5-site8-1.png)[
![5-site9-1-1](/wp-content/uploads/2016/04/5-site9-1-1.png)
](/wp-content/uploads/2016/04/5-site9-1-1.png)4. 右鍵快速操作：您也可以直接在畫面欄位上點選滑鼠右鍵，可快速執行[刪除欄位]、[插入欄位]以及[回復系統設定]。 XQ已將常用的功能選項、設定、商品切換功能視窗…等，都放在滑鼠右鍵選單內， **可以說您會按右鍵，XQ已經會了50％ **喔！ [
![5-site10](/wp-content/uploads/2016/01/5-site10.jpg)
](/wp-content/uploads/2016/01/5-site10.jpg)

### 

### **(四)欄位排序 **
請直接以滑鼠點選想要進行排序的欄位名稱，即可完成排序作業，可進行遞增或遞減排序。例如我們以點選「漲幅%」欄位名稱進行排序。 排序不會影響次標題的位置喔！是不是很好用呢！ [
![5-site12](/wp-content/uploads/2016/01/5-site12.jpg)
](/wp-content/uploads/2016/01/5-site12.jpg)下一篇我們將介紹怎麼設定交易帳號及下單操作囉！ [

#####


---

# XQ看盤頁面管理

Source: https://www.xq.com.tw/lesson/beginner/screen/

XQ為方便用戶在不同情況下使用，例如，把畫面都設定成自己慣用的頁面，或是在繁忙的工作時也希望可以知道股價變化。 在本篇中，小編將帶您認識如何運用XQ全球贏家的看盤工作表、設定主畫面，以及不同的報價模式（另開報價視窗、迷你報價模式、完全隱藏報價）等，讓XQ幫你更多！ [

#####


---

# 商品名稱顏色

Source: https://www.xq.com.tw/lesson/beginner/setcolor/

使用者可以設定以不同顏色顯示不同交易所商品名稱及股號。 

### **【如何進入】 **

- 選取主功能列【設定】中【我的設定】，再點選【商品名稱顏色】。 
- 進入對話盒後，即可依照自己的偏好，將不同市場的商品依各自的色系顯示。 
[

#####


---

# 技術分析基本操作(一)

Source: https://www.xq.com.tw/lesson/beginner/technical01/

### **(一) 如何切換週期頻率 **
1. 進入技術分析畫面： [
![11-site1](/wp-content/uploads/2016/01/11-site1.png)
](/wp-content/uploads/2016/01/11-site1.png)[
![0421-1-1](/wp-content/uploads/2016/04/0421-1-1.png)
](/wp-content/uploads/2016/04/0421-1-1.png)2. 畫面說明： [
![0421-2](/wp-content/uploads/2016/04/0421-2.png)
](/wp-content/uploads/2016/04/0421-2.png)(1) 呈現最新報價資訊，收盤價後方的符號：[ [
![up](/wp-content/uploads/2016/01/up.bmp)
](/wp-content/uploads/2016/01/up.bmp)]表較前一價格 上漲、[ [
![Fall](/wp-content/uploads/2016/01/Fall.bmp)
](/wp-content/uploads/2016/01/Fall.bmp)]表較前一價格下跌、[=]表與前一價格持平、 [S]表示己收盤，該數值為收盤價。 (2) 改變資料區間：圖形下方出現的：[收斂]按鈕（ [
![Icon_PaneBtn_01](/wp-content/uploads/2016/04/Icon_PaneBtn_01.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_01.jpg)） 表示壓縮資料，使畫面能看到的時間長度拉長，此時圖形會變小；[發散]按鈕（ [
![Icon_PaneBtn_02](/wp-content/uploads/2016/04/Icon_PaneBtn_02.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_02.jpg)） 表示減少資料，使畫面能看到的資料數減少，此時圖形會變大；[回復]按鈕（ [
![Icon_PaneBtn_03](/wp-content/uploads/2016/04/Icon_PaneBtn_03.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_03.jpg)） 表示回復到系統預設狀態；[區間放大縮小]按鈕（ [
![Icon_PaneBtn_05](/wp-content/uploads/2016/04/Icon_PaneBtn_05.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_05.jpg)） 可自行拖曳資料區間；您也可以利用圖形下的捲軸來查看資料，點[指標設定]按鈕（ [
![Icon_PaneBtn_04](/wp-content/uploads/2016/04/Icon_PaneBtn_04.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_04.jpg)）則可以進行技術分析的主圖指標及副圖指標設定。 (3) 可利用工具列中的分析工具進行畫線分析，詳細功能，請參見下一篇教學介紹： [技術分析基本操作(二) ](https://www.xq.com.tw/tutorial/基礎教學/技術分析基本操作二/)。 (4) 在畫面上按滑鼠右鍵，會出現功能選單，可以切換資料頻率、主圖類型、副圖類型等項目。 3. 切換週期頻率： (1) 點選右下角小時鐘按鈕，可設定切換商品的週期，資料頻率完整；左上則會對應顯示目前所選擇線圖。 [
![0421-3](/wp-content/uploads/2016/04/0421-3.png)
](/wp-content/uploads/2016/04/0421-3.png)(2) 或是直接在畫面上按右鍵，也可快速選擇[資料頻率]。 [
![0421-4](/wp-content/uploads/2016/04/0421-4.png)
](/wp-content/uploads/2016/04/0421-4.png)

### **(二) 放大縮小K線 **
1. 點選圖形下方的 [收斂]按鈕（ [
![Icon_PaneBtn_01](/wp-content/uploads/2016/04/Icon_PaneBtn_01.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_01.jpg)） 表示壓縮資料，此時圖形會變小； [
![0421-5](/wp-content/uploads/2016/04/0421-5.png)
](/wp-content/uploads/2016/04/0421-5.png)2. 點選[發散]按鈕（ [
![Icon_PaneBtn_02](/wp-content/uploads/2016/04/Icon_PaneBtn_02.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_02.jpg)） 表示減少資料，此時圖形會變大；點選[回復]按鈕（ [
![Icon_PaneBtn_03](/wp-content/uploads/2016/04/Icon_PaneBtn_03.jpg)
](/wp-content/uploads/2016/04/Icon_PaneBtn_03.jpg)） 則表示回復到系統預設狀態。 [
![0421-6](/wp-content/uploads/2016/04/0421-6.png)
](/wp-content/uploads/2016/04/0421-6.png)3. 點選[區間放大縮小]按鈕（ 
![Icon_PaneBtn_05](/wp-content/uploads/2016/04/Icon_PaneBtn_05.jpg)
） 可自行拖曳顯示區間K線圖；啟用此功能時，單擊滑鼠右鍵，選擇[回復]，則可以回復到系統預設狀態。 [
![0421-7-1](/wp-content/uploads/2016/04/0421-7-1.jpg)
](/wp-content/uploads/2016/04/0421-7-1.jpg)[
![0421-8-1](/wp-content/uploads/2016/04/0421-8-1.jpg)
](/wp-content/uploads/2016/04/0421-8-1.jpg)

### **(三) 固定查價/除權息/高低價、叫出查價線 **
1. 進入方式：由技術分析→滑鼠右鍵→選擇「設定」/【一般】Tab。 2. 勾選「標示區間最高價及最低價」、「標示除權息資料」、「固定顯示查價視窗」。 [
![11-site9](/wp-content/uploads/2016/01/11-site9.png)
](/wp-content/uploads/2016/01/11-site9.png)原技術分析圖形： [
![0421-7](/wp-content/uploads/2016/04/0421-7.png)
](/wp-content/uploads/2016/04/0421-7.png)增加設定後的技術分析圖形： [
![0421-8](/wp-content/uploads/2016/04/0421-8.png)
](/wp-content/uploads/2016/04/0421-8.png)3. 叫出查價線： 直接在畫面上以滑鼠點兩下，便可進入查價狀態，按Esc取消查價狀態。若勾選「固定顯示查價視窗」並啟用查價線功能時，查價資訊會固定顯示在畫面的左側。 [
![0421-9](/wp-content/uploads/2016/04/0421-9.png)
](/wp-content/uploads/2016/04/0421-9.png)

### **(四) 主圖指標設定及參數設定 **
在畫面上方這塊較大的圖，我們叫做主圖： [
![0421-9-1](/wp-content/uploads/2016/04/0421-9-1.jpg)
](/wp-content/uploads/2016/04/0421-9-1.jpg)在主圖上面點滑鼠右鍵，選擇[主圖指標]，可以看到所有可以加入的主圖指標，打勾表示已顯示在畫面上了，我們再加入一個「價量累計圖」看看： [
![0421-10-1](/wp-content/uploads/2016/04/0421-10-1.jpg)
](/wp-content/uploads/2016/04/0421-10-1.jpg)價量累計圖的深色橫條表示為現價，最大量則表示可能為支撐或壓力所在。 [
![0421-11-1](/wp-content/uploads/2016/04/0421-11-1.jpg)
](/wp-content/uploads/2016/04/0421-11-1.jpg)在主圖上預設為四條移動平均線，但如果現有的均線參數，都不是您想要的呢？ 我們可以點選滑鼠右鍵，進入[指標設定]，在第一個「移動平均」頁籤可以勾選要顯示幾條均線，以及可以自行修改均線周期，例如我們只留兩條均線，把參數改為22和65，按下完成；這時候圖上的均線，就是我們要的均線囉！ 您也可以在主圖的左上方，雙擊這個指標的名稱，可以快速進入參數設定的畫面喔！ [
![0421-11-1](/wp-content/uploads/2016/04/0421-11-1.png)
](/wp-content/uploads/2016/04/0421-11-1.png)主圖調整為顯示兩條22和65的均線如下： [
![0421-12-1](/wp-content/uploads/2016/04/0421-12-1.jpg)
](/wp-content/uploads/2016/04/0421-12-1.jpg)主圖也可以切換為其他指標，我們直接在畫面上點按滑鼠右鍵，選擇「主圖」，預設為K線圖，可以切換為其他主圖類型，例如連線圖、K線圖(預設)、美國線圖、OX圖、雙座標圖、新價線、不顯示主圖、顯示模擬K線..等。 
![11-site12](/wp-content/uploads/2016/01/11-site12.png)
例如以台積電為例，切換主圖為「雙座標圖」如下： [
![0421-10](/wp-content/uploads/2016/04/0421-10.png)
](/wp-content/uploads/2016/04/0421-10.png)最後和大家介紹主圖疊圖指標，我們可以把許多平時放在副圖來看的指標，也加到主圖上面； 請點選滑鼠右鍵，進入「設定->主圖疊圖」頁籤，系統預設有許多可以加到主圖上的指標，例如我們將「主力累計買賣超」給疊上來，指標的參數、樣式和顯示座標範圍都可以自行調整。 關於主圖疊圖指標，大家可以進一步參閱「 [XS自訂指標 ](https://www.xq.com.tw/learn/indicator/)」系列文章，將帶您更深入的了解各種用法。 [
![0421-12](/wp-content/uploads/2016/04/0421-12.png)
](/wp-content/uploads/2016/04/0421-12.png)這樣的主圖疊圖，是不是更有助於您的投資判斷呢！ [
![0421-16-1](/wp-content/uploads/2016/04/0421-16-1.jpg)
](/wp-content/uploads/2016/04/0421-16-1.jpg)下一篇我們將繼續介紹技術分析其他重要操作功能，學習就是要打鐵趁熱，我們繼續看下去吧！ [

#####


---

# 技術分析基本操作(二)

Source: https://www.xq.com.tw/lesson/beginner/technical02/

### **(一) 切換副圖指標 **
主圖以下較矮的圖形，我們叫做副圖，可以自行設定副圖指標或增加/減少副圖數量。 [
![0422-1-1](/wp-content/uploads/2016/04/0422-1-1.jpg)
](/wp-content/uploads/2016/04/0422-1-1.jpg)若要切換副圖指標，請直接在副圖欄框內（出現紅色框線）點選滑鼠右鍵，點按「選擇指標」，並點選您欲切換的指標即可。 可選擇的副圖指標有常用指標、技術指標、量能指標、商品指標、市場指標、期權指標、權證指標及XS指標...等。 [
![0422-1](/wp-content/uploads/2016/04/0422-1.png)
](/wp-content/uploads/2016/04/0422-1.png)例如：我們選擇「常用指標→KD」指標，將MACD指標換成顯示KD指標如下。 [
![0422-2](/wp-content/uploads/2016/04/0422-2.png)
](/wp-content/uploads/2016/04/0422-2.png)

### **(二) 增加/減少副圖 **
1. 增加副圖：如果系統預設的兩個副圖不夠，可以在畫面上按滑鼠右鍵，選擇[增加副圖]，會跳出對話盒以挑選指標，挑選完成後會在作用指標的下方增加一個副圖指標。 [
![0422-3](/wp-content/uploads/2016/04/0422-3.png)
](/wp-content/uploads/2016/04/0422-3.png)例如：新增副圖「商品指標→【控盤者買賣盤】」 [
![12-site2](/wp-content/uploads/2016/01/12-site2.jpg)
](/wp-content/uploads/2016/01/12-site2.jpg)[
![0422-4](/wp-content/uploads/2016/04/0422-4.png)
](/wp-content/uploads/2016/04/0422-4.png)2. 減少副圖：如果覺得這個指標不好用，可以直接在畫面上按滑鼠右鍵，選擇[刪除主/副圖/疊圖]，就刪掉作用指標囉！ [
![0422-5](/wp-content/uploads/2016/04/0422-5.png)
](/wp-content/uploads/2016/04/0422-5.png)

### **(三) 副圖指標設定 **
如果您有常用的指標組合，還可以把指標組合儲存起來，請在畫面上按滑鼠右鍵，選擇[儲存指標設定]，例如我們將系統預設的成交量及MACD副圖，儲存指標組合命名為「基本」。 [
![0422-6-1](/wp-content/uploads/2016/04/0422-6-1.png)
](/wp-content/uploads/2016/04/0422-6-1.png)接下來再設定另外一個副圖組合，請在畫面上按滑鼠右鍵，選擇[設定]，切換到【副圖設定】頁籤： 例如我們將此組副圖指標設定為：融資、融券、融資使用率及融券使用率。 [
![0422-3](/wp-content/uploads/2016/04/0422-3.jpg)
](/wp-content/uploads/2016/04/0422-3.jpg)並以相同方式，選擇右鍵->儲存指標設定，將此組副圖指標組合儲存為「資券」。 [
![0422-7-1](/wp-content/uploads/2016/04/0422-7-1.png)
](/wp-content/uploads/2016/04/0422-7-1.png)之後就可以使用右鍵→套用指標設定，選擇要使用的指標組合即可，只需要切換組合，不用每次都要重新勾選指標囉！ [
![0422-5-1](/wp-content/uploads/2016/04/0422-5-1.jpg)
](/wp-content/uploads/2016/04/0422-5-1.jpg)

### **(四) 畫線及畫線工具 **
在「技術分析」視窗上方有[分析工具]，使用者可自行於畫面上繪製趨勢線、線段、黃金率、黃金弧、黃金扇、向上/向下箭頭、增加註解文字...等。 以下就部份工具舉例如何操作： 1. 線段：以滑鼠在圖上選取起點後，按住左鍵拖曳至第二點後放開，即會在兩點間出現一條線段。回到「指標」箭頭工具並選取所繪製的線段，按右鍵可變更線段的顏色及線條樣式。 [
![0422-8](/wp-content/uploads/2016/04/0422-8.png)
](/wp-content/uploads/2016/04/0422-8.png)[
![0422-9](/wp-content/uploads/2016/04/0422-9.png)
](/wp-content/uploads/2016/04/0422-9.png)2. 向上/向下箭頭：點選後，將游標移入圖形區，按住左鍵便會出現一「向上紅色箭頭」或「向下綠色箭頭」，拖曳至所需標示地點放開左鍵便可完成符號標示。 [
![0422-10](/wp-content/uploads/2016/04/0422-10.png)
](/wp-content/uploads/2016/04/0422-10.png)3. 註解：按下左鍵拖曳出一個文字輸入區後，便會出現「輸入註解文字」的視窗供使用者輸入文字，在文字輸入區上點擊左鍵可使用定位點調整大小、拖曳中心點來移動位置並重新修改文字內容。 [
![0422-11](/wp-content/uploads/2016/04/0422-11.png)
](/wp-content/uploads/2016/04/0422-11.png)4. 橡皮擦：按下左鍵可擦掉游標下方的線段、圖形或註解文字。 5. 清除所有分析線：可以一次清除所有分析線。 [
![0422-12](/wp-content/uploads/2016/04/0422-12.png)
](/wp-content/uploads/2016/04/0422-12.png)下一篇我們將介紹【XQ全球贏家】超強的「型態辨識功能」，只要點兩下，符合型態的股票就會呈現在你的面前。我們趕快來看一下吧！ [

#####


---

# 概念股與特別報價

Source: https://www.xq.com.tw/lesson/beginner/thematic/

### **(一) 概念股報價 **
提供時下最熱門的概念股資訊，將具有題材、話題性及時效性的股票列為選股標的組合，例如耶誕概念股、光棍節(雙11)受惠概念股、Apple概念股..等，在新概念股成形，會跳出視窗告知有何最新概念股，並隨時更新題材，提供做好最專業的概念股整理，讓您能夠快速掌握市場的最新動態。 1. 進入方式：點選主功能列「報價→台股精選報價→概念股報價」。 2. 操作方式： (1) 直接點選各概念股名稱，例如「電玩展概念股」、「光棍節(雙11)受惠概念股」..等。 [
![8-site1](/wp-content/uploads/2016/01/8-site1.jpg)
](/wp-content/uploads/2016/01/8-site1.jpg)進入概念股報價頁面後，點選左上角的選單，也可直接切換各概念股。 [
![8-site3](/wp-content/uploads/2016/01/8-site3.jpg)
](/wp-content/uploads/2016/01/8-site3.jpg)(2) 在搜尋欄列內輸入關鍵字，例如「Apple」，按下Enter鍵即可整理出關鍵字相關之條件。 [
![8-site2](/wp-content/uploads/2016/01/8-site2.jpg)
](/wp-content/uploads/2016/01/8-site2.jpg)例如點選「Apple iPhone 6系列概念股」，將開啟報價如下所示。 [
![8-site4](/wp-content/uploads/2016/01/8-site4.jpg)
](/wp-content/uploads/2016/01/8-site4.jpg)

### **(二) 特別報價 **
上市櫃特別報價於盤中提供台股特別報價及排行項目，提供您依需要做不同切換。 1. 進入方式：點選主功能列「報價→台股精選報價→上市櫃特別報價」。 2. 操作方式： (1) 直接點選特別報價名稱，例如「量大股」、「創當日新高股」..等。 [
![8-site8](/wp-content/uploads/2016/01/8-site8.jpg)
](/wp-content/uploads/2016/01/8-site8.jpg)(2) 在名稱的後方均有清楚告知項目定義，以利使用者判斷。 [
![8-site9](/wp-content/uploads/2016/01/8-site9.jpg)
](/wp-content/uploads/2016/01/8-site9.jpg)這個看盤的小密技，大家要記住喔！ [

#####


---

# 台股成交明細時間揭示至「秒、毫秒、微秒」操作說明

Source: https://www.xq.com.tw/lesson/beginner/twse-transaction-time-details/

### **功能概述 **
自 **7.16.01 / 3.16.01 **以上版本（包含 **7.16.01 / 3.16.01 **）起，系統新增台股成交明細時間揭示精度至「秒」、 「毫秒」或「微秒」的相關設定。此設定可於以下兩個位置進行調整： 

- **商品盤勢設定 → 一般 ******台股成交明細時間揭示至「秒」或「毫秒」或「微秒」。 [
![](/wp-content/uploads/2025/08/01_商品盤勢設定秒毫秒微秒.png)
](/wp-content/uploads/2025/08/01_商品盤勢設定秒毫秒微秒.png)
- **系統參數 → 市場別 ******台股商品盤勢的成交明細時間，預設揭示至「秒」或「毫秒」或「微秒」。 
[
![](/wp-content/uploads/2025/08/02_系統參數秒毫秒微秒.png)
](/wp-content/uploads/2025/08/02_系統參數秒毫秒微秒.png)

### **商品盤勢設定操作說明 **
可依照以下步驟，將台股商品盤勢的成交明細時間設定為揭示「秒」、 「毫秒」或「微秒」。 

- 在商品盤勢頁面，按下滑鼠右鍵，選擇 **設定 **，進入商品盤勢設定。 
- 在設定畫面中，找到 **台股成交明細時間揭示至「秒」或「毫秒」或「微秒」 **的下拉式選項並選擇所需精度。 [
![](/wp-content/uploads/2025/08/05_商品盤勢設定.png)
](/wp-content/uploads/2025/08/05_商品盤勢設定.png)
- 按下 **完成 **後，即可在台股商品盤勢明細中顯示所設定的時間精度。 [
![](/wp-content/uploads/2025/08/06_由左到右秒到微秒.png)
](/wp-content/uploads/2025/08/06_由左到右秒到微秒.png)
示意圖由左至右依序為揭示「秒」、「毫秒」、「微秒」。 

### **系統參數設定操作說明 **
若希望將台股商品盤勢的成交明細時間設定為預設值，避免每次開啟新頁面時重新調整，可依以下步驟設定： 

- 開啟 **系統參數 **設定畫面。 

  - **XQ (個人版) **開啟路徑：設定 → 我的設定 → 系統偏好設定 [
![](/wp-content/uploads/2025/08/07_個人版路徑.png)
](/wp-content/uploads/2025/08/07_個人版路徑.png)
  - **XQ (企業版) **開啟路徑：系統 → 設定 → 系統參數 [
![](/wp-content/uploads/2025/08/08_企業版路徑.png)
](/wp-content/uploads/2025/08/08_企業版路徑.png)

- 在 **系統參數 **設定畫面中，點擊上方的 **市場別 **頁籤。 
- 在「台灣上市櫃」區塊中，找到 **台股商品盤勢的成交明細時間，預設揭示至「秒」或「毫秒」或「微秒」 **的選項，並選擇所需精度。 [
![](/wp-content/uploads/2025/08/09_系統參數.png)
](/wp-content/uploads/2025/08/09_系統參數.png)
- 按下 **確定 **後，新的商品盤勢頁面將依此設定顯示時間精度。 [
![](/wp-content/uploads/2025/08/10_系統參數.png)
](/wp-content/uploads/2025/08/10_系統參數.png)
例如： 若將成交明細時間預設揭示設定為「毫秒」並按下 **確定 **，之後開啟的新商品盤勢頁面中，成交明細時間將自動顯示為「毫秒」。 以上為「台股成交明細時間揭示至秒、毫秒、微秒」的功能與操作說明。 如有任何問題，請來信至客服信箱 **XQservice@xq.com.tw **洽詢。 [

#####


---

# 如何設定自選股

Source: https://www.xq.com.tw/lesson/beginner/watchlist/

在開始使用軟體之前，我們先來設定自選股吧！ 當大家在報章雜誌看到新聞，投資嗅覺靈敏的您，是否會想將新聞中提到的公司，納入您的股票投資組合，觀察其股價和基本面的發展呢？ 今天小編就要來教大家設定自選股，讓您在看盤時可以按照自己想要的分類方式，我們可以自設多個自選股商品組合，比如說可以設定「電動車概念股」、「元宇宙概念股」、「低軌道衛星股」等，將商品做分類，方便觀察。 商品組合內的種類可是以股票、指數、期貨，以及選擇權，沒有限制。我們趕快來看一下吧！ 圖文介紹： 

### **(一) 調整自選股 **
1. 進入方式： [
![0324-01](/wp-content/uploads/2016/01/0324-01.png)
](/wp-content/uploads/2016/01/0324-01.png)
![4-site2](/wp-content/uploads/2016/01/4-site2.png)
2. 畫面說明： [
![4-site4](/wp-content/uploads/2016/01/4-site4.png)
](/wp-content/uploads/2016/01/4-site4.png)

### **(二) 新增商品組合、查詢商品及調整組合內容 **
1. 讓我們來新增一個商品組合（例如：list01） [
![4-site5](/wp-content/uploads/2016/01/4-site5.jpg)
](/wp-content/uploads/2016/01/4-site5.jpg)2. 這時中間的組合內容空空一片，此時可透過右側的查詢商品來輸入個股。 在查詢商品時，系統會自動協助比對列示接近的商品在下方，找到要加入的商品，雙擊滑鼠或點選＂加入＂按鈕，或按＂Enter＂鍵，商品就會加進中間的組合內容區域。 
![4-site6](/wp-content/uploads/2016/01/4-site6.jpg)
3. 加次標，主要是方便您在同一組的自選股資料中，再把商品做分類（可能是按照商品屬性，或是按照產業分類），方便自己做查閱。 [
![4-site8](/wp-content/uploads/2016/01/4-site8.jpg)
](/wp-content/uploads/2016/01/4-site8.jpg)[
![4-site9](/wp-content/uploads/2016/01/4-site9.jpg)
](/wp-content/uploads/2016/01/4-site9.jpg)

### 

### **(三) 儲存商品組合 **
1. 組合內容有異動過，在組合名稱旁，都會出現個星號，在編輯視窗的左上角也會有"(尚未儲存)"的字樣，以提醒大家，內容有變，要記得儲存！ 
![4-site7](/wp-content/uploads/2016/01/4-site7.jpg)
2. 您可以一次調整多組的內容再進行儲存。右下角的三個按鈕，分別為： 

- 「完成」：儲存直到目前為止的變更，結束修改，編輯視窗會關掉。 
- 「取消」：放棄直到目前為止的變更，不做異動儲存，關掉編輯視窗。 
- 「儲存」：儲存直到目前為止的變更，編輯視窗不關閉。 
設定好自選股之後，下一篇我們將介紹如何看到自選股的報價喔！ [

#####


---

# XQ獨有技術指標

Source: https://www.xq.com.tw/lesson/beginner/xqindicator/

大家好。在這篇文章內要跟大家介紹在《XQ(企業版) 7.02版/XQ(個人版) 3.09.03版 》我們新推出的技術指標。 第一個要跟大家介紹的指標是「當日成本線」指標。這是一個主圖指標，所繪製的數值是這一個交易日開盤到現在的平均成交價格，也就是當日的成本線。 首先請大家開啟技術分析圖，切換到分鐘頻率，然後從設定畫面內選擇「當日成本線」這個指標。 [
![](/wp-content/uploads/2020/06/7.02-主圖指標設定-1.png)
](/wp-content/uploads/2020/06/7.02-主圖指標設定-1.png)[
![](/wp-content/uploads/2020/07/當日成本線.png)
](/wp-content/uploads/2020/07/當日成本線.png)眼尖的同學，應該會發現這個指標其實跟商品盤勢的「均線」指標是一樣的。 [
![](/wp-content/uploads/2020/07/走勢圖均線.png)
](/wp-content/uploads/2020/07/走勢圖均線.png)在這一次改版內，我們把一些原先只能在商品盤勢內才能看的到指標也加到技術分析圖上面，讓使用者觀察到多日的走勢變化。請注意技術分析圖的頻率要設定成分鐘頻率，不管是1分鐘，2分鐘，5分鐘，或是其他分鐘間隔，這個指標都可以畫的出來。在這篇文章底下所介紹的指標也都是專門設計給分鐘頻率圖所使用的。 **工商時間 **：這些支援分鐘頻率的指標只開放給付費客戶使用的，只要你購買任何一個模組的話，就可以使用這些指標。如果你想要瞭解 更多付費客戶獨有的功能的話，請參考 [這個連結 ](https://www.xq.com.tw/台股逐筆功能行情端相關異動/)。更多模組的相關說明，請參考 [這個連結 ](https://utm.to/4skkve)，或是點擊XQ(個人版)主選單「設定｜我的權限」功能。 第二個要介紹的指標是「量比」指標。量比的定義是估計量 / 昨日(整日)成交量。因為估計量是根據開盤到現在的成交量去推算收盤時可能的成交量，所以如果量比的數值大於1的話，表示今天的預估成交量會比昨日成交量大。我們可以根據量比的數值，來提前判斷當日成交量是否會成長或是萎縮。 [
![](/wp-content/uploads/2020/06/7.02-量比指標設定.png)
](/wp-content/uploads/2020/06/7.02-量比指標設定.png)[
![](/wp-content/uploads/2020/07/量比線.png)
](/wp-content/uploads/2020/07/量比線.png)接下來要介紹的指標，都是跟大小單別有關的。首先要介紹的是「大戶買賣力」指標，「散戶買賣力」指標，以及「大戶買賣力(分時)」指標。這幾個指標都是放在「即時籌碼」這個分類內。 [
![](/wp-content/uploads/2020/06/7.02-大戶散戶指標設定.png)
](/wp-content/uploads/2020/06/7.02-大戶散戶指標設定.png)[
![](/wp-content/uploads/2020/06/7.02-大戶散戶指標.png)
](/wp-content/uploads/2020/06/7.02-大戶散戶指標.png)自從台股逐筆撮合制度上線後，XQ會依照每一筆成交明細的金額大小，把這一筆成交歸類成特大單，大單，中單，以及小單 [四個等級 ](https://www.xq.com.tw/learn/beginner/blocktrades/)。「大戶買賣力」指標，所繪製的數值，就是是當日開盤累計到現在以外盤成交的大單+特大單的成交量減去以內盤成交的大單＋特大單的成交量。這個數值如果大於0的話，表示大戶目前是站在買方。 「大戶買賣力(分時)」指標跟「大戶買賣力」指標是類似的觀念，主要的差異是「大戶買賣力」所繪製的是開盤累計到現在的統計，用來觀察開盤到目前大戶買賣的趨勢變化，而「大戶買賣力(分時)」指標所繪製的則是當根分鐘K棒內的差異，用來觀察在這個時間點是否有突然的買賣力道異動。 「散戶買賣力」指標，所畫出來的數值則是當日開盤到現在外盤成交的小單成交量減去內盤成交的小單成交量，用來代表一般散戶的買賣力道。 這幾個指標除了可以在技術分析圖內看到之外，在商品盤勢的即時指標內也有支援喔。 [
![](/wp-content/uploads/2020/06/7.02-商品盤勢大戶買賣力.png)
](/wp-content/uploads/2020/06/7.02-商品盤勢大戶買賣力.png)如果您覺得上面這幾個指標判斷大戶/散戶的方式不符合您的預期，或是針對不同的股票您想要使用不同的篩選門檻的話，那麼您可以使用「自訂大戶買賣力」跟「自訂散戶買賣力」這兩個指標。這兩個指標提供參數，可以設定大戶/散戶的門檻。例如在「自訂大戶買賣力」指標內你可以設定參數為50，表示只要是單筆成交量大於50張的成交都算做大戶，然後依照外盤內盤來統計買賣力道的差異。如果是「自訂散戶買賣力」的話，則是依照參數，判斷單筆成交量<指定參數的為散戶單。 此次新增的指標，我們整理在下方列表，大家可以試看看。 [在接下來的文章內，我們會說明這次改版所新增加的欄位 ](https://www.xq.com.tw/learn/xspractice/realtime/)，以及如何透過XS自訂指標的方式來做更多的客製化。 指標名稱 指標位置 指標內容 當日成本線 XS指標/系統/主圖指標 顯示當日的成本(開盤累積到目前的成交均價) 量比 XS指標/系統/量能指標 顯示開盤到目前為止的量比數值(估計量/昨日量) 大戶買賣力 XS指標/系統/即時籌碼 顯示開盤迄今大戶(大單+特大單)買賣超的變化 大戶買賣力(分時) XS指標/系統/即時籌碼 顯示當根K線內大戶(大單+特大單)的買賣超 散戶買賣力 XS指標/系統/即時籌碼 顯示開盤迄今散戶(小單)買賣超的變化 大戶散戶籌碼流向 XS指標/系統/即時籌碼 開盤迄今的大戶累計買賣力畫一條線，散戶買賣力畫一條線，可以同時呈現大戶跟散戶的買賣力道變化。 自訂大戶買賣力 XS指標/系統/即時籌碼 指定大戶門檻(張數)，顯示開盤迄今單筆成交量超過門檻的買賣超變化 自訂散戶買賣力 XS指標/系統/即時籌碼 指定散戶門檻(張數)，顯示開盤迄今單筆成交量小於門檻的買賣超變化 買賣力 XS指標/系統/即時籌碼 開盤迄今累計的外盤量減去內盤量，不依照成交金額篩選。請參考商品盤勢的買賣力圖。 買賣力(分時) XS指標/系統/即時籌碼 類似買賣力，差異是只繪製當根K棒的外盤量減去內盤量。 漲跌成交量 XS指標/系統/即時籌碼 開盤迄今累計的上漲成交量減去下跌成交量。系統統計每一筆成交，如果這一筆成交價比上一筆成交價上漲的話，則這一筆成交單量歸類成上漲成交量。反之如果這一筆成交價比上一筆成交價下跌的話，則歸類成下跌成交量。請參考商品盤勢即時指標內的漲跌成交線。 漲跌成交量(分時) XS指標/系統/即時籌碼 類似漲跌成交量，差異是只繪製當根K棒的上漲成交量減去下疊成交量。 委買委賣張數 XS指標/系統/期權指標 顯示開盤累計到目前委買張數(口數) - 委賣張數(口數)的差異。支援大盤以及期權商品。請參考商品盤勢的買賣力圖。 委買委賣筆數 XS指標/系統/期權指標 顯示開盤累計到目前委買筆數 - 委賣筆數的差異。支援大盤以及期權商品。請參考商品盤勢即時指標內的委買委賣筆數線。 買賣成交筆數 XS指標/系統/期權指標 顯示開盤累計到目前委買成交筆數 - 委賣成交筆數，支援期權商品。這個指標如果大於0的話，表示目前是大單站在買方。 [

#####


---

# 什麼股票今天會拉漲停~老業內的不傳之秘二

Source: https://www.xq.com.tw/lesson/filter/%E4%BB%80%E9%BA%BC%E8%82%A1%E7%A5%A8%E4%BB%8A%E5%A4%A9%E6%9C%83%E6%8B%89%E6%BC%B2%E5%81%9C%E8%80%81%E6%A5%AD%E5%85%A7%E7%9A%84%E4%B8%8D%E5%82%B3%E4%B9%8B%E7%A7%98%E4%BA%8C/

延續 [〈老業內的不傳之秘〉 ](https://www.xq.com.tw/learn/filter/secret/)，本篇來討論的是超跌後的報復性上漲。 我用一張圖來說明老業內的邏輯： [
![112402](/xstrader-content/uploads/2015/11/112402.png)
](/xstrader-content/uploads/2015/11/112402.png)老業內的邏輯是，如果一檔股票因為突發性的利空而急殺，在下跌趨勢中出現這種情況時，很容易出現恐慌性的殺盤，最後甚至會出現融資斷頭及停損的賣壓，一旦這些賣壓都釋放完畢，往往會殺過頭，這時候原本想要在更低價位撿便宜貨的買盤，發現底部已經浮現，就會一湧而上，造成股價短期的急遽上揚。 所以老業內會在好股票落難時等著追第一根的報復性上漲。 基本這樣的邏輯，我寫了一個腳本如下： 

```
input:days(5);
input:period(20);
input:r1(20);
input:r2(10);
input:r3(2);
input:v1(1000);
setinputname(1,"短期天數");
setinputname(2,"波段天數");
setinputname(3,"波段最低跌幅");
setinputname(4,"短期最低跌幅");
setinputname(5,"本日急拉幅度");
setinputname(6,"成交量下限");
condition1=false;
condition2=false;
condition3=false;

if highest(high,period)>=close[1]*(1+r1/100)
then condition1=true;

if highest(high,days)>=close[1]*(1+r2/100)
then condition2=true;

if close>=close[1]*(1+r3/100) and volume>=v1
then condition3=true;

if condition1 and condition2 and condition3
then ret=1;
```

這個腳本符合了上述的精神，用這個腳本，昨天有跑出以下這檔股票。 [
![112401](/xstrader-content/uploads/2015/11/112401.png)
](/xstrader-content/uploads/2015/11/112401.png)各位如果有興趣，也可以使用這腳本修改參數或條件，變成屬於自己的策略喔！ [

#####


---

# 什麼股票今天會拉漲停~老業內的不傳之秘

Source: https://www.xq.com.tw/lesson/filter/%E4%BB%80%E9%BA%BC%E8%82%A1%E7%A5%A8%E4%BB%8A%E5%A4%A9%E6%9C%83%E6%8B%89%E6%BC%B2%E5%81%9C%E8%80%81%E6%A5%AD%E5%85%A7%E7%9A%84%E4%B8%8D%E5%82%B3%E4%B9%8B%E7%A7%98/

以前我在一家老字號的證券商工作，每次我們自營操作績效不好時，老闆就會找一些很厲害的營業員，讓我們去取經，因著這緣故，認識了幾個股市怪咖，到現在，交情超過二十年。我從他們身上學了很多，其中有一位，他很會挑今天會漲停的股票，我自己的觀察，他挑十檔，裡頭會漲停的可能有一到兩檔。 這陣子我用XS在交易，常去挖寶他挑漲停股的技巧，寫成程式，我整理了一下他的判斷方法，大致可以分成四種： 一、強勢股整理後重新出發 二、上漲後平台整理然後突破 三、超跌後的報復性上漲 四、重大利多第一根漲停後的隔一天 我分別寫了對應的腳本，今天先跟大家分享的是強勢股整理後重新出發。 我寫的腳本如下： 

```
input: stardate(20150824);//輸入計算波段漲幅的起始日期
input:ratio(30);//輸入波段上漲的最低要求漲幅
input:ratio1(7);//輸入見高點後至今的拉回最小幅度
input:ratio2(2);//輸入最新一日的最低漲幅
setinputname(1,"輸入上漲起始日");
setinputname(2,"輸入上漲最低幅度");
setinputname(3,"輸入最小拉回幅度");
setinputname(4,"今日最低漲幅");
value1=getbaroffset(stardate);//找出起始日是距今第幾根bar
value2=highest(high[1],value1+1);//找出波段高點

condition1=false;
condition2=false;

if value2>=close[value1]*(1+ratio/100)
then condition1=true;//波段高點跟起漲點收盤價相比要滿足最低漲幅

if value2>=close[1]*(1+ratio1/100)//現價低於高點超過一定幅度
then condition2=true;//

if nthhighestbar(1,high,10)>=5//現在距離近10日高點超過五根
then begin
if condition1 and condition2 and close>=close[1]*(1+ratio2/100)
then ret=1;
end;
```

這位老兄在挑這類股票時，會濾掉那些大股本的，以及冷門的，剩下的才會加進去自選股來盯。 我寫了這腳本請他用，他覺得還不賴。 小編把腳本po上來，歡迎大家拿去改成自己想要的喔！ [

#####


---

# 到底什麼樣的股票可以拿來當存股的標的

Source: https://www.xq.com.tw/lesson/filter/%E5%88%B0%E5%BA%95%E4%BB%80%E9%BA%BC%E6%A8%A3%E7%9A%84%E8%82%A1%E7%A5%A8%E5%8F%AF%E4%BB%A5%E6%8B%BF%E4%BE%86%E7%95%B6%E5%AD%98%E8%82%A1%E7%9A%84%E6%A8%99%E7%9A%84/

我的前老板錢太多沒處放，台幣利率又低，讓我挑幾檔可以拿來每年分點股利又能保本的股票來投資，他要的報酬率不高，年報酬五%就可以接受。為了達成任務，我把1000多檔股票用一些條件濾了一遍，最後給了他一些名單。在這過程中我發現，市場上不少的存股概念，好像太複雜了，我認為，挑定存股就是三原則：獲利穩定、配息穩定、會填息。然後就是等每年股票市場大跌後，開始分批買進。 這幾年，可能是台幣利率太低的關係，定存股的概念愈來愈受重視，我看到這類相關文章的時候，發現很多的觀念，例如要看ROE，ROA，要看自由現金流量等等的，這些都超過一般人的能力範圍，當然多學一點不是壞事，但怕的是學太多沒有聚焦反而無法挑到對股票。 我這次在挑定存股的過程，試了一些方法，最後回頭仔細比對後，我覺得以下的幾個重點才是直指核心，最能挑出安心定存股的： 1. 長期穩定股利，且獲利每年都達到一定水準 2. 長期營運不曾有大衰退 3. 董監事持股超過一定水準 所以我先寫一個腳本來找出過去五年每年現金股利最少兩元，而且最近四季稅後淨利超過兩億元台幣的公司。 以下是這個腳本的內容： 

```
input:p1(2,"現金股利下限");
input:period(5,"符合條件的連續年數");
condition1=false;

value1=GetField("現金股利","Y");
if trueall(value1>=p1,period) or trueall(value1[1]>=p1,period)
then condition1=true;

value2=GetField("本期稅後淨利","Q");//單位:百萬
value3=summation(value2,4);

if value3>200
then condition2=true;

if condition1 and condition2
then ret=1;
```

符合這個腳本條件的股票有140檔，名單如下： [
![022503](/xstrader-content/uploads/2016/02/022503.png)
](/xstrader-content/uploads/2016/02/022503.png)接下來再從這140檔當中，濾掉那些過去幾年曾經有較大衰退的公司，所以我在上面提到的那個腳本中，再加上下面的濾網： 

```
condition3=false;

value4=GetField("營業利益成長率","Y");
if countif(value4<-15,period)=0
then condition3=true;

if condition1 and condition2 and condition3
then ret=1;
```

這個濾網的意思就是濾掉那些過去幾年曾經有任何一年獲利衰退超過15%以上的公司，加上這個濾網，我們濾到只剩63檔股票。 [
![022504](/xstrader-content/uploads/2016/02/022504.png)
](/xstrader-content/uploads/2016/02/022504.png)接下來我再設了一個濾網: 董監事持股比例超過15%。加了這個條件之後，符合的股票再被濾掉 23檔，剩39檔，名單如下： [
![022505](/xstrader-content/uploads/2016/02/022505.png)
](/xstrader-content/uploads/2016/02/022505.png)最後我再設一道濾網，濾掉那些短期業績明顯在衰退的，我設的條件是濾掉那些近半年月營收年增率平均衰退超過5%的。經過這個過濾的方式後，再濾掉八家，剩31家，名單如下： [
![022506](/xstrader-content/uploads/2016/02/022506.png)
](/xstrader-content/uploads/2016/02/022506.png)這三十一檔就是在大盤大跌後，我覺得可以加入定存股名單的股票，當然這個名單在每個月月營收公佈後，都需要用最後一個濾網再重跑一次。 過去一年，加權指數跌了13%，這31檔股票有19檔的年報酬率是維持在零以上，表現比加權指數差的只有川湖，天仁，景碩，聯強及美利達這四檔，可見這樣的投資組合至少是會打敗大盤的。 綜合以上的說明，我的存股法條件就是以下三條： [
![022507](/xstrader-content/uploads/2016/02/022507.png)
](/xstrader-content/uploads/2016/02/022507.png)第一條是用XS腳本寫的，第二條及第三條都是透過系統內建的條件式，只是調整參數而已。 以上就是我的存股法SOP，邏輯單純: 每年都會配息，業績長期不衰退，董監持股不低，最近半年業績沒有大衰退。 [

#####


---

# 填息的應用

Source: https://www.xq.com.tw/lesson/filter/%E5%A1%AB%E6%81%AF%E7%9A%84%E6%87%89%E7%94%A8/

XS選股填息的應用，我們使用「除息後距今20天內的股票漲幅在1%以上的有那些」當作範例，期望大家思考後嘗試改寫，納入自己的交易策略中。 對於使用XS撰寫選股策略較不熟悉的夥伴們，建議先透過 [如何自己撰寫選股條件 ](https://www.xq.com.tw/learn/filter/condition/)的教學，以利學習到如何自己撰寫選股策略，再察看以下填息應用範例策略撰寫，會比較容易上手唷！ 此範例的撰寫方向如下： 

- 設定兩個 input 參數「設定事件發生在最近幾日」與「上漲%」以便在選股中心介面上調整策略參數。 
- 運用GetField("除息日期")、GetField("除息值")，找出除息日期與除息值；這兩個語法也有資料欄位，所以也可以使用在指標、警示、函數腳本中。 
- 用 datediff 語法搭配 if 判斷除息後距今20天內的股票。 
- 若商品符合步驟3，則使用GetBarOffset函數找出除息日的相對K棒數，以此當作 RateOfChange 函數的期數，即可計算今日到除息日期的漲跌幅。 
- 此XS選股腳本加入選股中心後，選股中心介面上記得調整資料筆數為20筆，有足夠的資料筆數運算，跑出來的選股結果才會正確。 
[
![](/wp-content/uploads/2018/07/V640改_XS選股_填息的應用.png)
](/wp-content/uploads/2018/07/V640改_XS選股_填息的應用.png)XS選股腳本程式碼範例如下，供大家參考學習，若有任何問題歡迎在 [討論區 ](https://forum.xq.com.tw/cat/xs%E4%BD%BF%E7%94%A8%E5%95%8F%E9%A1%8C/)詢問唷！ 

```
Input: dist(20, "事件發生在最近幾日"),ratio(1, "上漲%");

Value1 = GetField("除息日期");

If datediff(Date, Value1) >= 0 and datediff(Date, Value1) <= dist then begin
// 計算今日到除息日期的漲跌幅
//
Value2 = GetBarOffset(Value1);
Value3 = RateOfChange(Close, Value2);
if Value3 >= ratio Then Ret = 1;
end;

outputfield(1, GetField("除息值"), "除息值");
OutputField(2, Value1, "除息日期");
OutputField(3, Value2, "距離今日幾天");
outputfield(4, Value3, "區間漲幅(%)");
```

[

#####


---

# 如何創造個人排行榜

Source: https://www.xq.com.tw/lesson/filter/%E5%A6%82%E4%BD%95%E5%89%B5%E9%80%A0%E5%80%8B%E4%BA%BA%E6%8E%92%E8%A1%8C%E6%A6%9C/

### **新增自訂排行條件 **
你知道可以利用選股中心來創造自己專屬的個人排行榜嗎？除了利用 [OutputField ](http://xshelp.xq.com.tw/api.aspx?a=outputfield&b=bif)語法將數值輸出檢視或手動排序之外，現在我們也可以利用自訂排行的功能讓系統自動幫我們產生一份排行榜。 「自訂排行」可以直接將函數的回傳值進行排序篩選。所以只要透過函數腳本，使用者可以完成任意條件組合而成的排行榜，使用上更為便利。 以下我們將示範如何加入自訂排行的條件 

### 

### **`步驟一：開啟選股中心 `**
[
![filter01](/wp-content/uploads/2016/01/filter01.png)
](/wp-content/uploads/2016/01/filter01.png)

### 

### **`步驟二：新增選股法 `**
點擊功能列的 **新增選股 [
![filter20](/wp-content/uploads/2016/01/filter20.png)
](/wp-content/uploads/2016/01/filter20.png)**開啟新增選股策略視窗。 [
![filter620-1](/wp-content/uploads/2017/01/filter620-1.png)
](/wp-content/uploads/2017/01/filter620-1.png)

### 

### **`步驟三：新增自訂排行條件 `**
點擊紅圈處的 [
![filter620-6](/wp-content/uploads/2017/01/filter620-6.png)
](/wp-content/uploads/2017/01/filter620-6.png)。 挑選要用來排行的函數腳本，比如說 **外資連續買超排行榜 **。這是系統提供的腳本範例，可以計算任意天期外資連續買超的金額。當我們依函數回傳值進行排序時，就可以得到指定範圍的外資連續買超排行榜。 [
![filter620-7](/wp-content/uploads/2017/01/filter620-7-1.png)
](/wp-content/uploads/2017/01/filter620-7-1.png)

### 

### **`步驟四：設定函數 `**
在開始排序之前，有幾個函數的設定需要先確定。 1. 首先，就是每個函數的輸入參數，在這個範例中是Length（計算期數）。這個值一定要輸入，否則無法執行。我們輸入 **3 **，代表要計算3日外資連續買超排行榜。 2. 再來是資料讀取，決定要計算的區間範圍。這邊順便提醒一下，如果函數腳本是有用到前期值的（像是MACD或EMA），一定要設定足夠的資料讀取，算出來的值才會對。如果對這項設定還有不清楚的地方，可以參考「 [資料讀取範圍與腳本執行的關係 ](https://www.xq.com.tw/learn/xspractice/settotalbar/)」的說明。 3. 選擇腳本要執行的頻率。 4. 排序方向，可以設定 **由大到小 **或是 **由小到大 **。這邊我們選由大到小。 5. 最後，設定要取前幾 **名 **或是前幾 **％ **。 [
![filter620-8](/wp-content/uploads/2017/01/filter620-8.png)
](/wp-content/uploads/2017/01/filter620-8.png)點擊 **確定 **，把設定好的條件加入已選條件區，這樣就完成了一個外資連續買超排行榜的選股法。 [
![filter620-9](/wp-content/uploads/2017/01/filter620-9.png)
](/wp-content/uploads/2017/01/filter620-9.png)一般看盤軟體提供的外資買超排行榜都是計算一定區間內外資買超總金額的排行榜。透過XS的腳本，我們可以寫出比較複雜的條件。像是我們範例就是針對有出現 **連續 **買超的個股排行。參考系統腳本的範例，你可以很容易寫出投信連續買超、自營商連續買超或是三大法人連續買超的排行榜，是不是很方便！ XS最重要的特色就在於他的無限可能，現在就開始寫出你自己的排行條件吧！ [

#####


---

# 如何打造自己的選股策略

Source: https://www.xq.com.tw/lesson/filter/%E5%A6%82%E4%BD%95%E6%89%93%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E9%81%B8%E8%82%A1%E7%AD%96%E7%95%A5/

在【XS選股中心】提供數百個內建選股條件，讓你自由搭配組合，找到自己的致勝法則。 現在，打開XQ全球贏家，跟著文字說明實際操作一次吧！ 

### 

### **步驟一：開啟選股中心 **
[
![filter01](/wp-content/uploads/2016/01/filter01.png)
](/wp-content/uploads/2016/01/filter01.png)

### 

### **步驟二：新增選股法 **
點擊功能列的 **新增選股 [
![filter20](/wp-content/uploads/2016/01/filter20.png)
](/wp-content/uploads/2016/01/filter20.png)**開啟新增選股策略視窗。 最上方請設定選股的基本資料，包含名稱、多空、範圍及備註。 [
![filter21](/wp-content/uploads/2016/01/filter21.png)
](/wp-content/uploads/2016/01/filter21.png)示範如何找出有董監改選行情的股票，所以在名稱這邊我們輸入 **董監改選 **。多空方向就選擇 **多 **。 

### 

### **步驟三：挑選選股範圍 **
右上角的選股範圍可以從系統提供的幾個範圍以及自選組合中挑選。若是不足使用，可以點擊 [
![filter23](/wp-content/uploads/2016/01/filter23.png)
](/wp-content/uploads/2016/01/filter23.png)，自訂新的選股範圍。不過一般的狀況下，我們會直接設定成 **普通股全部(系統) **。 [
![filter22](/wp-content/uploads/2016/01/filter22.png)
](/wp-content/uploads/2016/01/filter22.png)設定完基本資料後，我們就可以開始來設定選股法的內容。 這邊有三類條件可以選擇：選股條件、排行規則及選股腳本。 

### 

### **步驟四：新增選股條件 **
首先我們來看選股條件。 選股條件是以欄位為基礎。點選欄位後，畫面右邊會列出欄位相關的選股條件。 怎麼找出要使用的欄位呢？如果你熟悉股票、財報相關名詞的話，最快的是利用搜尋來找欄位。不然的話也可以利用分類選單來查找。 那麼我們現在來加入董監改選的條件： 1. 在搜尋框中輸入「董」，欄位的部份就會篩選出包含這個字的欄位有哪些。 2. 選擇「下一次董監改選年(單一)」，右邊就會出現可選的條件。欄位的名稱後面的括弧是代表頻率，你可以同時使用不同頻率的資料來組成選股策略。 3. 條件中的輸入框代表是可以調整的參數。我們把參數改成 **2016 **，也就代表這個條件是找「下一次董監改選是2016年」的股票。 4. 點擊 **加入條件(A) **，把設定好的條件加入已選條件區。 [
![filter24](/wp-content/uploads/2016/01/filter24.png)
](/wp-content/uploads/2016/01/filter24.png)``

### 

### **步驟五：新增排行規則 **
第二種條件是排行規則。排行規則是對一群股票的某一個欄位值（可能是價量、或是財報數字）進行排序篩選。可以輕鬆挑選出前段班或後段班的股票。排行規則一樣也是以欄位為基礎。 這邊我們想找出董監持股水位偏低的。所以我們這樣選擇條件： 1. 選擇 **籌碼面 **2. 頻率選擇 **日 **3. 再點選 **董監持股佔股本比例 **這個欄位。 4. 畫面上右邊最後一個條件是董監持股佔股本比例[全市場][由大到小]排行前[30][名]，我們當然是要找董監持股低的，所以把 **由大到小 **改成 **由小到大 **，名次放寬到前 **100 **名。 5. 點擊 **加入條件(A) **，把設定好的條件加入已選條件區。 [
![filter25](/wp-content/uploads/2016/01/filter25.png)
](/wp-content/uploads/2016/01/filter25.png)

### **步驟六：新增選股腳本 **
最後一種條件是選股腳本，選股腳本是利用XScript寫成的條件，可以進行比較複雜的運算。並且，使用者也可以自己寫腳本，所以是一項非常強大的功能。 前面我們已經設定了快要董監改選且董監持股低的條件，這邊我們再加二個財務面的條件： 1. 選擇 **5.營收財務 **2. 勾選 **PB來到近進來低點 **、 **現金佔總市值比例 **這二個條件 3. 點擊 **加入條件(A) **，把設定好的條件加入已選條件區。（沒錯，一次可以勾選多個條件加入！） [
![filter26](/wp-content/uploads/2016/01/filter26.png)
](/wp-content/uploads/2016/01/filter26.png)

### **步驟七：完全符合條件及部份符合條件 **
當條件都加入已選條件區後，我們還可以在這裡進行條件的微調。刪除條件或是修改計算的頻率和參數。比較特別的是每個條件還可以設定成 **完全符合 **或 **部份符合 **這二種選項。部份符合就是指這群條件裡面，只需要滿足幾個條件，就幫我們選出來。 比如說我們這次的範例是要找出可能會有董堅改選行情的股票，那「下一次董監改選是2016年」和「董監持股佔股本比例全市場由小到大排行前100名」這二個需要完全符合的必要條件。另外二個「PB來到近年低點」、「現金佔總市值比例」則是我們希望選出便宜標的而增加的條件，只要能符合其中之一即可（當然是愈多愈好），所以我們把這二個條件調整到部份符合條件那邊。 1. 點擊 **PB來到近年低點 **前的圖示 2. 點擊 **現金佔總市值比例 **前的圖示 [
![filter27](/wp-content/uploads/2016/01/filter27.png)
](/wp-content/uploads/2016/01/filter27.png)按下完成，新增的選股法，就設定好了！！！ 透過幾個步驟就可以自己排列組合出專屬的選股法。平時看看網路、書籍、雜誌上的理財達人的選股邏輯，把它設成選股法，加以變化運用，自己也可能成為選股達人喔！ [

#####


---

# 如何找出大戶持股比例增加的股票？

Source: https://www.xq.com.tw/lesson/filter/%E5%A6%82%E4%BD%95%E6%89%BE%E5%87%BA%E5%A4%A7%E6%88%B6%E6%8C%81%E8%82%A1%E6%AF%94%E4%BE%8B%E5%A2%9E%E5%8A%A0%E7%9A%84%E8%82%A1%E7%A5%A8%EF%BC%9F/

觀察市場大戶的動向，一直是很多人分析股票的基本動作之一。臺灣集中保管結算所每週會公佈每檔股票的股權分散表，從中我們可以找出大戶動向的蛛絲馬跡。從6.30開始，XS選股可以利用股權分散表來挑選大戶動向異常的股票。 接下來為你介紹如何利用XS選股找出連續三個月大戶持股比例增加的股票。 首先，新增一個選股策略（忘記的人可以回去複習 [如何打造自己的選股策略 ](https://www.xq.com.tw/learn/filter/strategy/)）。策略名稱設成「大戶持股比例增加」。 [
![大戶持股比例增加](/wp-content/uploads/2017/08/大戶持股比例增加.png)
](/wp-content/uploads/2017/08/大戶持股比例增加.png)再來，搜尋選股條件的地方，輸入「大戶」二個字，就可以看到我們需要的條件，選「大戶持股比例(月)」。 這邊要說明一下參數，原始公佈的股權分散表分得很細，一共分了15級。這邊我們做了簡化，分成100張、200張、400張、600張、800張、1000張這六個門檻。因為我們是要找大戶嘛，調整一下條件參數為1000，代表我們要找持股1000張以上的大戶比例。 點擊「完成」就完成了「連續三個月大戶持股比例增加」的選股策略！是不是很簡單！ 既然可以找出大戶動向，當然也可以找出散戶軌跡，一樣在搜尋框輸入「散戶」即可。其實這二組選股條件的資料來源都是股權分散表，只是累加的內容是不一樣的。在「大戶持股比例」中，參數1000，代表的是1000張以上的持股比例。而在「散戶持股比例」的時候，參數1000，就變成是1000張以下的持股比例。 [
![散戶持股比例](/wp-content/uploads/2017/08/散戶持股比例.png)
](/wp-content/uploads/2017/08/散戶持股比例.png)當然，我們XS最棒的一點，就是什麼條件都可以自己寫。所以，如果內建的條件無法滿足你的需要，可以透過XScript編輯器來寫出自己想要的內容。 這次股權分散表相關內容提供的欄位一共有七個： 大戶持股比例 大戶持股張數 大戶持股人數 散戶持股比例 散戶持股張數 散戶持股人數 總持股人數 除了總持股人數外，都支援100張、200張、400張、600張、800張、1000張這六個級距。寫法如下： value1=Getfield("大戶持股比例","W",param:=1000); 同時這些欄位也可以用在指標及警示腳本，所以無論是要拿來畫自訂指標或是觸發警示交易都一樣可以。 [

#####


---

# 如何自己撰寫選股條件

Source: https://www.xq.com.tw/lesson/filter/%E5%A6%82%E4%BD%95%E8%87%AA%E5%B7%B1%E6%92%B0%E5%AF%AB%E9%81%B8%E8%82%A1%E6%A2%9D%E4%BB%B6/

在


---

# 布林通道的奧義

Source: https://www.xq.com.tw/lesson/filter/%E5%B8%83%E6%9E%97%E9%80%9A%E9%81%93%E7%9A%84%E5%A5%A7%E7%BE%A9/

小編最近收到一個找股心法，希望能夠寫成自動交易的程式，心法共有三個規則如下： 

- **20日均線上彎 (代表中線上股價是走高的) **
- **布林通道缺口上下打開 **
- **股價漲超過上通道已經第二天了 **
來信者說這三個規則是他看文章時抄下來的，寫的人說這是勝率很高的交易策略。 小編仔細地研究這三條規則，我想這個策略是要尋找那些先前盤整，現在漲勢很明確的股票。 怎麼說呢？ 我們來看看布林通道的公式： 

```
Input: price(numericseries), length(numericsimple), _band(numericsimple);

BollingerBand = Average(price, length) + _band * StandardDev(price, length, 1);
```

根據上述的公式，我們可以看得出來，布林通道的的值是股價的移動平均線再加上N個股價的標準差。 我們先來看一下標準差的公式： 

```
input: thePrice(numericseries), Length(numericsimple), DataType(numericsimple);

Value1 = VariancePS(thePrice, Length, DataType);
if Value1 > 0 then
StandardDev = SquareRoot(Value1)
else
StandardDev = 0;
```

從上面這個公式我們可以看得出來，標準差是變異數的開根號。 那什麼又是變異數呢？ 

```
input: thePrice(numericseries), Length(numericsimple), DataType(numericsimple);

variable: Period(0), sum(0), avg(0);

VariancePS = 0;
Period = Iff(DataType = 1, Length, Length - 1);
if Period > 0 then
begin
avg = Average(thePrice, Length);
sum = 0;
for Value1 = 0 to Length - 1
begin
sum = sum + Square(thePrice[Value1] - avg);
end;
VariancePS = sum / Period;
end;
```

從上面這個公式，我們可以看得出來，變異數是每一個價位跟平均價的差的平方之總和。 我們用一張圖來表達上述的意思： [
![100602](/xstrader-content/uploads/2015/10/100602.png)
](/xstrader-content/uploads/2015/10/100602.png)根據這個公式，變異數就是把每一點到平均線的差的平方加總起來除以計算天數，這個數字愈大，代表股價的波動愈大。標準差則是把標準差開根號，統計學上教我們，如果股價的波動是屬於一種常態分配，那麼股價的波動範圍，有超過95%的機率會在正負兩個標準差之內。 [
![100601](/xstrader-content/uploads/2015/10/100601.png)
](/xstrader-content/uploads/2015/10/100601.png)而布林值的概念就是代表如果股價是呈現常態分配，那就有95%以上的機率，股價會在這個通道裡頭波動。 了解布林值的概念之後，我們來看上面的三個選股原則。 我們會發現，如果布林通道缺口(上通道與下通道的距離)上下打開，那就代表標準差從很小變大，根據上面的公式，這種情況代表： 1. 先前股價的波動很小 2. 這幾日波動變大了。 而20日均線上彎則代表短線上股價是上漲的，至於股價漲超過上通道已經第二天了，則代表這次的上漲是玩真的，才能出現黑天鵝現象。 所以根據這樣的思維，小編寫了以下的腳本： 

```
input:length(20);
variable:up1(0),down1(0),mid1(0),bbandwidth(0);
up1 = bollingerband(Close, Length, 2);
down1 = bollingerband(Close, Length, -2);
mid1 = (up1 + down1) / 2;

bbandwidth = 100 * (up1 - down1) / mid1;
if bbandwidth crosses above 5 and close > up1 and close> up1[1]
and average(close,20)>average(close,20)[1]
then ret=1;
```

這個腳本符合這三個選股原則。 以下的股票就是昨天符合這三個選股原則選出來的股票，今天盤中的股價表現： [
![100603](/xstrader-content/uploads/2015/10/100603.png)
](/xstrader-content/uploads/2015/10/100603.png)我們可以發現，是有股票漲的很兇猛，但短線勝率其實並沒有特別的突出，不過如果拉長來看，這種股票如果出現在長期下跌之後，往往是一種空頭翻多頭的反轉訊號。 我的觀察是，根據這個方法選出來的股票，基本上都是屬於盤整後有點上漲的股票，但這些股票，有些其實屬於假突破，股價還在盤整格局中，如果因為這個策略而跳下去買，反而容易追到高點。 那要如何分辨那些是假突破呢？ 小編的觀察點有幾個： 1. 量有沒有放大？有放大代表人氣真的有流進來 2. 先前的整理夠不夠久。上通道與下通道走窄的時間夠不夠近且平 以上是小編對布林通道的一些觀察，大家不妨在程式上加些價量的濾網，可以更精準也挑到會漲的股票，祝大家長期穩定也操作順利。 以下也是相關的文章，供大家參考 ? [【XQ官方部落格文】布林通道指標 ](https://www.xq.com.tw/xstrader/%E5%B8%83%E6%9E%97%E9%80%9A%E9%81%93%E6%8C%87%E6%A8%99/)? [【XQ官方部落格文】%B指標 ](https://www.xq.com.tw/xstrader/%EF%BC%85b%E6%8C%87%E6%A8%99/)[

#####


---

# 年底前投信作帳的可能標的

Source: https://www.xq.com.tw/lesson/filter/%E5%B9%B4%E5%BA%95%E5%89%8D%E6%8A%95%E4%BF%A1%E4%BD%9C%E5%B8%B3%E7%9A%84%E5%8F%AF%E8%83%BD%E6%A8%99%E7%9A%84/

每年到了年底又是投信拼績效的時候，年度績效第一名的桂冠大家都想搶，我們以2015年的為例，可以看到這一年勝負大致底定。 [
![122201](/xstrader-content/uploads/2015/12/122201.png)
](/xstrader-content/uploads/2015/12/122201.png)真的有機會拼第一名的，應該是宏利投信，富蘭克林華美，第一投信及統一投信這四家旗下的基金。 我以前寫過一個腳本，專門用來在年底前找出投信可能作帳的股票。 

這個腳本如下： 

```
input:r1(50),day(30),r2(15),r3(5000),r4(30);
setinputname(1,"股本上限單位億");
setinputname(2,"天期");
setinputname(3,"區間買超天數");
setinputname(4,"區間合計買超張數");
setinputname(5,"漲幅上限");
value1=GetField("投信買張","D");
value2=GetField("最新股本");//單位:億

condition1=false;
condition2=false;
condition3=false;

if value2<r1
then condition1=true;//股本小於50億元

value3=countif(value1>50,day);
if value3>=r2
then condition2=true;//近30天裡有超過15天買超

if summation(value1,day)>r3
then condition3=true;//近30天合計買超超過5000張

if condition1 and condition2 and condition3
and close<close[day-1]*(1+r4/100)
then ret=1;



```

利用這個腳本，我們可以找出那些符合以下腳本的股票： 1. 股本不大投信拉得動 2. 最近常買超 3. 買超達到一定張數 4. 漲幅還沒有到拉上去沒人跟的地步 我用這個腳本調整了一下參數，條件放得極寬： 1. 股本小於100億元 2. 過去五十天有15天買超 3. 買超張數超過2000張 4. 過去五十天漲幅低於200% 結果跑出了61檔股票： [
![1222](/xstrader-content/uploads/2015/12/1222.png)
](/xstrader-content/uploads/2015/12/1222.png)大家可以把這個腳本拿回去改成自己想要挑的基金作帳選股法。 [

#####


---

# 從月線與季線看台股當前的漲昇架構

Source: https://www.xq.com.tw/lesson/filter/%E5%BE%9E%E6%9C%88%E7%B7%9A%E8%88%87%E5%AD%A3%E7%B7%9A%E7%9C%8B%E5%8F%B0%E8%82%A1%E7%95%B6%E5%89%8D%E7%9A%84%E6%BC%B2%E6%98%87%E6%9E%B6%E6%A7%8B/

台股能不能繼續漲？如果可以，會是什麼股票領漲？ 要回答這個問題，我們先來對市場的多空架構做個定義： [
![101205](/xstrader-content/uploads/2015/10/101205.png)
](/xstrader-content/uploads/2015/10/101205.png)如果根據這樣的定義，那麼加權指數已經即將正式翻多。 [
![101204](/xstrader-content/uploads/2015/10/101204.png)
](/xstrader-content/uploads/2015/10/101204.png)如果從細產業來看，我們會發現，這當中塑化原料及不鏽鋼兩大族群是衝的最快的兩類產業，他們的指數分別在九月中旬及下旬就領先翻多。 [
![101201](/xstrader-content/uploads/2015/10/101201.png)
](/xstrader-content/uploads/2015/10/101201.png)[
![101203](/xstrader-content/uploads/2015/10/101203.png)
](/xstrader-content/uploads/2015/10/101203.png)為了很快的了解到底目前有那些股票位於這六階段不同的位置，我寫了一個腳本如下，我特別濾掉那些股價不到10元，成交量不到1000張的股票： 

```
input:status(1);
setinputname(1,"1:復甦期，2:收集期，3:多頭，4:警示期，5:發散期，6:空頭");
variable:m20(0),m60(0),message("0"),userchoice("0");
m20=average(close,20);
m60=average(close,60);
if close > m20 and c< m60 and m20<m60
then message="復甦期"
else
if close > m20 and c> m60 and m20<m60
then message="收集期"
else
if close > m20 and c> m60 and m20 > m60
then message="多頭"
else
if close < m20 and c>m60 and m20>m60
then message="警示期"
else
if close < m20 and c<m60 and m20>m60
then message="發散期"
else
if close < m20 and c<m60 and m20<m60
then message="空頭";

switch(status)
begin
case=1 :
userchoice="復甦期";
case=2 :
userchoice="收集期";
case=3 :
userchoice="多頭";
case=4 :
userchoice="警示期";
case=5 :
userchoice="發散期";
case=6 :
userchoice="空頭";
end;

if message=userchoice
and volume>1000 and close>10
then ret=1;
outputfield1(message);
setoutputname1("今日訊號");
outputfield2(message[1]);
setoutputname2("昨日訊號");
outputfield3(message[2]);
setoutputname3("前日訊號");
```

根據這個腳本，我選出的多頭的股票如下圖： [
![101207多頭](/xstrader-content/uploads/2015/10/101207多頭.png)
](/xstrader-content/uploads/2015/10/101207多頭.png)空頭的股票如下圖： [
![101206空頭](/xstrader-content/uploads/2015/10/101206空頭.png)
](/xstrader-content/uploads/2015/10/101206空頭.png)我們從多頭及空頭架構的股票，可以發現，受惠於台幣貶值的外銷股，景氣到底的塑化股，以及跌深且旺季到的電子股，目前是處於多頭走勢，金融股，航空股及部份先前比較強的個股則處於空頭走勢。 從這樣的架構來看，台幣續貶力道，電子旺季持續力，美國需求，以及全球景氣循環股的續航力(油價及工業金屬)，會是這個盤能持續多頭多久的主要指標。 除了用這一套方法來研判大盤漲昇架構之外，我稍稍更改一下腳本如下： 

```
variable:m20(0),m60(0),message("0") ;
m20=average(close,20);
m60=average(close,60);
if close > m20 and c< m60 and m20<m60
then message="復甦期"
else
if close > m20 and c> m60 and m20<m60
then message="收集期"
else
if close > m20 and c> m60 and m20 > m60
then message="多頭"
else
if close < m20 and c>m60 and m20>m60
then message="警示期"
else
if close < m20 and c<m60 and m20>m60
then message="發散期"
else
if close < m20 and c<m60 and m20<m60
then message="空頭";

if message<>message[1]
and volume>500 and close>10
then ret=1;
outputfield1(message);
setoutputname1("今日訊號");
outputfield2(message[1]);
setoutputname2("昨日訊號");
outputfield3(message[2]);
setoutputname3("前日訊號");
```

這個腳本可以找出最近一日訊號跟前一日不同的股票，以下幾張圖就是根據上述的腳本跑出來的，有的變好，有的變壞，加減參考囉。 [
![101208](/xstrader-content/uploads/2015/10/101208.png)
](/xstrader-content/uploads/2015/10/101208.png)[
![101209](/xstrader-content/uploads/2015/10/101209.png)
](/xstrader-content/uploads/2015/10/101209.png)[
![101210](/xstrader-content/uploads/2015/10/101210.png)
](/xstrader-content/uploads/2015/10/101210.png)[
![101211](/xstrader-content/uploads/2015/10/101211.png)
](/xstrader-content/uploads/2015/10/101211.png)[

#####


---

# 每日選股清單的妙用

Source: https://www.xq.com.tw/lesson/filter/%E6%AF%8F%E6%97%A5%E9%81%B8%E8%82%A1%E6%B8%85%E5%96%AE%E7%9A%84%E5%A6%99%E7%94%A8/

當你透過【XS選股中心】建構了你的選股策略之後，接下來怎麼樣才能每天都看到最新符合這些條件的股票呢？ 在這一篇文章內我們要為您介紹【XS選股中心】的「 **每日自動執行」 **功能。這個功能可以讓系統在資料更新時，自動幫您執行選股策略並將結果推送到你的 **每日自動選股清單 **。幫你省去每天重複操作的動作。 (XQ全球贏家個人版V2.40新增功能：【每日自動執行】新增「統計資訊」) 系統資料更新的時間，請參考「 [資料更新時間整理 ](https://www.xq.com.tw/資料更新時間整理/)」的說明 我們用文字敘述把操作的流程也說明一次： 

### 

### **步驟一：開啟選股中心 **
[
![filter01](/wp-content/uploads/2016/01/filter01.png)
](/wp-content/uploads/2016/01/filter01.png)選股中心的版面配置如下： 

- 功能列：所有功能都可直接由功能列上的按鈕作操作。 
- 目錄區：可依標籤或目錄的方式檢索現有的選股策略。 
- 清單區：列出目前所選的標籤或目錄內的選股策略清單。 
- 條件內容區：顯示目前所選的選股策略條件內容。 
- 選股結果區：顯示最新的選股結果，以頁籤分隔條件。 
- K線預覽 
[
![filter02](/wp-content/uploads/2016/01/filter02.png)
](/wp-content/uploads/2016/01/filter02.png)

### 

### **步驟二：選取選股策略 **
在目錄區，可以依標籤或目錄來切換清單區內的選股策略清單。 點選「系統→10.大師選股」，右方清單區會列出多位國際大師的選股策略。 [
![filter14](/wp-content/uploads/2016/01/filter14.png)
](/wp-content/uploads/2016/01/filter14.png)點擊「1003.華倫巴菲特」，可以在條件內容區看到巴菲特的選股條件。 [
![filter03](/wp-content/uploads/2016/01/filter03.png)
](/wp-content/uploads/2016/01/filter03.png)再點擊功能列的「每日自動執行」按鈕，就可以將巴菲特大師選股設成每日自動執行。 

### **步驟三：檢視每日自動選股清單 **
設定成每日自動執行的選股策略，除了可以在選股中心檢視選股結果外，系統還會自動幫你產生一組對應的商品組合。 位置在每日自動選股清單，依選股策略名稱存放（這裡的例子是1003.華倫巴菲特）。 開啟警示中心頁面（策略→雲端策略中心→警示中心），在左下角的小頁籤，可以找到「自動選股」。 [
![filter16](/wp-content/uploads/2016/01/filter16.png)
](/wp-content/uploads/2016/01/filter16.png)這邊就會自動列出最新的每日自動選股結果。 [
![filter15](/wp-content/uploads/2016/01/filter15.png)
](/wp-content/uploads/2016/01/filter15.png)目前可以設定100組的每日自動執行策略，超級夠用！快點把你每日必做的功課設成每日自動執行，讓電腦來幫你節省重複操作的時間，將精神放在更需要思考決策的地方。 

### **小秘訣 **
由於每日選股清單是一種系統組合，所以還可以搭配 **策略雷達 **使用。 在設定策略雷達的時候，指定範圍選擇組合。 [
![filter19](/wp-content/uploads/2016/01/filter19.png)
](/wp-content/uploads/2016/01/filter17.png)挑選 **每日自動選股清單 **[
![filter18](/wp-content/uploads/2016/01/filter18.png)
](/wp-content/uploads/2016/01/filter18.png)如果再搭配策略雷達的排程功能使用， 這樣就可以讓電腦晚上自動幫你選股，白天盤中程式監控篩選，完全自動化！ [](#)

### **(XQ全球贏家個人版 V2.40) 【每日自動執行】新增「統計資訊」 **
從上面的教學，想必大家已經熟悉【選股中心】的「每日自動執行」功能了吧！ 在使用這功能時，很多人也會去比對所有每日自動執行的策略篩選出來的商品是否有交集，進而關注有符合比較多策略的商品，不過這一切都要手動去整理，很不方便。 所以在XQ全球贏家2.40版本，我們在【選股中心】的「每日自動執行策略」介面中，增加「統計資訊」，讓大家可以一目了然地知道有哪些商品是符合最多的策略。 廢話不多說，我們就來看看下面的說明吧！ 

### **【每日自動執行】清單：增加「全部/多方/空方 策略總表」 **
在點選左方【每日自動執行】標籤後，用戶們就會在右邊的「選股策略列表」上方看到新增的「全部策略總表(統計)」、「多方策略總表(統計)」、「空方策略總表(統計)」這三個統計資訊。 

- 全部策略總表(統計)：統計了所有每日自動執行策略的商品＆商品檔數 
- 多方策略總表(統計)：統計了所有每日自動執行多方策略的商品＆商品檔數 
- 空方策略總表(統計)：統計了所有每日自動執行空方策略的商品＆商品檔數 (小叮嚀：要去指定策略的「多/空」方向後，策略才會歸類到多方/空方的總表唷！) 
在【選股策略列表】中去點選統計報表時，下方【選股結果清單】也會顯示所選取的統計資訊的所有商品。 [
![](/wp-content/uploads/2018/07/A2.png)
](/wp-content/uploads/2018/07/A2.png)

### 

### **選股結果：增加「符合策略(多)、符合策略(空)、符合策略(不指定)」欄位 **
而在【選股結果清單】中，系統也支援了「符合策略(多)、符合策略(空)、符合策略(不指定)」這三個欄位，讓各位用戶可以清楚知道所選出來的商品有符合哪些策略。 [
![](/wp-content/uploads/2018/07/A3.png)
](/wp-content/uploads/2018/07/A3.png)以下方示意圖中「1538 正峰新」這檔商品來說，他符合了2個「多方策略」，當我們去點選「符合策略(多)」欄位中的「2」時，系統就會顯示所符合的策略名稱！(示意圖中我們知道「1538 正峰新」符合了「102.MACD黃金交叉」、「103.KD黃金交叉」這兩個策略)。 [
![](/wp-content/uploads/2018/07/A4.png)
](/wp-content/uploads/2018/07/A4.png)

### 

### **警示中心頁面：也支援顯示「統計資訊」 **
在上面說明中，我們知道【每日自動執行】有增加了「全部策略總表(統計)、多方策略總表(統計)、空方策略總表(統計)」這三個統計資訊。 所以在【警示中心頁面】的「自動選股」頁籤中，系統也相對應支援這三個統計資訊。大家可以參考下方示意圖，在下拉選單中我們可以看到新增了「全部、多方統計、空方統計」這三個選項，點選後就會看到相對應的商品統計囉！ [
![](/wp-content/uploads/2018/07/A5.png)
](/wp-content/uploads/2018/07/A5.png)另外，頁面中也支援「符合策略(多)、符合策略(空)、符合策略(不指定)」這三個欄位，大家可以在【自選報價欄位】介面裡的「選股統計欄位」中，將這三個欄位給加入，這樣就可以在【警示中心頁面】中清楚把握到所篩選出來商品所符合策略的統計資訊！ [
![](/wp-content/uploads/2018/07/A6-1.png)
](/wp-content/uploads/2018/07/A6-1.png)希望這個新功能可以幫助到大家，祝大家投資順利！！ [

#####


---

# 營收公佈後，挑潛力股的方法

Source: https://www.xq.com.tw/lesson/filter/%E7%87%9F%E6%94%B6%E5%85%AC%E4%BD%88%E5%BE%8C%EF%BC%8C%E6%8C%91%E6%BD%9B%E5%8A%9B%E8%82%A1%E7%9A%84%E6%96%B9%E6%B3%95/

每個月的11日，所有的上市櫃公司都已公佈最新一個月的營收，這時候，如果您可以使用【XS選股中心】，尋找「月營收創25個月來新高」的股票，這些股票當中，可能會有未來盤面上最耀眼的潛力股。 這個選股法我設的選股條件如下： [
![091101](/xstrader-content/uploads/2015/09/091101.png)
](/xstrader-content/uploads/2015/09/091101.png)除了月營收創25個月新高之外，我加了兩個條件。 第一個是最新股本小於100億，因為這樣的股票動起來比較刺激。第二個是近三個月營收年增率平均大於5%，這是避免因為上個月出貨延到這個月，而造成上個月營收大衰退，這個月營收創高的假性成長。 為什麼要尋找這種股票呢？因為這種股票代表是一種新的成長動能的成型，可能是新產品，新客戶抑或新的產能，找出答案，可能就是找到潛力股。 我們舉一個很經典的例子： [
![091102](/xstrader-content/uploads/2015/09/091102.png)
](/xstrader-content/uploads/2015/09/091102.png)儒鴻在2012年 10月營收創25個月來新高時，它的股價是86.4元，後來又兩次營收創25個月來新高，股價長期呈現上昇趨勢。 再舉宏捷科為例，它在2014年五月第一次營收創25個月來新高，當時它的股價才25元， [
![091103](/xstrader-content/uploads/2015/09/091103.png)
](/xstrader-content/uploads/2015/09/091103.png)隨後連續半年營收每個月都創新高，股價先漲了一倍到50元，今年再漲一倍超過100元。 接下來把這個月跑出來的，符合上述條件的股票列在下方： [
![091104](/xstrader-content/uploads/2015/09/091104.png)
](/xstrader-content/uploads/2015/09/091104.png)我們可以一檔一檔去觀察，營收成長是什麼因素造成的，如果其後續的動能是持續的，是會漸漸加溫的，那我們就極有可能找到一檔潛力股了。 [

#####


---

# 用XS寫籌碼集中度的選股策略

Source: https://www.xq.com.tw/lesson/filter/%E7%94%A8xs%E5%AF%AB%E7%B1%8C%E7%A2%BC%E9%9B%86%E4%B8%AD%E5%BA%A6%E7%9A%84%E9%81%B8%E8%82%A1%E7%AD%96%E7%95%A5/

網友想要直接有籌碼集中度的欄位可以拿來用，在XS改版前遠水救不了近火，所以我就寫了一個自訂函數來算籌碼集中度，並且拿它來選那些籌碼集中度高且股價還沒有大漲的股票。 我的函數寫法如下： 

```
input:days(numericsimple,"計算天數");
value1=GetField("主力買賣超張數");
value2=summation(volume,days);
value3=summation(value1,days);
if value2<>0
then value4=value3/value2*100;
bs=value4;
```

我把這個函數的名稱取為BS，是Buysell(買賣超)的簡寫，各位可以取不同的名字。 接下來我用這個函數寫了下面這個腳本： 

```
 input:days(10,"天數");
input:ratio(5,"最低百分比");
input:percent(10,"漲幅上限");
value1=bs(days);
if close[days-1]<>0 and close>close[days-1]
then value2=(close-close[days-1])/close[days-1]*100;
if value1>ratio and value2<percent 
then ret=1;
outputfield(1,value1,0,"籌碼集中度");
outputfield(2,value2,1,"區間漲幅%");
```

這個腳本可以找出在N日內，籌碼集中度高於多少百分比，且漲幅低於多少百分比的股票。 我用這個腳本來跑今天的資料，挑出的股票如下圖： [
![021801](/xstrader-content/uploads/2016/02/021801.png)
](/xstrader-content/uploads/2016/02/021801.png)如果想要更改區間，只要點選下圖的調整參數按鈕。 [
![021802](/xstrader-content/uploads/2016/02/021802.png)
](/xstrader-content/uploads/2016/02/021802.png)就會跳出以下的視窗，調整不同的天期或百分比了。 [
![021803](/xstrader-content/uploads/2016/02/021803.png)
](/xstrader-content/uploads/2016/02/021803.png)[

#####


---

# 給股市長期投資人的忠告

Source: https://www.xq.com.tw/lesson/filter/%E7%B5%A6%E8%82%A1%E5%B8%82%E9%95%B7%E6%9C%9F%E6%8A%95%E8%B3%87%E4%BA%BA%E7%9A%84%E5%BF%A0%E5%91%8A/

最近接觸到一些股票長期投資者，發現每個人各有自己的撇步與罩門，整理了他們誤觸的地雷，我提出五點對股市長期投資者的忠告。 這些長期投資者，我發現他們朗朗上口的投資標的，常常有中鋼，中華電信，台積電，台達電，國泰金，巨大，正新，寶成，統一超，亞泥，台塑，南亞，長榮海運等等。 但在這些股票中，還是有一些股票，這五年來不漲反跌，讓這些長期投資者的投資績效大不如前。 [
![092101](/xstrader-content/uploads/2015/09/092101.png)
](/xstrader-content/uploads/2015/09/092101.png)不過也有一些股票長期下來還真的擺的愈久賺的愈多： [
![092102](/xstrader-content/uploads/2015/09/092102.png)
](/xstrader-content/uploads/2015/09/092102.png)看到上面這些對照組，綜合這些朋友的長期投資經驗，我想提出五個觀察點： **1. 要挑龍頭股。 **龍頭股代表的經營績效優於同業，代表的是競爭力。 **2. 要挑有經濟規模的行業 **[
![092103](/xstrader-content/uploads/2015/09/092103.png)
](/xstrader-content/uploads/2015/09/092103.png)什麼叫經濟規模呢？就是當您很大了之後，您的營運成本會比那些新進者低很多的行業，例如像流通業統一超及全家，還有像保全業如中保這種，前者一趟車子出來可以送貨到很多家據點，後者一個保全中心可以cover很多的客戶，這種大者恆大的，別人要進來會很辛苦，就可以長期維持比較好的利潤。 這種股票通常都有維持高毛利率的特性。 **3. 要挑每股營收高的公司 **如果一門生意要做一塊錢生意得投一塊錢資本支出，這種生意算是很消耗資本的行業，而且往往賺到的錢不能發現金，必須再拿去投資，所以才會造成每股營收不高。這種公司一旦賺不到足以再繼續投資的錢，就可能無法維持以往的績優表現，我們要小心那些獲利是靠砸大錢投資堆積出來的公司。 **4. 要挑A級領導人帶領的公司 **我的朋友們有人挑上某公司的原因，竟然是因為常在電視上看到該公司的老闆，而且這位老闆經常講出一些他覺得很棒的經營管理哲學。 就我的觀察，這個世界瞬息萬變，老闆如果常在公開場合講東講西，很容易被打臉，如果老闆怕被打臉死不認錯，常會把公司帶向一個沒有彈性的方向，這時候如果看錯了就很慘，我比較傾向那些有穩定但不張揚的團隊領導的公司。 **5. 要挑營收長期維持在上昇軌道上的公司 **這點很重要，十家新創的公司，十年後頂多剩三家，一定要長期觀察那些公司能否維持在成長的軌道上。 我根據上述五個原則，訂了幾個選股條件如下： [
![092104](/xstrader-content/uploads/2015/09/092104.png)
](/xstrader-content/uploads/2015/09/092104.png)挑出了45檔的股票： [
![092005](/xstrader-content/uploads/2015/09/092005.png)
](/xstrader-content/uploads/2015/09/092005.png)大家可以從這中間在去過濾那些產業前景不明的，非產業龍頭股的，剩下的就是比較值得長期留意的族群了。 [

#####


---

# 證所稅廢了，長期會有什麼影響？

Source: https://www.xq.com.tw/lesson/filter/%E8%AD%89%E6%89%80%E7%A8%85%E5%BB%A2%E4%BA%86%EF%BC%8C%E9%95%B7%E6%9C%9F%E6%9C%83%E6%9C%89%E4%BB%80%E9%BA%BC%E5%BD%B1%E9%9F%BF%EF%BC%9F/

證所稅廢了。 這個稅法經過七折八扣之後，對資本市場原本是有兩類人會受影響。 1. 參與未上市及IPO交易的。這部份也是這次廢除後的最實質受惠者。 2. 每年交易金額超過10億的大戶們。這部份原本民國107年起要實施，現在等於直接喊停。這部份的影響是看看原來因為這個因素而出走的大戶們會不會再回到台股市場，這部份我是審慎樂觀，畢竟10億的門檻對大戶來說，要達到是很容易的，這個限制拿掉了，確實是有助於市場的活絡。 但如果從台股長期的籌碼安定性來觀察，我認為下面三個法令對我們操作上的影響，比證所稅還大。 1. 兩稅合一之股利扣抵稅額減半 2. 綜合所得稅增加一個綜合所得淨額超過1000萬的部份，稅率是45% 3. 股利所得超過一萬元的部份加扣2%的健保補充費及0.48%的長照保險補充保費 這三條加起來，上市櫃公司每賺一塊錢，公司的大股東及高級主管們，要被政府拿走的錢接近0.52元。 這三條法令，讓內資與外資稅負差距接近18%，加上證所稅，讓很多大股東都搖身一變成為假外資。 現在證所稅取消了，但這三條法令還在，我判斷，大股東們的做法會調整如下： 1. 出去的錢不會回來。 2. 公司賺的錢會維持低的股利政策，把錢留在公司 3. 等累積一陣子的保留盈餘之後，再作減資。 4. 每年年初偏多，在除權前逢高賣出不必申報轉讓的持股 5. 等到第三及第四季時，再伺機回補持股 基於這五點觀察，個人覺得未來： 1. 高殖利率的股票未來不見得還會分派高的股息 2. 未來第一及第二季有行情，第三及第四季拉回的季節性現象會更明顯 在我們個人操作上，現金多，股價低於每股淨值，大股東持股比例高的股票，會是未來可能有減資行情的候選人。 以今年為例，我先前曾跟大家提過的矽統： [
![2363](/xstrader-content/uploads/2015/11/2363.png)
](/xstrader-content/uploads/2015/11/2363.png)還是最近的無敵： [
![8201](/xstrader-content/uploads/2015/11/8201.png)
](/xstrader-content/uploads/2015/11/8201.png)乃至於華紙： [
![1905](/xstrader-content/uploads/2015/11/1905.png)
](/xstrader-content/uploads/2015/11/1905.png)這每一檔在起漲時，都是 1. 股價遠低於淨值 2. 帳上現金不少 3. 銀行負債極低 4. 本業就算虧也不大 這樣的公司，減資的話，可以拿回現金，且不必繳稅，持股的總市值因為EPS提高，股價走高反而還增加，這是最符合大股東利益的作法。 今年上半年宣佈減資的就超過14家公司。 以國巨集團為例，從國巨，奇利新到智寶通通減資。 我用【XS選股平台】寫了一個挑選這類股票的選股策略： [
![111801](/xstrader-content/uploads/2015/11/111801.png)
](/xstrader-content/uploads/2015/11/111801.png)符合條件的公司共八家如下： [
![111802](/xstrader-content/uploads/2015/11/111802.png)
](/xstrader-content/uploads/2015/11/111802.png)大家可以參考以上策略找出那些股價遠低於淨值、讓大股東想減資的公司喔！ [

#####


---

# 選股中心的錯誤代碼說明

Source: https://www.xq.com.tw/lesson/filter/%E9%81%B8%E8%82%A1%E4%B8%AD%E5%BF%83%E7%9A%84%E9%8C%AF%E8%AA%A4%E4%BB%A3%E7%A2%BC%E8%AA%AA%E6%98%8E/

大家好，XS 選股腳本編譯完成後，加入選股中心，執行選股策略時， 因為有時候會只有出現錯誤代碼，但不會敘述錯誤原因，如下圖： [
![](/wp-content/uploads/2022/10/56d52aa9-8dd4-482d-8aca-a9b801191815_擷取.jpg)
](/wp-content/uploads/2022/10/56d52aa9-8dd4-482d-8aca-a9b801191815_擷取.jpg)所以本篇文章會以列表的方式，告知大家各個錯誤代碼代表的錯誤原因， 選股中心的錯誤代碼說明，如下列表，提供給大家參考： 錯誤代碼 錯誤原因說明 50000 XML 資訊格式錯誤 50001 沒有找到可執行的腳本 50101 缺少應用程式 ID 資訊 50102 缺少使用者 ID 資訊 50103 起始日期大於結束日期 50104 缺乏回測頻率 50022 伺服器資料不正確 50023 策略內含無效的自訂範圍 50024 自選股錯誤 50025 系統商品組合錯誤 50027 不支援此市場 50031 取得指定市場的商品列表時發生錯誤 50032 不支援此商品 50033 不支援此商品在目前頻率的資料 50034 取得的資料範圍中的資料有問題，導致找不到指定的自選股範圍 50201 取得策略指定的商品範圍列表時發生錯誤 50202 商品不在策略範圍內 50301 商品尚未掛牌 50302 結束日期低於最舊資料支援的日期 50303 資料長度不足 50304 指定的回測區間內無交易日 50305 最大引用筆數比資料支援的長度還長 50306 準備高精準度 K 線錯誤 50307 準備模擬 K 線錯誤 50308 未支援欄位 50003 參數設定錯誤 50008 不合法的版號 50009 產生XS腳本物件失敗 50010 XS腳本物件不存在，請重新編譯 50011 腳本執行中 50012 腳本等待執行中 50013 相關的程式物件沒有初始化成功 50014 傳入錯誤的參數 50021 腳本不符合最新版本, 需要重新編譯 50030 腳本過期 50035 腳本物件的 ID 是空值 50037 腳本參數值是 Invalid Field / NA Field 50401 腳本參數數量錯誤 50402 相關程序初始化錯誤 50004 執行超過時間 50015 計算出現執行異常 50016 計算出現讀取欄位資料的異常 50017 計算執行到RaiseRunTimeError的語法 50019 資料長度不夠計算 50020 嘗試取得未來資料，請注意[]是否使用負數 50501 除以零 50502 欄位資料不存在 50503 分配腳本運算時發生未知問題 50504 函數值發生未知錯誤 50505 排行發生未知錯誤 50506 無可執行的執行日期區間 50507 排行函數資料問題 50508 不支援的語法 50509 手動停止 50601 取欄位分類群組出現錯誤 50602 取欄位偏移數值出現錯誤 50603 取欄位資訊出現錯誤 50036 選股欄位的格式不合法 59901 選股欄位的翻譯錯誤 59902 開始日期的格式錯誤 59903 結束日期的格式錯誤 59904 第一筆資料日期的格式錯誤 如果看了上述的說明，仍有疑問無法排除，請提供以下資訊，並mail至 [XQservice@XQ.com.tw ](mailto:XQservice@XQ.com.tw)，會有專人安排釐清，謝謝： 1. 問題描述。 2. 有問題的完整畫面截圖。 3. 選股策略匯出檔案，匯出時請勾選「匯出選股策略所含的自訂腳本」 4. 指標腳本匯出檔案。 5. Log資料夾壓縮檔案，預設路徑：C:\SysJust\XQLite\LOG [

#####


---

# 選股中心：新增『回溯』及『回測』功能

Source: https://www.xq.com.tw/lesson/filter/%E9%81%B8%E8%82%A1%E4%B8%AD%E5%BF%83%EF%BC%9A%E6%96%B0%E5%A2%9E%E3%80%8E%E5%9B%9E%E6%BA%AF%E3%80%8F%E5%8F%8A%E3%80%8E%E5%9B%9E%E6%B8%AC%E3%80%8F%E5%8A%9F%E8%83%BD/

相信大家已經很習慣用選股策略來篩選商品了吧！現在小編要來介紹在XQ全球贏家的【選股回溯】及【選股回測】功能，這兩個功能分別可以讓各位用戶去看過去某個日期的選股結果，以及模擬計算過去某段時間該選股策略的進/出場狀況＆報酬率成效！ [](#)

### 

### **一、選股回溯功能介紹 **
有使用過選股策略的用戶應該不陌生下面的圖示，不過在左下的【選股結果報表】上方新增了「回溯功能列」，這功能列可以讓大家輕鬆的去指定過往某個日期並呈現該日期的選股結果唷！讓我們隨著底下說明一步一步的來操作吧！ [
![](/wp-content/uploads/2018/07/P1.png)
](/wp-content/uploads/2018/07/P1.png)

#### 【回溯功能列】介面說明 
【回溯功能列】包含以下幾個功能： [
![](/wp-content/uploads/2018/07/P2.png)
](/wp-content/uploads/2018/07/P2.png)

- 直接切換策略「前一日」/「後一日」的選股結果 

  - 點擊「左箭頭」，系統會去篩選前一個日期的選股結果；點擊「右箭頭」，系統會去篩選後一個日期的選股結果 
  - 如果目前已經是最新的選股結果，「右箭頭」會無法點擊；反之，如果已經是系統能夠提供的最早的資料，則「左箭頭」會無法點擊。 

- 指定策略過往某個日期的選股結果 

  - 如果是要選擇比較久遠的日期，這時可以點擊「日曆」按鈕叫出日曆工具，去指定要篩選的日期。 

- 直接切換到策略「最新」的選股結果 

  - 各位用戶如果依照上面的說明使用下來的話，現在應該是在過去某個日期的選股結果，而現在想要切換到目前最新資料的日期的話，可以點擊「最新」按鈕。 
  - 小叮嚀：如果系統已經轉檔最新的資料(ex：當天的籌碼資料)，這時「最新」按鈕的右上也會出現一個小紅點，當看到這個小紅點後去點擊「最新」按鈕，該策略就會用最新的轉檔資料執行，篩選出最新的選股結果。 
[
![](/wp-content/uploads/2018/07/P3.png)
](/wp-content/uploads/2018/07/P3.png)

#### 選股結果列表：因應回溯功能的修改 
選股結果列表中，有幾個基本會出現欄位，分別為「成交」、「漲幅％」、「總量」，這幾個欄位一定會顯示目前系統最新轉檔的資料，所以為了讓各位用戶在回溯過去日期時，可以清楚知道該日期的收盤價格，所以回溯時列表會出現「收盤價(回溯日期)」＆「區間漲幅％」這兩個欄位。 [
![](/wp-content/uploads/2018/07/P4.png)
](/wp-content/uploads/2018/07/P4.png)舉例來說，上面的示意圖是回溯到2018/7/11日，而當下「1213大飲」最新轉檔的成交價為「13.65」，7/11的收盤價是「13.55」，所以簡單的「區間漲幅％」是 (13.65 - 13.55)/13.55 = 0.74 

### 

### **二、選股回測功能介紹 **
接下來為大家介紹選股的回測功能！ 和策略雷達的回測功能一樣，我們提供了商品過去的歷史資料，讓用戶可以來模擬選股策略在過去一段時間中，商品的進/出場狀況＆報酬率成效！！ 下面我們就來看看選股策略「回測功能」的基本操作 

#### 執行選股策略回測的入口 
在【選股回測】功能中，我們可以對「選股中心」的選股策略做回測，也可以對【XScript編輯器】中任一個選股腳本直接回測，所以會有以下兩個回測入口點： 

- 【選股中心】中，可以利用「選股策略」右鍵選單的「執行回測」選項，或是上方工具列的「回測」按鈕來叫出這個選股策略的「執行回測設定」介面 
[
![](/wp-content/uploads/2018/07/P5.png)
](/wp-content/uploads/2018/07/P5.png)

- 在【XScript編輯器】中，開啟要執行回測的選股腳本，然後點擊上方工具列的「回測」按鈕，系統就會叫出該選股腳本的「執行回測設定」介面 
[
![](/wp-content/uploads/2018/07/P6.png)
](/wp-content/uploads/2018/07/P6.png)

#### 設定選股回測參數，完成設定後開始執行 
在進行上方的步驟後，相信大家應該已經叫出「執行回測設定」介面，介面的配置說明如下： 

- 回測參數區：設定回測的頻率、區間、市場、商品範圍、以及交易方向 
- 選股策略參數區：設定選股條件/腳本參數、進場參數 
- 出場參數區：出場條件參數設定 
- 交易參數區：交易費用設定 
[
![](/wp-content/uploads/2018/07/P7.png)
](/wp-content/uploads/2018/07/P7.png)在這個介面，用戶們可以依照自己需求來調整參數，當設定完成後，就可以點擊介面右下角的【開始回測】按鈕，系統就會開始執行回測功能！ 

#### 回測執行狀態說明 
系統在開始執行回測後，會出現「回測執行狀態」介面，用戶可以利用這介面確認回測正在執行狀態。「回測執行狀態」介面配置如下： 

- 啟動時間：顯示回測開始執行的時間。 
- 腳本名稱：顯示被執行回測的腳本名稱（並不是策略雷達的命名，這一點請用戶注意!!） 
- 執行狀態：顯示回測執行完成度百分比。 
- 停止回測按鈕：讓回測停止執行的按鈕。 
[
![](/wp-content/uploads/2018/07/P8.png)
](/wp-content/uploads/2018/07/P8.png)如果在回測執行過程中，用戶們要停止執行，可以點選「4.停止回測按鈕」，點選後系統會確認是否要停止回測執行(參考下面圖示)，如果停止當下已經有部份商品執行完畢，可以勾選「顯示已經完成的結果」，這樣在按下「確定」按鈕後，系統除了停止執行回測外，也會顯示已經執行完畢的回測結果。 [
![](/wp-content/uploads/2016/04/stop4.png)
](/wp-content/uploads/2016/04/stop4.png)

#### 回測報告：檢視回測結果 
當回測執行完成，系統就會開啟該選股策略的【回測報告】，用戶們可以在這個介面檢視該策略的回測結果。 回測報告的詳細說明， [請參考：策略雷達回測功能：『回測報告』說明 ](https://www.xq.com.tw/learn/sensor/backtestreport/)[
![](/wp-content/uploads/2018/07/P10.png)
](/wp-content/uploads/2018/07/P10.png)

### 

### **三、策略雷達回測功能：支援「選股」 **

#### 【執行商品】下拉選單支援「選股」 
在這次XQ策略雷達 2.40改版，選股已經支援了回測功能，所以如果各位用戶的策略雷達是使用「選股」來當作執行商品時，該策略雷達也能夠使用【策略雷達回測功能】(在舊的版本是不行的)。 所以在新的【策略雷達執行回測】介面中，我們可以看到「執行商品」下拉選單出現了「選股」的選項。當系統在執行回測時，也會模擬每日的「選股結果」來進行回測。 [
![](/wp-content/uploads/2018/07/P11.png)
](/wp-content/uploads/2018/07/P11.png)

#### 可以使用「選股」來當作是進場的條件 
而如果想要直接使用所選擇的「選股」來當作策略雷達的進場條件，我們在介面上也提供讓用戶們直接使用「選股」的使用方式唷！ 可以參考下面圖示，畫面中的「進場設定」，小編取消勾選「腳本」前面的方框，這就代表著小編要用所選擇的「選股策略」當作進場條件來回測，是不是很方便！！ (P12) [
![](/wp-content/uploads/2018/07/P12.png)
](/wp-content/uploads/2018/07/P12.png)好了，關於選股的【回溯】＆【回測】功能介紹也到了尾聲，希望這次新加的功能能夠幫助到各位用戶，祝大家投資順利！！ [

#####


---

# 選股中心基本操作

Source: https://www.xq.com.tw/lesson/filter/%E9%81%B8%E8%82%A1%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/

【XS選股中心】是把選股邏輯轉化成條件式的系統，價、量、財報、籌碼等資料隨你取用，只怕想不到、不怕選不到。 看完影片後應該覺得選股中心的操作一點都不難吧！為了方便大家實做，以下用文字敘述的方式一一說明操作流程： 

### 

### **步驟一：開啟選股中心 **
[
![filter01](/wp-content/uploads/2016/01/filter01.png)
](/wp-content/uploads/2016/01/filter01.png)選股中心的版面配置如下： 

- 功能列：所有功能都可直接由功能列上的按鈕作操作。 
- 目錄區：可依標籤或目錄的方式檢索現有的選股策略。 
- 清單區：列出目前所選的標籤或目錄內的選股策略清單。 
- 條件內容區：顯示目前所選的選股策略條件內容。 
- 選股結果區：顯示最新的選股結果，以頁籤分隔條件。 
- K線預覽 
[
![filter02](/wp-content/uploads/2016/01/filter02.png)
](/wp-content/uploads/2016/01/filter02.png)目錄區中的「標籤」可以讓你快速的篩選選股策略，目前提供以下的選擇方式： 

- 全部：列出所有選股策略 
- 最新：依選股策略的 **建立日期 **，列出最新的20個 
- 常用：依選股策略的 **執行次數 **，列出最多的20個 
- 每日自動執行：列出所有 **啟動每日自動執行 **的選股策略 
- 最近執行：依選股策略的 **執行時間 **，列出最新的20個 
- 最近匯入：列出最近一次匯入的選股策略 
你也可以在搜尋區內輸入文字查詢吻合的選股策略。 

### 

### **步驟二：執行選股策略 **
在目錄區，可以依標籤或目錄來切換清單區內的選股策略清單。 點選「系統→10.大師選股」，右方清單區會列出多位國際大師的選股策略。 [
![filter11](/wp-content/uploads/2016/01/filter11.png)
](/wp-content/uploads/2016/01/filter11.png)點擊「1003.華倫巴菲特」，可以在條件內容區看到巴菲特的選股條件。 [
![filter03](/wp-content/uploads/2016/01/filter03.png)
](/wp-content/uploads/2016/01/filter03.png)接下來，左鍵雙擊「1003.華倫巴菲特」，就會執行這個選股條件並在選股結果區看到篩選結果。 

### **步驟三：檢視選股結果 **
執行完的選股策略，會在選股結果區看到篩選結果。 點擊股名或股號，可以在右方看到K線預覽。 雙擊股名或股號，可以將股票帶入個股分析頁面，檢視更多相關資訊。 `[
![filter04](/wp-content/uploads/2016/01/filter04.png)
](/wp-content/uploads/2016/01/filter04.png)`

### 

### **步驟四：加入自選股 **
選出來的股票，我們可以將有興趣的標的加入自選股，方便明天盤中觀察。 只要勾選代碼前的勾選股，再點擊工具列上的 [
![filter12](/wp-content/uploads/2016/01/filter12.png)
](/wp-content/uploads/2016/01/filter12.png)按鈕，就可以把勾選的股票加入你的自選組合當中。 工具列上的按鈕可以對股票清單進行操作： 

- [
![filter05](/wp-content/uploads/2016/01/filter05.png)
](/wp-content/uploads/2016/01/filter05.png)：把勾選的股票加入自選股 
- [
![filter06](/wp-content/uploads/2016/01/filter06.png)
](/wp-content/uploads/2016/01/filter06.png)：匯出整份股票清單成excel做進一步分析 
- [
![filter07](/wp-content/uploads/2016/01/filter07.png)
](/wp-content/uploads/2016/01/filter07.png)：重新執行或停止執行選股策略 
- [
![filter08](/wp-content/uploads/2016/01/filter08.png)
](/wp-content/uploads/2016/01/filter08.png)：調整顯示的欄位順序 
- [
![filter09](/wp-content/uploads/2016/01/filter09.png)
](/wp-content/uploads/2016/01/filter09.png)：顯示/隱藏K線預覽 
以上就是XS選股中心的基本操作，是不是很簡單呢？每天我們都可以透過這四個步驟輕鬆完成每天盤後的選股功課，迎接明天盤中的考驗。但是XS選股中心能幫你更多！每天自動將你的選股策略以最新的資料重新執行選股，將結果存進「每日選股清單」當中。接下來，我們會教你如何使用方便的 [**每日自動執行功能 **](https://www.xq.com.tw/learn/filter/dailylist/)。 [

#####


---

# outputfield排序

Source: https://www.xq.com.tw/lesson/filter/outputfield%E6%8E%92%E5%BA%8F/

相信有在使用【選股中心】的用戶，對outputfield應該相當熟悉，本篇來介紹outputfield的新功能。 如果沒用過outputfield的用戶可以看 [OutputField - (內建函數) ](https://xshelp.xq.com.tw/index.aspx?HelpName=OutputField&group=GENERALFUNC)各位對小編說的outputfield 新功能想必非常好奇，話不多說，小編趕緊介紹。 Outputfield 在新版2.30中，多了一個排序的功能，也就是可以直接藉由outputfield 的語法來設定排序，接著小編就用腳本來做示範： 

### 

### **排序功能1：由大至小 **

```
1ret = 1;
2outputfield(1,GetField("每股稅後淨利(元)","Q"),2,"EPS", order := 1);
```

[
![由大至小](/wp-content/uploads/2017/07/由大至小.png)
](/wp-content/uploads/2017/07/由大至小.png)可以看到在outputfield 後方多下一個函數設定order := 1 ，所選出的選股結果，就會依照每股稅後淨利的數值，由大至小的做排序的動作。 

### **排序功能2：由小至大 **

```
1ret = 1;
2outputfield(1,GetField("每股稅後淨利(元)","Q"),2,"EPS", order := -1);
```

[
![由小至大](/wp-content/uploads/2017/07/由小至大.png)
](/wp-content/uploads/2017/07/由小至大.png)將函數設定order :=- 1 ，所選出的選股結果，則會變為由小至大做排序的動作。 相信在outputfield增加排序的功能後，要挑選股票時就會更加方便啦。 [

#####


---

# 選股因子分析：用數據說話，打造高勝率選股策略

Source: https://www.xq.com.tw/lesson/filter/stockselectionfactoranalysis/

## **前言 **
您是否常聽到「本益比低比較好」、「動能強才會漲」這些說法？ 這些用來描述股票特徵的指標，我們稱為「因子」。 但問題是這些因子在過去的市場中，真的具備獲利能力嗎？ XS 功能「選股因子分析」可以讓我們不再憑感覺投資，而是用歷史數據來說話。 本文將帶您了解因子的概念，並透過一個實戰案例，教您如何使用「選股因子分析」工具優化選股策略。 

## **什麼是選股因子分析？ **
在進入工具之前，我們先釐清兩個核心觀念： 

- **選股因子 **：簡單來說就是「描述股票特徵的數據」。 

  - **基本面因子 **：如本益比 （ P/E ） 、股東權益報酬率 （ ROE ） 。 
  - **技術面因子 **：如 RSI 強弱、股價動能。 
  - **籌碼面因子 **：如外資買賣超、大戶持股比例。 

- **因子分析 **：這是一個「驗證」的過程。 我們透過歷史回測，觀察當某個因子數值高 （ 或低 ） 時，股票未來的漲跌幅表現，藉此判斷該因子是否具有預測股價的能力。 

## **XS 選股因子分析流程 **
在「 XS 選股因子分析」工具中，完成一次標準的分析只需要五個步驟： 

- **建立函數 **：定義您的選股邏輯 （ 因子 ） 。 
- **參數設定 **：設定回測時間與樣本範圍等參數。 
- **執行分析 **：每日計算因子，分組統計報酬。 
- **觀察報表 **：解讀數據，確認因子是否有效。 
- **優化策略 **：根據結果應用於選股策略。 

## **範例演練 （ 52 週動能因子 ） **

### **因子概念 **
「強者恆強」，股價越接近過去的高點，代表上漲力道越強。 

- 越接近 1 → 股價接近 52 週新高，動能越強。 
- 越接近 0 → 股價遠離 52 週新高，動能越弱。 

### **建立函數腳本 **
我們需要撰寫一個 XS 函數腳本來計算這個指標。 衡量當日收盤價相對於過去 52 週 （ 約 252 個交易日 ） 最高價的強弱位置。 **XS 函數腳本範例： **

```
// 52週動能_最高價


// 設定

Var:moment(0);

settotalBar(750);


// 因子

moment = close / highest(high, 252);

Value99 = moment;

If Value99<>0 Then retVal = Value99;
```

### **功能入口 **
完成函數腳本編譯後，可在 XScript 中以下列三種方式開啟因子分析設定： 

- 在左側目錄中，右鍵點選函數腳本，點擊「因子分析」。 [
![](/wp-content/uploads/2025/12/因子分析入口-左側目錄右鍵.png)
](/wp-content/uploads/2025/12/因子分析入口-左側目錄右鍵.png)
- 開啟函數腳本分頁，在上方工具列中點選「因子分析」。 [
![](/wp-content/uploads/2025/12/因子分析入口-上方頁籤右鍵.png)
](/wp-content/uploads/2025/12/因子分析入口-上方頁籤右鍵.png)
- 開啟函數腳本分頁，右鍵點選函數分頁頁籤，點擊「因子分析」。 [
![](/wp-content/uploads/2025/12/因子分析入口-上方工具列.png)
](/wp-content/uploads/2025/12/因子分析入口-上方工具列.png)

### **參數設定 **
[
![](/wp-content/uploads/2025/12/因子分析參數設定.png)
](/wp-content/uploads/2025/12/因子分析參數設定.png)因子分析的參數設定與選股回測大致相同，以下針對不同點說明： 

- **進場腳本 **此處顯示的是要作為因子的函數腳本，點擊右側放大鏡會調出函數目錄視窗。 
[
![](/wp-content/uploads/2025/12/因子分析參數設定-函數選取.png)
](/wp-content/uploads/2025/12/因子分析參數設定-函數選取.png)

- **樣本設定 **為了避免極端數據扭曲分析結果，可以在設定中選擇如何處理「離群值」。 

  - **原始值 **：不做任何調整，使用最原始的計算數據。 
  - **ZScore （ 標準化分數法 ） **：透過統計學的標準差來過濾，系統會自動踢除 ZScore 大於 3 或小於 -3 的數值。 
  - **IQR （ 四分位距法 ） **：利用數據排列的四分位數 （ Q1 、 Q3 ） 來判斷，系統會踢除超過「 Q3 + 1.5 倍 IQR 」或低於「 Q1 - 1.5 倍 IQR 」的數值。 

### **報表分析 **
執行分析後，系統會跑出因子分析報表，報表分為五個部分： 

- **等分報酬率圖 **是驗證因子是否有效的核心。 圖表中分 10 組 （ D1 至 D10 ） 的平均報酬率及勝率，理想的因子，我們應該看到第 1 組報酬率最低 （ 最高 ） ，第 10 組報酬率最高 （ 最低 ） ，且中間組別依序排列，代表因子有區分優劣股票的潛力。 
[
![](/wp-content/uploads/2025/12/報表分析-等分報酬率圖-scaled.png)
](/wp-content/uploads/2025/12/報表分析-等分報酬率圖-scaled.png)

- **數據結構 **「因子分布圖」用來診斷因子數值是否含有極端離群值，可透過此統計圖選擇合適的樣本調整方法；而「報酬率分布圖」則顯示各組報酬的集中度，幫助觀察獲利的穩定性與風險。 
[
![](/wp-content/uploads/2025/12/報表分析-分佈圖-scaled.png)
](/wp-content/uploads/2025/12/報表分析-分佈圖-scaled.png)

- **數據完整性 **「樣本數分析圖」追蹤每日的有效股票數量，確保回測結果並非建立在極少數樣本上，以此觀察數據的代表性與回測的穩健性。 
[
![](/wp-content/uploads/2025/12/報表分析-樣本數分析-scaled.png)
](/wp-content/uploads/2025/12/報表分析-樣本數分析-scaled.png)

- **報酬穩定性 **「分組表現概況圖」總結了各組的最終表現，而「年度表現趨勢圖」則從時間維度檢視因子是否在不同年度持續有效。 
[
![](/wp-content/uploads/2025/12/報表分析-分組表現概況-scaled.png)
](/wp-content/uploads/2025/12/報表分析-分組表現概況-scaled.png)

- **因子指標評分 **

  - **報酬率 **：衡量因子的獲利能力。 
  - **風險報酬比 **：衡量每承受一單位風險所獲得的回報。 
  - **勝率 **：產生正報酬的股票比例，評估是否整體股票普遍都有獲利能力。 
  - **年度勝率 **：產生正報酬的年份比例，評估因子在不同年度中，是否普遍都有獲利能力。 

[
![](/wp-content/uploads/2025/12/報表分析-因子指標-scaled.png)
](/wp-content/uploads/2025/12/報表分析-因子指標-scaled.png)

### **優化選股策略 **
經過上述分析，假設我們確認「 52 週動能」是一個有效因子，接下來該怎麼應用？ 可以在您的選股腳本中，呼叫因子函數 （ 52 週動能\_最高價 ） 來排行，並篩選出指定排行區間 （ 例如因子值最大的 10% ） 。 這樣就能選出市場上相對動能最強勢的一批股票，以此將經數據驗證的高效條件，整合進您的選股策略。 **XS 選股腳本範例： **

```
// 將「52週動能_最高價」加入選股策略

// 使用因子的數值來排行

rank myfactor begin

    retval = CallFunction("52週動能_最高價");

end;

// 選擇D10，也就是pr 90以上的股票

if myfactor.pr >= 90 Then ret = 1;
```

## **結語 **
選股因子分析是量化交易的基石。 一個穩健的策略並非來自單一的直覺，而是來自於對大量歷史數據的科學驗證與不斷優化。 透過 XS 的工具，您可以將腦中的投資靈感轉化為可被驗證的數據。 現在，試著寫下您感興趣的因子，開始您的第一次分析吧！ 

## **附錄： XS 預設系統因子 **

- 【大小單】 

  - 大單20日買賣超金額 
  - 小單20日買賣超金額 
  - 中單5日買賣超金額 
  - 特大單5日買賣超金額 

- 【技術指標】 

  - 120日賣出動能(Kiosotto) 
  - 150日買進動能(Kiosotto) 
  - Andean Oscillator多頭(20) 
  - Andean Oscillator空頭(120) 
  - ATR\_10日 
  - Empty\_line指標\_20d 
  - OBV MACD\_OSC柱狀體 
  - StochRSI\_K 
  - Wave Smoother 
  - YZVolatility(14) 
  - 人氣指標AR\_250 
  - 海龜20日潛在波動性 
  - 築底指標(ZDZB) 

- 【基本】 

  - P\_CFV 
  - QMJ\_safe 
  - ROA\_P 
  - ROA\_PB 
  - ROE\_P 
  - ROE\_PB 
  - ROS\_P 
  - 本益比5日變異 
  - 企業價值EV 
  - 自由現金流量\_P 
  - 股價毛利比\_3 
  - 股價營收比\_3 
  - 股價營利比\_12 

- 【價量】 

  - 10日內破低次數 
  - 10日內跌幅超過5%天數 
  - 20日內破低次數 
  - 52週動能 
  - 52週動能\_最高價 
  - calmar\_ratio\_250d 
  - dd\_ma\_250d 
  - 流動性因子(成交值) 
  - 高低動能\_5日 
  - 跌破5年線 
  - 價量動能\_20日 
  - 最高價均價幅度 

- 【籌碼】 

  - 主力10日內買超天數 
  - 主力20日籌碼區間買超賣超比 
  - 外資10日內賣超天數 
  - 外資10日買張佔股本比 
  - 自自20日內買超天數 
  - 自自20日籌碼區間買超賣超比 
  - 法人10日內賣超天數 
  - 借券賣出餘額張數 
  - 綜十10日內買超天數 

[

#####


---

# 「繪圖偏移」說明

Source: https://www.xq.com.tw/lesson/indicator/%E3%80%8C%E7%B9%AA%E5%9C%96%E5%81%8F%E7%A7%BB%E3%80%8D%E8%AA%AA%E6%98%8E/

目前 XS 指標的運作方式是將腳本中的 Plot 指令畫在運算的當根 K 棒上，但有些情境下使用者會希望能夠向後 (未來) 畫出預測值，或是向前 (過去) 畫出轉折點和落後指標。 這次改版中針對各種類型的 Plot 函數 (除了本身就可以指定位置的 PlotLine 以外) 增加了新參數，讓使用者可以以當下運算的 K 棒為基準向前向後畫出所需的數值。 

### **參數語法 **

```
Plot(序列編號, 數值, shift:=N)
Plot(序列編號, 數值, “序列名稱”, shift:=N)
PlotN(數值, shift:=N)
PlotN(數值, “序列名稱”, shift:=N)
PlotK(序列編號, vOpen, vHigh, vLow, vClose, shift:=N)
PlotK(序列編號, vOpen, vHigh, vLow, vClose, "序列名稱", shift:=N)
PlotFill(序列編號, vFrom, vTo, shift:=N)
PlotFill(序列編號, vFrom, vTo, "序列名稱", shift:=N)
```

### **參數的運作方式 **

- Plot 指令中的 shift 參數能夠讓畫出來的圖形以運算的 K 棒為基準點進行偏移。 
- 該數值需為整數，正值時向右 / 未來偏移，負值時向左 / 過去偏移。 
- 該數值代表的是偏移的 K 棒數量，舉例來說 shift := -2 代表著原本應該畫在當根 K 棒的數值會被改畫在向左 2 根 K 棒的位置上。 
- 不同的 Plot 指令可以有不同的偏移量，但每個 Plot 都只能夠有一個偏移值。若同一個 Plot 指令被賦予了複數個值時則會出現錯誤。 
- 如果偏移值為負數，當畫的位置超出了繪圖起始點的話則不會畫出。 
- 如果偏移值為正數，當畫的位置超出了保留空間的話則不會畫出。 

### **保留空間的運作方式 **
因應繪圖偏移功能，保留空間的運作方式也做了調整。 由於原本的保留空間會隨著 K 棒的增加而減少，直到空間用完後才向後推移，會導致空間不足時向右偏移的指標無法顯示。 此次改版中新增加了 固定保留空間 的選項。 [
![](/wp-content/uploads/2024/11/01-1.png)
](/wp-content/uploads/2024/11/01-1.png)在勾選後，保留空間的大小將不會隨著 K 棒的增加減少，而是維持在固定的寬度。 這樣使用者只要確保設定的 K 棒數量大於 XS 指標的偏移量，就能夠完整的畫出。 保留空間能夠設定的最大值為 60。 

### **簡單範例 - 一目均衡表 **

```
input: ConvPeriod(9, "轉換天數");
input: BasePeriod(26, "樞紐天數");
input: LagPeriod(52, "延遲天數");

// 轉換線
Value1 = (Highest(High, ConvPeriod) + Lowest(Low, ConvPeriod)) / 2;

// 樞紐線
Value2 = (Highest(High, BasePeriod) + Lowest(Low, BasePeriod)) / 2;

// 先行帶 A
Value3 = (Value1 + Value2) / 2;

// 先行帶 B
Value4 = (Highest(High, LagPeriod) + Lowest(Low, LagPeriod)) / 2;

Plot(1, value1, "轉換線");
Plot(2, value2, "樞紐線");
Plot(3, Close, "後行時間", shift:=-BasePeriod+1);
Plot(4, Value3, "先行時間(1)", shift:=BasePeriod-1);
Plot(5, Value4, "先行時間(2)", shift:=BasePeriod-1);
PlotFill(6, Value3, Value4, shift:=BasePeriod-1);
```

[

#####


---

# 「自訂 K 線」說明

Source: https://www.xq.com.tw/lesson/indicator/%E3%80%8C%E8%87%AA%E8%A8%82-k-%E7%B7%9A%E3%80%8D%E8%AA%AA%E6%98%8E/

XQ 增加了讓指標腳本能夠繪製 K 棒的語法。 

### **函數語法 **

```
PlotK(序列編號, Open, High, Low, Close)
PlotK(序列編號, Open, High, Low, Close, "序列名稱")
```

### **函數說明 **

- 序列編號是 1~999 的數值，與目前 XS Plot 的序列編號相同。 
- 序列名稱是非必需的參數，如果不傳的話，預設的序列名稱為 "Plot" + 序列編號，例如 "Plot2"。 
- 「Open, High, Low, Close」對應的是自訂 K 棒的開高低收。 

### **函數的運作方式 **
PlotK 在每次腳本運算時，會在對應的橫軸位置 (也就是在運算的 K 棒位置上) 依據輸入的數值畫出 K 棒。 若該次腳本運算時沒有執行到 PlotK 的話，對應位置上就不會畫出 K 棒。而有運算到 PlotK，但又想將其清除的話，可以使用 NoPlot 函數。 

### **PlotK 繪圖設定 **
K 棒柱體和外框的顏色可以在繪圖設定中作修改，如下圖。 [
![](/wp-content/uploads/2024/09/01-1.png)
](/wp-content/uploads/2024/09/01-1.png)若希望將畫出的 K 線取代原有的主圖，可以在技術線圖設定中將主圖的 K 線改為連線圖，並將連線的顏色設定成和背景顏色相同。 [
![](/wp-content/uploads/2024/09/02-2-1024x525.png)
](/wp-content/uploads/2024/09/02-2.png)這樣只要將所需的 XS 指標設定為主圖疊圖，就可以達到近似的效果。 [
![](/wp-content/uploads/2024/09/03-2-1024x570.png)
](/wp-content/uploads/2024/09/03-2.png)

### **簡單範例 1 - 平均 K 線 (Heikin-Ashi) **

```
var: ha_open(0), ha_high(0), ha_low(0), ha_close(0);

if currentbar = 1 then
ha_open = (open + close) / 2
else
ha_open = (ha_open[1] + ha_close[1]) / 2;

ha_close = (open + high + low + close) / 4;
ha_high = maxlist(high, ha_open, ha_close);
ha_low = minlist(low, ha_open, ha_close);

PlotK(1, ha_open, ha_high, ha_low, ha_close, "平均K線");
```

### **簡單範例 2 - 不同商品的比較 **
如果希望可以將大盤的 K 棒和股票放在一起比較的話，可以透過自訂 K 棒的方式來達成。 

```
PlotK(1, GetSymbolField("TSE.TW", "Open"), GetSymbolField("TSE.TW", "High"), 
GetSymbolField("TSE.TW", "Low"), GetSymbolField("TSE.TW", "Close"));
```

由於大盤的價格和股票的價格相差甚遠不適合直接比較，可以將兩者除以相同 K 棒位置的價格，讓其有相同的起始點，這樣就很容易看出兩者漲跌差異。 

```
//紀錄開始計算的第一根K棒開盤價
if currentBar = 1 then begin
value100 = GetSymbolField("TSE.TW", "Open");
value101 = open;
end;

//將之後的價格都除以開盤價
value1 = GetSymbolField("TSE.TW", "Open") / value100;
value2 = GetSymbolField("TSE.TW", "High") / value100;
value3 = GetSymbolField("TSE.TW", "Low") / value100;
value4 = GetSymbolField("TSE.TW", "Close") / value100;
PlotK(1, value1, value2, value3, value4);

value5 = open / value101;
value6 = high / value101;
value7 = low / value101;
value8 = close / value101;
PlotK(2, value5, value6, value7, value8);
```

[

#####


---

# 主力作多成本線

Source: https://www.xq.com.tw/lesson/indicator/%E4%B8%BB%E5%8A%9B%E4%BD%9C%E5%A4%9A%E6%88%90%E6%9C%AC%E7%B7%9A/

在網路上最常見到的兩個問題，一個是XX股翻空了嗎？另一個是反彈會漲到哪裡？ 今天我就來跟大家介紹一個指標：主力作多成本線。 我們可以用這個指標，來研判目前主力的持股成本，進而研判漲多拉回的止跌點，以及大跌後反彈的滿足點，以及主力是不是還持續看好這檔股票。 先跟大家介紹這個指標的腳本： 

```
input:period(40);
value1=GetField("主力買張");
value2=(o+h+l+c)/4;
value3=value1*value2;//做多金額
if summation(value1,period)<>0
then value4=summation(value3,period)/summation(value1,period);
//主力作多金額除以主力買張
plot1(value4,"主力作多成本線");
```

大家可以把這個腳本複製成為一個新增的指標類腳本， 然後把這個指標畫在主圖疊圖上，並且在副圖上使用主力進出這個指標。 這樣就可以畫出一張如附圖這樣的K線圖： 
![](/xstrader-content/uploads/2022/03/主力作多成本線01.png)
在這張圖裡，我們會知道主力的成本，當股價拉回主力成本附近時，如果主力是買超的，那就代表主力還要持續作多，如果主力是大賣超，那就代表主力要清倉出場了。 在反彈時，主力成本線也可以作為反彈的滿足點。 要特別聲明，這個指標對那些主力有在著墨的熱門股比較有參考價值，對那些沒啥量沒特定主導勢力的股票就不合用。 附圖我放了幾張熱門股的主力成本線對照圖： 
![](/xstrader-content/uploads/2022/03/主力作多成本線02.png)

![](/xstrader-content/uploads/2022/03/主力作多成本線03.png)

![](/xstrader-content/uploads/2022/03/主力作多成本線04.png)

![](/xstrader-content/uploads/2022/03/主力作多成本線05.png)
有興趣的朋友可以參考看看，最近行情不好，但 [【XQ量化交易平台】 ](https://utm.to/4jdbk3)的使用人數還是非常穩定的成長，顯示大家對於量化分析還是非常感興趣。 可惜我coding功力有限，只能提供一些我長期看盤交易體驗到的一些簡單概念，介紹一些簡單的計算，期待台灣量化交易界能高手輩出，引領一代風騷。 祝大家操作順利！ [

#####


---

# 什麼是XS指標

Source: https://www.xq.com.tw/lesson/indicator/%E4%BB%80%E9%BA%BC%E6%98%AFxs%E6%8C%87%E6%A8%99/

[
![什麼是XS指標](/wp-content/uploads/2016/01/8-07.png)
](/wp-content/uploads/2016/01/8-07.png)XS指標，是使用XScript語法寫出計算邏輯的指標，它可以自訂顏色、繪圖樣式、座標範圍，在技術分析線圖上驗證新的交易策略與想法。 [

#####


---

# 什麼時候起就不能當死多頭？

Source: https://www.xq.com.tw/lesson/indicator/%E4%BB%80%E9%BA%BC%E6%99%82%E5%80%99%E8%B5%B7%E5%B0%B1%E4%B8%8D%E8%83%BD%E7%95%B6%E6%AD%BB%E5%A4%9A%E9%A0%AD%EF%BC%9F/

我們很習慣作多，大部份的時候我們的思考都是在挑可以買的股票! 我們找可以長期投資的股票，我們找均線多頭排列的股票，我們找三大法人同步買進的股票，我們找技術指標出現買進訊號的股票。 我們總相信，我們挑的股票有所本，可以打敗大盤，就算大盤跌，我們買的股票基於這個跟那個因素，還是可能逆勢上漲，但， 從過去的經驗裡，我們會發現，當整個股票市場進到主跌段之後，不是我們打敗大盤，而是我們被大盤打敗。 因此，有些江湖老手只要指數一破月線就收手不玩了，要等到指數站穩月線才又進場，但這個指標在橫盤時常常一下子跌破，一下子又站上，總是讓我們一下子全退場，一下子又好像可以進場，弄的我們三心兩意，忽多忽空。 於是，我回到最基本的數學，上市股票有864檔，上櫃股票有693檔，如果他們各自的上漲家數，在近期內，最差的時候如果都還有個200檔以上，那就佔整體普通股的1/4以上，這樣的時候，應該是還可以做多，但如果不到這個數字，應該就是屬於那種很容易被大盤打敗的時候了。 於是，我用xs寫了一個指標，腳本如下： 

```
input:shortterm(5);
input:midterm(20);
setinputname(1,"短期均線");
setinputname(2,"中期均線");
value1=GetField("上漲家數");
value2=lowest(value1,shortterm);
value3=average(value2,midterm);
plot1(value3,"中期均線");
```

這個指標的意思是我找出近五天的上漲家數最低點取20日移動平均，我發現這個指標蠻有參考價值。 [
![092301](/xstrader-content/uploads/2015/09/092301.png)
](/xstrader-content/uploads/2015/09/092301.png)上圖是這個指標跟加權指數的對照圖。 我們可以很清楚的看到，這個指標值還在200以上時，指數基本上是屬於多頭走勢，如果在200以下，很明顯的是在空頭市場。 不只上市股票有這樣的特性，上櫃也是如此，下圖是OTC指數跟這個指標的對應圖： [
![092302](/xstrader-content/uploads/2015/09/092302.png)
](/xstrader-content/uploads/2015/09/092302.png)有了這個指標，我們可以有一個很明確的依據，在必要的時候，克制一下我們死多頭的行為，以現在的情況為例，目前這指標還在200以上，所以還可以假設這個盤仍有個股表現的空間，一旦跌破200，那就代表我們挑的股票，可能只有兩成甚至更低的機率會上漲，這時候就是我們多看少做的時候了。 [

#####


---

# 修正式價量指標VPT(Volume price trend)

Source: https://www.xq.com.tw/lesson/indicator/%E4%BF%AE%E6%AD%A3%E5%BC%8F%E5%83%B9%E9%87%8F%E6%8C%87%E6%A8%99vptvolume-price-trend/

[
![2016061701](/xstrader-content/uploads/2015/06/2016061701.png)
](/xstrader-content/uploads/2015/06/2016061701.png)在推廣XS的過程中，我有一些年紀大的，不大有學習動機跟能力的朋友，會直接嗆我說：「你說的這些我都聽攏謀，霧煞煞。你直接給我一個指標，看漲看跌清清楚楚的，我學不了那麼多。」 每次碰到這種，我都很想請他自己去買把槍，買個口罩及安全帽。 在我使用XS的過程中，我確實是設計過很多的指標，若要說有考慮到價跟量，又能指出多空趨勢，又要能夠濾掉那些因為一時衝動所造成的假訊號的，倒是有個指標。 這個指標我稱之為「修下式價量指標」。 這個指標的概念很簡單： 1. 先算出每天的Midprice。也就是每天的開高低收四個值的平均值。 2. 然後把這個值乘以每天價格的漲跌幅，再乘上當天的成交量。 3. 然後一路累加這個數值。 這樣計算出來的指標，在盤整時整條線會很貼近水平線，只有在漲跌趨勢很明確時才會上漲或是下跌，所以如果拿它跟它自身的一定週期移動平均線來對照，我們可以看到非常明確的進出場訊號。 我把上述的概念及算法用XS語法寫的指標如下： 移動平均線的天期就勞煩各位自己調整了。 

```
input:days(10);
setinputname(1,"移動平均線天數");
var:tvp(0),mpc(0);
mpc=(open+high+low+close)/4;

if mpc[1]<>0
then
tvp=tvp[1]+(mpc-mpc[1])/mpc[1]*volume
else
tvp=tvp[1];
value1=average(tvp,days);
plot1(tvp,"修正型價量指標");
plot2(value1,"移動平均");
```

我們來看兩個例子： [
![061801](/xstrader-content/uploads/2015/06/061801.png)
](/xstrader-content/uploads/2015/06/061801.png)[
![061802](/xstrader-content/uploads/2015/06/061802.png)
](/xstrader-content/uploads/2015/06/061802.png)這兩檔股票都曾經歷經很長的整理期，tvp展現出來的就是長期橫向的水平走勢，我們每天看到小紅小黑，心裡七上八下，但從tvp指標來看，有沒有真的離開橫向盤整的格局，其實就很清楚了。 [

#####


---

# 如何繪製進出場訊號

Source: https://www.xq.com.tw/lesson/indicator/%E5%A6%82%E4%BD%95%E7%B9%AA%E8%A3%BD%E9%80%B2%E5%87%BA%E5%A0%B4%E8%A8%8A%E8%99%9F/

[
![如何在K線圖上繪製進出場訊號? ](/wp-content/uploads/2016/04/8-006.png)
](/wp-content/uploads/2016/04/8-006.png)有一天小編被問到，像這種畫面是怎麼弄的？怎麼樣才能在圖上標進出場點？ [
![indicator35](/wp-content/uploads/2016/04/indicator35.png)
](/wp-content/uploads/2016/04/indicator35.png)其實一點都不難，調整一下繪圖的樣式設定就行了。 今天我們用一個例子來說明 **如何在K線圖上繪製進出場訊號 **。 小編舉的例子很簡單，就是拿5日均線當作參考，站上5日均線就進場做多，跌破5日均線就多單出場。 腳本如下： 

```
variable: intrabarpersist position_1(0); // 目前position
variable: intrabarpersist entry_price(0); // 最後一次進場的價格

//進場邏輯
//
condition1 = close crosses above average(close, 5);
// 出場邏輯
//
condition2 = close crosses below average(close, 5);

if position_1= 0 then
begin
if condition1 then
    begin
        position_1= 1;
        entry_price = close;
        print("(ENTRY) Date:", Date, " EntryPrice:", entry_price);
        plot1(low * 0.98, "entry");
    end;
end
    else
        begin
        if condition2 then
            begin
                position_1= 0;
                entry_price = 0;
                print("(EXIT) Date:", Date);
                plot2(high * 1.02, "exit");
            end;
        end;

```

由於今天的主題是說明怎麼樣在圖上顯示進出場點， 所以千萬不要問小編這個策略會不會賺錢...... 不過如果有人對腳本內容有興趣，可以寫信給我們，這樣小編又可以多寫一篇文章。 在這個腳本中，我們把進場訊號的點位存在plot1,出場訊號的點位存在plot2。 直接 [疊加到主圖 ](https://www.xq.com.tw/lesson/indicator/新增xs主圖指標/)上，畫面是這個樣子。 [
![indicator36](/wp-content/uploads/2016/04/indicator36.png)
](/wp-content/uploads/2016/04/indicator36.png)接下來要在 **繪圖樣式 **中，變更指標的樣式、粗線、顏色等屬性。 在XS編輯器左邊的公式面板中，找到 **買賣點 **腳本，點擊右鍵開啟選單，選擇 **繪圖設定 **開啟繪圖設定視窗。 [
![indicator38](/wp-content/uploads/2016/04/indicator38.png)
](/wp-content/uploads/2016/04/indicator38.png)首先把樣式變更為 **點 **，每個點其實就是一個預設的圖示，目前內建有15種圖示（如圖） 我們把進場樣式設成▲，把出場樣式設定成▼；顏色也同時調成紅色和綠色。 [
![](/wp-content/uploads/2016/04/1.png)
](/wp-content/uploads/2016/04/1.png)如果不喜歡”系統“內建圖示，也可以利用右邊的”自訂“功能，將偏好的圖示給匯入，系統就可以使用匯入的圖示來繪製指標 [
![](/wp-content/uploads/2016/04/2.png)
](/wp-content/uploads/2016/04/2.png)點擊 **確定 **儲存後，再重新將指標疊加到主圖，就可以在技術分析圖上看到買賣點的標示。 [
![indicator35](/wp-content/uploads/2016/04/indicator35.png)
](/wp-content/uploads/2016/04/indicator35.png)最後要提醒大家的是，小編特地把進出場邏輯是寫在獨立的段落。也就是說，只要把condition1和condition2替換成你現有的進出場邏輯，就可以直接在圖上顯示買賣點摟。 [

#####


---

# 尋找底部到了的領先指標

Source: https://www.xq.com.tw/lesson/indicator/%E5%B0%8B%E6%89%BE%E5%BA%95%E9%83%A8%E5%88%B0%E4%BA%86%E7%9A%84%E9%A0%98%E5%85%88%E6%8C%87%E6%A8%99/

大跌之後常有反彈，但「該不該搶」是大學問，手腳快的，可以搶，不是能一直盯著盤的，最好等落底了賺波段。 我們今天先來看一下，台股近三十年來的幾次波段大底，看看有沒有共同的特徵，可以讓我們做為波段抄底的參考。 [
![070901](/xstrader-content/uploads/2015/07/070901.png)
](/xstrader-content/uploads/2015/07/070901.png)上圖發生在民國76年，指數從4700跌到2300 [
![080902](/xstrader-content/uploads/2015/07/080902.png)
](/xstrader-content/uploads/2015/07/080902.png)這是發生在民國78年的郭婉容證所稅事件，連跌19根停板後反彈破底後以W底完成築底。 [
![080903](/xstrader-content/uploads/2015/07/080903.png)
](/xstrader-content/uploads/2015/07/080903.png)這是民國79年，歷史上最慘下跌，從12682跌到2485。 [
![080904](/xstrader-content/uploads/2015/07/080904.png)
](/xstrader-content/uploads/2015/07/080904.png)上面這張則是民國80年5月從6200跌到4200 [
![080905](/xstrader-content/uploads/2015/07/080905.png)
](/xstrader-content/uploads/2015/07/080905.png)上面這張是民國81年從年初的5400一路下跌，跌了一整年，跌到年底的3150後才見底。 [
![080906](/xstrader-content/uploads/2015/07/080906.png)
](/xstrader-content/uploads/2015/07/080906.png)上面這張則是從82年初的 5000點跌到九月中的3800點。 [
![080907](/xstrader-content/uploads/2015/07/080907.png)
](/xstrader-content/uploads/2015/07/080907.png)上圖則是民國83年電子股初試啼聲後的修正波，從6600跌到4500。 [
![080908](/xstrader-content/uploads/2015/07/080908.png)
](/xstrader-content/uploads/2015/07/080908.png)上圖則是1999年初的V型反轉。 [
![080910](/xstrader-content/uploads/2015/07/080910.png)
](/xstrader-content/uploads/2015/07/080910.png)上圖則是2000年網路風暴後，一直到隔年 11月才打出來3500點的真正大底。 [
![080909](/xstrader-content/uploads/2015/07/080909.png)
](/xstrader-content/uploads/2015/07/080909.png)上圖是2003年五月在4300到4100間打了近兩週的底，那之後就一路上到了7000點。 [
![080911](/xstrader-content/uploads/2015/07/080911.png)
](/xstrader-content/uploads/2015/07/080911.png)上圖是2005年10月底跌破5750所創的波段底部。 [
![080912](/xstrader-content/uploads/2015/07/080912.png)
](/xstrader-content/uploads/2015/07/080912.png)上圖大家應該不陌生，這是雷曼兄弟事件之後打了五個月的大底。 給大家看這些圖的目的是，跟大家分享一個我的經驗，除非是地緣政治突發性利空所造成的下跌，不然底部大部份都至少打兩支腳。 所以大家看到全面性的下跌時，如果要尋找波段翻多的時點，可以耐心的等候第二支腳的結束，而不要一直在猜底部到了沒？ 先前有跟大家介紹過一個漲跌家數比的指標 它的腳本如下： 

```
input:period1(5);
value1=GetField("上漲家數");
value2=GetField("下跌家數");
value3=GetField("漲停家數");
value4=GetField("跌停家數");
value5=value1+value3*2-(value2+value4*2);
value6=average(value5,period1);

plot1(value6,"移動平均");
```

之所以介紹這個指標，是因為我發現，在歷次的底部區時，這個指標都先從下降趨勢變成上升趨勢，這時候指數通常都還在破底或整理。 [
![070816](/xstrader-content/uploads/2015/07/070816.png)
](/xstrader-content/uploads/2015/07/070816.png)以上圖為例，上一次次貸風暴後，指數還在破底，這個指標已經翻揚了，代表指數在跌時，上漲的家數與漲停的家數已經比先前高了，這代表追價，翻多的力道比先前強了，這是一個很重要的打底訊號 透過這個指標，加上第二支腳的概念，以及量極縮，是我判斷底部到了沒的重要依據。 [

#####


---

# 布林通道指標

Source: https://www.xq.com.tw/lesson/indicator/%E5%B8%83%E6%9E%97%E9%80%9A%E9%81%93%E6%8C%87%E6%A8%99/

前兩天看到了週刊上一個成功的投資故事，故事的主角先前不管透過基本面，技術面，在股票操作上一直都是虧錢，後來他覺得採取科學的精神，透過統計學常態分配的原理，用兩個標準差做為他進出的依據，他的邏輯是股價的波動也是一種常態分配，有95%的機率股價會落在平均值加減兩個標準差的區間裡，所以如果股價突破兩個標準差，就算是超漲，可以獲利了結，跌破兩個標準差，那就是超跌，應該逢低承接。他說自從他改成使用這種統計上的操作方式，長期都能獲利。 這位老兄找到的聖杯，其實就是技術分析上常有人用的布林通道(BBand) 我用XS的腳本跟大家做個說明 在XS裡頭有一個BollingerBand的函數，這個函數的腳本如下: 

```
Input: price(numericseries), length(numericsimple), _band(numericsimple);
BollingerBand = Average(price, length) + _band * StandardDev(price, length, 1);
```

意思是說BolingerBand是移動平均加上N個標準差。 然後我們用以下的腳本在畫布林軌道線 

```
input: Length(20), UpperBand(2), LowerBand(2)
variable: up(0), down(0), mid(0)
SetInputName(1, "天數");
SetInputName(2, "上");
SetInputName(3, "下");

up = bollingerband(Close, Length, UpperBand);
down = bollingerband(Close, Length, -1 * LowerBand);
mid = (up + down) / 2;
```

然後畫出up,down,mid三條線，這樣就可以符合這位老兄的操作心法了，我把它畫在加權指數上，其結果就如附圖 為了讓大家可以很簡單的了解投資標的目前所處的位置，我們可以根據這三條線，作出以下的定義 1.股價接近或突破up，代表過熱 2.股價接近或跌破down，代表超跌 3.股價跌破down之後，回頭穿越down，代表反彈 4.股價突破mid代表翻多 5.股價突破up後跌破up代表拉回 6.再跌破mid後代表翻空 如此一來，我們就可以很清楚的標示每一檔個股目前的狀態，以及對應的操作策略。 XS的好處就是每次在報章雜誌上看到別人的操作秘訣，我們總能寫出一個對應的腳本來變成自己的操作策略。 [
![bb](/xstrader-content/uploads/2015/05/bb.png)
](/xstrader-content/uploads/2015/05/bb.png)[

#####


---

# 從細產業資金流向看類股輪動

Source: https://www.xq.com.tw/lesson/indicator/%E5%BE%9E%E7%B4%B0%E7%94%A2%E6%A5%AD%E8%B3%87%E9%87%91%E6%B5%81%E5%90%91%E7%9C%8B%E9%A1%9E%E8%82%A1%E8%BC%AA%E5%8B%95/

到昨天為止，近一週來，產業機械，手工具機，砷化鎵，製藥業等細產業，是漲的比較整齊且幅度較大的細產業，我們如何在一開始的起漲點時，就能掌握住這些主流產業？這是一個值得研究的課題。 為了尋找資金在各細產業間的流動狀況，我寫了一個資金流向指標，腳本如下： 

```
input:short1(5),mid1(12);
setinputname(1,"短期平均");
setinputname(2,"長期平均");
value1=GetField("資金流向");
value2=average(value1,20);
value3=value1-value2;
value4=average(value3,short1);
value5=average(value3,mid1);
plot1(value4,"短期均線");
plot2(value5,"長期均線");
```

這個腳本的意思是，拿當日的資金流向(成交值佔整體市場比重)，去減資金流向的20日平均線，這個值如果大於零，代表流向這個行業的資金，比過去一個月的平均高，反之則代表資金在流出這個行業。 然後再把這個數值算出兩個移動平均，透過不同天期的移動平均，來觀察特定產業資金流入流出的情況。 我們先來看兩張圖。 這一張是製藥業細產業指數的走勢與資金流向指標的連動情況： [
![091401](/xstrader-content/uploads/2015/09/091401.png)
](/xstrader-content/uploads/2015/09/091401.png)[
![091402](/xstrader-content/uploads/2015/09/091402.png)
](/xstrader-content/uploads/2015/09/091402.png)上面這張是手工具機的指標跟資金流向指標的對照圖。 我們可以發現，其實在手工具機指數下跌的末跌段，資金流向指標從七月中之後就開始反轉向上，到了八月初就開始突破零，突破零代表資金是轉成淨流入。 我們可以使用這個指標來觀察及尋找細產業中，那些行業開始在匯集人氣，而那一些則人氣開始在渙散，這樣一來，我們就可以預知那些細產業： [
![091403](/xstrader-content/uploads/2015/09/091403.png)
](/xstrader-content/uploads/2015/09/091403.png)例如今年初面板股上漲時，指數花了兩個半月作頭，但資金流向指標則很明顯的，一直處於零之下，代表資金在持續流出。 以上舉細產業指標為例，說明我們可以運用資金流向這個欄位，寫出資金流向指標，來判斷資金是流入還是流出特定行業，由於細產業指標只有XQ才有提供，使用操盤高手的朋友則不妨拿它來觀察個股的資金變化。 [
![091404](/xstrader-content/uploads/2015/09/091404.png)
](/xstrader-content/uploads/2015/09/091404.png)上圖即是宏捷科這檔熱門股的資金流向指標與股價對照圖。 可以看的出來，以0為基準，基本上可以清楚的顯示出個股資金流入與流出的軌跡。 [

#####


---

# 從MA-Osc指標談指標繪製的技巧

Source: https://www.xq.com.tw/lesson/indicator/%E5%BE%9Ema-osc%E6%8C%87%E6%A8%99%E8%AB%87%E6%8C%87%E6%A8%99%E7%B9%AA%E8%A3%BD%E7%9A%84%E6%8A%80%E5%B7%A7/

[
![8-1](/wp-content/uploads/2016/03/8-1.png)
](/wp-content/uploads/2016/03/8-1.png)小編常常被問到關於XS自訂指標的一個問題是，我怎麼樣可以畫出上漲是紅棒，而下跌是綠棒的圖呢 ? 如果你已經用過了XS自訂指標之後，應該有看過指標繪圖的設定畫面，從這裡可以指定繪圖樣式為柱狀體。 可是，目前XS只支援一個顏色，沒有辦法直接從設定畫面來指定上漲的柱狀體顏色以及跟下跌的柱狀體顏色。那有其他辦法可以辦到嗎？ 答案當然是可以的。 設計的方式，我們一樣來看一下腳本： 

```
input: Length1(5), Length2(10);
SetInputName(1, "天數一");
SetInputName(2, "天數二");
value1 = Average(close, Length1);
value2 = Average(close, Length2);
value3 = (value1 - value2);
Plot1(value3, "MA-Osc");


```

上面的範例是一個很有名的指標，叫做 [移動平均線擺盪指標 ](http://www.moneydj.com/KMDJ/wiki/wikiViewer.aspx?keyid=635abbb6-1fe6-46ab-b309-68d5eb96b6a6)。 這個指標的原理是計算兩條均線之間的差異(短均線─長均線)，用來觀察均線目前是位於多頭排列還是空頭排列，也可以比較清楚的看到交叉的轉折點。 要把這個指標畫出來的話，直接使用線條來描繪當然可以。可是如果是畫成柱狀體的話，會更容易看的出來。所以我們把繪圖方式改成柱狀體， 畫出來的樣子像底下這樣： [
![MA_Osc_0325_02](/wp-content/uploads/2016/03/MA_Osc_0325_02.png)
](/wp-content/uploads/2016/03/MA_Osc_0325_02.png)雖然畫出來了，可是還不夠完美。如果可以把多頭排列區(Value3 > 0)的地方畫成紅色，把空頭排列區(Value3 < 0)的地方畫成綠色的話，那就更好了。 那要怎麼做呢？如果指標的一個plot只能設定一種繪圖方式/顏色的話，那我們是不是可以試著把這個指標變成兩個plot呢？ 

```
input: Length1(5), Length2(10);
SetInputName(1, "天數一");
SetInputName(2, "天數二");
value1 = Average(close, Length1);
value2 = Average(close, Length2);
value3 = (value1 - value2);
if value3 >= 0 then
Plot1(value3, "+MA-Osc")
else
Plot2(value3, "-MA-Osc");


```

稍微修改一下程式，當value3 >= 0的時候，我們畫成Plot1，而value3 < 0的時候，我們畫成Plot2。 這樣子我們就可以把Plot1跟Plot2設定成不同的顏色了！ [
![MA_Osc_0325_03](/wp-content/uploads/2016/03/MA_Osc_0325_03.png)
](/wp-content/uploads/2016/03/MA_Osc_0325_03.png)最後小編要提醒大家，因為Plot1跟Plot2其實都是在畫一樣的數值，所以設定畫面內的座標必須要設成一樣的(在這裡都選I)，才不會畫出來的上下比例不正確。 另外，如果是從K線端，修改完設定之後，可以按【設為XS指標預設值】，以後這個指標就會長這個樣子囉！ 在XS自訂指標還沒有支援雙色的柱狀設定之前，還是可以運用這一篇的技巧來達到一樣的效果。大家如果有類似的需求的話，可以試看看。 [

#####


---

# 改良版的移動平均線~四大力道線

Source: https://www.xq.com.tw/lesson/indicator/%E6%94%B9%E8%89%AF%E7%89%88%E7%9A%84%E7%A7%BB%E5%8B%95%E5%B9%B3%E5%9D%87%E7%B7%9A%E5%9B%9B%E5%A4%A7%E5%8A%9B%E9%81%93%E7%B7%9A/

[
![061002](/xstrader-content/uploads/2015/06/061002.png)
](/xstrader-content/uploads/2015/06/061002.png)我們經常用收盤價作移動平均線，然後尋找不同天期的均線，出現黃金交叉時買進，出現死亡交叉時賣出。 之所以這麼做，是因為我們覺得收盤價是當天多空爭戰的最後結果，所以拿收盤價的移動平均代表了一段時間多空爭戰的軌跡。 但如果我們細看每根K棒，我們其實除了收盤價之外，還有當天的開盤價，最高價，最低價，我們可以運用這些價位，更精確的勾勒出當天多空爭鬥的力道。 就像上面的這張圖 我們可以 1.把每天最高價到收盤價的距離，視為當天上檔的賣壓 2.把每天最低價到收盤價的距離，視為下檔的支撐 3.把每天開盤價到收盤價之間的距離，視為多方或空方的戰績 4.把前一天收盤價到今天開盤價的距離，視為前一日收盤後多空消息消化後的結果 當我們把這種多空力道都考慮進去之後，我們可以計算一段時間這些力道的總和，這樣的總和，會比收盤價更能表現出這檔商品多空力道的消張。 根據這樣的想法，我寫了一個指標，這個指標的寫法如下: 

```
input:days(10),period(20);
setinputname(1,"短期參數");
setinputname(2,"長期參數");

value1=summation(high-close,period);//上檔賣壓
value2=summation(close-open,period); //多空實績
value3=summation(close-low,period);//下檔支撐
value4=summation(open-close[1],period);//隔夜力道
if close<>0
then
value5=(value2+value3+value4-value1)/close;
value6=average(value5,days);
plot1(value5,"四大力道線");
plot2(value6,"移動平均線");
```

[
![061003](/xstrader-content/uploads/2015/06/0610031.png)
](/xstrader-content/uploads/2015/06/0610031.png)我把這個指標稱為四大力道線 從上圖我們可以發現，這個指標在趨勢轉折時，比較可以敏感地偵測出多空力道的微妙變化，在盤整時，則會在零附近呈現鋸齒狀波動。 所以我們可以拿這個指標，來輔助我們找到多空方向在微妙轉變的股票。 [

#####


---

# 新增自訂指標

Source: https://www.xq.com.tw/lesson/indicator/%E6%96%B0%E5%A2%9E%E8%87%AA%E8%A8%82%E6%8C%87%E6%A8%99/

[
![自訂指標](/wp-content/uploads/2016/01/4-1.png)
](/wp-content/uploads/2016/01/4-1.png)在 [XQ全球贏家的臉書專頁 ](https://www.facebook.com/XQ全球贏家-178222061342)內我們會常常會分享一些新的指標，文章內的指標程式碼都是可以直接使用的。 

### **步驟一：複製程式碼 **
首先，我們要從文章上複製指標的程式碼。這邊我們以 [築底指標 ](http://xstrader.net/築底指標-2/)做範例。 打開網頁之後，可以看到圖文並茂的說明。每篇可都是專家們的心血，值得你再三研究。不過我們今天是來教怎麼樣把指標放到XQ裡，所以，請往下找到程式碼的位置。 在每篇文章中，程式碼都是以獨立區塊顯示的，點擊右上角的標記程式碼之後，系統會自動幫你選取要複製的程式碼。請利用右鍵選單將程式碼複製一份下來。 [
![indicator24](/wp-content/uploads/2016/01/indicator24.png)
](/wp-content/uploads/2016/01/indicator24.png)

### **步驟二：開啟XScript編輯器 **
接下來，回到XQ、打開XScript編輯器。 從主選單的 策略→XScript編輯器 [
![indicator23](/wp-content/uploads/2016/01/indicator23-1.png)
](/wp-content/uploads/2016/01/indicator23-1.png)XScript編輯器的版面配置如下： 

- 功能列：功能包括「檔案」、「編輯」、「檢視」、「編譯」、「視窗」、「說明」。 
- 工具列：常用功能可直接點選工具列上的按鈕作操作。 
- 公式區：提供樹狀或清單檢示所有公式。 
- 編輯區：公式腳本的編輯區。 
- 屬性區：顯示所選公式的屬性值。 
- 訊息區：顯示系統或除錯訊息。 
[
![indicator32](/wp-content/uploads/2016/01/indicator32.png)
](/wp-content/uploads/2016/01/indicator32.png)

### **步驟三：新增指標腳本 **
這次的範例是「築底換標」，所以接下來我們來新增一個指標腳本 1. 點擊工具列上的【新增】 [
![indicator33](/wp-content/uploads/2016/01/indicator33.png)
](/wp-content/uploads/2016/01/indicator33.png)，會出現新增腳本視窗 XS腳本一共有四種類型： 

- 指標：可以用於技術分析繪製自訂指標 
- 選股：可以用於選股中心做為選股條件 
- 警示：可以用於策略雷達做為警示條件 
- 函數：如果是會很常重複使用的程式碼，寫成函數腳本後可以被其他腳本引用 
2. 選擇指標腳本 3. 在名稱欄填入「築底指標」 4. 確認新增 [
![indicator25](/wp-content/uploads/2016/01/indicator25.png)
](/wp-content/uploads/2016/01/indicator25.png)5. 在編輯區上剛剛複製的程式碼 6. 點擊工具列上的"編譯" [
![indicator34](/wp-content/uploads/2016/01/indicator34.png)
](/wp-content/uploads/2016/01/indicator34.png)或按下 **F6 **編譯腳本 [
![indicator26](/wp-content/uploads/2016/01/indicator26.png)
](/wp-content/uploads/2016/01/indicator26.png)當訊息視窗顯示編譯成功的訊息時，就完成新增腳本的動作。 如果有錯誤訊息出現，請檢查腳本是否正確。 [
![indicator27](/wp-content/uploads/2016/01/indicator27.png)
](/wp-content/uploads/2016/01/indicator27.png)

### **步驟四：檢視自訂指標 **
現在我們要把寫好的指標腳本放到技術分析看看效果如何 1. 在一般工具列的代碼欄填入商品代碼（例如：2330.TW），然後點擊顯示商品技術分析圖，開啟商品K線。 [
![indicator12](/wp-content/uploads/2016/01/indicator12.png)
](/wp-content/uploads/2016/01/indicator12.png)2. 在技術分析圖上按滑鼠右鍵，可以叫出右鍵選單，選擇 **增加副圖 **開啟新增副圖指標設定視窗。 [
![indicator17](/wp-content/uploads/2016/01/indicator17.png)
](/wp-content/uploads/2016/01/indicator17.png)3. 在搜尋框中輸入 **築 **可以列出所有包含築字的指標。點擊 **築底指標 **，相關屬性設定會顯示在右半邊。 [
![indicator620-1](/wp-content/uploads/2016/01/indicator620-1.png)
](/wp-content/uploads/2016/01/indicator620-1.png)4. 點擊 **完成 **後，就可以看到新增加的築底指標出現在畫面的最下方。 [
![indicator28](/wp-content/uploads/2016/01/indicator28.png)
](/wp-content/uploads/2016/01/indicator28.png)

### **小秘訣 **
設定 **XS指標計算範圍 **，可以加快系統處理的速度，相關說明如下 1. 在技術分析圖上按滑鼠右鍵，可以叫出右鍵選單，選擇 **設定 **開啟技術分析設定視窗。 [
![indicator39](/wp-content/uploads/2017/01/indicator39.png)
](/wp-content/uploads/2017/01/indicator39.png)2. XS指標計算範圍設定說明 資料頻率依 **日線以上 **、 **分鐘 **與 **Tick **區分，下列介紹各資料頻率繪圖的方式 

- 日線以上：預設不勾選。勾選此項，則XS指標計算範圍，依據 **資料筆數 **或 **指定開始日 **選項，開始繪圖。 
- 分鐘、Tick：預設勾選。勾選此項，則XS指標計算範圍，依據 **設定期間 **繪圖；不勾選此項，系統會以所有已下載資料進行運算，可能會有系統延滯的現象。 
[
![indicator620-2](/wp-content/uploads/2017/01/indicator620-2.png)
](/wp-content/uploads/2017/01/indicator620-2.png)3. XS指標計算範圍使用時機為，當您的XS指標，僅需看一段時間到現在的繪圖畫面時，可勾選此項，降低電腦耗能。 [

#####


---

# 新增XS主圖指標

Source: https://www.xq.com.tw/lesson/indicator/%E6%96%B0%E5%A2%9Exs%E4%B8%BB%E5%9C%96%E6%8C%87%E6%A8%99/

[
![新增主圖指標](/wp-content/uploads/2016/01/8-1-1.png)
](/wp-content/uploads/2016/01/8-1-1.png)主圖指標是會疊加在K線上一起繪製的指標。通常是可以提供價格判斷的指標，例如均線、BBand之類的。接下來我們逐步示範如何在主圖上疊加系統內建的 **外資成本線 **指標。 

### **步驟一：開啟K線 **
[
![indicator12](/wp-content/uploads/2016/01/indicator12.png)
](/wp-content/uploads/2016/01/indicator12.png)

### **步驟二：選擇自訂指標 **
在技術分析圖上按滑鼠右鍵，可以叫出右鍵選單，選擇指標設定開啟技術分析設定視窗。 [
![indicator15](/wp-content/uploads/2016/01/indicator15.png)
](/wp-content/uploads/2016/01/indicator15.png)切換到「主圖疊圖」可以疊加寫好的自訂指標。選擇「系統\主圖指標」，雙擊「外資成本」可以將自訂指標加入疊圖指標區。 外資成本線的預設計算期間是20天，你可以自行調整參數值。 [
![indicator05](/wp-content/uploads/2016/01/indicator05.png)
](/wp-content/uploads/2016/01/indicator05.png)

### **步驟三：設定繪圖樣式 **
接下來可以在 **繪圖樣式 **中，變更指標的樣式、粗細、顏色等屬性。 我們把代表外資買進的線調成橘色、把外資賣出線的調成紅色。並且為了比較容易檢視，也把粗細設到第三級。 除此之外，每個指標最多可以設定二個不同的座標。在這邊我們先將二個序列的座標都設成Ⅰ，待會再到 **座標範圍 **去設定座標。 [
![indicator19](/wp-content/uploads/2016/01/indicator19.png)
](/wp-content/uploads/2016/01/indicator19.png)

### **步驟四：設定座標範圍 **
最後一步是設定座標範圍。系統提供了四種設定供你選擇： 

- 自動：系統依照序列中的數值範圍決定繪圖座標。如果是副圖指標的話，一般建議使用這個。 
- 對稱：畫面中央固定為零軸。適合指標數值會在零軸上下擺盪時使用，例如MACD的柱狀體。 
- 自訂：由使用者手動設定座標範圍。 
- 價位座標：使用主圖K棒的座標比例。如果指標是要和K棒一起比較的，請選這個。例如均線或通道指標。 
在這個範例中，因為外資買進成本、外資賣出成本都是要和K線比較的，所以我們把第一座標軸設成 **價位座標 **。 [
![indicator20](/wp-content/uploads/2016/01/indicator20.png)
](/wp-content/uploads/2016/01/indicator20.png)點擊完成後，就可以看到外資成本疊加在主圖。 [
![indicator08](/wp-content/uploads/2016/01/indicator08.png)
](/wp-content/uploads/2016/01/indicator08.png)在下一篇文章內我們將會介紹如果新增一個XS副圖指標，請大家繼續看下去。 [

#####


---

# 新增XS副圖指標

Source: https://www.xq.com.tw/lesson/indicator/%E6%96%B0%E5%A2%9Exs%E5%89%AF%E5%9C%96%E6%8C%87%E6%A8%99/

[
![8-1 (2)](/wp-content/uploads/2016/01/8-1-2.png)
](/wp-content/uploads/2016/01/8-1-2.png)副圖是獨立於主圖之外的顯示區域，用來顯示輔助判斷的資訊。以下我們示範如何新增 **外資累計買賣超 **這一個XS副圖指標。 

### [
![1458891307_arrows-43](/wp-content/uploads/2016/01/1458891307_arrows-43.png)
](/wp-content/uploads/2016/01/1458891307_arrows-43.png)**文字版： **

### 

### **步驟一：開啟K線 **
[
![indicator12](/wp-content/uploads/2016/01/indicator12.png)
](/wp-content/uploads/2016/01/indicator12.png)

### **步驟二：新增副圖指標 **在技術分析圖上按滑鼠右鍵，可以叫出右鍵選單，選擇"增加副圖"開啟新增副圖指標設定視窗。 
[
![indicator17](/wp-content/uploads/2016/01/indicator17.png)
](/wp-content/uploads/2016/01/indicator17.png)在搜尋框中輸入 **外資 **可以列出所有包含外資的指標。選擇「XS指標\系統\籌碼指標」，點擊 **外資累計買賣超 **。外資累計買賣超的相關屬性設定會顯示在右半邊。預設計算期間是5天，你可以自行調整參數值。 

### **步驟三：設定繪圖樣式 **
接下來可以在 **繪圖樣式 **中，變更指標的樣式、粗細、顏色等屬性。 為了方便觀察（或是美觀）可以為不同的序列設定不同的型式。我們把累計買賣超設定為柱圖、比例%設定為線條。 除此之外，每個指標最多可以設定二個不同的座標。把累計買賣超的座標都設成Ⅱ，待會再到 **座標範圍 **去設定座標。 

### **步驟四：設定座標範圍 **
接下來是設定座標範圍。系統提供了四種設定供你選擇： 

- 自動：系統依照序列中的數值範圍決定繪圖座標。一般副圖指標建議使用這個。 
- 對稱：由使用者自訂對稱的水平位置（預設是0）。適合指標數值會在某個中心水準上下擺盪時使用，例如MACD的柱狀體。 
- 自訂：由使用者手動設定座標範圍，並可設定最大值或最小值。 
- 價位座標：使用主圖K棒的座標比例。如果指標是要和K棒一起比較的，請選這個。例如均線或通道指標。 
注意！只有第一座標軸的刻度會顯示在畫面上。 在這個範例中，因為在外資累計買賣超中，零軸是買超或賣超的分界線，所以第一和第二座標軸都設成 **對稱 **。並且希望顯示的刻度是外資進出比例，因此剛剛在繪圖樣式那邊把累計買賣超的座標設成Ⅱ。 

### **步驟五：設定查價視窗 **
最後，如果你對於數值的呈現有特殊的要求，可以再設定查價視窗顯示的數值格式。 

- 數值顯示：可以指定數值的單位。 

  - 完整顯示：顯示原始的數值。 
  - %：顯示百分比數值，例如0.01會顯示成1%。 
  - 萬/億：顯示以萬或億為單位的值，例如10,000顯示成1萬、100,000,000顯示成1億。 
  - 萬/百萬：顯示以萬或百萬為單位的值，例如10,000顯示成1萬、1,000,000顯示成1百萬。 
  - 千/百萬：顯示以千或百萬為單位的值，例如1,000顯示成1千、1,000,000顯示成1百萬。 
  - K/M/B：顯示以K（千）、M（百萬）或B（十億）為單位的值，例如10,000顯示成10K、1,000,000顯示成1M、1,000,000,000顯示成1B。 
  - 隱藏：可以只繪圖而不在查價視窗顯示數值。這個可以用於標示超買超賣的水準。 

- 小數格式：可以指定數值顯示的小數位數（整數或1~4位小數）。 
點擊 **完成 **後，就可以看到新增加的外資累計買賣超副圖出現在畫面的最下方。 [
![indicator21](/wp-content/uploads/2016/01/indicator21.png)
](/wp-content/uploads/2016/01/indicator21.png)在這一篇跟


---

# 短線止跌的訊號

Source: https://www.xq.com.tw/lesson/indicator/%E7%9F%AD%E7%B7%9A%E6%AD%A2%E8%B7%8C%E7%9A%84%E8%A8%8A%E8%99%9F/

股市老手常勸戒我們，千萬不要伸手去接正在往下掉的刀子，但又老是有人跟我們說要危機入市，兩邊說的都有道理，但貿然去接又怕套在半山腰，最好是能夠有什麼訊號讓我們看到時，可以知道已經有大咖的進場在這邊護盤了，今天要介紹的就是這種連續好幾天都留下影線的股票。 我們怎麼找出近來低檔有撐的股票呢，請參考以下的腳本 

```
input:short1(5),mid1(20);
setinputname(1,"短期平均");
setinputname(2,"長期平均");
if truerange<>0
then begin
if close<=open
then
value1=(close-low)/truerange*100
else
value1=(open-low)/truerange*100;
end;
value2=average(value1,short1);
value3=average(value2,mid1);

plot1(value2,"短期均線");
plot2(value3,"長期均線");
```

這個腳本的概念是找出下影線佔真實波動區間的比例，然後看看這數據短天期的移動平均線是不是遠大於長天期的移動平均，如果發生這種情況，就表示近幾日股價下跌時都有一股拉回來的力量在支撐。 以光環為例，請參考下圖 [
![010701](/xstrader-content/uploads/2016/01/010701.png)
](/xstrader-content/uploads/2016/01/010701.png)當這種情況出現時， 短線上至少有反彈空間。 不過要提醒大家的是，逆市作多手腳要快，看不對還是得走啊~！ [

#####


---

# 短線過熱的指標

Source: https://www.xq.com.tw/lesson/indicator/%E7%9F%AD%E7%B7%9A%E9%81%8E%E7%86%B1%E7%9A%84%E6%8C%87%E6%A8%99/

[
![0605](/xstrader-content/uploads/2015/06/0605.png)
](/xstrader-content/uploads/2015/06/0605.png)放寬漲跌幅之後，短線大家追逐強勢股的趨勢更加明顯，這時候最怕的就是愛到最高點，愛到反轉點。 我研究這些強勢股的多空轉折點時，發現股價在大漲後，如果成交量暴增，當沖及融資買進佔成交量比重接近六成時，往往是短線過熱的一個指標，這種股票就不宜再追高，如果手中有持股，不妨先獲利了結。 基於這樣的觀察，我寫了一個指標： 

```
input:p1(5);
setinputname(1,"移動平均線天期");
value1=GetField("融資買進張數");
value2=GetField("現股當沖張數");
value3=GetField("資券互抵張數");

value4=value1+value2+value3;

if volume>0
then value5=value4/volume;
value6=average(value5,p1);

plot1(value5,"短線交易比例");
plot2(value6,"移動平均線");
```

從腳本的寫法看得出來，這個指標是在計算融資買進加資券互抵加現股當沖合計佔成交張數的比例。 我們以最近最熱的旅遊股雄獅做例子。 股票短線急漲後，出現量增且短線交易比例接近0.6時，股價就出現反轉了。 基於這樣的指標，我寫了一個選出短線過熱股票的選股腳本： 

```
input:p1(5),p2(20),p3(15);
setinputname(1,"成交量比前一天多?%");
setinputname(2,"漲幅計算區間");
setinputname(3,"區間漲幅下限");

settotalbar(100);

value1=GetField("融資買進張數");
value2=GetField("現股當沖張數");
value3=GetField("資券互抵張數");

value4=value1+value2+value3;

if volume>0
then value5=value4/volume;

if volume>volume[1]*(1+p1/100)
and value5>=0.59
and close>close[p2-1]*(1+p3/100)
then ret=1;
```

各位不妨把這腳本拿出選股，看看短線過熱後股票後市怎麼走？ [

#####


---

# 研判主力有沒有落跑的自訂指標

Source: https://www.xq.com.tw/lesson/indicator/%E7%A0%94%E5%88%A4%E4%B8%BB%E5%8A%9B%E6%9C%89%E6%B2%92%E6%9C%89%E8%90%BD%E8%B7%91%E7%9A%84%E8%87%AA%E8%A8%82%E6%8C%87%E6%A8%99/

股票大跌時，開始有朋友會問小編：「你覺得XXX該砍還是該留？」 我個人在研判這件事時，主要是靠幾個籌碼面的自設指標，用來判斷主力有沒有跑掉，以及這檔股票是不是只剩散戶在買。 我的邏輯是如果主力沒有跑掉，也還站在買方，那就有解套波的可能，如果盤沒有太差我就等反彈再來賣，反之，我就認賠了。 要如何偵測主力跑了沒？我用的是控盤者買超比例，散戶買進比例及散戶賣出比例這三個指標。 XS把每一檔股票每一家分公司每一個價位買進金額超過100萬的稱為控盤者買進張數，同樣的標準，也算出了每檔股票的控盤者賣出張數，兩者的差就是控盤者買賣超。 XS也把每一檔股票每一家分公司每一個價位交易金額低於50萬的稱為散戶買進及散戶賣出。 我們透過Getfield 的語法可以把這三個欄位拿來設計成自訂指標，我分別寫了以下的幾個腳本。 第一個腳本如下： 

```
input:period(5);
value1=GetField("散戶買張");
if volume<>0 then 
value2=value1/volume*100;
value3=average(value2,period);
plot1(value3,"散戶買進比例");
```

第二個腳本如下： 

```
input:period(5);
value1=GetField("散戶賣張");

if volume<>0 then value2=value1/volume*100;
value3=average(value2,period);
plot1(value3,"散戶賣出比例");
```

第三個腳本如下： 

```
value1=GetField("控盤者買賣超張數");
 
if value1>0 then value2=value1 else value3=value1; 
if value1>0 then begin plot1(value2); 
noplot(value3); 
end else 
begin plot2(value3); 
noplot(value2); 
end;
```

從這三個腳本做自訂指標時，我們可以透過這些指標來研究主力跑掉了沒有？ 
1. 如果控盤者從買超變賣超那就要小心主力在落跑 2. 如果散戶買進比例跳昇，這也是主力落跑的跡象 3. 如果散戶賣出比例降低，代表賣的極可能是主力。 舉幾個圖為例： [
![散戶賣出指標](/xstrader-content/uploads/2016/01/散戶賣出指標.png)
](/xstrader-content/uploads/2016/01/散戶賣出指標.png)[
![散戶買進比例的例子](/xstrader-content/uploads/2016/01/散戶買進比例的例子.png)
](/xstrader-content/uploads/2016/01/散戶買進比例的例子.png)[
![控盤者仍買超](/xstrader-content/uploads/2016/01/控盤者仍買超.png)
](/xstrader-content/uploads/2016/01/控盤者仍買超.png)智邦控盤者仍買超，可成的控盤者就已經落跑了。 [
![控盤者跑一陣子了](/xstrader-content/uploads/2016/01/控盤者跑一陣子了.png)
](/xstrader-content/uploads/2016/01/控盤者跑一陣子了.png)以上是我的研判方式，大家可以根據這些欄位，設計出更迷人的策略。 [

#####


---

# 進出場訊號-置頂、置底、最高、最低

Source: https://www.xq.com.tw/lesson/indicator/%E9%80%B2%E5%87%BA%E5%A0%B4%E8%A8%8A%E8%99%9F-%E7%BD%AE%E9%A0%82%E3%80%81%E7%BD%AE%E5%BA%95%E3%80%81%E6%9C%80%E9%AB%98%E3%80%81%E6%9C%80%E4%BD%8E/

[
![如何讓你在繪製訊號](/wp-content/uploads/2017/07/08.png)
](/wp-content/uploads/2017/07/08.png)看過上一篇 [如何繪製進出場訊號 ](https://www.xq.com.tw/learn/indicator/createbuynsellsignals/)的文章後，相信大家現在對於進出場點的繪製不陌生了，今天小編要來介紹如何讓你在繪製訊號時，更方便的用法。 同樣使用例子來說明如何在K線圖繪製訊號，小編用收盤價站上或跌破5日均線上當作繪製訊號的依據。 腳本如下： 

```
value1 =1;
value2 =2;

if close > average(close,5) 
then
plot1(value1,"置頂");

if close < average(close,5)
then
plot2(value2,"置底");

value3 =3;
value4 =4;

if close[1] > average(close,5) 
then
plot3(value3,"最高");

if close[1] < average(close,5) 
then
plot4(value4,"最低");

```

由於主要是介紹繪圖功能，小編盡量用較簡單的腳本當作範例，其餘的就請各位自行發揮使用啦。 將指標疊加到主圖上後，畫面預設會是線條的圖型， 同樣至XS編輯器左邊的公式面板中，找到腳本，點擊右鍵開啟選單，選擇繪圖設定開啟繪圖設定視窗。 [
![繪圖設定](/wp-content/uploads/2017/07/繪圖設定.png)
](/wp-content/uploads/2017/07/繪圖設定.png)首先把樣式變更為點，每個點其實就是一個預設的圖示， 我們把進場樣式設成，把出場樣式設定成 ；顏色也同時調成橘色和紅色。 [
![繪圖樣式1](/wp-content/uploads/2017/07/繪圖樣式1.png)
](/wp-content/uploads/2017/07/繪圖樣式1.png)到這邊之前的操作方式都與


---

# PlotLine語法的介紹

Source: https://www.xq.com.tw/lesson/indicator/plotline%E8%AA%9E%E6%B3%95%E7%9A%84%E4%BB%8B%E7%B4%B9/

大家好，今天來跟大家介紹一個XS指標的新功能：PlotLine，用來繪製直線。 

## 設計目的 
大家都知道，可以透過指標腳本的Plot(...)語法，在每一根bar洗價時，畫出指標的數值，所以如果要畫一條直線的話，可以在每次Plot時都傳入同一個數值(水平線)，或是依照預期的斜率算出Y的數值，就可以產生直線的效果。 可是透過Plot語法，每次都是畫一個點，而且是畫在洗價的那一根bar上面。如果我希望繪製一條趨勢線，例如底下黃色的這條線： [
![](/wp-content/uploads/2023/10/PlotLine1-e1698387465500.png)
](/wp-content/uploads/2023/10/PlotLine1.png)這條水平線，是這檔商品今年以來迄今的最高價格，我希望可以把這條線畫出來，當成是一個可能的壓力。可是這樣子的趨勢線，目前Plot語法是辦不到的： 

- 我們想要計算的是從今年開始到昨日為止的最高價，所以腳本必須跑到昨日那一根bar，才能算出這個數值。 
- 當腳本算出最高點是546.0時，這時候已經跑到昨日了。之後只能把這個數值畫在昨日的點，以及未來的點上面，可是沒有辦法往回畫！ 

## 基本使用方式 
針對這樣子的需求，我們提供了一個新的PlotLine的語法，讓指標腳本可以更自由的繪製直線。 PlotLine的基本語法如下： 
---

```
PlotLine(序列編號, x1, y1, x2, y2)
PlotLine(序列編號, x1, y1, x2, y2, "序列名稱")
```

---
首先，必須傳入一個序列編號。序列編號的意義跟Plot語法是一樣的，代表這是這個指標的第幾條線，範圍從1到999。 請注意，一個指標腳本內可以同時呼叫Plot(...)以及PlotLine(...)，每次呼叫Plot或是PlotLine時都必須指定一個序列編號，這些序列編號會共用這個1到999的範圍，也就是說，每一個Plot/PlotLine的編號必須是不同的才不會產生問題。 接下來要傳入這條線的起點跟終點， 每一個點包含兩個數值，第一個數值是這個點的X座標，第二個數值是這個點的Y座標 。 X座標的單位是 第幾根bar ，從1開始，一直到CurrentBar。 Y座標的單位則是 價位 ，也就是從Open、High、Low、Close等演算出來的數值。 除了傳入起點/終點的座標之外，也可以傳入序列名稱，用法與Plot語法是一樣的。 接下來我們來看一個簡單的範例： 
---

```
{ 從畫面第一點畫一條水平線，位置是目前最新的收盤價 }
PlotLine(1, 1, Close, CurrentBar, Close, “最新價”);
```

---
我們把上面的指標命名為PlotClose，然後用主圖疊圖的方式把PlotClose加到圖上面： [
![](/wp-content/uploads/2023/10/PlotLine2-e1698387483724.png)
](/wp-content/uploads/2023/10/PlotLine2.png)跟一般的Plot一樣，可以選擇繪圖樣式等參數，不過如果是PlotLine的話，那麼形式就只能選擇線條，或是線段，不能選擇其他的樣式，畢竟我們想要畫的是一條線，對吧！ 按完成之後，接下來在技術分析圖上面就可以看到這個PlotLine的效果了： [
![](/wp-content/uploads/2023/10/PlotLine3-e1698387527301.png)
](/wp-content/uploads/2023/10/PlotLine3.png)

## 重畫的行為 
我們回過頭來思考一下這個指標腳本執行的過程。 我們知道指標腳本會跑過資料區間內的每一根bar，所以 

- 在跑資料區間的第一根bar時，腳本呼叫PlotLine，起點是(1, 第一根bar的close)，終點是(1, 第一根bar的close)。 
- 跑資料區間的第二根bar時，腳本呼叫PlotLine， 起點是(1, 第二根bar的close), 終點是(2, 第二根bar的close)。 
- 跑第三根bar時, 繼續呼叫PlotLine，起點是(1, 第三根bar的close)，終點是(3, 第三根bar的close)。 
- 一直到最新一根bar，這時候起點是(1, 最新一根bar的close), 終點是(CurrentBar, 最新一根bar的close)。 
那麼，指標呼叫了這麼多次PlotLine，傳入的起點/終點的位置都不一樣，為何只會畫出一條線呢？ 這個表示，當腳本呼叫PlotLine時，預設的行為會把同一個繪圖序列 先前的PlotLine清掉，然後用這一次傳入的起點/終點來取代 ，所以腳本重複的呼叫PlotLine，最後顯示出來的是最後一次呼叫PlotLine的結果。 

## 線條跟線段的差異 
先前我們有提到PlotLine可以選擇以線條或是線段的方式來繪製，那這兩者有什麼區別呢？ 我們用底下的範例來說明： 
---

```
{ 畫出過去N日(不包含當日)的最高價/最低價 }

input: days(5);

if BarFreq <> "Min" then return;
if Date <> Date[1] then begin
    value1 = Highest(GetField("High", "D")[1], days);
    value2 = Lowest(GetField("Low", "D")[1], days);
    PlotLine(1, 1, value1, CurrentBar, value1, "Max");
    PlotLine(2, 1, value2, CurrentBar, value2, "Min");
end;
```

---
我們把這個腳本存成「PlotMinMax」，然後把這個指標用主圖疊圖的方式放到0050的5分K線圖上面。如果我們選擇的是「線條」的話，呈現方式如下圖： [
![](/wp-content/uploads/2023/10/PlotLine4-e1698387545879.png)
](/wp-content/uploads/2023/10/PlotLine4.png)其中紅色的水平線代表的是最近5日(不含最新一日，也就是不含5/19日)的最高價，綠色的水平線代表的是最近5日的最低價。 同樣的指標，我們如果選擇的是「線段」的話，那麼呈現的方式如下圖： [
![](/wp-content/uploads/2023/10/PlotLine5-e1698387558725.png)
](/wp-content/uploads/2023/10/PlotLine5.png)注意到這兩張圖的差別是，當使用線段時，5/19日的資料都沒有畫出來。 我們來看看腳本的寫法，好理解為何會有這樣子的差異： 

- 因為是統計過去N日的資料，所以只在換日的時候做一次統計(if Date <> Date[1])。 
- 算出區間高點跟區間低點之後，上面的腳本也只會在換日的時候才呼叫PlotLine。 
依照先前的討論，每一次呼叫PlotLine時，都會清掉先前的PlotLine重畫。所以以紅色這條線來說，最後一次呼叫PlotLine時傳入的起點是(1, 5月14~5/18日的最高價)，終點則是(5/19的起點，5月14~5/18日的最高價)。 如果選擇的是「線段」的話，那麼繪圖的範圍就依照指定的起點/終點。 可是如果選擇的是「線條」的話，那麼系統就會自動依照這條線的斜率，把「終點」一路延伸到最新的一根bar，所以當5/19日有新的K棒出現時，這兩條PlotLine也會自動的畫出來，產生類似射線的效果。 請注意： 

- 所謂的起點跟終點，是以傳入的X座標來決定， 起點永遠在終點的左邊 ，也就是說PlotLine(1, 5, 5, 10, 10)跟PlotLine(1, 10, 10, 5, 5)的效果是一樣的。 
- 選擇「直線」的話，只會自動延伸終點到最新一根bar，不會自動從PlotLine的起點往左邊延伸。 

## 如何繪製多個區段 
趨勢線未必就是一條直線，也有可能是由多個線段所組合而成的。例如底下這張圖裡面顯示的zigzag指標： [
![](/wp-content/uploads/2023/10/PlotLine6-e1698387571656.png)
](/wp-content/uploads/2023/10/PlotLine6.png)如果要畫出藍色的這條線，肯定必須要呼叫好幾次PlotLine，每次繪製一個線段，然後把這些線段接起來。可是先前我們有提到如果重新呼叫PlotLine時，先前繪製的線會被塗掉，那我們要怎麼呼叫PlotLine才能達到這樣子的效果呢？ 如果我們希望呼叫PlotLine時，保留目前已經畫好的線，不要去清除他的話，那麼可以使用add這個參數： 
---

```
PlotLine(序列編號, x1, y1, x2, y2, add:=1)
PlotLine(序列編號, x1, y1, x2, y2, "序列名稱", add:=1)
```

---
add是一個optional的參數，預設的數值是0，表示每次呼叫時就清除先前的線條。可是如果我們傳入1的話，那麼效果就是不清除先前的線條，而是把這次想要畫的線條 疊加 上去。透過這個參數，我們就可以畫出上圖zigzag指標的效果了！ 底下是一個使用add參數的範例： [
![](/wp-content/uploads/2023/10/PlotLine7-e1698387581529.png)
](/wp-content/uploads/2023/10/PlotLine7.png)這個指標腳本使用add參數，在每一日的分K圖上面畫出了CDP指標的五條線。程式碼如下： 
---

```
if BarFreq <> "Min" then RaiseRunTimeError("請跑分鐘頻率");

var: HH(0), LL(0), CC(0);
var: CDP(0), AH(0), NH(0), NL(0), AL(0);

if Date <> Date[1] then begin
    // 換日
    // 
    HH = GetField("High", "D")[1];
    LL = GetField("Low", "D")[1];
    CC = GetField("Close", "D")[1];
    CDP = (HH + LL + 2*CC) / 4;
    AH = CDP + HH - LL;
    NH = 2*CDP - LL;
    NL = 2*CDP - HH;
    AL = CDP - (HH - LL);
    PlotLine(1, CurrentBar, CDP, CurrentBar, CDP, "CDP", add:=1);
    PlotLine(2, CurrentBar, NH, CurrentBar, NH, "NH", add:=1);
    PlotLine(3, CurrentBar, NL, CurrentBar, NL, "NL", add:=1);
    PlotLine(4, CurrentBar, AH, CurrentBar, AH, "AH", add:=1);
    PlotLine(5, CurrentBar, AL, CurrentBar, AL, "AL", add:=1);
end;
```

---
在每一天換日時，計算當日的CDP指標，同時使用add:=1的參數把今日的CDP指標疊加到圖上面。 底下是指標的繪圖設定方式： [
![](/wp-content/uploads/2023/10/PlotLine8-e1698387590327.png)
](/wp-content/uploads/2023/10/PlotLine8.png)因為CDP是水平線，他的數值在每一天開盤時就可以決定，所以我們不需要每一根bar都呼叫PlotLine，可以使用「線條」的方式，讓CDP指標自動延伸到今天最新的一根bar。 另外眼尖的讀者應該有注意到在這個指標腳本內呼叫PlotLine時，起點跟終點的X座標都是一樣的，例如起點是(CurrentBar, CDP)，終點也是(CurrentBar, CDP)。當起點跟終點的X座標都是同一個數值時，系統會認定這就是一條水平線(斜率=0)，所以腳本只需要在換日時呼叫PlotLine一次就可以把這一整天的CDP指標都畫好了。 

## 其他進階用法 

### 可以清掉線條嗎? 
如果腳本在某些情境底下想要把先前畫好的直線清掉的話(類似NoPlot(..))，那可以怎麼做呢？ 
---

```
if condition1 then PlotLine(1, 0, 0, 0, 0);   // 清掉這條線
```

---
可以像上面這樣子寫，把起點/終點都設定成0，就可以清掉目前的線了。 

### 起點終點重疊的定義 
先前我們有提過呼叫PlotLine時可以透過add參數來保留先前已經畫好的直線。可是如果這一次傳入的座標與先前畫好的直線重疊的話，那會發生什麼事情？ 舉例： 

- 先呼叫 PlotLine(1, 1, 100, 50, 100) 
- 再呼叫 PlotLine(1, 25, 200, 100, 200, add:=1) 
首先我們畫出了(1, 100) ~ (50, 100)的一條水平線。 接下來我們要畫(25, 200) ~ (100, 200)的另外一條水平線，同時希望保留先前的直線。 由於XS的PlotLine的機制底層還是是透過Plot的方式來實做，所以每一個X位置，只會畫出一個點。 當繪圖的X範圍遇到重疊時(例如上面從x = 25到x=50的區塊)，目前的作法就是讓後面的PlotLine覆蓋先前的PlotLine。所以上面這兩次PlotLine就會產生以下的結果： 

- (1, 100) ~ (24, 100)的水平線，加上 
- (25, 200) ~ (100, 200)的水平線 

### PlotLine的限制 
在其他與XS類似的產品內，也有類似PlotLine的功能。例如Multichart有TL的 [相關語法 ](https://www.multicharts.com/trading-software/index.php?title=Category:Trendline_Drawing)，TradingView也有 [Lines的語法 ](https://www.tradingview.com/pine-script-docs/en/v5/concepts/Lines_and_boxes.html#lines)。 XS的PlotLine與這些語法最大的差異是，PlotLine的底層還是是一種Plot，所以會受到以下的限制： 

- 每個PlotLine必須指定一個繪圖序列，而且這個繪圖序列的數值必須是一個constant，不能動態的定義。 
- 每個PlotLine的繪圖序列，在一個X位置上，只會有一個Y值，所以沒有辦法繪製垂直線。 
使用者在設計腳本時，請留意這些限制，我們也會持續努力，讓PlotLine的功能可以更加的強大。 [

#####


---

# 商品盤勢_XS指標：支援「主圖疊圖」

Source: https://www.xq.com.tw/lesson/indicator/trendsupportsmainimageoverlay/

### 1. 功能概述 

在 **XQ **版本 **7.17.01 / 3.17.01 250923 **中，商品盤勢頁面新增支援 **XS 指標 **加入主圖疊圖的功能。   
如下示意圖所示，主圖中疊加的 **SAR 指標 **即為 **XS 指標 **於商品盤勢頁面主圖疊圖的呈現樣貌。 

[
![](/wp-content/uploads/2025/10/XS主圖疊圖_01.png)
](/wp-content/uploads/2025/10/XS主圖疊圖_01.png)

---

### 2. 操作說明 

以下為在商品盤勢頁面中，將 **XS 指標 **加入主圖疊圖的操作步驟： 

- 進入商品盤勢頁面。 
- 點擊滑鼠右鍵，選擇「設定」，進入技術分析設定畫面。 
- 在技術分析設定畫面上方的標籤頁中，新增所需的疊圖至商品盤勢主圖。 

- 可在此畫面中加入欲顯示的 **XS 指標 **。 
- 可調整 **XS 指標 **的參數設定、繪圖樣式、座標範圍與查價視窗等。 
- 設定完成後，按下「完成」按鈕，即可完成 **XS 指標 **主圖疊圖的設定操作。 
[
![](/wp-content/uploads/2025/10/XS主圖疊圖_02.png)
](/wp-content/uploads/2025/10/XS主圖疊圖_02.png)
---

### 3. 聯絡方式 

以上為「商品盤勢 XS 指標：支援主圖疊圖」的功能說明與操作步驟。   
若有任何問題或建議，請來信至客服信箱 [XQservice@XQ.com.tw ](mailto:XQservice@XQ.com.tw)與我們聯繫。 
[

#####


---

# XS指標的錯誤代碼說明

Source: https://www.xq.com.tw/lesson/indicator/xs%E6%8C%87%E6%A8%99%E7%9A%84%E9%8C%AF%E8%AA%A4%E4%BB%A3%E7%A2%BC%E8%AA%AA%E6%98%8E/

大家好，XS 指標腳本編譯完成後，加入主圖疊圖或副圖指標時， 因為有時候會只有出現錯誤代碼，但不會敘述錯誤原因，如下圖： [
![](/wp-content/uploads/2022/10/6c2ba883-1236-477a-b9f4-acbd00312af0_0127-1.jpg)
](/wp-content/uploads/2022/10/6c2ba883-1236-477a-b9f4-acbd00312af0_0127-1.jpg)所以本篇文章會以列表的方式，告知大家 XS 指標各個錯誤代碼代表的錯誤原因， 列表如下，提供給大家參考： 錯誤代碼 錯誤原因說明 1002 腳本物件產生失敗。 1003 腳本參數設定錯誤。 1004 腳本物件不存在。 1008 計算停止，計算模組還沒準備好。 1009 計算停止，因為計算發生錯誤，請檢查腳本內的算式。 1010 計算停止，取得資料欄位錯誤, 可能是因為「最大引用」數值小於腳本需要的資料範圍。 1011 計算停止，執行錯誤。 如果使用者有設定錯誤訊息，則使用使用者自訂的錯誤訊息。 1012 取得腳本參數錯誤。 1013 取得腳本Plot參數錯誤，例如Plot名稱，Plot每個點上面的名稱。 1017 商品代碼不存在（可能原因：商品已下市） 1021 歷史 K 棒資料用網址取得時出現異常（可能原因：伺服器異常） 1022 歷史 K 棒資料在語法分析時出現問題（可能原因：DB資料格式有誤） 1023 歷史資料欄位用網址取得時出現異常（可能原因：伺服器異常） 1024 歷史資料欄位在語法分析時出現問題（可能原因：DB資料格式有誤） 1025 不支援此商品。 1026 不支援此頻率。 1027 不支援此欄位資料。 1028 資料欄位無法取負值，請更改輸入設定。 1030 取資料錯誤。 1031 資料欄位個數為0。 1032 不支援歷史K棒資料（開高低收量） 1034 腳本版號不符合目前XQ版號。 1035 體驗帳號，無付費欄位資料的權限。 1036 腳本期限已到。 1037 切商品要停止計算。 1039 執行前檢查腳本，並進行編譯時失敗。 1040 指標腳本不支援Quote報價欄位資料語法。 1041 Tick資料用網址取得時出現異常（可能原因：伺服器異常） 1042 Tick資料在語法分析時出現問題（可能原因：即時資料格式有誤） 1043 不支援的語法。 如果看了上述的說明，仍有疑問無法排除，請提供以下資訊，並mail至 [XQservice@XQ.com.tw ](mailto:XQservice@XQ.com.tw)，會有專人安排釐清，謝謝： 1. 問題描述。 2. 有問題的完整畫面截圖。 3. 頁面匯出檔案，匯出時請勾選「匯出頁面中『XS指標』的自訂腳本」 4. 指標腳本匯出檔案。 5. Log資料夾壓縮檔案，預設路徑：C:\SysJust\XQLite\LOG [

#####


---

# XS指標高手分享篇

Source: https://www.xq.com.tw/lesson/indicator/xs%E6%8C%87%E6%A8%99%E9%AB%98%E6%89%8B%E5%88%86%E4%BA%AB%E7%AF%87/

[
![8-1 (4)](/wp-content/uploads/2016/03/8-1-4.png)
](/wp-content/uploads/2016/03/8-1-4.png)在這裡我們蒐集了一些高手分享的XS指標，這裡面的文章都有提供指標內容以及應用方式，大家可以複製到XQ操盤高手內跑看看。也歡迎大家加入我們的 [臉書專頁 ](https://www.facebook.com/XQ全球贏家-178222061342)，我們會不定期的分享更多的應用，更歡迎您隨時跟我們交流。 

- [研判主力有沒有落跑的自訂指標 ](http://xstrader.net/研判主力有沒有落跑的自訂指標/)
- [什麼時候起就不能當死多頭? ](http://xstrader.net/什麼時候起就不能當死多頭?)
- [尋找底部到了的領先指標 ](http://xstrader.net/尋找底部到了的領先指標)
- [主力作多成本線 ](http://xstrader.net/主力作多成本線)
- [改良版的移動平均線~四大力道線 ](http://xstrader.net/改良版的移動平均線~四大力道線)
- [布林通道指標 ](http://xstrader.net/布林通道指標)
- [短線過熱的指標 ](http://xstrader.net/短線過熱的指標)
- [短線止跌的訊號 ](http://xstrader.net/短線止跌的訊號)
- [從細產業資金流向看類股輪動 ](http://xstrader.net/從細產業資金流向看類股輪動)
- [修正式價量指標VPT(Volume price trend) ](http://xstrader.net/修正式價量指標vptvolume-price-trend/)
[

#####


---

# XS實戰7門課

Source: https://www.xq.com.tw/lesson/intro/

[
![XS實戰教學首頁](/wp-content/uploads/2016/03/05_00.png)
](/wp-content/uploads/2016/03/05_00.png)每天辛苦作投資功課，可是股票這麼多，市場上一堆訊息，我該怎麼驗證跟判斷呢？每天早上打開看盤程式，螢幕閃來閃去，價格忽紅忽綠，用眼睛一直叮著看，深怕錯失投資時機，可是人又不是機器，難道沒有更好的方法嗎？ 那就讓電腦來協助你，更有效率的找標的吧！ 程式交易可以讓你每天要做的功課自動化：電腦可以自動幫你監控觀察名單中的股票，即時幫你篩選哪些股票出現買進訊號？又有哪些股票出現賣出訊號？電腦也可以幫你從海量的資料庫內找出投資的契機，有沒有哪些好的標的超跌了可以開始留意，又有哪些股票的價格已經跟他的營收脫勾了需要小心。 更重要的是，這些篩選的方式都是隨時可以調整的，一旦掌握了箇中奧秘，你的招式就可以千變萬化，不管大盤多空，都可以隨時找出應用的方式。 那～程式交易語法，是不是一定要會寫程式才學的會？會不會很難學？怎麼學？是不是要上很貴的課程？ 在【XS實戰7門課】的系列課程內，就讓我們從最簡單的觀念講起，一路講到如何實戰應用，讓不會寫程式的人學會寫程式，而且還是寫程式交易的程式！ 現在就跨出學習的第一步，開始上課吧！ [

#####


---

# 第一堂: 寫第一支程式

Source: https://www.xq.com.tw/lesson/intro/lesson1/

[
![XS實戰7門課_01](/wp-content/uploads/2016/03/XS實戰7門課_01.png)
](/wp-content/uploads/2016/03/XS實戰7門課_01.png)”寫程式！我又不是科班出身的，怎麼可能會寫程式！” 這是內心小劇場的聲音嗎？ 別擔心，別害怕，其實學會和電腦溝通並不困難。 七堂課的終極目標就是可以把你的投資邏輯一步一步的讓電腦明白，然後替你去執行，打造出獨一無二的投資秘笈。 點選下面影片，開始上課囉！ 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之一-.ppt)。 本堂重點摘要： 

- 了解「敘述」與「腳本」。 
- 學會「回傳值」、「運算子」、「標點符號」、「常數」、「忽略字」、「輸出語法」。 
- 寫出第一個腳本。 
[

#####


---

# 第二堂: 腳本的重要元素

Source: https://www.xq.com.tw/lesson/intro/lesson2/

[
![XS實戰7門課_02](/wp-content/uploads/2016/03/XS實戰7門課_02.png)
](/wp-content/uploads/2016/03/XS實戰7門課_02.png)學武之人都知道，馬步紮得穩，功夫才會好。 學習程式語言也一樣，基礎概念紮實，觀念清楚，底子打好，才能練就一身好絕學。 不會寫程式的朋友，一定要先服用第一堂課的內容。 上過第一堂課的朋友，請接著上第二堂囉！ 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之二-.pptx)。 本堂重點摘要： 

- 了解「變數」、「參數」與「函數」。 
- 學習「GetField」與「GetQuote」語法。 
[

#####


---

# 第三堂: 如何把投資思維串成自動化交易

Source: https://www.xq.com.tw/lesson/intro/lesson3/

[
![XS實戰7門課_03](/wp-content/uploads/2016/03/XS實戰7門課_03.png)
](/wp-content/uploads/2016/03/XS實戰7門課_03.png)工欲善其事，必先利其器。 在投資思維轉換成自動化交易的流程中，除了策略形成外，XQ提供的「自訂指標」、「策略警示」、「選股中心」功能，是完整策略發展的重要輔助工具。 這堂課是要教大家如何使用XS策略模組功能，一定不要錯過喔！ 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之三.ppt)。 本堂重點摘要： 

- 了解「XS編輯器」、「自訂指標」、「策略警示」、「選股中心」的用途。 
- 運用上列功能設定自動交易。 
[

#####


---

# 第四堂: 流程控制

Source: https://www.xq.com.tw/lesson/intro/lesson4/

[
![XS實戰7門課_04](/wp-content/uploads/2016/03/XS實戰7門課_04.png)
](/wp-content/uploads/2016/03/XS實戰7門課_04.png)邏輯思考，是解決問題的關鍵。 在投資決策上，更是如此。 這堂課進入更深入的程式交易語法學習，首先要學的是流程控制的語法， 藉由”Input-Process-Output ”的思考流程，一步步把策略想法換成一行行程式語法。 話不多說直接看影片！ 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之四.ppt)。 本堂重點摘要： 

- 流程控制概念。 
- 學習條件判斷與迴圈語法。 
- 演算法介紹。 
[

#####


---

# 第五堂: 常用的函數

Source: https://www.xq.com.tw/lesson/intro/lesson5/

[
![XS實戰7門課_05](/wp-content/uploads/2016/03/XS實戰7門課_05.png)
](/wp-content/uploads/2016/03/XS實戰7門課_05.png)單字，是學習英文的基礎。 在程式語言的世界裡，知道越多的「函數」，可以節省腳本撰寫的速度，降低撰寫的難度。 這堂課要介紹常用的函數，開始上課吧！ 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之五.ppt)。 本堂重點摘要： 

- 學會常用的時間函數、數學函數、邏輯判斷函數、趨勢分析函數。 
除了影片中介紹的函數外，系統還有很多很多的函數語法可以運用（ [請點我！ ](http://xshelp.xq.com.tw/lists.aspx?a=GENERALFUNC)）， [
![xshelp](/wp-content/uploads/2016/03/xshelp.png)
](/wp-content/uploads/2016/03/xshelp.png)記得越多的函數語法，對於腳本的撰寫越事半功倍喔！ [

#####


---

# 第六堂: 籌碼分析與價量指標的應用

Source: https://www.xq.com.tw/lesson/intro/lesson6/

[
![XS實戰7門課_06](/wp-content/uploads/2016/03/XS實戰7門課_06.png)
](/wp-content/uploads/2016/03/XS實戰7門課_06.png)先恭喜各位，程式交易基本上學到第五堂就算可以出師了！（握拳！） 不過，好還要更好，學無止盡， 在最後兩堂課中，著重在語法的應用，透過許多案例，學到語法撰寫的技巧。 這次先了解籌碼分析與價量指標的應用。 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之六.ppt)。 本堂重點摘要： 

- 籌碼分析常用欄位。 
- 開高低收四個價位衍生的相關欄位。 
- 股性分析。 
- 技術分析的基本演算法。 
[

#####


---

# 第七堂: 實戰應用

Source: https://www.xq.com.tw/lesson/intro/lesson7/

[
![XS實戰7門課_07](/wp-content/uploads/2016/03/XS實戰7門課_07.png)
](/wp-content/uploads/2016/03/XS實戰7門課_07.png)XS實戰七門課的最終回，重點放在操盤應用。 在這一系列由基礎到應用的課程，可以把你的投資邏輯一步一步的讓電腦明白，然後替你去執行。 學習程式交易的過程，挫敗是難免，常常寫出來的跟自己想的不一致，只要常問、常看範例，慢慢地就會上手。 這堂課分享了許多寶貴的投資知識，請仔細收看！ 附件： [投影片請點此下載 ](/wp-content/uploads/2016/03/程式交易的七堂課之七.ppt)。 本堂重點摘要： 

- 交易時機常用腳本。 
- 大盤分析。 
- 選股法則。 
- 企業生命週期。 
[

#####


---

# 如何新增警示

Source: https://www.xq.com.tw/lesson/sensor/%E6%96%B0%E5%A2%9E%E8%AD%A6%E7%A4%BA/

[
![XS策略雷達_01_a](/wp-content/uploads/2016/01/XS策略雷達_01_a.png)
](/wp-content/uploads/2016/01/XS策略雷達_01_a.png)在 [XQ全球贏家的臉書專頁 ](https://www.facebook.com/XQ全球贏家-178222061342)內我們會常常會分享一些警示腳本。現在就為你示範如何把文章內的腳本設定成策略雷達的操作步驟。 首先，我們要從文章複製腳本的程式碼。這邊我們以 [糾結均線突破 ](https://www.xq.com.tw/xstrader/?s=糾結均線突破)做範例。 打開網頁之後，可以看到圖文並茂的說明。每篇可都是專家們的心血，值得你再三研究。不過我們今天是來教怎麼樣把腳本變成可以執行的策略雷達，所以，請往下找到程式碼的位置。 在每篇文章中，程式碼都是以獨立區塊顯示的，點擊右上角的 **標記程式碼 **之後，系統會自動幫你選取要複製的程式碼。請利用右鍵選單將程式碼複製一份下來。 [
![radar07](/wp-content/uploads/2016/01/radar07.png)
](/wp-content/uploads/2016/01/radar07.png)

### **步驟二：開啟XScript編輯器 **
接下來，回到XQ、打開XScript編輯器。 從主選單的 策略→XScript編輯器 [
![indicator23](/wp-content/uploads/2016/01/indicator23.png)
](/wp-content/uploads/2016/01/indicator23.png)
> XScript編輯器的版面配置如下： 

- 功能列：功能包括「檔案」、「編輯」、「檢視」、「編譯」、「視窗」、「說明」。 
- 工具列：常用功能可直接點選工具列上的按鈕作操作。 
- 公式區：提供樹狀或清單檢示所有公式。 
- 編輯區：公式腳本的編輯區。 
- 屬性區：顯示所選公式的屬性值。 
- 訊息區：顯示系統或除錯訊息。 
`[
![indicator32](/wp-content/uploads/2016/01/indicator32.png)
](/wp-content/uploads/2016/01/indicator32.png)`

### **步驟三：新增警示腳本 **
接下來我們來新增一個警示腳本 1. 點擊工具列上的"新增" [
![indicator33](/wp-content/uploads/2016/01/indicator33.png)
](/wp-content/uploads/2016/01/indicator33.png)，會出現新增腳本視窗 
> XS腳本一共有四種類型： 

- 指標：可以用於技術分析繪製自訂指標 
- 選股：可以用於 **選股中心 **做為選股條件 
- 警示：可以用於 **策略雷達 **做為警示條件 
- 函數：如果是會很常重複使用的程式碼，寫成函數腳本後可以被其他腳本引用 
2. 選擇警示腳本 3. 在名稱欄填入「糾結均線突破」 4. 確認新增 [
![radar08](/wp-content/uploads/2016/01/radar08.png)
](/wp-content/uploads/2016/01/radar08.png)5. 在編輯區上剛剛複製的程式碼 6. 點擊工具列上的"編譯" [
![indicator34](/wp-content/uploads/2016/01/indicator34.png)
](/wp-content/uploads/2016/01/indicator34.png)或按下 **F6 **編譯腳本 [
![radar09](/wp-content/uploads/2016/01/radar09.png)
](/wp-content/uploads/2016/01/radar09.png)當訊息視窗顯示 **編譯成功 **的訊息時，就完成新增腳本的動作。 
> 如果有錯誤訊息出現，請檢查腳本是否正確。 `[
![radar10](/wp-content/uploads/2016/01/radar10.png)
](/wp-content/uploads/2016/01/radar10.png)`

### **步驟四：加入策略雷達 **
現在我們要把寫好的警示腳本放到策略雷達中執行 1. 在寫好的警示腳本上按滑鼠右鍵，可以叫出右鍵選單，選擇 **加入策略雷達 **，系統會自動開啟新增策略雷達視窗。 [
![radar11](/wp-content/uploads/2016/01/radar11.png)
](/wp-content/uploads/2016/01/radar11.png)2. 設定要監控的商品。 [
![radar03](/wp-content/uploads/2016/01/radar03-1.jpg)
](/wp-content/uploads/2016/01/radar03-1.jpg)3. 點擊 **加入 **，警示腳本就已經加入策略雷達並開始執行。 [
![radar13](/wp-content/uploads/2016/01/radar13.png)
](/wp-content/uploads/2016/01/radar13.png)
> 注意到策略雷達現在前面亮著的綠燈了嗎？燈號代表著策略雷達執行狀態，一共有四種：綠燈 [
![radar14](/wp-content/uploads/2016/01/radar14.png)
](/wp-content/uploads/2016/01/radar14.png)：正常執行。紅燈 [
![radar15](/wp-content/uploads/2016/01/radar15.png)
](/wp-content/uploads/2016/01/radar15.png)：執行出現錯誤。黃燈 [
![radar16](/wp-content/uploads/2016/01/radar16.png)
](/wp-content/uploads/2016/01/radar16.png)：部份商品正常執行，部份商品出現執行異常。灰燈 [
![radar17](/wp-content/uploads/2016/01/radar17.png)
](/wp-content/uploads/2016/01/radar17.png)：停止執行。 OK，到這裡，如果警示正常執行的話，你就不用盯著螢幕看了，等到有符合警示條件的商品出現時，系統就會跳出警示視窗。 [

#####


---

# 策略雷達串接下單

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E4%B8%B2%E6%8E%A5%E4%B8%8B%E5%96%AE/

[
![串接自動下單](/wp-content/uploads/2016/03/XS策略雷達_06.png)
](/wp-content/uploads/2016/03/XS策略雷達_06.png)XS策略雷達觸發下單的功能，讓您的訊號從觸發到下單一氣呵成，往全自動交易又邁進了一大步。 之前我們使用「策略雷達」，在條件成立跳出訊號時，最快速的方法就是點擊「警示視窗」裡面的「下單」按鈕，把商品資訊帶入下單列。常常稍一猶豫，價格就跑了好幾檔。 在看完了影片介紹後，各位用戶是不是想要馬上體驗一下策略雷達的下單功能了呢？為了各位用戶方便設定，底下文章會用文字敘述的方式一一帶大家走過下單設定，以及啟動觸發下單的流程。 在開始說明前，各位用戶要先知道，只有自訂策略可以做下單設定，系統中所提供的系統策略是無法使用觸發串下單的功能，這一點要請用戶注意唷！ 

### **下單方式選擇 **
在「策略雷達」的警示清單中選擇一個要設定觸發下單的自訂策略，並點選下方功能頁籤中的「下單設定」，就會進入到下單設定的功能入口。 [
![下單方式選擇1](/wp-content/uploads/2016/03/下單方式選擇1.png)
](/wp-content/uploads/2016/03/下單方式選擇1.png)用戶們也可以利用自訂策略的右鍵選單，點選裡面的「下單設定」項目，系統也一樣會跳到「下單設定」功能頁籤。 [
![下單方式選擇2](/wp-content/uploads/2016/03/下單方式選擇2.png)
](/wp-content/uploads/2016/03/下單方式選擇2.png)如果所選定的策略還未完成下單設定，在進入到「下單設定」介面時，系統會先顯示提示文字，說明由左側點選合適的下單模組，我們可以點擊左側的「下單模組」來開始設定策略的觸發下單方式。 [
![下單方式選擇3](/wp-content/uploads/2016/03/下單方式選擇3.png)
](/wp-content/uploads/2016/03/下單方式選擇3.png)可以看到畫面的左邊是可供挑選的下單模組；目前系統有提供「證券限價單」、「證券限價定時單」、「證券平倉單」、「期權限價單」、「期權限價定時單」、「期權平倉單」六種委託類型，用戶們可以依照不同的策略，選擇不同的下單模組來設定。 

### **下單參數設定 **
當點選了下單模組後，系統會在右邊顯示模組的參數設定內容，每個下單模組的內容都不大一樣，用戶們可以依據自己的需求來選擇模組，而用戶們也可以自行調整參數設定，以下我們就用「證券限價單」這個下單模組來說明下單參數介面： 

- 1. 交易帳號設定：提供下拉選單，挑選觸發後要下單的交易帳號 
- 2. 觸發設定：提供觸發後的下單方向，以及買單&賣單時所對應的委託條件 
- 3. 下單數量：可以選擇每次觸發時的下單數量或金額 
- 4. 下單價格：可以設定每次觸發時的下單價格，目前可以指定「成交價」，或是「觸發價」 
- 5. 策略安全設定：設定「下單總次數」，以及「下單總金額」的安全設定，確保下單時的風險控管 [
![下單參數設定1](/wp-content/uploads/2016/03/下單參數設定1.png)
](/wp-content/uploads/2016/03/下單參數設定1.png)
在「1. 交易帳號設定」下拉選單的右邊有個「設定交易帳號」按鈕，點選這個按鈕可以叫出「交易帳號管理」介面，用戶們可以利用這介面來新增其他的交易帳號 [
![下單參數設定2](/wp-content/uploads/2016/03/下單參數設定2.png)
](/wp-content/uploads/2016/03/下單參數設定2.png)不過想必用戶們跟小編一樣是一個謹慎小心的使用者，在使用策略雷達下單功能前，一定想先確認訊號觸發後所帶的下單委託，是不是和「下單參數」中所設定的一樣，以及這個策略是否有達到心目中的預期成效，這時就可以使用 [「XQ模擬交易帳號」 ](https://www.xq.com.tw/learn/beginner/simulate/)，在使用XQ模擬交易帳號下，系統會將策略觸發時的下單委託給傳送到模擬交易後台，來模擬真實的交易狀況，這樣用戶就可以確認委託單的狀況，以及策略的成效。 而要如何使用「 [XQ模擬交易帳號 ](https://www.xq.com.tw/learn/beginner/simulate/)」呢？很簡單，每個XQ用戶都會內建兩個模擬交易帳號，不用做任何設定，只要登入XQ系統後就會自動登入，所以在「1. 交易帳號設定」下拉選單中，自動就會產生這兩組帳號，分別為「 **證-模擬交易(內建)-01 **」＆「 **證-模擬交易(內建)-02 **」用戶們可以針對不同的策略來使用不同的帳號，這樣更可以比較出策略的成效‧ [
![下單參數設定3](/wp-content/uploads/2016/03/下單參數設定3-1.png)
](/wp-content/uploads/2016/03/下單參數設定3-1.png)當下單參數設定完成後，用戶們只要按下「儲存」按鈕，系統就會將設定儲存完成，注意！在完成設定前，請再次確認「5. 策略安全設定」是否有填入符合用戶所能夠接受的下單總次數&下單總金額，以確保做好下單的風險控管。 [
![下單參數設定4](/wp-content/uploads/2016/03/下單參數設定4-1.png)
](/wp-content/uploads/2016/03/下單參數設定4-1.png)

### **啟動觸發帶下單 **
當我們為策略完成下單設定後，必須開啟「觸發下單」開關，這樣當策略在執行時，系統才會在有商品觸發的同時送出委託，用戶們可以在任何時候調整這個開關(包含策略在執行時)，如果在策略執行時關閉「觸發下單」，系統在下次觸發出現時，就不會送出委託。 有兩種方式可以開啟「觸發下單」。 

- 1. 下單設定的左上角 
- 2. 警示清單的下單欄位 
- [
![啟動觸發帶下單1](/wp-content/uploads/2016/03/啟動觸發帶下單1.png)
](/wp-content/uploads/2016/03/啟動觸發帶下單1.png)
當我們開啟「觸發下單」開關後，我們可以開始執行這個策略，當有商品觸發後，系統就會執行下單的動作，用戶們可以在這個策略的「執行紀錄」頁籤中(底下第四個功能頁籤)，查詢到觸發下單的紀錄。 [
![啟動觸發帶下單2](/wp-content/uploads/2016/03/啟動觸發帶下單2.png)
](/wp-content/uploads/2016/03/啟動觸發帶下單2.png)而系統所送出的委託單，用戶們可以至主選單「交易」底下的「證券委託查詢」頁面，確認剛剛所下的委託單狀況。 [
![啟動觸發帶下單3](/wp-content/uploads/2016/03/啟動觸發帶下單3.png)
](/wp-content/uploads/2016/03/啟動觸發帶下單3.png)

### **分類項目：可觸發下單&觸發下單執行中 **
在「策略雷達」左邊分類區中，有兩個分類是和觸發下單的策略有相關，分別是「可觸發下單」&「觸發下單執行中」這兩個分類。 「可觸發下單」分類中，會列出已經設定好下單設定的策略，顧名思義，「下單設定」如果沒完成的策略，是不會在這個分類中出現，讓用戶們可以方便管理。 [
![可觸發下單](/wp-content/uploads/2016/03/可觸發下單.png)
](/wp-content/uploads/2016/03/可觸發下單.png)而「觸發下單執行中」的分類中，則會列出「觸發下單」已開啟且正在執行的策略 [
![觸發下單執行中](/wp-content/uploads/2016/03/觸發下單執行中.png)
](/wp-content/uploads/2016/03/觸發下單執行中.png)文章到介紹到這裡已經接近尾聲，希望各位XS的用戶們可以藉由這篇文章來了解策略雷達串下單的操作流程，在這裡預祝大家投資順利!! [

#####


---

# 策略雷達回測功能介紹

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E5%9B%9E%E6%B8%AC%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%B4%B9/

[
![回測](/wp-content/uploads/2016/03/XS策略雷達_05.png)
](/wp-content/uploads/2016/03/XS策略雷達_05.png)在熟悉「策略雷達」的使用方式後，相信各位用戶應該開始嘗試執行「策略雷達」所提供的系統策略了吧？還是更進一步將腦中的進/出場的方法寫成警示了呢？ 不過無論是使用系統提供，又或者是自己所寫的，各位用戶一定在想這個警示的成效如何？這時就可以利用策略雷達的「回測功能」來模擬驗證了。 而什麼是「回測」呢？回測就是利用過去一段時間的資料，來評估方法(警示)的可行性。 在「策略雷達」的回測功能中，提供了商品過去的歷史資料，用戶們可以利用歷史資料來模擬警示在過去一段時間中商品的進/出場狀況＆報酬率成效！ 

### **執行回測的入口 **
回測可以從兩個地方執行，一個是從「XScript編輯器」中，點選「回測」按鈕來執行；另一個是從「策略雷達」右鍵選單中的「執行回測...」項目。 

- 從「XScript編輯器」中，開啟要執行回測的警示腳本，然後點選「回測」按鈕來執行回測 
[
![IDE(1)](/wp-content/uploads/2016/04/IDE1.png)
](/wp-content/uploads/2016/04/IDE1.png)

- 也可以在「策略雷達」右鍵選單中，點選「執行回測...」來執行回測 
[
![sensor(2)](/wp-content/uploads/2016/04/sensor2.png)
](/wp-content/uploads/2016/04/sensor2.png)

### **設定回測參數，完成設定後開始執行回測 **
[](#)在上一段說明中，我們知道「回測功能」有兩個入口，不管從哪個入口，系統都會叫出「執行回測設定」介面，而介面配置如下： 

- 1. 回測參數區：設定回測頻率、區間、商品及交易方向。 
- 2. 腳本參數區：設定進場/出場腳本（6.20新功能）及出場條件。 
- 3. 交易參數區：設定每筆「單邊」交易費用與期貨商品的保證金成數。 

  - 證券單邊交易費用說明：「系統會依照交易成本的設定來調整執行時所顯示的損益數值。使用者可以依照所選擇券商的交易費用填入對應的交易成本數值。」 
  - 舉例來說，假設證券手續費折數為 3 折，手續費率為 0.1425 %；交易稅率為 0.3 %，則單邊交易費用約為 0.19 %＝((0.1425%\*0.3\*2)+0.3%)/2 

[
![](/wp-content/uploads/2016/05/%E5%9B%9E%E6%B8%AC%E5%8F%83%E6%95%B8%E5%8D%80.png)
](/wp-content/uploads/2016/05/%E5%9B%9E%E6%B8%AC%E5%8F%83%E6%95%B8%E5%8D%80.png)在這介面中，用戶們可以依據自己需求來調整回測參數。 在6.20版中，出場方式新增了指定出場腳本的功能。使用者在出場的部份，也可以用警示腳本來達成客製化的出場條件。還可以搭配內建的停利、停損或最大持有時間的出場條件，使用上更便利！不過，這4種出場方式一定要勾選一種，否則無法開始執行回測喔！！ 當參數設定完成後，用戶們就可以點選介面中右下角的「開始回測」按鈕，點選後系統就會開始執行回測功能。 

### **回測執行狀態說明 **
系統在開始執行回測後，會出現「回測執行狀態」介面，用戶可以利用這介面確認回測正在執行狀態。「回測執行狀態」介面配置如下： 1. 啟動時間：顯示回測開始執行的時間。 2. 腳本名稱：顯示被執行回測的腳本名稱（並不是策略雷達的命名，這一點請用戶注意!!） 3. 執行狀態：顯示回測執行完成度百分比。 4. 停止回測按鈕：讓回測停止執行的按鈕。 [
![status(3)](/wp-content/uploads/2016/04/status3.png)
](/wp-content/uploads/2016/04/status3.png)如果在回測執行過程中，用戶們要停止執行，可以點選「4.停止回測按鈕」，點選後系統會確認是否要停止回測執行(參考下面圖示)，如果停止當下已經有部份商品執行完畢，可以勾選「顯示已經完成的結果」，這樣在按下「確定」按鈕後，系統除了停止執行回測外，也會顯示已經執行完畢的回測結果。 [
![stop(4)](/wp-content/uploads/2016/04/stop4.png)
](/wp-content/uploads/2016/04/stop4.png)

### **檢視回測結果 **
當回測執行完成(或者是中途停止回測然後顯示部份回測結果)，系統就會開啟「回測報告」介面顯示回測的統計數據。 

- 用戶們可以從「整體統計」中，看到警示腳本整體的回測結果 
[
![backtest620-04](/wp-content/uploads/2017/01/backtest620-04.png)
](/wp-content/uploads/2017/01/backtest620-04.png)

- 在「商品統計表」中，是用列表示來顯示所有商品的回測結果，用戶們可以利用列表的排序功能，來快速找到自己想找尋的商品，例如：我們可以針對「總報酬率」做排序，就可以快速找到報酬率最高的商品。這時用戶們可以點擊這檔商品的「商品名稱」，系統就會帶到這檔商品的「商品分析」頁面。 
[
![backtest620-05](/wp-content/uploads/2017/01/backtest620-05.png)
](/wp-content/uploads/2017/01/backtest620-05.png)

- 在「商品分析」頁面中，除了會顯示這檔商品的回測統計數據外，用戶們也可以看到這檔商品在這段回測期間的走勢圖，在走勢圖中，系統也會標示每筆交易的進場/出場時間。 
[
![backtest620-06](/wp-content/uploads/2017/01/backtest620-06.png)
](/wp-content/uploads/2017/01/backtest620-06.png)

- 而「商品分析」中的「明細表」，則是將每筆交易列成Table，在這邊可以清楚看到每筆交易的交易價格及報酬率資訊。 
[
![backtest620-09](/wp-content/uploads/2017/01/backtest620-09.png)
](/wp-content/uploads/2017/01/backtest620-09.png)

### **「回測報告」的儲存＆匯出功能 **

- 用戶們如果想要將回測報告儲存下來，可以利用介面中的「儲存」功能將回測報告儲存下來。 
[
![backtest620-10](/wp-content/uploads/2017/01/backtest620-10.png)
](/wp-content/uploads/2017/01/backtest620-10.png)

- 而儲存下來的檔案則可以利用「XScript編輯器」來開啟 
[
![open save](/wp-content/uploads/2016/03/11.png)
](/wp-content/uploads/2016/03/11.png)

- 如果想要使用報告中的統計數據，則可以利用介面中的「匯出」功能，系統會將報告匯出成xlsx的檔案，檔案中會包含整體統計、商品統計表、單商品分析等資料。 
[
![backtest620-11](/wp-content/uploads/2017/01/backtest620-11.png)
](/wp-content/uploads/2017/01/backtest620-11.png)

### **重新回測 **
如果對回測結果不符合預期也沒關係。點擊「重新回測」，再微調一下回測的參數，看看回測結果是否會有改善。 [
![backtest620-12](/wp-content/uploads/2017/01/backtest620-12.png)
](/wp-content/uploads/2017/01/backtest620-12.png)看完了以上介紹，是不是已經了解了要如何對警示腳本做回測了呢？如果要更進一步的了解「執行回測設定」中各個參數的設定方式，以及「回測報告」的數據意義，可以參考以下章節，祝大家投資順利!!! 

- [策略雷達回測功能：「回測參數」說明 ](https://www.xq.com.tw/learn/sensor/backtestparameters/)
- [策略雷達回測功能：「回測報告」說明 ](https://www.xq.com.tw/learn/sensor/backtestreport/)

#### 
[

#####


---

# 策略雷達回測功能：「回測參數」說明

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E5%9B%9E%E6%B8%AC%E5%8A%9F%E8%83%BD%EF%BC%9A%E3%80%8C%E5%9B%9E%E6%B8%AC%E5%8F%83%E6%95%B8%E3%80%8D%E8%AA%AA%E6%98%8E/

[
![回測參數說明及設定](/wp-content/uploads/2016/04/XS策略雷達_03.png)
](/wp-content/uploads/2016/04/XS策略雷達_03.png)各位XS的用戶，想必已經開始使用「策略雷達」的「回測功能」了吧！不過在執行回測前，要先在執行回測設定介面把參數設定完成後才能執行。在這篇文章中，我們會從「策略雷達」的使用角度為您說明參數的設定方式。 文章內容包含「基本參數設定」、「進出場參數設定」、「交易參數設定」、「其餘設定」。 [
![](/wp-content/uploads/2016/04/%E5%9B%9E%E6%B8%AC%E8%A8%AD%E5%AE%9A%E9%A0%81%E9%9D%A2.png)
](/wp-content/uploads/2016/04/%E5%9B%9E%E6%B8%AC%E8%A8%AD%E5%AE%9A%E9%A0%81%E9%9D%A2.png)

### **基本參數設定 **
「基本參數設定」包含以下參數 [
![](/wp-content/uploads/2016/04/%E5%9F%BA%E6%9C%AC%E5%8F%83%E6%95%B8%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2016/04/%E5%9F%BA%E6%9C%AC%E5%8F%83%E6%95%B8%E8%A8%AD%E5%AE%9A.png)

#### 1. 交易方向 
交易方向預設選項會依據策略雷達本身的多空而定，如果設定為 **多 **，系統就會選擇「作多」；若設定為 **空 **，則系統就會選擇「作多」；如果策略雷達本身沒有設定方向，系統預設為「作空」。用戶們也可以自行調整交易方向 以下為作多/作空的動作定義： 

- 作多：回測過程中，如果有觸發商品，系統會模擬 **買進 **觸發商品，此為作多的進場動作。 
- 作空：回測過程中，如果有觸發商品，系統會模擬 **賣出 **觸發商品，此為做空的進場動作 

#### 2. 執行頻率 
執行頻率是決定回測進行時所使用的頻率資料，用戶可以依據參數中所提供的頻率自行調整。 預設會先設定成策略雷達本身使用的頻率，例如：如果策略雷達本身的頻率設定為「日」頻率，「執行頻率」的設定就是「日」。 

#### 3. 開始/結束日期 
開始/結束日期是決定回測的開始和結束時間，用戶可以自行調整區間範圍。 舉例來說，如果開始日期為「2016/1/6」，結束日期為「2016/4/6」，當系統開始執行回測後，在「2016/1/6～2016/4/6」區間中如果有觸發商品，系統就會依據交易方向來模擬進場，如果到了2016/4/6日結束時，還有未出場的商品，系統就會強迫將這些商品出場。 開始/結束的預設區間是近3個月，用戶可以自行調整區間範圍。不過系統重新啟動後，就會回復成預設區間，這一點要請用戶留意。 

#### 4. 執行商品 
執行商品是決定回測執行時的商品範圍。範圍的來源有五種：商品(可複選)、組合(自選+系統)、選股、庫存、檔案，用戶可以自行調整成所需要的範圍。 預設會先設定成策略雷達本身使用的商品範圍，例如：如果策略雷達本身的執行商品是「組合-上市櫃普通股全部」，當叫出執行回測設定介面時，「執行商品」也會設定成「組合-上市櫃普通股全部」。 在v6.40中，有了「選股回測」的新功能，使用策略雷達回測時，也同時支援「選股」來源，系統會依照當日收盤後選出的股票，在隔日執行策略觸發判斷進出場。 

### **進出場參數設定 **
「進出場參數設定」包含以下參數 [
![](/wp-content/uploads/2016/04/%E9%80%B2%E5%87%BA%E5%A0%B4%E5%8F%83%E6%95%B8%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2016/04/%E9%80%B2%E5%87%BA%E5%A0%B4%E5%8F%83%E6%95%B8%E8%A8%AD%E5%AE%9A.png)

#### 1. 腳本參數 
這裡會顯示策略雷達腳本中所有的參數，預設會使用策略雷達本身的設定，用戶也可以自行調整參數數值。 

#### 2. 模擬逐筆洗價 
「模擬逐筆洗價」是讓回測執行時，為了貼近當時K棒的發展來洗價，策略雷達的逐筆洗價是每一次的成交都會執行腳本，而這邊會分為兩種狀況，舉例來說： 執行頻率為「日」頻率情況下，回測功能為了更接近實際狀況，使用當天的1分鐘K棒來判斷是否需要進場。 執行頻率為「週」、「月」頻率情況下，模擬逐筆洗價則會使用日資料做洗價，判斷是否有達成進場條件。如果不啟用，系統只會用該頻率每一筆K棒最後的開、高、低、收、量來判斷是否需要進場。 用戶們可以自行決定回測執行時要不要模擬逐筆洗價。 

#### 3. 最大同時進場次數 
最大同時進場次數是指定回測過程中同時在進場狀態的交易個數上限，用戶可以選擇不勾選。 

- 不勾選「最大同時進場次數」：表示在回測過程中，只要有商品觸發，系統就會進場，沒有任何限制。 
- 勾選「最大同時進場次數」：系統會先檢查當下還未出場的交易個數，如果等於「最大同時進場次數」所設定的數值，就算有商品觸發也不再進場。 
例如：「最大同時進場次數」設定為5，回測當下未出場的交易個數也為5，此時如果又有商品觸發，這時系統就不會對這檔商品做進場動作。 

#### 4. 進/出場價格 
進/出場價格有兩種選項提供設定，分別為下期開盤價、當期收盤價。選擇下期開盤價，代表當策略觸發時，會在下一根的K棒的開盤價進/出場，若是當期收盤價，則是策略出發時，會以當根K棒的收盤價為進/出場。 

#### 5. 出場方式 
在回測設定介面中提供三種出場方式：停利、停損、最大持有時間，用戶可以複選多個出場方式，不過至少要勾選一種。回測過程中，當價格有符合任一個出場條件時，系統就會執行反向平倉的動作。 底下為這三種出場方式的說明： 

- 停利：提用戶設定停利的比例。如果回測過程中使用當下的價格出場所獲得的利益>=進場價格 \* **[停利的比例] **，系統會執行出場動作。 
- 停損：提供用戶設定停損的比例。如果回測過程中使用當下的價格出場所失去的損失>=進場價格 \* **[停損的比例] **，系統會執行出場動作。 
- 最大持有時間：提供用戶設定持有期間。如果進場後經過設定的持有期間還未出場，系統就會強制執行出場動作。 
最大持有期間的設定，在v6.40中調整成兩種不同的規則，以下舉例說明： 

#### 規則一：分鐘頻率 
分鐘頻率有「期數」、「天數」可以設定。「期數」會根據所設定的頻率來計算，舉例來說：如果回測的執行頻率為「1分鐘」頻率，而最大持有期間設定為5；如果回測過程中有商品觸發，當下觸發的K棒就當成第1期，如果到了第5期(也就是第5分鐘)還未出場的話，系統就會以第5期結束時下一期的開盤價進行出場動作。「天數」則是按天來計算，舉例來說：如果最大持有期間設定為1；回測過程中有商品觸發，當下觸發的日期會當成第1日，到了隔日開盤前未出場的話，系統會以隔日的開盤價做出場動作。 

#### 規則二： 
日頻率以上，期數會根據所設定的頻率來計算，舉例來說：如果回測的執行頻率為「日」頻率，而最大持有期間設定為5；如果回測過程中有商品觸發，當下觸發的日期就當成第1期，如果到了第5期(也就是第5日)還未出場的話，系統就會以第5期結束時下一期的開盤價進行出場動作 

### **交易參數設定 **
「交易參數設定」包含以下參數 [
![](/wp-content/uploads/2016/04/%E4%BA%A4%E6%98%93%E5%8F%83%E6%95%B8%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2016/04/%E4%BA%A4%E6%98%93%E5%8F%83%E6%95%B8%E8%A8%AD%E5%AE%9A.png)

#### 1. 股票交易費用 
交易費用是設定單次交易的交易費用比例。 舉例來說，如果交易費用比例0.3%，而某次台股商品交易的進場價格為100元，出場價格為105元，在交易單位為1的情況下，交易費用就是(100+105) \* 1 \* 0.3% = 0.615 

#### 2. 期貨交易費用 
設定期貨單次交易的交易費用比例，分為「元」跟「%」。「元」是設定固定的金額，而「%」的計算方式同股票交易費用的算法。 

#### 3. 期貨保證金成數 
期貨的保證金成數是用來定義進場成本，舉例來說，當進場點數為10000，期貨保證金成數設定為10%，則進場成本為10000\*10%=1000 

### **其餘設定 **
「其餘設定」包含以下參數 [
![](/wp-content/uploads/2016/04/%E5%85%B6%E9%A4%98%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2016/04/%E5%85%B6%E9%A4%98%E8%A8%AD%E5%AE%9A.png)

#### 1. **啟動腳本內Print指令 **
腳本內如果有print指令，勾選此指令選項，可以將相關運算資料儲存下來，輸出相關資料成文字檔，作為其他的應用。 看到這邊，是不是已經了解如何設定回測參數了呢？下一篇我們會繼續說明要如何來看「 [回測報告 ](https://www.xq.com.tw/learn/sensor/backtestreport/)」。 [

#####


---

# 策略雷達回測功能：「回測報告」說明

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E5%9B%9E%E6%B8%AC%E5%8A%9F%E8%83%BD%EF%BC%9A%E3%80%8C%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E3%80%8D%E8%AA%AA%E6%98%8E/

[
![回測報告](/wp-content/uploads/2016/04/XS策略雷達_04.png)
](/wp-content/uploads/2016/04/XS策略雷達_04.png)各位XS的用戶，在對「策略雷達」執行回測後，最重要的工作就是在回測報告中確認執行的成效!! 各位XS的用戶，在對「策略雷達」執行回測後，最重要的工作就是在回測報告中確認執行的成效！ 在這篇文章中，我們將為您介紹「回測報告」中的四種顯示模式。詳情如下： 

### 

### **整體統計 **
整體統計是用來顯示策略績效的全面報告。 為了可以更客觀評估策略投資組合的投資績效，從XQv6.40起各項整體統計數值計算改時間加權報酬（Time Weighted Returns, TWR）的方式計算。時間加權報酬通常被用於衡量基金的投資績效，主要考量的是策略訊號對策略績效的影響，而非資金流入、流出造成的績效變動。 由於時間加權報酬率的計算方式，即使是相同報酬率的二筆交易，在不同的時間對策略績效的影響有可能會不同。某些用來評估單筆交易而非策略部位的數值項目（例如最大獲利率），我們會特別在後面標註單筆，代表這些項目的值僅考慮單筆進出場點的計算，而非策略績效的貢獻度。 另外，現在每筆交易的報酬率，在股票商品會納入除權息再投資，在期貨商品則會去除換月價差影響，讓報酬率變得更為精確。不過，為了方便使用者於圖表上比對進出場點，我們在交易分析中顯示的進出場價仍然是回測頻率的點位，而非計算報酬所用的價格。 整體統計是顯示回測的整體報告，用戶們可以參考底下的說明。 [
![](/wp-content/uploads/2018/07/%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A_%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88_6.43.png)
](/wp-content/uploads/2018/07/%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A_%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88_6.43.png)

#### 回測設定顯示 
這裡主要是顯示回測的參數設定，讓用戶們可以知道回測的資料範圍區間、腳本所輸入的參數，以及交易設定的設定內容‧ 針對回測的商品範圍部分，系統會將執行結果顯示在「執行商品個數」欄位，裡面內容會呈現執行成功/失敗的商品數量，用戶們可以點擊失敗的個數link，點擊後系統會跳出執行失敗的列表，用戶們可以從列表中知道商品執行失敗的原因‧ [
![](/wp-content/uploads/2016/04/%E5%9B%9E%E6%B8%AC%E8%A8%AD%E5%AE%9A%E9%A1%AF%E7%A4%BA.png)
](/wp-content/uploads/2016/04/%E5%9B%9E%E6%B8%AC%E8%A8%AD%E5%AE%9A%E9%A1%AF%E7%A4%BA.png)

#### 進出場設定 
[
![](/wp-content/uploads/2016/04/%E9%80%B2%E5%87%BA%E5%A0%B4%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2016/04/%E9%80%B2%E5%87%BA%E5%A0%B4%E8%A8%AD%E5%AE%9A.png)進出場設定是顯示腳本所輸入的參數，以及出場的交易設定。 

#### 匯總報表 
匯總報表是顯示這個回測在這段區間內，所有因觸發而產生的模擬交易的整體報表，主要顯示下列資訊 [
![](/wp-content/uploads/2018/07/%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88_%E5%A0%B1%E9%85%AC%E8%A8%88%E7%AE%97_6.43.png)
](/wp-content/uploads/2018/07/%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88_%E5%A0%B1%E9%85%AC%E8%A8%88%E7%AE%97_6.43.png)

#### 總交易次數 
一個進場+出場視為一次的交易，在回測區間內所產生的所有交易次數加總，就是「總交易次數」 例如：A策略雷達在回測中，台積電總共交易了5次，大立光總共交易了6次，所以總交易次數就是11次‧ 

#### 獲利次數 
「總交易次數」內賺錢(報酬率>0)的交易次數 

#### 虧損次數 
「總交易次數」內賠錢(報酬率<0)的交易次數 

#### 勝率 
「獲利次數」佔「總交易次數」的百分比 

#### 總報酬率%(單筆) 
依據交易分析中的進場點和出場點計算所得出的每筆交易的報酬率（股票會納入除權息再投資、期貨會去除換月價差影響） 

#### 平均報酬率% 
整體統計中，總交易報酬率的平均值 總報酬率/總交易次數 

#### 最大獲利率%(單筆) 
交易分析裡，每筆交易報酬率>0(賺錢)的交易中，報酬率最大(賺最多)就是「最大獲利率%」 例如:A策略雷達在回測中，總共只有3次交易: 

- 第一次交易的報酬率為3% 
- 第二次交易的報酬率為10% 
- 第三次交易的報酬率為-2% 
在這個回測中只有第一&第二次交易的報酬率>0，且最大報酬率率是第二次交易，所以最大獲利率就是10% 

#### 最大虧損率%(單筆) 
交易分析裡，每筆交易報酬率<0 (賠錢)的交易中，報酬率最小(賠最多)就是「最大虧損率%」 例如:B策略雷達在回測中，總共只有3次交易: 

- 第一次交易的報酬率為3% 
- 第二次交易的報酬率為-5% 
- 第三次交易的報酬率為-8% 
在這個回測中只有第二&第三次交易的報酬率<0，且最小的報酬率是第三次交易，所以最大虧損率就是-8% 

#### 總報酬率% 
總報酬率是指回測區間內投資組合的時間加權報酬率。每日計算投資組合的平均報酬率，再以複利的方式算出投資組合的時間加權報酬率。 舉例來說： 

- 1/1日的投資組合中僅有一檔商品，且該商品的日報酬率為5%，則1/1日的投資組合報酬率為5%，總報酬率為(1+5%)-1=5% 
- 1/2日的投資組合中有二檔商品，日報酬率各為-3%及-5%，則1/2日的投資組合報酬率為((-3%)+(-5%))/2=-4%，總報酬率為(1+5%)\*(1-4%)-1=0.8% 
- 1/3日的投資組合中僅有一檔商品，且該商品的日報酬率為2%，則1/3日的投資組合報酬率為2%，總報酬率為(1+5%)\*(1-4%)\*(1+2%)-1=2.82% 
- 依此類推 

#### 最大連續獲利率% 
將總報酬率%繪製成每日曲線圖（總報酬率走勢圖）找出每一段總報酬率%連續增加的區段並計算中間的差值，就是連續獲利率，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-1.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-1.png)

- 連續獲利率的算法： 

  - 當單日報酬率 ≧ 0 時，公式為：（1＋單日報酬率）×（1＋前一期的連續獲利率）－1 
  - 當單日報酬率＜0 時，此數值為 0 

連續獲利率累加的算法，是採用時間加權報酬率的公式運算。 而將回測區間中計算出所有的連續獲利率後取出最大值，就是「最大連續獲利率%」 

#### 最大連續虧損率% 
將總報酬率%繪製成每日曲線圖（總報酬率走勢圖），找出每一段總報酬率%連續減少的區段並計算中間的差值，就是連續虧損率，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E.png)

- 連續虧損率的算法： 

  - 當單日報酬率 ≦ 0 時，公式為：（1＋單日報酬率）×（1＋前一期的連續虧損率）－1 
  - 當單日報酬率＞0 時，此數值為 0 

連續虧損率累加的算法，是採用時間加權報酬率的公式運算。 而將回測區間中計算出所有的連續虧損率後取出最小值，就是「最大連續虧損率%」 

#### 最大區間獲利率% 
區間獲利率的計算方式與連續獲利率的差異是連續獲利率要求總報酬率必須持續向上，可是區間獲利率允許總報酬率暫時的下滑，只要總報酬率沒有跌破前低值的話都算是獲利中，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-4.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-4.png)

- 區間獲利率的算法 

  - 當總報酬率大於總報酬率的最小值時，公式為：（1＋總報酬率）／（1+總報酬率的最小值）－1 
  - 當總報酬率小於或等於總報酬率的最小值時，則為 0 

- 總報酬率的算法 

  - 採用時間加權報酬率，公式為：（1＋單日報酬率）×（1＋前一期的總報酬率）－1 

上述算法，因為是用報酬率在算，所以我們會加上本金去計算實際的獲利率變化。可以想成本金是 100 把所有的數值都換成錢後，再去計算區間的獲利率。 而將回測區間中計算出所有的區間獲利率後取出最大值，就是「最大區間獲利率%」 

#### 最大區間虧損率% 
區間虧損率的計算方式與連續虧損率的差異是連續虧損率要求總報酬率必須持續向下，可是區間虧損率允許總報酬率暫時的上升，只要總報酬率沒有突破前高值的話都算是虧損中，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E-2.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E-2.png)

- 區間獲利率的算法 

  - 當總報酬率小於總報酬率的最大值時，公式為：（1＋總報酬率）／（1+總報酬率的最大值）－1 
  - 當總報酬率小於或等於總報酬率的最小值時，則為 0 

- 總報酬率的算法 

  - 採用時間加權報酬率，公式為：（1＋單日報酬率）×（1＋前一期的總報酬率）－1 

上述算法，因為是用報酬率在算，所以我們會加上本金去計算實際的獲利率變化。可以想成本金是 100 把所有的數值都換成錢後，再去計算區間的虧損率。 而將回測區間中計算出所有的區間虧損率後取出最小值，就是「最大區間虧損率%」 

#### 總報酬率走勢圖 
顯示回測區間中投資組合總報酬率的每日曲線圖，區間中最後一日的數值，會等於上面「匯總報表」中的「總報酬率％」。走勢圖有支援查價功能，使用者可以查詢每日的投資組合報酬率變化。 [
![report2-03](/wp-content/uploads/2016/04/report2-03.png)
](/wp-content/uploads/2016/04/report2-03.png)用戶們也可以利用走勢圖下方的區間調整bar，來zoom in/zoom out走勢圖。 [
![report2-04](/wp-content/uploads/2016/04/report2-04.png)
](/wp-content/uploads/2016/04/report2-04.png)如果想要和其他商品比較，也可以利用走勢圖右上角的「+」icon，來加入其他商品來比較。例如想知道自己的策略有沒有打敗大盤，就可以加入「加權指數」來比較看看！ [
![](/wp-content/uploads/2016/04/%E7%B8%BD%E5%A0%B1%E9%85%AC%E7%8E%87%E8%B5%B0%E5%8B%A2%E5%9C%963.png)
](/wp-content/uploads/2016/04/%E7%B8%BD%E5%A0%B1%E9%85%AC%E7%8E%87%E8%B5%B0%E5%8B%A2%E5%9C%963.png)[
![report2-06](/wp-content/uploads/2016/04/report2-06.png)
](/wp-content/uploads/2016/04/report2-06.png)

### **商品統計表 **
商品統計表會列出每個商品的回測結果，且每個欄位都支援排序的功能，方便用戶們找到該欄位中數值最大(最小)的商品。 如果列表中的商品太多，用戶們可以使用右上角的搜尋Tool，只要敲入股號或股名，系統就會快速在列表區中顯示出找尋結果，是不是很方便呢！！ [
![report2-07](/wp-content/uploads/2016/04/report2-07.png)
](/wp-content/uploads/2016/04/report2-07.png)列表也支援直接把列表中的商品加到自選組合功能，用戶們可以先勾選要加到自選組合的商品，然後點選列表左上角的「加到自選股...」按鈕，系統就會跳出「加入自選商品組合」的介面，用戶可以利用這個介面將所勾選的商品加入到所選擇的自選組合中。 [
![report2-08](/wp-content/uploads/2016/04/report2-08.png)
](/wp-content/uploads/2016/04/report2-08.png)如果用戶覺得某一檔商品的回測報告不錯，想要確認這檔商品的每個交易回測結果，可以直接點擊列表中這個商品的商品名稱，系統就會自動跳到這個商品的「商品分析」。 [](#)[
![report2-09](/wp-content/uploads/2016/04/report2-09.png)
](/wp-content/uploads/2016/04/report2-09.png)

### **商品分析 **
商品分析介面中，上方會顯示「單商品回測報告」，而下方會顯示這個商品的「報酬率」、「走勢圖」、「交易明細表」。 要切換其他商品的回測報告，可以利用左邊的導航欄，在「商品分析」項目下，會列出所有的商品，用戶們可以點選來切換目前商品分析中所顯示的商品。或是點選右上方的上/下一檔箭頭，也可以切換上下一檔商品。 [
![report2-10](/wp-content/uploads/2016/04/report2-10.png)
](/wp-content/uploads/2016/04/report2-10.png)

#### 單商品回測報告 
單商品回測報告的數值是顯示這個策略中該商品相關的交易的數值分析。這邊的數值計算仍然維持原本的每筆交易報酬率累加的計算方式，而非時間加權報酬率。每個項目的計算說明如下： [
![](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E5%95%86%E5%93%81%E5%88%86%E6%9E%90.png)
](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E5%95%86%E5%93%81%E5%88%86%E6%9E%90.png)

#### 總交易次數 
一個進場+出場視為一次的交易，在回測區間內該商品的所有交易次數加總，就是「總交易次數」 

#### 獲利次數 
「總交易次數」內賺錢(報酬率>0)的交易次數 

#### 虧損次數 
「總交易次數」內賠錢(報酬率<0)的交易次數 

#### 勝率 
「獲利次數」佔「總交易次數」的百分比 

#### 報酬率% 
依據交易分析中的進場點和出場點計算所得出的每筆交易的報酬率（股票會納入除權息再投資，期貨會去除換月價差影響） 

#### 平均報酬率% 
商品每筆交易報酬率的平均值 每筆交易報酬率相加 / 總交易次數 

#### 最大獲利率% 
商品每筆交易報酬率>0(賺錢)的交易中，報酬率最大(賺最多)就是「最大獲利率%」 

#### 最大虧損率% 
商品每筆交易報酬率<0 (賠錢)的交易中，報酬率最小(賠最多)就是「最大虧損率%」 

#### 總報酬率% 
商品每次交易的報酬率加總 

#### 最大連續獲利率% 
將總報酬率%繪製成每日曲線圖（總報酬率走勢圖）找出每一段總報酬率%連續增加的區段並計算中間的差值，就是連續獲利率，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-1.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-1.png)

- 連續獲利率的算法： 

  - 當單日報酬率 ≧ 0 時，公式為：（1＋單日報酬率）×（1＋前一期的連續獲利率）－1 
  - 當單日報酬率＜0 時，此數值為 0 

連續獲利率累加的算法，是採用時間加權報酬率的公式運算。 而將回測區間中計算出所有的連續獲利率後取出最大值，就是「最大連續獲利率%」 

#### 最大連續虧損率% 
將總報酬率%繪製成每日曲線圖（總報酬率走勢圖），找出每一段總報酬率%連續減少的區段並計算中間的差值，就是連續虧損率，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E9%80%A3%E7%BA%8C%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E.png)

- 連續虧損率的算法： 

  - 當單日報酬率 ≦ 0 時，公式為：（1＋單日報酬率）×（1＋前一期的連續虧損率）－1 
  - 當單日報酬率＞0 時，此數值為 0 

連續虧損率累加的算法，是採用時間加權報酬率的公式運算。 而將回測區間中計算出所有的連續虧損率後取出最小值，就是「最大連續虧損率%」 

#### 最大區間獲利率% 
區間獲利率的計算方式與連續獲利率的差異是連續獲利率要求總報酬率必須持續向上，可是區間獲利率允許總報酬率暫時的下滑，只要總報酬率沒有跌破前低值的話都算是獲利中，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-4.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E7%8D%B2%E5%88%A9%E7%8E%87%E8%AA%AA%E6%98%8E-4.png)

- 區間獲利率的算法 

  - 當總報酬率大於總報酬率的最小值時，公式為：（1＋總報酬率）／（1+總報酬率的最小值）－1 
  - 當總報酬率小於或等於總報酬率的最小值時，則為 0 

- 總報酬率的算法 

  - 採用時間加權報酬率，公式為：（1＋單日報酬率）×（1＋前一期的總報酬率）－1 

上述算法，因為是用報酬率在算，所以我們會加上本金去計算實際的獲利率變化。可以想成本金是 100 把所有的數值都換成錢後，再去計算區間的獲利率。 而將回測區間中計算出所有的區間獲利率後取出最大值，就是「最大區間獲利率%」 

#### 最大區間虧損率% 
區間虧損率的計算方式與連續虧損率的差異是連續虧損率要求總報酬率必須持續向下，可是區間虧損率允許總報酬率暫時的上升，只要總報酬率沒有突破前高值的話都算是虧損中，舉例來說： [
![](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E-2.png)
](/wp-content/uploads/2018/07/%E6%9C%80%E5%A4%A7%E5%8D%80%E9%96%93%E8%99%A7%E6%90%8D%E7%8E%87%E8%AA%AA%E6%98%8E-2.png)

- 區間獲利率的算法 

  - 當總報酬率小於總報酬率的最大值時，公式為：（1＋總報酬率）／（1+總報酬率的最大值）－1 
  - 當總報酬率小於或等於總報酬率的最小值時，則為 0 

- 總報酬率的算法 

  - 採用時間加權報酬率，公式為：（1＋單日報酬率）×（1＋前一期的總報酬率）－1 

上述算法，因為是用報酬率在算，所以我們會加上本金去計算實際的獲利率變化。可以想成本金是 100 把所有的數值都換成錢後，再去計算區間的虧損率。 而將回測區間中計算出所有的區間虧損率後取出最小值，就是「最大區間虧損率%」 

#### 報酬率 
將單商品的總報酬率繪製成每日曲線圖。未平倉的交易會假設在區間的最後一天平倉。 [
![](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E5%A0%B1%E9%85%AC%E7%8E%87.png)
](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E5%A0%B1%E9%85%AC%E7%8E%87.png)

#### 走勢圖 
走勢圖是顯示單商品在回測區間內的k線圖走勢，系統會在有交易的k棒中顯示「進場」、「出場」的標記，而標記中會顯示交易的序號。 再回顧一下前面文章有提到的說明，一個進場+出場等於一次交易，以下面的圖示來看，紅色的框框代表為進場，綠色的框框代表為出場，而同一個交易會標示同一個交易序號，所以上面圖示所圈起的序號「1」的進場/出場圖示，就是代表「交易序號1的進場＆出場」標記。 [
![report2-11](/wp-content/uploads/2016/04/report2-11.png)
](/wp-content/uploads/2016/04/report2-11.png)如果想了解走勢圖上某一筆交易的進出場價格，可以利用走勢圖提供的查價線，只要用滑鼠點擊有標示交易序號的k棒，系統就會在商品名稱下方顯示交易進出場的價格＆該筆交易的報酬率，而交易標記也會用黃色底色顯示，讓用戶們知道目前該筆交易的進出場是在那一根k棒。 [
![](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E8%B5%B0%E5%8B%A2%E5%9C%962.png)
](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E8%B5%B0%E5%8B%A2%E5%9C%962.png)用戶們也可以利用走勢圖右上角的「上/下一筆交易」按鈕，快速切換到切到上一筆/下一筆交易。例如：下方圖示中，走勢圖是顯示交易序號1的資訊，當點擊「下一筆交易」按鈕時，系統就會跳到交易序號2。 [
![](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E8%B5%B0%E5%8B%A2%E5%9C%963.png)
](/wp-content/uploads/2016/04/%E5%96%AE%E5%95%86%E5%93%81_%E8%B5%B0%E5%8B%A2%E5%9C%963.png)用戶如果需要看到每筆交易更詳細的資料，可以參考明細表的說明。 [](#)

#### 明細表 
明細表會用表格來呈現這檔商品在回測區間內的所有交易，系統會依照交易序號來排序，所以用戶可以在這個表格中一目了然的知道所有交易的交易資訊，資訊包含以下欄位： [
![report2_13](/wp-content/uploads/2016/04/report2_13.png)
](/wp-content/uploads/2016/04/report2_13.png)

#### 交易序號 
顯示每筆交易的序號，交易的序號是回測的過程中系統所給的交易編號。 

#### 交易日期 
顯示每筆交易的進場/出場日期，上面為進場，下面為出場。 

#### 交易價位 
顯示每筆交易進場/出場的價位和交易方向(買進或賣出)，上面為進場，下面為出場。 

#### 報酬率 
顯示每筆交易的報酬率(股票會納入除權息再投資、期貨會去除換月價差影響)。 

#### 累計報酬率 
這裡的累計報酬率，初始值是交易序號1的報酬率，然後從交易序號1往下累加。 例如：「交易序號3」的累計報酬率就會累計「交易序號1」、「交易序號2」、「交易序號3」的報酬率所計算出來的值。 

#### 連續次數 
顯示報酬率>0 & 報酬率<0的連續次數，如果連續幾筆交易都是報酬率>0，系統就會顯示「賺1、賺2、賺3...」；反之，如果連續幾筆交易都是報酬率<0，系統就會顯示「賠1、賠2、賠3...」，依此類推。 

### **交易分析 **
交易分析介面中，上方表格會顯示此次回測所有商品的每筆交易，用戶們可以點選表格中的任一筆交易，下方就會顯示該筆交易商品的走勢圖，而走勢圖的查價線也會停留在該筆交易的進場日期。 用戶們也可以利用表格右上角的「<」&「>」這兩個按鈕，來依序切換表格中上/下一筆交易。 [
![](/wp-content/uploads/2016/04/%E4%BA%A4%E6%98%93%E5%88%86%E6%9E%901.png)
](/wp-content/uploads/2016/04/%E4%BA%A4%E6%98%93%E5%88%86%E6%9E%901.png)如果用戶們想要快速過濾「賺錢」or「賠錢」的交易，可以利用表格上方的「賺錢」＆「賠錢」，快速確認此次回測中所有賺錢＆賠錢的交易。 [
![](/wp-content/uploads/2016/04/%E4%BA%A4%E6%98%93%E5%88%86%E6%9E%902.png)
](/wp-content/uploads/2016/04/%E4%BA%A4%E6%98%93%E5%88%86%E6%9E%902.png)而走勢圖的操作行為和功能，和商品分析的走勢圖一樣，用戶們可以參考「走勢圖」。 

### **腳本資料 **

### [
![report2-16](/wp-content/uploads/2016/04/report2-16.png)
](/wp-content/uploads/2016/04/report2-16.png)
腳本資料介面會顯示這個策略雷達的腳本內容。而介面右上角的「copy」功能，則可以將腳本複製後貼到別的記事本等編輯軟體上。 [](#)看到這邊，回測報告的說明也告了一段落，希望各位用戶可以輕鬆的利用回測功能來檢視策略雷達的成效，並祝大家投資順利！！ [

#####


---

# 策略雷達基本操作

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/

[
![如何新增警示](/wp-content/uploads/2016/01/XS策略雷達_02.png)
](/wp-content/uploads/2016/01/XS策略雷達_02.png)本篇將為你說明「盤中量化交易模組」的 **策略雷達 **的基本操作。先來看一段介紹影片～ 如果有你有跟著影片操作，應該已經了解如何新增、執行一個策略雷達以及查詢警示記錄。 還記不清楚也沒關係，可以跟著以下的步驟練習。 \* 步驟一：開啟策略雷達 從功能列→策略→策略雷達，就可以開啟策略雷達視窗 [
![radar01](/wp-content/uploads/2016/01/radar01.png)
](/wp-content/uploads/2016/01/radar01.png)策略雷達的版面配置如下： 

- 功能列：所有功能都可直接由功能列上的按鈕作操作。 
- 目錄區：可依標籤或目錄的方式檢索現有的策略雷達。 
- 清單區：列出目前所選的標籤或目錄內的策略雷達清單。 
- 訊息區：顯示目前策略雷達的相關執行內容及設定。 

`[
![radar02](/wp-content/uploads/2016/01/radar02.png)
](/wp-content/uploads/2016/01/radar02.png)`

\* 步驟二：啟動策略雷達 
1.選擇一個系統預設的策略雷達，這邊我們以「酒田戰法\長腳十字星」為例。 2.調整要監控的警示範圍。範圍的來源有三種：商品（可複選）、組合（自選+系統）或XS選股。調整好自己要的範圍後，按儲存。 3.點擊啟動，開始監控。 

`[
![radar03](/wp-content/uploads/2016/01/radar03.jpg)
](/wp-content/uploads/2016/01/radar03.jpg)`

#### \*\*指定範圍內的[選股]類型，需有購買[選股模組]方能使用\*\* 

``
\* 步驟三：警示記錄 啟動策略雷達後，警示記錄會出現在： 1.觸發時會跳出警示提示視窗。 2.在雲端策略中心看到觸發的警示記錄。 
> 開啟雲端策略中心：策略→雲端策略中心→警示中心 3.觸發的記錄會自動變成系統組合。只要當天有觸發的商品，都會被納入。 
> 開啟綜合看盤：報價→綜合看盤→自動監控 請依個人使用習慣選擇 [
![radar06](/wp-content/uploads/2016/01/radar06.png)
](/wp-content/uploads/2016/01/radar06.png)

### [免費下載桌機版 ](https://bit.ly/2F7A6ct)

### [程式內可購買「盤中量化交易模組」 ](https://bit.ly/2F7A6ct)

以「月」計價，首次訂閱後享有7天體驗鑑賞 
[

#####


---

# 策略雷達平倉功能

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E5%B9%B3%E5%80%89%E5%8A%9F%E8%83%BD/

[
![功能教學-06XS策略雷達_2017-0720](/wp-content/uploads/2017/07/876x300_功能教學-06XS策略雷達_2017-0720.png)
](/wp-content/uploads/2017/07/876x300_功能教學-06XS策略雷達_2017-0720.png)XS策略雷達平倉功能可以讓策略雷達的訊號在觸發之後，依預先設定好的平倉條件，自動送出平倉委託。 在 [策略雷達串接下單 ](https://www.xq.com.tw/learn/sensor/buystocks/)文章中，已經介紹過訊號串下單的整體操作流程及說明「下單設定」頁籤中的下單參數＆介面，而在這篇文章中，則會針對平倉功能做詳細說明。 

### **選擇證券平倉或期權平倉 **
XS策略雷達平倉功能，是放在策略雷達內容的「下單設定」頁籤裡(第二個頁籤)的下單模組中，提供證券平倉與期權平倉功能，如下圖。 [
![xscp001](/wp-content/uploads/2017/07/xscp001.png)
](/wp-content/uploads/2017/07/xscp001.png)

#### **證券平倉 **
如果你的訊號觸發後，是要以平倉委託單來平倉證券。下單類型請選擇證券平倉。證券平倉單可以設定以下參數： [
![xscp002](/wp-content/uploads/2017/07/xscp002.png)
](/wp-content/uploads/2017/07/xscp002.png)

#### **平倉方式 **

- 分為現股多單平倉(含今日)(現賣)、現股空單平倉 (現買)、融資歷史平倉(資賣)、融券歷史平倉(券買)、融資當沖平倉(券賣)與融券當沖平倉(資買)。 

#### **每次平倉數量 **

- 可以選擇每次觸發時，平倉數量為全部庫存張數或固定張數。 
- 另外要注意一點，如果固定張數大於證券商品所持有張數時，則平倉委託會送出所持有張數的數量。例如，假設每次平倉固定張數為3張、證券商品所持有張數為2張，策略觸發後，會送出一筆平倉數量為2張的證券平倉單。 

#### **平倉價格 **

- 目前可以指定二種平倉參考價：一是依照觸發當時商品的成交價、二是腳本觸發時的觸發價格。並且可以依平倉參考價為基準，上下微調十檔（10個ticks）。 
- 另外要注意的一點，檔數的計算方式是絕對價位，和買進、賣出無關。例如，如果成交價是100時，並且設定為成交價加一檔時，無論多或空單平倉的委託價都是100.5。 

#### **策略安全設定 **

- 平倉風險控管可以設定下單次數最多幾次。如果你的下單次數設定為最多3次，則只有前三次觸發的商品會送出平倉委託。也就是說，開始執行警示之後，最多只會送出三筆平倉委託。 

#### **交易帳號 **

- 這邊可以選擇的帳號是已經登入成功的證券帳號（不包含群組帳號），或者是選擇XQ內建的模擬證券交易帳號。如果還沒設定XQTrade交易帳號的話，可以點擊設定交易帳號進行設定。 

### 

### **期權平倉 **
如果你的訊號觸發後，是要以平倉委託單來平倉期權。下單類型請選擇期權平倉。期權平倉單可以設定以下參數： [
![xscp003](/wp-content/uploads/2017/07/xscp003.png)
](/wp-content/uploads/2017/07/xscp003.png)

#### **平倉方式 **

- 分為期貨多單平倉(賣出)、期貨空單平倉(買進)、選擇權多單平倉(賣出)與選擇權空單平倉(買進)。 

#### **每次平倉數量 **

- 可以選擇每次觸發時，平倉數量為全部庫存口數或固定口數。 
- 另外要注意一點，如果固定口數大於期權商品所持有口數時，則平倉委託會送出所持有口數的數量。例如，假設每次平倉固定口數為3口、期權商品所持有口數為2口，策略觸發後，會送出一筆平倉數量為2口的期權平倉單。 

#### **平倉價格 **

- 目前可以指定二種平倉參考價，並且須指定二種有效時間 

  - 二種平倉參考價：一是依照觸發當時商品的成交價、二是腳本觸發時的觸發價格。並且可以依平倉參考價為基準，上下微調五檔（10個ticks）。 
  - 二種有效時間：一是IOC搓合一次、二是FOK搓合一次且須完全成交。 

- 另外要注意的一點，檔數的計算方式是絕對價位，和買進、賣出無關。例如，如果成交價是8000時，並且設定為成交價加一檔時，無論多或空單平倉的委託價都是8001。 

#### **策略安全設定 **

- 平倉風險控管可以設定下單次數最多幾次。如果你的下單次數設定為最多3次，則只有前三次觸發的商品會送出平倉委託。也就是說，開始執行警示之後，最多只會送出三筆平倉委託。 

#### **交易帳號 **

- 這邊可以選擇的帳號是已經登入成功的期權帳號（不包含群組帳號），或者是選擇XQ內建的模擬期權交易帳號。如果還沒設定XQTrade交易帳號的話，可以點擊設定交易帳號進行設定。 

### 

### **啟動觸發下平倉單 **
選擇完證券平倉或期權平倉之後，正式開始下平倉單之前記得去啟動觸發下平倉單。 這樣子才會在警示觸發的同時，送出平倉委託。 

#### 1. 下單設定的左上角 
[
![xscp004](/wp-content/uploads/2017/07/xscp004.png)
](/wp-content/uploads/2017/07/xscp004.png)

#### 2. 警示清單的下單欄 
[
![xscp005](/wp-content/uploads/2017/07/xscp005.png)
](/wp-content/uploads/2017/07/xscp005.png)就算警示已經啟動，你仍然隨時可以從警示清單啟動或停止觸發下平倉單的功能（僅限已設定好下單方式的警示），並不會影響到警示的執行狀況。 你可以點選 **可觸發下單 **這個標籤後，查看「下單模組」欄位資料找到證券平倉或期權平倉全部有設定下單方式的警示。而正在執行觸發下單的警示是會列在 **觸發下單執行中 **這個標籤。 

### 

### **中止觸發下單 **
如果盤中行情波動過大或發生其他緊急狀況的時候，可以直接點擊工具列上的 **中止觸發下單 [
![xsst005](/wp-content/uploads/2016/03/xsst005.png)
](/wp-content/uploads/2016/03/xsst005.png)**按鈕，停止所有警示的觸發下單功能。 看到這邊，策略雷達平倉功能介紹已告一段落，相信大家已經對策略雷達平倉功能有了基本的認識，希望可以幫助用戶們從訊號觸發到下平倉單一氣呵成。 用戶們如果有任何建議歡迎來信，並祝大家投資順利，我們下次見！ [

#####


---

# 策略雷達與雷達回測的錯誤代碼說明

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E8%88%87%E9%9B%B7%E9%81%94%E5%9B%9E%E6%B8%AC%E7%9A%84%E9%8C%AF%E8%AA%A4%E4%BB%A3%E7%A2%BC%E8%AA%AA%E6%98%8E/

大家好，XS 警示腳本編譯完成後， 加入雷達執行時，錯誤代碼與錯誤原因說明，列表如下： 錯誤代碼 錯誤原因說明 5023 無法取得歷史價格資料。 5024 歷史價格資料格式有誤。 5025 無法取得歷史統計資料。 5026 歷史統計資料格式有誤。 5027 該商品頻率不支援引用歷史資料。 5029 引用的歷史資料不存在。 5030 無法取得即時資料。 5031 即時資料格式有誤。 5032 電腦網路異常。 回測警示腳本，與回測策略雷達，錯誤代碼與錯誤原因說明，列表如下： 錯誤代碼 錯誤原因說明 1 未知錯誤 2 回測服務錯誤 3 輸入格式錯誤 4 沒有找到可以執行的腳本 5 腳本建立失敗 6 參數設定錯誤 7 逾時 8 此商品頻率目前不支援回測 9 腳本版號不符 10 產生 XS 腳本物件失敗 11 此 XS 腳本物件不存在 12 此 XS 腳本物件執行中 13 此 XS 腳本物件等待執行中 14 相關的服務的物件沒有初始化成功 15 輸入參數錯誤 16 計算錯誤 17 欄位取得錯誤或不支援的欄位、頻率 18 計算執行到RaiseRunTimeError的語法 19 資料長度不夠計算 20 取資料索引值錯誤，索引值必須大於等於0 21 腳本不符合最新版本，需要重新編譯 22 讀取腳本失敗 23 目前回測尚不支援報價欄位 24 取欄位資料失敗 25 結束日期比開始日期早 26 除以0 27 不合法的欄位資料 28 不支援副商品或不支援副商品的頻率 29 未知的商品ID，商品欄位，頻率 30 此商品頻率無歷史資料 31 系統發生異常，請洽詢您的業務或是嘉實客服 32 不符合選股策略條件 33 選股策略執行錯誤 34 使用不支援的語法 101 未知錯誤 102 產品金鑰有問題 103 解密失敗 104 請求類型錯誤 105 回傳類型錯誤 106 缺少資料相關資訊 107 沒有可用的回測服務 108 沒有連線到回測服務 109 伺服器傳輸錯誤 1001 未知錯誤 1002 回測主機資訊錯誤 1003 請求格式錯誤 1004 重試錯誤 1005 取消執行回測 1006 無權限的商品 1007 不合法的商品 1008 腳本逾期 1009 取得腳本到期日錯誤 1010 XQ程序錯誤 1011 取得使用者資訊錯誤 1012 無法取得使用者資料庫路徑 1013 操作使用者資料庫錯誤 如果看了上述的說明，仍有疑問無法排除，請提供以下資訊，並mail至 [XQservice@XQ.com.tw ](XQservice@XQ.com.tw)，會有專人安排釐清，謝謝： 1. 問題描述。 2. 有問題的完整畫面截圖。 3. 雷達策略匯出檔案，匯出時請勾選「匯出策略雷達所包含的自訂腳本」與「包含選股策略」 4. 指標腳本匯出檔案。 5. Log資料夾壓縮檔案，預設路徑：C:\SysJust\XQLite\LOG [

#####


---

# 策略雷達串接下單：「下單參數」說明

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E8%A7%B8%E7%99%BC%E4%B8%8B%E5%96%AE%E5%8A%9F%E8%83%BD%EF%BC%9A%E3%80%8C%E4%B8%8B%E5%96%AE%E5%8F%83%E6%95%B8%E3%80%8D%E8%AA%AA%E6%98%8E/

[
![策略雷達串接下單：「下單參數」說明](/wp-content/uploads/2016/03/08_11.png)
](/wp-content/uploads/2016/03/08_11.png)XS策略雷達觸發下單的功能，讓您的訊號從觸發到下單一氣呵成，往全自動交易又邁進了一大步。 之前我們使用「策略雷達」，在條件成立跳出訊號時，最快速的方法就是點擊「警示視窗」裡面的「下單」按鈕，把商品資訊帶入下單列。常常稍一猶豫，價格就跑了好幾檔。 在看完了影片介紹後，各位用戶是不是想要馬上體驗一下策略雷達的下單功能了呢？為了各位用戶方便設定，底下文章會用文字敘述的方式一一帶大家走過下單設定，以及啟動觸發下單的流程。 在開始說明前，各位用戶要先知道，只有自訂策略可以做下單設定，系統中所提供的系統策略是無法使用觸發串下單的功能，這一點要請用戶注意唷！ 

### **下單方式選擇 **
在「策略雷達」的警示清單中選擇一個要設定觸發下單的自訂策略，並點選下方功能頁籤中的「下單設定」，就會進入到下單設定的功能入口。 [
![下單方式選擇1](/wp-content/uploads/2016/03/下單方式選擇1.png)
](/wp-content/uploads/2016/03/下單方式選擇1.png)用戶們也可以利用自訂策略的右鍵選單，點選裡面的「下單設定」項目，系統也一樣會跳到「下單設定」功能頁籤。 [
![下單方式選擇2](/wp-content/uploads/2016/03/下單方式選擇2.png)
](/wp-content/uploads/2016/03/下單方式選擇2.png)如果所選定的策略還未完成下單設定，在進入到「下單設定」介面時，系統會先顯示提示文字，說明由左側點選合適的下單模組，我們可以點擊左側的「下單模組」來開始設定策略的觸發下單方式。 [
![下單方式選擇3](/wp-content/uploads/2016/03/下單方式選擇3.png)
](/wp-content/uploads/2016/03/下單方式選擇3.png)可以看到畫面的左邊是可供挑選的下單模組；目前系統有提供「證券限價單」、「證券限價定時單」、「證券平倉單」、「期權限價單」、「期權限價定時單」、「期權平倉單」六種委託類型，用戶們可以依照不同的策略，選擇不同的下單模組來設定。 

### **下單參數設定 **
當點選了下單模組後，系統會在右邊顯示模組的參數設定內容，每個下單模組的內容都不大一樣，用戶們可以依據自己的需求來選擇模組，而用戶們也可以自行調整參數設定，以下我們就用「證券限價單」這個下單模組來說明下單參數介面： 

- 1. 交易帳號設定：提供下拉選單，挑選觸發後要下單的交易帳號 
- 2. 觸發設定：提供觸發後的下單方向，以及買單&賣單時所對應的委託條件 
- 3. 下單數量：可以選擇每次觸發時的下單數量或金額 
- 4. 下單價格：可以設定每次觸發時的下單價格，目前可以指定「成交價」，或是「觸發價」 
- 5. 策略安全設定：設定「下單總次數」，以及「下單總金額」的安全設定，確保下單時的風險控管 [
![下單參數設定1](/wp-content/uploads/2016/03/下單參數設定1.png)
](/wp-content/uploads/2016/03/下單參數設定1.png)
在「1. 交易帳號設定」下拉選單的右邊有個「設定交易帳號」按鈕，點選這個按鈕可以叫出「交易帳號管理」介面，用戶們可以利用這介面來新增其他的交易帳號 [
![下單參數設定2](/wp-content/uploads/2016/03/下單參數設定2.png)
](/wp-content/uploads/2016/03/下單參數設定2.png)不過想必用戶們跟小編一樣是一個謹慎小心的使用者，在使用策略雷達下單功能前，一定想先確認訊號觸發後所帶的下單委託，是不是和「下單參數」中所設定的一樣，以及這個策略是否有達到心目中的預期成效，這時就可以使用 [「XQ模擬交易帳號」 ](https://www.xq.com.tw/learn/beginner/simulate/)，在使用XQ模擬交易帳號下，系統會將策略觸發時的下單委託給傳送到模擬交易後台，來模擬真實的交易狀況，這樣用戶就可以確認委託單的狀況，以及策略的成效。 而要如何使用「 [XQ模擬交易帳號 ](https://www.xq.com.tw/learn/beginner/simulate/)」呢？很簡單，每個XQ用戶都會內建兩個模擬交易帳號，不用做任何設定，只要登入XQ系統後就會自動登入，所以在「1. 交易帳號設定」下拉選單中，自動就會產生這兩組帳號，分別為「 **證-模擬交易(內建)-01 **」＆「 **證-模擬交易(內建)-02 **」用戶們可以針對不同的策略來使用不同的帳號，這樣更可以比較出策略的成效‧ [
![下單參數設定3](/wp-content/uploads/2016/03/下單參數設定3-1.png)
](/wp-content/uploads/2016/03/下單參數設定3-1.png)當下單參數設定完成後，用戶們只要按下「儲存」按鈕，系統就會將設定儲存完成，注意！在完成設定前，請再次確認「5. 策略安全設定」是否有填入符合用戶所能夠接受的下單總次數&下單總金額，以確保做好下單的風險控管。 [
![下單參數設定4](/wp-content/uploads/2016/03/下單參數設定4-1.png)
](/wp-content/uploads/2016/03/下單參數設定4-1.png)

### **啟動觸發帶下單 **
當我們為策略完成下單設定後，必須開啟「觸發下單」開關，這樣當策略在執行時，系統才會在有商品觸發的同時送出委託，用戶們可以在任何時候調整這個開關(包含策略在執行時)，如果在策略執行時關閉「觸發下單」，系統在下次觸發出現時，就不會送出委託。 有兩種方式可以開啟「觸發下單」。 

- 1. 下單設定的左上角 
- 2. 警示清單的下單欄位 
- [
![啟動觸發帶下單1](/wp-content/uploads/2016/03/啟動觸發帶下單1.png)
](/wp-content/uploads/2016/03/啟動觸發帶下單1.png)
當我們開啟「觸發下單」開關後，我們可以開始執行這個策略，當有商品觸發後，系統就會執行下單的動作，用戶們可以在這個策略的「執行紀錄」頁籤中(底下第四個功能頁籤)，查詢到觸發下單的紀錄。 [
![啟動觸發帶下單2](/wp-content/uploads/2016/03/啟動觸發帶下單2.png)
](/wp-content/uploads/2016/03/啟動觸發帶下單2.png)而系統所送出的委託單，用戶們可以至主選單「交易」底下的「證券委託查詢」頁面，確認剛剛所下的委託單狀況。 [
![啟動觸發帶下單3](/wp-content/uploads/2016/03/啟動觸發帶下單3.png)
](/wp-content/uploads/2016/03/啟動觸發帶下單3.png)

### **分類項目：可觸發下單&觸發下單執行中 **
在「策略雷達」左邊分類區中，有兩個分類是和觸發下單的策略有相關，分別是「可觸發下單」&「觸發下單執行中」這兩個分類。 「可觸發下單」分類中，會列出已經設定好下單設定的策略，顧名思義，「下單設定」如果沒完成的策略，是不會在這個分類中出現，讓用戶們可以方便管理。 [
![可觸發下單](/wp-content/uploads/2016/03/可觸發下單.png)
](/wp-content/uploads/2016/03/可觸發下單.png)而「觸發下單執行中」的分類中，則會列出「觸發下單」已開啟且正在執行的策略 [
![觸發下單執行中](/wp-content/uploads/2016/03/觸發下單執行中.png)
](/wp-content/uploads/2016/03/觸發下單執行中.png)文章到介紹到這裡已經接近尾聲，希望各位XS的用戶們可以藉由這篇文章來了解策略雷達串下單的操作流程，在這裡預祝大家投資順利!! [

#####


---

# 策略雷達：「手機傳送」功能說明

Source: https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%EF%BC%9A%E3%80%8C%E6%89%8B%E6%A9%9F%E5%82%B3%E9%80%81%E3%80%8D%E5%8A%9F%E8%83%BD%E8%AA%AA%E6%98%8E/

[
![行動裝置同步接收](/wp-content/uploads/2016/12/XS_2016-1222.png)
](/wp-content/uploads/2016/12/XS_2016-1222.png)各位XS的用戶，是不是每每苦於只能在電腦端確認策略的觸發訊號？ 就讓策略雷達「手機傳送功能」來幫您解決吧！！ 從現在起，只要您啟用策略的手機傳送，讓您在任何地方都可以即時收到策略的觸發訊號！ 

### **一、要如何把策略的觸發訊號傳送到手機？ **
想必大家是第一次設定策略的手機傳送功能吧！接下來就跟著小編來做策略的「手機傳送」初體驗吧！ 在看下去之前，大家請先開啟並登入手機的「XQ全球贏家APP」，以便在完成電腦端的設定後，可以隨著小編馬上切入手機端的說明 [
![push_01](/wp-content/uploads/2016/12/push_01.png)
](/wp-content/uploads/2016/12/push_01.png)

#### 開啟「手機傳送ON/OFF」開關 
在策略雷達上方工具列中，有個「手機傳送ON/OFF」開關，這個開關主導著是否要將策略的觸發訊號傳送到手機的關鍵，只有在開啟(ON)這個開關，系統才會將觸發訊號傳送到手機，所以現在我們先把這個開關給開到「ON」狀態。 [
![push_02](/wp-content/uploads/2016/12/push_02.png)
](/wp-content/uploads/2016/12/push_02.png)

#### 選擇要傳送到手機的策略 
開啟手機傳送開關後，接下來我們就要選擇想傳送到手機的策略囉。 大家可以看一下中間的策略列表，每個策略的左邊都有一個「手機」欄位。 現在我們選擇一個策略並把滑鼠游標移到這個策略的「手機」欄位，移過去後，游標地方會出現一個半透明的手機圖示，並顯示「手機傳送尚未啟用」字樣，這代表著這個策略還未啟用手機傳送的功能。 [
![push_03](/wp-content/uploads/2016/12/push_03.png)
](/wp-content/uploads/2016/12/push_03.png)接下來我們用滑鼠左鍵點擊這個半透明的手機圖示，點擊後手機圖示變成實心非透明的狀態，並顯示「手機傳送已啟用，策略尚未執行」，這表示這個策略已經啟用了手機傳送功能，接下來只要執行這個策略就完成設定程序!! [
![push_04](/wp-content/uploads/2016/12/push_04.png)
](/wp-content/uploads/2016/12/push_04.png)(小編這邊是選擇頻率為「1分鐘」、設定「k棒內單次觸發」的策略，這樣比較快會有觸發訊號，以利待會在手機端看到結果!!) 

#### 執行「啟用手機傳送」的策略 
上一個步驟，我們已經啟用了策略的手機傳送功能，接下來我們就點擊「啟動」來執行這個策略，當策略開始執行後，我們會發覺手機圖示變成了綠色，滑鼠游標移過去時，也會顯示「手機傳送中」，這就代表著這個策略已經會把觸發訊號給傳送到手機的XQ全球贏家APP！到這邊，電腦端的設定就完成囉！ [
![push_05](/wp-content/uploads/2016/12/push_05.png)
](/wp-content/uploads/2016/12/push_05.png)另外，在底下「執行紀錄」中也可以看到目前手機狀態是「手機傳送中」 [
![push_06](/wp-content/uploads/2016/12/push_06.png)
](/wp-content/uploads/2016/12/push_06.png)我們也可以把左邊標籤切換到「手機傳送中」，中間的Table就只會顯示目前正在手機傳送中的策略。 [
![push_07](/wp-content/uploads/2016/12/push_07.png)
](/wp-content/uploads/2016/12/push_07.png)

### **二、如何用手機看到策略的觸發訊號 **
接下來我們馬上看看手機「XQ全球贏家APP」要如何看到觸發訊號，如果還沒開啟的用戶，請先開啟並登入「XQ全球贏家APP」！ 

#### 等待策略的觸發訊息 
如果用戶們照著上面說明操作下來，電腦中應該會有一個已經啟用手機傳送功能並且正在執行中的策略。現在我們先在手機XQ全球贏家APP登入後的畫面，等待電腦端的策略觸發！ 在策略發生觸發後，手機畫面上方會出現一則「警示訊息」，這代表著電腦的策略觸發訊號已經傳到手機端了！ 大家繼續往畫面的下下方看，XQ全球贏家APP畫面的右下角，有一個「警示」選項，而「警示」選項有個小小的紅色數字，這說明著有未讀的觸發訊號(下方畫面中的紅色數字「1」，代表有1則未讀的觸發訊號)，現在我們點進「警示」介面看看吧。 [
![xqm_05](/wp-content/uploads/2016/12/xqm_05.png)
](/wp-content/uploads/2016/12/xqm_05.png)

#### 切到「警示」介面 
在警示介面中，我們會看到剛剛觸發的警示訊息卡片，卡片上會有觸發的策略名稱、策略的多空方向，以及觸發商品的資訊(包含觸發價格、漲跌、觸發時間) [
![xqm_06](/wp-content/uploads/2016/12/xqm_06.png)
](/wp-content/uploads/2016/12/xqm_06.png)由於警示畫面中，預設的顯示是「全部警示」，所以會同時顯示其他來源的觸發訊號，如果要畫面單獨顯示電腦策略雷達的觸發訊號，大家可以點選畫面中左上角的「 [
![xqm_07](/wp-content/uploads/2016/12/xqm_07.png)
](/wp-content/uploads/2016/12/xqm_07.png)」叫出切換來源選單，然後點選選單中的「 [
![xqm_08](/wp-content/uploads/2016/12/xqm_08.png)
](/wp-content/uploads/2016/12/xqm_08.png)」選項，這樣畫面中就只會顯示電腦策略雷達的觸發訊號 [
![xqm_09](/wp-content/uploads/2016/12/xqm_09.png)
](/wp-content/uploads/2016/12/xqm_09.png)到這邊大家應該已經熟悉策略雷達的手機傳送功能，希望手機傳送功能能讓各位XS用戶用更輕鬆的方式來使用策略雷達，在這裡祝大家投資順利！！ [

#####


---

# 觸發設定方式的應用

Source: https://www.xq.com.tw/lesson/sensor/%E8%A7%B8%E7%99%BC%E8%A8%AD%E5%AE%9A%E6%96%B9%E5%BC%8F%E7%9A%84%E6%87%89%E7%94%A8/

在策略雷達的設定畫面內有一個觸發設定的選項，這個設定到底有哪些用途呢？在底下就一一為您介紹。 [
![](/wp-content/uploads/2016/01/sensor_觸發方式-1.png)
](/wp-content/uploads/2016/01/sensor_觸發方式-1.png)觸發設定總共有４種選項，分別是 **連續觸發 **， **K棒內單次觸發 **， **啟動後只觸發一次 **，以及 **單次洗價模式 **。 當選擇 **連續觸發 **時，每次訊號觸發時都會通知，不做任何的限制。通常在腳本觸發情境與先前的觸發無關， 且需要重複通知時就可以選擇這種方式。 舉例而言： 

```
if q_TickVolume > 1000 then ret = 1;

```

上面的腳本使用日線頻率執行，採用逐筆洗價的方式，所以每一次的成交都會執行腳本，且成交單量大於1000張時則通知。由於我們希望知道每一次的大單，所以可以選擇連續觸發的通知方式。 **K棒內單次觸發 **跟 **啟動後只觸發一次 **的定義很類似： **K棒內單次觸發 **指的是在同一根K棒內如果觸發多次訊號的話，只通知第一次，換了K棒之後就又可以繼續通知。而 **啟動後只觸發一次 **則是策略啟動之後不管觸發多次訊號，就只通知第一次。 同樣的，選擇哪種設定方式會跟腳本的內容以及我們預期想要接受的訊號時機點有密切的關係。我們看以下腳本： 

```
if barfreq = "Min" and barinterval = 1 and
TrueAll(close >Close[1] ,10) then ret=1;

```

這個腳本是應用在１分鐘頻率上，當連續10筆K棒都上漲時則觸發。為了追求時效，我們把洗價模式設定成逐筆洗價，表示當有價格成交時就馬上執行腳本，而不是等到1分鐘K棒結束時才執行腳本。這樣子的話當目前的成交價比前一根K棒上漲，而且先前也已經連續漲了9根時，腳本就會觸發。在這種情形底下，就可以把觸發方式設定成Ｋ棒內單次觸發，以減少通知的次數。 那什麼時候可以使用 **啟動後只觸發一次 **呢？我們看一下底下的腳本： 

```
if close > Average(close, 10) and close[1] < Average(close, 10) and
volume > Average(volume, 5) * 3
then ret=1;

```

上面的腳本會在收盤價穿越10日均線，且成交量突破5日均量時觸發。我們把這個腳本應用在日線資料上，設定成是逐筆洗價，觸發方式則是 **啟動後只觸發一次 **，所以當第一次發生收盤價穿越後就通知，接下來價格可能上下波動，也可能再次產生穿越的情形，可是就不再通知了。 當然，觸發方式如何設定沒有一定的準則，端看腳本設計方式，以及使用者預期接受到的觸發情境而異，您不妨自己動手試看看。 最後一個要講的是 **單次洗價模式 **。這是一個很特別的執行方式：他與其他執行方式最大不同之處在於，選擇了單次洗價模式之後，腳本執行後會把最後一根K棒符合腳本條件的商品列出來之後就停止執行，不像其他的執行方式會等待即時價格更新後才觸發。也就是說， **單次洗價模式 **的執行邏輯跟選股中心的執行方式是比較類似的。 以上簡單說明了觸發設定的各種不同定義，以及不同情境底下應用的方式。大家可以實際操作試看看中間的差異，有任何問題的話也歡迎隨時提出。 [

#####


---

# 基準參照商品的應用

Source: https://www.xq.com.tw/lesson/sensor/%E9%80%B2%E9%9A%8E%E7%AF%87-%E5%8F%83%E7%85%A7%E5%95%86%E5%93%81%E7%9A%84%E6%87%89%E7%94%A8/

有很多市場先進都這樣子告訴我們，做股票要順勢，一定要根據大盤的多空來判斷該用哪種方式進出。同樣的，策略雷達內這麼多個腳本，有一些偏短線多方的腳本也一定要在盤勢上揚的情形底下使用，勝算才會高。那該怎麼讓策略雷達只有在盤勢OK的時候，才發訊號給我呢？ 底下就跟大家介紹一個進階的功能： **基準商品參照 **。 這個功能可以讓你在指數均線多頭排列時，才通知你大型股也均線多頭排列的股票，這個功能可以讓你在面板股資金回流時，再通知你量能暴增的面板股，這個功能可以讓你在台積電創新高之後，一旦聯電創新高時通知你。 怎麼做呢？ 當您在設定策略雷達時，中右方有個按鍵叫基準商品參照(參考附圖)，按下去時，會跳出一個視窗，長的跟設定策略雷達的視窗很像，從這個視窗內可以引用任何一個腳本，可以調整參數，指定頻率，更重要的，他可以讓你選擇一個商品，這個商品就是基準商品。 [
![sensor_參照商品_basic](/wp-content/uploads/2016/03/sensor_參照商品_basic.png)
](/wp-content/uploads/2016/03/sensor_參照商品_basic.png)重點來了：在策略雷達執行的時候，只有當這個商品符合腳本的警示條件時，你前面設定的策略雷達，其他符合的警示，才會通知你。 我們在操作時，經常會參照一些市場上的形勢，才來決定交易決策，像是短線操作時，我們常在市場多頭時，才會搶進今天強勢的股票，因為在空頭市場，經常是開高走低殺尾盤，若是貿然搶進盤中強勢股，可能一直在停損。基準商品參照，可以讓你設定參照的情況，只有情況符合，策略雷達才會啟動。 就算我們是期指操作者，只操作一個商品，有的時候我們也想同時處理兩個頻率的腳本，例如我們要找日線跟週線均線都多頭排列的近月期指，透過這個方法是做得到的。 除了參照商品這個武器之外，更進階的使用者，也可以在腳本內利用跨商品/跨頻率的語法來做到類似甚至更複雜的控制！在下一篇文章內，我們會跟大家介紹這個語法，請大家繼續讀下去。 [

#####


---

# 跨商品/跨頻率的語法介紹

Source: https://www.xq.com.tw/lesson/sensor/%E9%80%B2%E9%9A%8E%E7%AF%87-%E8%B7%A8%E5%95%86%E5%93%81%E8%B7%A8%E9%A0%BB%E7%8E%87%E7%9A%84%E8%AA%9E%E6%B3%95%E4%BB%8B%E7%B4%B9/

同樣是參考指數趨勢當作進出的條件，我們可以用


---

# 「自動洗價」說明

Source: https://www.xq.com.tw/lesson/sensor/auto-marked-to-market/

XQ 新增了自動洗價的功能，讓使用者可以不需根據執行商品是否有洗價強制讓策略運算，達到在執行商品沒有發生交易的狀況下也能夠判斷是否要警示或是進出場。 有了這項功能後，即使是在盤前的階段也能夠讓策略運作並下出委託，但需注意只有在交易所開始收單後策略雷達和自動交易中心才能夠下單。 
---

### **設定方式 **
策略雷達和自動交易中心裡的策略能夠設定自動洗價。 以下會分別說明兩邊的設定方式。 **策略雷達 **[
![](/wp-content/uploads/2024/09/01-1024x564.png)
](/wp-content/uploads/2024/09/01.png)可以看到原本的洗價設定右方多了一格自動洗價可以勾選，且接著可以設定自動洗價運作的時段。 [
![](/wp-content/uploads/2024/09/02-1-1024x564.png)
](/wp-content/uploads/2024/09/02-1.png)在點選藍色的字串後，會跳出設定洗價時段以及自動間隔的視窗，提供的間隔最短為 1 秒，最長則是到 60 秒。 [
![](/wp-content/uploads/2024/09/03-1-1024x564.png)
](/wp-content/uploads/2024/09/03-1.png)其中洗價時段有內建幾個選項可以快速點選台灣市場常用的時段，亦可以選擇自訂時段來調整。 自動間隔則是設定距離上次洗價幾秒後要強制洗價運算一次。 **自動交易 **[
![](/wp-content/uploads/2024/09/04-1-1024x466.png)
](/wp-content/uploads/2024/09/04-1.png)自動交易在洗價設定中也可以作調整。 [
![](/wp-content/uploads/2024/09/05-1-1024x466.png)
](/wp-content/uploads/2024/09/05-1.png)在勾選自動洗價後，就會跳出設定自動洗價運作的時段以及自動洗價間隔的部分。每次洗價間隔的部分一樣是最短為 1 秒，最長到 60 秒。 
---

### **如何運作 **
在新增的自動洗價的選項後，策略會有 4 種運作方式，以下會分別作說明。 **逐筆洗價和自動洗價皆不勾選 **在這種情況下，策略的運作方式會和原本的非逐筆洗價相同。 只有在執行商品 K 棒結束後的第一次洗價，策略才會去運算已結束的那根 K 棒。 **只勾選逐筆洗價 **在這種情況下，策略的運作方式會和原本的逐筆洗價相同。 策略會在每次商品洗價時運算，每次運算間隔最短會相隔 0.125 秒。 **只勾選自動洗價 **在這種情況下，策略會在設定的間隔秒數後自動洗價運算。 不會受到商品本身是否發生成交 Tick，或是 K 棒是否結束而影響。 為了確保每根 K 棒運算結果正常，換 Bar 後的第一次自動洗價會重洗已結束 K 棒，此次洗價不會觸發警示或交易。 **逐筆洗價和自動洗價皆勾選 **這模式是結合「逐筆洗價」和「自動洗價」的功能。 在這種情況底下，策略除了在執行商品有新成交 Tick 進來的時候運算 (逐筆洗價規則)，若在自動洗價設定的間隔秒數間都沒有 Tick 進來時，策略也會自動洗價並運算。 **需要注意的事項： **

- 此項功能只有針對及時運作的策略，並不包含回測的部分。 不會影響到策略在啟動時的資料讀取筆數或自動交易所設定的策略部位計算起點，只有在策略啟動運算完畢後的即時區間才會運作。 在自動洗價運作的狀況下，不會產生新的 K 棒，只有實際的交易才會產生 K 棒。若商品持續沒有交易，那麼自動洗價運算的 K 棒將會是該商品最後一次產生交易的 K 棒。 
- 自動洗價功能可以自訂洗價區間，目前系統並沒有限制自訂區間的起始和結束時間。但伺服器會判斷執行商品是否已經收盤，已經收盤的商品是不會執行自動洗價的。 
- 自動洗價的交易指令要在限定的時段中才能夠執行送單的動作，目前支援的區間為： 

1. 股票：08:35 ~ 13:40 

2. 日盤指數期貨：08:35 ~ 13:55 

3. 夜盤指數期貨：14:50 ~ 05:10 

4. 日盤股票期貨：08:35 ~ 13:55 

5. 夜盤股票期貨：17:15 ~ 05:10 
會有以上限制的原因是為了避免在券商不收單的時段送出委託而導致錯誤。 若自動洗價時在限定時段以外執行了交易指令，執行紀錄會顯示目前為非收單時段，交易指令將不會執行。 

- 證券開盤前的時段不能夠下市價單，以及期貨在盤前的兩分鐘內無法刪改委託單。 故在撰寫腳本時可以用時間判斷洗價時段，避開在盤前下出市價單導致策略中斷的情況。 期貨雖然可以在盤前下出市價單，但策略雷達和自動交易中心的期貨商品都是送出範圍市價單，故也需要避開。 

---

### **新增/調整欄位和函數 **
為了應對這個功能，XS 語法也新增與調整了現有的 XS 欄位，讓使用者可以更靈活判斷目前策略的設定和市場的狀態。 ******函數 **

```
GetInfo("IsRealTime")
```

此函數在腳本運算是因為自動洗價的時候也會回傳 1，不會因為自動洗價運算的資料非最新的資料而回傳 0。 

```
GetInfo("IsTimerMode")
```

此函數會回傳腳本這次運算的原因，若為自動洗價的話則為 1，其他狀況則為 0。 

此函數只支援交易腳本和警示腳本，使用在其他腳本的話會回傳 0。 

---
**欄位 **以下報價欄位可以用來取得在盤前、收盤前以及盤中盤中價格穩定措施時的試搓資訊。 **試搓成交價 **

```
q_SimulatedTradePrice
```

此欄位會回傳試搓的成交價格。 
**試搓成交量 **

```
q_SimulatedTradeVolume
```

此欄位會回傳試搓的成交數量。 
**試搓成交時間 **

```
q_SimulatedTradeTime
```

此欄位會回傳試搓的成交時間，格式為HHMMSS。 
**試搓成交日期 **

```
q_SimulatedTradeDate
```

此欄位會回傳試搓的成交日期，格式為YYYYMMDD。 
以下報價欄位會回傳市場的狀態。 **市場狀態 **

```
q_MarketState
```

此欄位會回傳目前的市場狀態，可以判斷目前是否屬於盤前搓合階段。 

0 = 正常洗價 

2 = 暫停交易 

3 = 延緩收盤 

4 = 開盤前試搓 

5 = 開盤前試搓/不允許刪改單 (期交所) 

6 = 收盤前試搓 

7 = 暫緩開盤 

8 = 暫停交易後開始試搓(證交所/期交所) 

9 = 暫停交易後開始試搓/不允許刪改單 (期交所) 
**穩定價格狀態 **

```
q_CircuitBreakState
```

此欄位會回傳目前市場是否處於盤中價格穩定措施。 

0 = 無 

1 = 暫緩搓合且趨跌 

2 = 暫緩搓合且趨漲 

---

### **使用範例 **
以下提供幾個適合使用自動洗價來處理的範例。 **開盤前依據試搓的價格決定是否下單 **

```
if q_MarketState = 4 and Position = 0 and q_SimulatedTradePrice > close then setposition(1, close);
```

在開盤試搓階段藉由自動洗價觸發的運算判斷當下的試搓價格是否大於昨日的收盤價，如果是的話下出 1 張委託價為昨日收盤價的買進限價單。 
**收盤前試搓時平倉 **

```
if q_MarketState = 6 and Position > 0 and Filled > 0 then setposition(1, GetField("跌停價", "D"));
```

在收盤試搓階段藉由自動洗價觸發的運算判斷策略是否有多方庫存，如果有庫存的話則下出委託價為跌停價的賣出限價單。 
**讓商品就算沒有成交也可以下單交易 **

```
condition1 = GetSymbolField("2330.TW", "Close") cross over Average(GetSymbolField("2330.TW", "Close"), 10);

if condition1 and position = 0 and filled = 0 and symbol = "FICDF*1.TF" then setposition(1, market);
```

一般來說股票期貨的洗價數量小於對應的股票，而這會導致想要依照股票價格來判斷是否交易期貨商品的觸發時間相對較晚，甚至可能無法觸發。 

使用自動洗價的話就可以避免此種狀況發生。 
**讓不同商品可以在同時洗價交易 **

```
input: _spread(50, "價差");

value1 = getsymbolField("FITXN*1.TF", "Close");
value2 = getsymbolField("FITXN*2.TF", "Close");
value3 = value2 - value1;

if value3 < -_spread and position = 0 and filled = 0 then begin
 if symbol = "FITXN*1.TF" then setposition(-1, market);
 if symbol = "FITXN*2.TF" then setposition(1, market);
 end
else if value3 > 0 and position <> 0 and filled <> 0 then begin
 if symbol = "FITXN*1.TF" then setposition(0, market);
 if symbol = "FITXN*2.TF" then setposition(0, market);
 end;
```

此為一個簡單的逆價差交易範例，在遠月近月價差小於設定參數時買進遠月期貨並放空近月期貨。 

大部分的情況下兩個不同的商品同時洗價的可能性很低，尤其其中一個商品還是遠月藉由自動洗價的設定就可以讓兩個商品在同一時間運算交易。 
**在處於盤中價格穩定措施由市價單改為限價單 **

```
condition1 = close cross over Average(close, 10);

if condition1 and position = 0 and filled = 0 then begin 
 if q_CircuitBreakState = 0 then setposition(1, market)
 else setposition(1, getfield("漲停價", "D"));
 end;
```

在洗價時使用 q\_CircuitBreakState 來判斷當下是否處於價格穩定措施，並依次判斷是要送出市價單還是限價單。 
[

#####


---

# 潛龍飛天

Source: https://www.xq.com.tw/lesson/sensor/hiddendragon/

今天想跟大家介紹一個小弟我長年看K線時觀察到的一個交易策略我把它稱之為潛龍飛天。 各位請看以下這張圖： [
![071204](/xstrader-content/uploads/2015/07/071204.png)
](/xstrader-content/uploads/2015/07/071204.png)我發現，當一檔股票在急漲後，如果在其拉回整理的過程中，底部愈墊愈高，且整理的時間夠久，當它最終突破幾個整理期間的高點連線後，後市持續上漲的機率很高。 通常這種線型代表這檔股票的供需出現變化，買方在一陣急拉後，不再追高，改採低接的方式來增加持股，在低接一陣子之後，買方如果願意再墊高一點買進，代表在原來的低價區已接不到股票了，這樣持續幾次，股價就會出現長長未再破底，但高檔有賣壓的線型，這就是上圖的樣式。 這樣的股票，如果搭配我們發現有主力在長期吸納持股，等到浮額都被清光了，賣壓愈來愈輕，最終一突破整理區間的高價區，代表多方終於打贏了決定性的戰役，空方一定要撤退到另一個陣線才能阻擋多方的攻勢，於是短多的機率就會變高，這樣的走勢，很像一尾潛在水面下的龍終於冒出水面，所以我稱為潛龍飛天。 我舉一個例子， [
![071501](/xstrader-content/uploads/2015/07/071501.png)
](/xstrader-content/uploads/2015/07/071501.png)各位看上圖，會發現，佳格前一陣子的走勢完全符合潛龍飛天的型態，而且我們看到收集派發指標也出現籌碼在被收集的訊號。所以當佳格股價突破80元左右的空方防線區之後，空方一直退到90元左右。 接下來大家一定會問我，那要怎麼找到這種潛龍飛天的股票呢？每天要一檔一檔看，看1500檔嗎？ 以前YES，我都是直接打開財訊快報，快速瞄過每檔股票的線圖； 但現在有了XS，我們可以寫一個策略，叫電腦在盤中把符合條件的股票挑出來。 以下就是符合潛龍飛天概念的腳本： 

```
input:StartDate(20150301);
input:LowMonth(3);

if currentbar =1 and date < startdate then raiseruntimeerror("日期不夠遠");

variable:iHigh(0); iHigh=maxlist(iHigh,H);
variable:iLow(100000); iLow=minlist(iLow,L);
variable:hitlow(0),hitlowdate(0);
if iLow = Low then //觸低次觸與最後一次觸低日期
begin
hitlow+=1;
hitlowdate =date;
end;

if DateAdd(hitlowdate,"M",3) < Date and//如果自觸低點那天三個月後都沒有再觸低
iHigh/iLow < 1.3 and //波動在三成以內
iHigh = High then

//來到設定日期以來最高點
ret =1;
```

這樣挑出來的股票不會多，所以我們就可以一檔一檔檢視其籌碼的情況。 如此一來，潛龍起飛時，我們就可以第一時間就掌握住了。 不過在此要跟大家報告，這個腳本不見得天天挑得出股票，挑出來的股票，也是要看大盤好不好，如果大盤不好，千萬不要勉強作多，畢竟再多整理一下，多方有更便宜的股票可以買，不見得願意追高。 [

#####


---

# Larry Williams 短線交易秘訣

Source: https://www.xq.com.tw/lesson/sensor/larrywilliams/

[
![r1](/xstrader-content/uploads/2015/05/r1.png)
](/xstrader-content/uploads/2015/05/r1.png)Larry Williams的著名著作《短線交易密訣》中提到一個非常重要的概念:當收盤上漲時,價格若處於強勢波動率收斂，當股價再創短其新高時，就是非常理想的進場點，反之則為空點。 這樣的概念可能有點抽象，讓我們來情境試想：有一檔股票正在漲，昨天的波動率假設是2，今天又上漲了，而且今天收盤價和最低價的距離只有不到1，這表示往下去的力道已經收斂掉了，當這樣的情況出現，如果股價突然衝過這兩天的高點，那就是多方要出擊了，這是個一決勝點。當然，這時後最好是記下這天的低點，用來當作停損使用！ 我們來看一下腳本： 

```
vars: _MarketPosition(0);
Condition1 = Close > Close[1] and (Close-Low) <= 0.5*(High[1]-Low[1]);
Condition2 = Close < Close[1] and (High-Close) <= 0.5*(High[1]-Low[1]);
{整個策略非常單純,上面兩行僅判斷波動率,下面則是部位判斷與停損點的設定}
if _MarketPosition < 1 then begin if condition1[1] and C > maxlist(H[1],H[2]) then
begin
plot4(C*1.01 ,"作多");
plot5(C*1.02);plot6(C*1.03);plot7(C*1.04);
plot8(C*1.05);plot9(C*1.06);plot10(C*1.07);
_MarketPosition=1;
value1 =minlist(L[1],L[2]);
end;
if C cross over value2 and _MarketPosition=-1 then
begin
plot4(C*1.01 ,"回補");
_MarketPosition=0;
end;
end
else if _MarketPosition >-1 then
begin
if condition2[1] and C < minlist(L[1],L[2]) then
begin
plot11(C*0.99 ,"作空");
plot12(C*0.98);plot13(C*0.97);plot14(C*0.96);
plot15(C*0.95);plot16(C*0.94);plot17(C*0.93);
_MarketPosition=-1;
value2 = maxlist(H[1],H[2]) ;
end;
if C cross under value1 and _MarketPosition=1 then
begin
plot3(C*1.01 ,"出場");
_MarketPosition=0;
end;
end;
```

可以從圖裡面看得到這個點容易成為決勝點。 改成警示的話腳本會變成下面，跑出來的結果各位可以參考對照是不是有這樣的現象： 

```
vars: _MarketPosition(0);
Condition1 = Close > Close[1] and (Close-Low) <= 0.5*(High[1]-Low[1]);
Condition2 = Close < Close[1] and (High-Close) <= 0.5*(High[1]-Low[1]);
if _MarketPosition < 1 then
begin
if condition1[1] and C > maxlist(H[1],H[2]) then
begin
ret=1;
value1 =minlist(L[1],L[2]);
end;
if C cross over value2 and _MarketPosition=-1 then
begin
_MarketPosition=0;
end;
end
else if _MarketPosition >-1 then
begin
if condition2[1] and C < minlist(L[1],L[2]) then
begin
_MarketPosition=-1;
value2 = maxlist(H[1],H[2]) ;
end;
if C cross under value1 and _MarketPosition=1 then
begin
_MarketPosition=0;
end;
end;
```

[
![r2](/xstrader-content/uploads/2015/05/r2.png)
](/xstrader-content/uploads/2015/05/r2.png)[

#####


---

# 盤中開始暴量的低PB股

Source: https://www.xq.com.tw/lesson/sensor/lowpb/

行情走到這邊，我發現不少異軍突起的股票，都是屬於那種低股價淨值比的，低PB的股票我們用XS選股每天隨時都可以挑出來，但不是每一檔低PB的股票都會漲，特別是如果盤中我們想要在這類股票一發動時就進場，那麼我們最好能夠在盤中就掌握低PB的股票人氣回籠的徵兆。 怎麼判斷呢？ 預估量是一個方法，這些低PB的股票之所以低PB，很大的原因是因為乏人問津。一般乏人問津的股票，其具體的表現就是沒有量，所以當一檔低PB的股票預估當日成交量會比十日均量高出三成且主要都是外盤成交時，就很值得留意了。 那麼我們怎麼透過XS來在盤中找到這種股票呢？ 首先我們可以用XS選股挑出低PB的股票： [
![102002](/xstrader-content/uploads/2015/10/102002.png)
](/xstrader-content/uploads/2015/10/102002.png)接下來就要拿這341檔來跑預估量會暴增的策略 先前我們有介紹過預估量的函數，其腳本如下： 

```
variable:CloseTime(133000); // 收盤時間
variable: OpenMinutes(270);//一天有幾分鐘開盤
variable: MinutestoClose(270); //到收盤還有幾分鐘
variable: Length(20); //用過去幾天日資料計算
variable: AvgDayVol(0); //平均日量
variable: AvgMinVolinDay(0); //平均分鐘量
variable: LeftVol(0); //剩餘時間的估計量

variable: estVol(0); //最終估計量

AvgDayVol = average(V,Length);

AvgMinVolinDay = AvgDayVol/OpenMinutes; //過去這段時間每分鐘的平均量

MinutestoClose = Timediff(CloseTime,currenttime,"M"); //現在到收盤還有幾分鐘

LeftVol = MinutestoClose *AvgMinVolinDay;// 剩餘時間乘上每分鐘均量 = 盛夏時間可能有多少量

if ( barfreq ="D") then //是日線才會對
begin
if Date =currentdate then //今天才回估量
estVol =volume + LeftVol //估計量 等於 現在的日總量 加上 剩下時間估計的量
else
estVol =v; //過去的話就直接回實際的量
end;
estvolume =estVol;
```

有了這個預估量的函數，我們就可以很容易的寫出預估量暴增的腳本 

```
value1=q_InSize;//當日內盤量
value2=q_OutSize;//當日外盤量
if estvolume > average(volume[1],10)*1.3//預估量比十日均量多出三成
and value2>value1//外盤量比內盤量多
then ret=1;
```

接下來我們就用這個腳本來設定策略雷達： [
![102001](/xstrader-content/uploads/2015/10/102001.png)
](/xstrader-content/uploads/2015/10/102001.png)如上圖，我們在指定範圍設成PB<0.8的選股法，然後把"觸發設定"設成日內單次觸發，這樣一來，我們就可以讓電腦在盤中只要有那一檔PB<0.8的個股預估量爆增，馬上透過警示中心通知我們。 如下圖： [
![102003](/xstrader-content/uploads/2015/10/102003.png)
](/xstrader-content/uploads/2015/10/102003.png)以今天為例，我大約9:28分啟動這個策略，到中午11:30左右為止，符合低PB且預估量暴量的股票如下： [
![102004](/xstrader-content/uploads/2015/10/102004.png)
](/xstrader-content/uploads/2015/10/102004.png)從上圖我們可以發現，雖然今天指數到11:28分是下跌的，但上面大部份的股票是上漲的。 以在名單上的康那香為例， 09:47的時候，康那香符合預估量爆增的條件，那時候的康那香價位是12.15，到了11點之後，康那香的股價已經來到12.85。 [
![102005](/xstrader-content/uploads/2015/10/102005.png)
](/xstrader-content/uploads/2015/10/102005.png)透過這個策略我們確實可以在這些低PB乏人問津股票出量的第一時間就掌握進場的時機，但在這邊還是要跟大家說明的是，這些股票能走多遠，還是要看基本面有沒有變化而定。 以在名單中的昱晶為例，到第二季財報為止，它的每股淨值是29.7，如果以股價低於PB X 0.8來算，當股價跌破23.8時，它就符合低PB的條件，我們從K線圖上可以發現，必須要K線也配合是屬於中長紅的格局時，才是多頭人氣重新匯聚的徵兆。 [
![102006](/xstrader-content/uploads/2015/10/102006.png)
](/xstrader-content/uploads/2015/10/102006.png)如果是在大漲之後，或者是在下降趨勢之中，則不應輕取妄動。 整體來說，這個低PB暴量的策略如果挑出來的股票又符合多次到底而破，整理後突破等策略，其後市看漲的機率就更高了。 [

#####


---

# 看盤用的腳本

Source: https://www.xq.com.tw/lesson/sensor/marketscript/

看盤是大學問，從盤面中挑股票作短線是另外一門大學問，我認識的大戶們，都是這兩門學問的高材生。我試著用XS把他們的智慧轉化為警示腳本，供大家參考。 過去在證券商及投信服務時，有些機會，認識了一些大戶級的朋友，也有機會坐在他們的貴賓室，陪他們看盤，我整理了不同大戶的看盤邏輯，可以分成看大勢及挑股票兩種不同的心法。 先說看大勢，基本上大戶只要今天的盤不會大跌就願意進場，我留意到他們在研判今天的盤會不會大跌，主要是看幾個部份： 1. 大架構是不是處於多頭走勢。 2. 人氣有沒有潰散。 3. 指標股能不能帶動追價 再來看挑股票，基本上一個原則：愈強愈好。從盤面上，則可以留意以下幾個特徵： 1. 一直在外盤成交 2. 掛委買的張數明顯積極 3. 佔大盤成交比重明顯成長 4. 開盤委買張數及均張都明顯變大 根據上述的邏輯，我寫了兩個腳本。 一個用來看大勢： 

```
condition1=false;
condition2=false;
condition3=false;

if average(close,5)>average(close,22)
then condition1=true;//週線在月線之上

if estvolume>average(volume,20)
then condition2=true;//預估量高於20日均量

value3=q_UpLimitSecs;//漲停家數
value4=q_UpSecurities;//上漲家數

if value3>15 or value4>250
then condition3=true;//漲停夠多或上漲的夠多

if condition1 and condition2 and condition3
then ret=1;
```

另一個用來挑可以繼續盯著看的股票： 

```
value1=q_InSize;//內盤量
value2=q_OutSize;//外盤量
value3=q_SumBidSize;//總委買
value4=q_BidAskDiff;//委買賣差(張)
value5=q_CashDirect;//佔大盤成交比重
value6=q_BoughtLotsAtOpen;//開盤委買張數
value7=q_BoughtAverageAtOpen;//開盤委買均張

condition1=false;
condition2=false;
condition3=false;
condition4=false;

input:r1(1.5,"外盤量/內盤量的比值");
input:q1(1000,"外盤量-內盤量");
input:q2(300,"總委買下限");
input:q3(200,"委買賣差下限");
input:r2(20,"佔大盤成交比重成長下限");
input:q4(300,"開盤委買張數下限");
input:r3(20,"開盤委買均張成長率下限");

if value1<>0
then value8=value2/value1;
if time>090500 and value8>=r1
then condition1=true;//外盤是內盤的 1.5倍以上

if value3>=q2 and value4>q3
then condition2=true;//總委賣夠大且買賣差也夠大

value9=average(value5,20);
if value5>=value9*(1+r2/100)
then condition3=true;//佔大盤成交值比重明顯回昇

if value6>q4 and value7>average(value7,20)*(1+r3/100)
then condition4=true;//開盤委買張數及均張都夠迷人

if condition1 or condition2 or condition3 or condition4
then ret=1;
```

在設定策略雷達時，我用第二個腳本，並且在參照參數的地方，我選擇加權指數，並且使用第一個腳本。 [
![021901](/xstrader-content/uploads/2016/02/021901.png)
](/xstrader-content/uploads/2016/02/021901.png)透過這樣的設定，我們就可以在盤中只有大勢還可以作多時，把那些值得盯盤的股票，透過策略雷達，一檔檔送到我們面前來，這麼一來，應該就不必再盯著電視牆了。 [

#####


---

# 跨頻率多重濾網交易策略的設計

Source: https://www.xq.com.tw/lesson/sensor/multifilters/

在設計交易策略時，常有跨頻率的需求，今天來跟大家討論，類似這樣的交易策略，要如何設計。 在程式交易這個領域裡，Alexander Elder的著作："Trading for a living"是大家常會拿來參考的一本書 [
![trading for a living](/xstrader-content/uploads/2016/03/trading-for-a-living.png)
](/xstrader-content/uploads/2016/03/trading-for-a-living.png)這本書有中譯本，名稱叫作《操作生涯不是夢》。 [
![操作生涯不是夢](/xstrader-content/uploads/2016/03/操作生涯不是夢.png)
](/xstrader-content/uploads/2016/03/操作生涯不是夢.png)在這本書裡，Alexander 提出了一個觀念：叫作三重濾網交易系統(Triple Screen Trading System)，它的概念是把股價波動的趨勢分成三種，一是主趨勢，二是中期趨勢，三是短期趨勢，他用Tide(潮汐)，波浪(Wave)與小漣漪(Ripple)三種海浪的變化來代表這三種不同的趨勢，顧名思義，潮汐是長線的主要趨勢，漲潮時，海水會愈來愈逼近海岸，退潮時則海水會離海岸愈來愈遠。在漲潮退潮的過程中，海浪則是一波波打向岸邊，不斷地往前衝然後後退，漣漪則是海浪踫到不同地形地物時所激起的浪花，雖然漂亮而惹人注目，但對於大方向無關緊要。 Alexander的三重濾網交易系統的概念就是 1. 掌握主要趨勢 (週線) 2. 在短期超買超賣後尋找進場時機 (日線) 3. 從股價的波動中確認進場點 (盤中) 這樣的觀念，等於在一個交易系統中，同時使用了週線，日線及盤中洗價(例如60分鐘線)這樣的概念，這是一個跨三種頻率的交易策略，這樣的策略該怎麼建構呢？ 首先，我們先用選股來處理日線及日線以上頻率的條件，如週線及月線等，然後再把選股的結果拿去跑一個盤中洗價的日線或分鐘線的策略雷達腳本。 舉個例子，我們來建構一個符合下列三個條件的三重濾網交易系統： 1. 週線的移動平均線是多頭排列。 2. 日線KD進入超賣區 3. 盤中60分鐘線創新高 首先，我們先寫下兩個選股腳本： 

```
input:S1(6,"天期");
value1=average(close,s1);
if close>value1
then ret=1;
```

上面這個是移動平均線多頭排列，我們把這腳本應用在週線上。 下面這個則是KD進入超賣區： 

```
// KD指標, K值由下往上穿越D值
//
input: Length(9), RSVt(3), Kt(3);
variable: rsv(0), k(0), _d(0);

SetBarBack(maxlist(Length,6));
SetTotalBar(maxlist(Length,6) * 4);

SetInputName(1, "天數");
SetInputName(2, "RSVt權數");
SetInputName(3, "Kt權數");

Stochastic(Length, RSVt, Kt, rsv, k, _d);

IF k<20 and _d<30
then ret=1;


```

我們把這個腳本用在日線上。 最後我們運用突破近期新高的腳本。 

```
input: Price(close); setinputname(1,"比較價別");
input: Length(10); setinputname(2,"近期期數");

if Price > highest(high[1] ,Length) then ret=1;

```

然後把這個腳本用在60分鐘線 透過這三個腳本，我們串起了一個跨頻率的交易策略 首先我們運用前兩個腳本，挑出符合條件的股票。 
[
![030101](/xstrader-content/uploads/2016/03/030101.png)
](/xstrader-content/uploads/2016/03/030101.png)然後再把這個選股策略取個名字叫「三重濾網之前兩重」，然後讓系統「每日自動執行」。 最後我們再把第三個腳本納入每日自動執行的策略雷達： [
![030102](/xstrader-content/uploads/2016/03/030102.png)
](/xstrader-content/uploads/2016/03/030102.png)如此一來，符合這三重濾網的股票，在盤中就會出現在警示中心這個頁面了。 市場的老人常叫我們不要逆勢操作，也常要我們用長線保護短線，或是說看長作短，三重濾網交易系統的設計概念，跟市場老手們的想法不謀而合。 至於這三重交易系統應該用什麼指標，書上是建議第一重看長線，可以用趨勢型的指標，如MA，MACD等，第二重則建議用震盪指標，如KD，RSI等，第三重則是用突破型交易策略，因為這三者合在一起就可以找出在對的趨勢裡，短期整理後又重新往趨勢前進的股票。 要提醒大家的是，目前的XS系統，並沒有在同一個策略雷達腳本中，讓User處理跨頻率，而選股腳本又只能處理日線及以上的頻率，因此，目前我們目前在XS上執行三重濾網的交易策略時，前兩重一定要日線以上，例如我們無法執行一個用日線，60分鐘線及一分鐘線所構成的三重濾網交易系統，這還有賴嘉實的XS產品開發團隊的努力才能達成，目前是做不到的。 [

#####


---

# 股價越過整數關卡

Source: https://www.xq.com.tw/lesson/sensor/roundnumber/

我師父常說：「反常必有妖」。例如一檔股票平常都是十幾塊錢的，突然有一天站上20元，這時就有必要探討一下這家公司是不是基本面有什麼變化? 是不是接到大單？是不是產品價格看漲，毛利上昇。 以矽瑪為例，這檔股票近三個月多來都在 20元以下游走，最低還跌破15元，一旦見到2字頭，就代表有些情況在改變，結果是接大單，六月狂出貨，股價如今已站上30元。 [
![072101](/xstrader-content/uploads/2015/07/072101.png)
](/xstrader-content/uploads/2015/07/072101.png)所以這種股價突破近期的整數關卡，實在是一個很值得我們重視的訊號。 為了在盤中就找出這樣的股票，我寫了一個腳本如下： 

```
input:period(10);
setinputname(1,"維持原價位區間的天數");
value1=intportion(close/10);
if trueall(value1[1]=value1[2],period)
and value1>value1[1] and value1<10
then ret=1;
```

這當中應用了一個叫做intportion的函數，這個函數是用來取整數用的，例如： value1=intportion(10.2); 那麼value1就等於10 我們用intportion這個函數，就可以知道close/10這個數字的有沒有更動，這個數字是股價的十位數，這個價位如果改變就代表十位數變了。 以上是挑十位數站上另一個整數區間的腳本，也可以用同樣的方法寫出跌破一個整數價位區間的腳本。 當個股發生這種事情，代表其供需有些改變，如果找出背後的原因，也許就找到一檔飆股了。 [

#####


---

# 私房交易策略介紹之旱地拔葱

Source: https://www.xq.com.tw/lesson/sensor/scallion/

眼尖的各位，若一檔股票，一段時間量縮橫向整理後的中長紅，後市往往還有高點。 是的，這是自從我開始從事程式交易以來，最靠譜的交易策略 這個策略有三個原則 1. 超過十個交易日股價橫向整理 2. 在整理期間成交量明顯萎縮 3. 以中長紅的姿態突破整理 4. 突破時帶著比先前多出不少的成交量 過去為了找到這樣的股票，我曾經寫過也用過幾個策略 例如我常推薦大家使用的多次到頂而破策略雷達 

```
input:HitTimes(3); setinputname(1,"設定觸頂次數");
input:RangeRatio(1); setinputname(2,"設定頭部區範圍寬度%");
input:Length(20); setinputname(3,"計算期數");

variable: theHigh(0); theHigh = Highest(High[1],Length); //找到過去其間的最高點
variable: HighLowerBound(0); HighLowerBound = theHigh *(100-RangeRatio)/100; // 設為瓶頸區間上界
variable: TouchRangeTimes(0); //期間中進入瓶頸區間的低點次數,每跟K棒要歸0

//回算在此區間中 進去瓶頸區的次數
TouchRangeTimes = CountIF(High[1] > HighLowerBound, Length);

if TouchRangeTimes >= HitTimes and ( q_ask> theHigh or close > theHigh) then ret=1;
```

要使用這個策略，可以直接在雲端策略中心中訂閱多次到頂突破這個策略即可 [
![101707](/xstrader-content/uploads/2015/10/101707.png)
](/xstrader-content/uploads/2015/10/101707.png)訂閱後每天可以從警示中心這一頁盤中即時跳出符合這個策略的股票 [
![101708](/xstrader-content/uploads/2015/10/101708.png)
](/xstrader-content/uploads/2015/10/101708.png)這個腳本的最大問題是只考慮價沒有考慮量，而且只考慮向上突破而沒有考慮先有是否有量縮盤整。 後來我有寫過另一個叫股票箱突破的策略雷達 腳本如下: 

```
input:length(12);
value1=NthHighest(1,high,length);
value3=nthhighest(3,high,length);
value4=Nthlowest(1,low,length);
value5=nthlowest(3,low,length);

if
value1[1]<=1.03*value3[1]
and value5[1]<=value4[1]*1.03
and value1[1]<=value4[1]*1.1
and close>value1[1]
then ret=1;
```

這個腳本昨天出現訊號的股票如下圖 [
![101709](/xstrader-content/uploads/2015/10/1017091.png)
](/xstrader-content/uploads/2015/10/1017091.png)大家不妨參考對照未來的走勢。 除了上述兩個腳本之外，各位也可以根據上面的那四個定義，另外再寫出一個符合上述邏輯的策略，我覺得只要follow這四個精神，應該可以找到短多的股票，而且，勝率真的夠高。 這個交易策略背後的邏輯是，當股價脫離原先的盤整區域，代表原來的多空平衡已被破壞，一根中長紅代表的是多方正式撃潰空方的最後防線，接下來就是長驅直入了，我們在這時候進場，圖的就是這種空頭全面潰敗，多頭乘勝追擊追撃的過程，這個過程很重要的是 1. 要一確定中長紅就跟進去。 2. 最好挑那種對峙很久的，這種一被撃潰就後防空虛，多頭可以一路追撃。 3. 最好上面沒有太多解套賣壓的。 根據上述這三個原則，各位可以把這個策略的腳本改寫的更精準。 [

#####


---

# 幫手中持股設定賣出訊號出現時的通知機制

Source: https://www.xq.com.tw/lesson/sensor/sellnotice/

這一波快速的拉回，到昨天指數跌了500點，個股跌超過15%的一大堆，小弟我很慘，有一檔股票跌了兩成，之所以這麼慘，是因為前幾天的下跌時我在忙，看它跌多了就想說等反彈再來賣，沒想到後來就一直破底。 為了防止這樣的慘案再次發生，我今天寫了一個腳本，準備搭配XQ新開放的自動下單機制，讓電腦幫我賣股票。 這個腳本如下: 

```
//DMI賣出訊號
 input:Length(14); setinputname(1,"計算期數");
 variable: pdi(0), ndi(0), adx_value(0);
 DirectionMovement(Length, pdi, ndi, adx_value);
 if pdi<pdi[1] and ndi>ndi[1] and ndi crosses over pdi
 then ret=1
 else begin
   //KD高檔死亡交叉
   input: Length1(9), RSVt(3), Kt(3), HighBound(75);
   SetInputName(1, "計算期數");
   SetInputName(2, "RSVt權數");
   SetInputName(3, "Kt權數");
   SetInputName(4, "高檔區");
   variable: rsv(0), k(0), _d(0);
   Stochastic(Length1, RSVt, Kt, rsv, k, _d);
   if k>HighBound and k crosses under _d
   then ret=1
   else begin
     //MTM由正轉負
     input: Length2(10); SetInputName(1, "期數");
     if momentum(close,Length2) crosses under 0
     then ret=1
     else begin
       //投信法人都賣超
       if Open < Close[1] and Close < Close[1] and
          GetField("外資買賣超")[1]<0 and GetField("投信買賣超")[1]<0
       then ret=1
       else begin
         //MACD出現賣出訊號
         input: FastLength(12), SlowLength(26), MACDLength(9);
         SetInputName(1, "DIF短期期數");
         SetInputName(2, "DIF長期期數");
         SetInputName(3, "MACD天數");
         variable: difValue(0), macdValue(0), oscValue(0);
         MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);
         if oscValue Crosses Below 0
         then ret=1
         else begin
           //RSI高檔死亡交叉
           input: Length4(6); SetInputName(1, "短期期數");
           input: Length5(12); SetInputName(2, "長期期數");
           input: HighBound1(75); SetInputName(3, "高檔區");
           value1=RSI(close,Length4);
           value2=RSI(close,Length5);
           if value1 crosses under value2 and value1>HighBound1
           then ret=1
           else begin
             //一舉跌破多根均線
             input: shortlength(5); setinputname(1,"短期均線期數");
             input: midlength(10); setinputname(2,"中期均線期數");
             input: Longlength(20); setinputname(3,"長期均線期數");
             variable: shortaverage(0);
             variable: midaverage(0);
             variable: Longaverage(0);
             shortaverage=Average(close,shortlength);
             midaverage=Average(close,midlength) ;
             Longaverage = Average(close,Longlength);
             if close crosses under shortaverage and
                close crosses under midlength and
                close crosses under Longaverage
             then ret=1;
           end;
         end;
       end;
     end;
   end;
end;
```

透過這個腳本，只要系統有出現以下七種狀況的其中一種，電腦就會自動通知我。 1. DMI賣出訊號 2. KD高檔死亡交叉 3. MTM由正轉負 4. 投信外資都賣超 5. MACD出現賣出訊號 6. RSI高檔死亡交叉 7. 一舉跌破多根均線 然後把這個腳本拿去設成策略雷達，設定的畫面如下： [
![121501](/xstrader-content/uploads/2015/12/121501.png)
](/xstrader-content/uploads/2015/12/121501.png)執行商品設成庫存，如此一來，當出現賣出訊號時就會通知我了。 如果您的交易戶XQ有Support 的話，您也可以像我一樣，直接把單子下出去，不過目前這功能必須自行填交易張數，不能自動帶庫存。 [
![1125](/xstrader-content/uploads/2015/12/1125.png)
](/xstrader-content/uploads/2015/12/1125.png)[

#####


---

# 運用趨勢性指標時，透過股性做確認趨勢是否成形

Source: https://www.xq.com.tw/lesson/sensor/trendindicator/

當趨勢指標(如MA，MACD出現買進訊號時，我們最忐忑的是，這把下去不知道會不會又踫到盤整盤所出現的假訊號，偏偏老手們常說一年裡頭三個月漲，三個月跌，六個月盤，所以摃龜的機率還蠻大的。我試著在趨勢指標出現買進訊號時，再加上一個濾網，看看是否當上昇趨勢成形時，股性是否也明顯變好，如果兩者同步，代表脫離盤整的機會比較高。 基於上述的精神，我寫了一個腳本如下： 

```
 //先預計兩個前提假設都不存在
condition1=false;
condition2=false;

//定義趨勢明確的條件

// MACD 黃金交叉 (dif向上穿越macd)
//
input: FastLength(12, "DIF短期期數"), SlowLength(26, "DIF長期期數"), MACDLength(9, "MACD期數");
variable: difValue(0), macdValue(0), oscValue(0);

SetBarBack(maxlist(FastLength,SlowLength,6) + MACDLength);
SetTotalBar((maxlist(FastLength,SlowLength,6) + MACDLength) * 4);


MACD(weightedclose(), FastLength, SlowLength, MACDLength, difValue, macdValue, oscValue);

if difValue Crosses Above macdValue
then condition1=true;

//定義有足夠的證據顯示股性出現轉變


input:day(66,"股性指標的移動平均天數");
input:ratio(10,"股性指標超出均值比率");
variable:count(0);


value1=q_TotalTicks;//總成交次數
value2=average(value1,day);
value3=GetField("強弱指標");
value4=average(value3,day);
value5=GetField("外盤均量");
value6=average(value5,day);
value7=GetField("主動買力");
value8=average(value7,day);
value9=GetField("開盤委買");
value10=average(value9,day);
count=0;
if value1>=value2*(1+ratio/100)
then count=count+1;
if value3>=value4*(1+ratio/100)
then count=count+1;
if value5>=value6*(1+ratio/100)
then count=count+1;
if value7>=value8*(1+ratio/100)
then count=count+1;
if value9=value10*(1+ratio/100)
then count=count+1;

if count >=3 then condition2=true;

//當上昇趨勢成形且股性明顯轉變時

if condition1 and condition2
then ret=1;








```

這個腳本就是使用了強弱指標，外盤均量，主動買力，總成交次數及開盤委買張數等五個指標做為衡量股性的工具，任何MACD出現黃金交叉的股票，都必須在上述五個股性指標中，有三個以上能夠出現比平均值高出一成以上的表現。 我試著用這樣的方法，來避開趨勢性指標出現太多假訊號，造成過多停損的後果。 當然也有朋友會透過選股的方式，先找出原本就認為比較有上漲機會的股票，這也是一種方式。 找形成上昇趨勢的股票，並且努力濾掉那些假訊號，是一個值得長期study的topic。 [

#####


---

# 主力一直在買的股票何時可以進場跟單？

Source: https://www.xq.com.tw/lesson/sensor/whenenter/

為什麼主力買超這麼多，股票還是不會漲？ 主力買超的股票我衝進去買，會不會剛好被主力出貨？ 自從主力買超這樣的資料隨處可以取得之後，這兩個問題常常被提出來。 我寫過幾個腳本，想要找出主力佈局後開始拉高的第一時間點，以下是我的研究過程。 首先我想先找出主力買超且股價近期還沒有大漲過的股票，我用的選股條件如下： [
![022603](/xstrader-content/uploads/2016/02/022603.png)
](/xstrader-content/uploads/2016/02/022603.png)首先我先定義那些股票是屬於主力買超： 1. 近2天每天都買超超過500張 或者是 2. 近2天每天買超張數合計佔成交量5%以上 或者是 3. 最近10天加起來買超超過2000張 其次，我只挑中小型的股票，所以我設了一個條件把股本超過100億元的股票都濾掉。 最後，為了避免被主力逢高出貨，所以我濾掉那些主力買超但十天內漲幅超過一成的股票，這個部份我是寫了一個選股的腳本如下： 

```
input:period(10,"計算區間");
input:ratio(10,"最低漲跌幅");

if close[period-1]<>0
then begin
if (close/close[period-1]-1)*100<ratio
then ret=1;
end;
outputfield(1,(close/close[period-1]-1)*100,1,"區間漲跌幅");

```

以昨天為例，昨天符合這些條件的股票共有45檔，我根據主力買超張數排序，超過100張的名單如下： [
![020604](/xstrader-content/uploads/2016/02/020604.png)
](/xstrader-content/uploads/2016/02/020604.png)
接下來我用符合這些條件的股票，用盤中的腳本去跑，希望找到那些主力即將開始拉昇的股票，以下的這個腳本，是我覺得不錯用的： 

```
if barfreq <> "Min" or Barinterval <>1 then RaiseRuntimeError("請設定頻率為1分鐘");
input:n1(10);
setinputname(1,"開盤連續幾分鐘");
variable:BarNumberOfToday(0); 
if Date <> Date[1] then BarNumberOfToday=1 
else BarNumberOfToday+=1;{記錄今天的Bar數} 

if Date =currentdate then begin
variable: idx(0),tTime(0);
tTime=0;
 
for idx = 0 to n1-1
begin
if Close[idx] > Close[idx+1] then tTime+=1;
 {推升時記1}
 end; 

if tTime >=n1*0.6//1分鐘線大部份的時間都在上漲
and q_PriceChangeRatio < 5 {漲幅仍在5%內}
and Timediff(Time,Time[BarNumberOfToday-1],"M") =n1{分鐘} 
 {離開盤第1個價10分鐘內}

then ret=1;
end;
```

這個腳本是去尋找今天開盤前十分鐘，十根一分鐘線裡，至少六根是上漲的。為什麼這麼寫呢? 因為通常主力買超的數據在前一晚公佈後，今天開盤一定會有散戶去搶，主力如果還沒有要開始拉，開盤的時候應該是會站在賣方，打下來之後再繼續吃，如果開盤十分鐘走勢超過六成的時間都上漲，很有可能就是今天要表態了。 當然這個腳本如果在大盤開高時，容易出現錯誤的訊號，但如果在大盤開低或開平時，就很值得參考了。 以上是我的研究，報告完畢。 [

#####


---

# XS策略雷達高手分享篇

Source: https://www.xq.com.tw/lesson/sensor/xs%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E9%AB%98%E6%89%8B%E5%88%86%E4%BA%AB%E7%AF%87/

[
![高手分享](/wp-content/uploads/2016/03/XS策略雷達_07.png)
](/wp-content/uploads/2016/03/XS策略雷達_07.png)在這裡我們蒐集了一些高手分享的XS警示，這裡面的文章都有提供警示內容以及應用方式，大家可以複製到XQ操盤高手內跑看看。也歡迎大家加入我們的 [臉書專頁 ](https://www.facebook.com/XQ全球贏家-178222061342)，我們會不定期的分享更多的應用，更歡迎您隨時跟我們交流。 

- [潛龍飛天 ](http://xstrader.net/潛龍飛天)
- [Larry Williams 短線交易秘訣 ](http://xstrader.net/larry-williams-短線交易秘訣/)
- [股價越過整數關卡 ](http://xstrader.net/股價越過整數關卡)
- [私房交易策略介紹之旱地拔葱 ](http://xstrader.net/私房交易策略介紹之旱地拔葱)
- [盤中開始暴量的低PB股 ](http://xstrader.net/盤中開始暴量的低PB股)
- [幫手中持股設定賣出訊號出現時的通知機制 ](http://xstrader.net/幫手中持股設定賣出訊號出現時的通知機制)
- [運用趨勢性指標時，透過股性做確認趨勢是否成形 ](http://xstrader.net/運用趨勢性指標時，透過股性做確認趨勢是否成形/)
- [看盤用的腳本 ](http://xstrader.net/看盤用的腳本)
- [跨頻率多重濾網交易策略的設計 ](http://xstrader.net/跨頻率多重濾網交易策略的設計)
- [主力一直在買的股票何時可以進場跟單? ](http://xstrader.net/主力一直在買的股票何時可以進場跟單?)

### [免費下載桌機版 ](https://bit.ly/2F7A6ct)

### [程式內可購買「盤中量化交易模組」 ](https://bit.ly/2F7A6ct)

以「月」計價，首次訂閱後享有7天體驗鑑賞 
[

#####


---

# 雲端監控

Source: https://www.xq.com.tw/lesson/xqapp/cloudmonitor/

不知道各位小夥伴們平常追蹤多少檔個股呢？ 小編比較懶，只追蹤了51檔股票，建立了8個群組 ? 根據研究統計，台灣股民平均追蹤的個股為117檔，中位數為61檔，群組數為14組！ 相信大家的狀況也差不多，對吧？ 當追蹤的個股數量一多，監控和警示的設定就變得很麻煩，一檔一檔設定真的很辛苦對吧？ 所以，隆重向大家介紹：XQ APP 全新功能—雲端監控上線拉！ **雲端監控不只能監控「個股」還能同時監控「群組」和「庫存」，更重要的是… ****除了最基本的「價格」、「量能」外，還添加了非常多的策略性條件！ **接下來就讓我們一起玩這強大的功能唄 ? [
![](/wp-content/uploads/2022/01/1642401148045.jpg)
](/wp-content/uploads/2022/01/1642401148045.jpg)

### **一、針對個股進行監控 **
如果我們已經鎖定好目標，正在虎視眈眈的等待機會上門，就非常適合使用個股來進行監控。 過去我們只能「價格、量能、事件和新聞」作為監控的條件，現在我們還能透過各式各樣的「策略」來進行監控： 目前我們能夠透過「功能捷徑」中的入口 和 個股頁面中的「警示」進入雲端監控區 [
![](/wp-content/uploads/2022/01/01.jpg)
](/wp-content/uploads/2022/01/01.jpg)接下來我們只要選擇自己想要的條件即可完成設定，以下圖為例：假設我們希望以「突破三角整理」作為我們的條件，那麼我們可以在「型態」的分類中找到，然後直接選擇即可，就是這麼簡單 ? [
![](/wp-content/uploads/2022/01/02.jpg)
](/wp-content/uploads/2022/01/02.jpg)

### **二、針對群組進行監控 **
想必大家針對不同類型的群組都有不同的觀察模式對吧？如果我們所設定的群組是「屬性差異性比較大」的，那就非常適合使用群組監控（每一種類型的商品所設定的條件應該會不同），只要群組中有任何一檔商品滿足條件就會發出通知！ [
![](/wp-content/uploads/2022/01/03.jpg)
](/wp-content/uploads/2022/01/03.jpg)[
![](/wp-content/uploads/2022/01/04.jpg)
](/wp-content/uploads/2022/01/04.jpg)除了在雲端監控的功能區中進行設定以外，我們也能在「自選群組」中快速加入監控 [
![](/wp-content/uploads/2022/01/05.jpg)
](/wp-content/uploads/2022/01/05.jpg)

### **三、針對庫存進行監控 **
庫存監控除了可以根據不同帳號進行監控外，同樣也能滿足多元的加碼或出場條件，以下圖為例我們設定： ● 買進後下跌5% ● 買進後爆量價跌 ● 買進後股價創五日新低 ● 買進後大戶連續賣出 [
![](/wp-content/uploads/2022/01/06.jpg)
](/wp-content/uploads/2022/01/06.jpg)

### **四、查看監控通知 **
我們可以在「通知中心」和「個股警示」的頁面中查看已經觸發的通知 [
![](/wp-content/uploads/2022/01/07.jpg)
](/wp-content/uploads/2022/01/07.jpg)

### **五、操作小技巧 **
雲端監控可以同時設定數種不同的策略，對於單商品、群組、帳號庫存有多種需求的小夥伴們可以善用這個功能，除此之外我們也可以根據市場變化對個別的條件開關提示，這樣可以有效的避免過多的通知，如此一來設定再多通知也不用怕吵雜囉～ [
![](/wp-content/uploads/2022/01/08.jpg)
](/wp-content/uploads/2022/01/08.jpg)好拉～今天的介紹就到這裡，相信各位小夥伴們已經能夠感受雲端監控的強大與便利了，趕快打開 XQ APP 體驗這項功能吧? [

#####


---

# 族群透視

Source: https://www.xq.com.tw/lesson/xqapp/group/

大部分剛入市的小夥伴們在進行選股時，大多都是透過 **「直接條件」 **或 **「大眾排行」 **找到個股。 但諷刺的是 … 「明明自己設定的條件看起來既完美又嚴苛，或者自己排行的類別看起來非常可靠，甚至被找出來的個股其技術面看起來也很妥妥當當，但最後要下單時手還是情不自禁地抖了兩下。」 因為我們其實內心都清楚… **即便看起來很完美卻仍有些草率了 **，對吧 ? 然而操作的方式百百種，俗話說： **人以群分 股以類聚 **，如果今天我們換個方式， **改從近期的類股輪動找出強弱勢族群，再從其成分股中找出領頭羊或潛力股 **，也不失為一個不錯的方式喔 ? XQ全新功能–族群透視 除了提供最基本的29大「上市櫃」類股排名外，還提供 **「細產業」 **及 **「熱門主題」 **的族群排行，最重要的是 … **我們還能從中找到大戶默默關注的族群 **? 廢話就說到這，一起來玩玩看吧！ 老話一句，還沒上車的小夥伴們趕緊下載囉 ～ [
![](/wp-content/uploads/2022/03/1647831202814.jpg)
](/wp-content/uploads/2022/03/1647831202814.jpg)

### **一、從這裡進入族群透視首頁 **
目前我們可以透過三個入口進入族群透視的首頁，分為別「功能捷徑」、「行情Memu」以及「首頁小工具」。 [
![](/wp-content/uploads/2022/03/1647831268740.jpg)
](/wp-content/uploads/2022/03/1647831268740.jpg)

### **二、上市櫃排行 **
****目前XQ APP在上市櫃排行提供了「漲幅」、「跌幅」、「成交比重」和「比重差」四項分類進行篩選，我們可以根據這四個分類快速找到強勢族群。 這邊想提醒一下剛入市的小夥伴們： 我們在族群（資金流向／產業輪動）的分析時，個人認為 **「成交比重」 **及 **「比重差」 **的重要性是大於漲跌幅的，所以千萬別為了求方便只關注漲跌幅喔 ? **[
![](/wp-content/uploads/2022/03/1647831367141.jpg)
](/wp-content/uploads/2022/03/1647831367141.jpg)**

### **三、細產業 & ****主題 **
**「細產業」族群是根據上市29類進一步拆解的群組，而「主題」則是透過各式各樣的題材組合而成 **，近似於「概念股」的邏輯。 透過細產業 & 主題排行能讓我們 **進一步縮小篩選範圍 **，更有效率地找到目標獵物，各位小夥伴們務必善用阿！ 目前XQ APP在這兩項排行提供了「漲幅」、「跌幅」、「量比」、「買進大戶」和「賣出大戶」五項分類進行篩選，我們同樣可以根據這五項分類快速找到強勢族群。 尤其是 **「買進大戶」 **和 **「賣出大戶」 **是我們特別需要關注的，它簡單明瞭地讓我們知道目前大戶最青睞最照顧哪些細分族群，換言之有了這兩項數據對我們的操作那是一個如虎添翼哪～ 所以強烈建議： **一定要使用細產業 & ****主題族群來操作！ ****一定要使用細產業 & ****主題族群來操作！ ****一定要使用細產業 & ****主題族群來操作！ **[
![](/wp-content/uploads/2022/03/1647831476956.jpg)
](/wp-content/uploads/2022/03/1647831476956.jpg)

### **四、實戰小技巧 **
上面的分享相信各位小夥伴們已經非常清楚「族群透視」可以為我們在操作上提供哪些幫助，接下來小編將近一步和大家分享三個分析時的小眉角： ① 交集：如果某個族群同時出現在各項分類（漲幅／成交比重／比重差／買進大戶）的 **前3名 **② 差距：如果某個族群在漲幅／成交比重／比重差／買進大戶分類中排名第一，且與第二名在 **數據上有明顯的差距 **③ 時間：如果某個族群 **「當日」 **的排名和 **「近五日」 **的排名都在前3名 如果我們分析時發現滿足上面其中一點，那麼該族群就值得我們特別留意喔 ? 好拉 ～ 今天的介紹就到這兒， **趕快拿起你的手機揪出強勢類股吧！ **

### 
[

#####


---

# XQ獨家大戶買賣力

Source: https://www.xq.com.tw/lesson/xqapp/ibp/

相信大部分喜歡當沖的小夥伴們肯定經常遇到這樣狀況： **當我們正在看盤的時候沒有交易機會，而當我們沒在看盤的時候卻錯過交易機會。 **此時我們轉身回頭看著股價就像變了心回不去的女朋友，於是我們陷入兩難，到底是追還是不追？ 追了心裡毛毛的，不追心裡卻癢癢，追了你會擔心，不追你又不甘心；人生中最矛盾的時候大概莫過於此。 現在，我們只要打開XQ手機版中的 **「大戶買賣力」 **就可以輕鬆解決這個問題！ 我們都知道 **生活中「錢」不是萬能，但是在股市中有「錢」就是神；所以不管價格如何起起落落，我們只要跟著主力準沒錯！ **這篇文章我們將會和你分享：如何利用大戶買賣力讓交易變更超容易！ 還沒下載XQ手機版的小夥伴們趕緊上車囉 ～ [
![](/wp-content/uploads/2021/09/1630476414685.jpg)
](/wp-content/uploads/2021/09/1630476414685.jpg)

### 

### **一、什麼是「大戶買賣力」和「散戶買賣力」 **
不免俗的還是要向大家快速介紹一下這個指標，簡單來說 … ★ 大戶買賣力：大戶在盤中的買賣趨勢變化，你只要看到大戶買賣力 **以紅柱的方式表現，代表大戶目前正在買 **， **綠柱則代表正在賣。 **★ 散戶買賣力：散戶在盤中的買賣趨勢變化，你只要看到散戶買賣力 **以紅柱的方式表現，代表散戶目前正在買 **， **綠柱則代表正在賣。 ******由於官網上對於大戶買賣力的介紹已經非常多詳細的介紹了，為了節省各位小夥伴們時間，這邊就簡單帶過，有興趣研究更多關於「大戶買賣力」的小夥伴們可以參考： ● 大戶買賣力影片教學 

- [一分K大戶買賣力累積指標 ](https://www.xq.com.tw/videoteach/一分k大戶買賣力累積指標/)
- [大戶買賣力變成可以出交易訊號的腳本 ](https://www.xq.com.tw/videoteach/大戶買賣力變成可以出交易訊號的腳本/)
- [用大戶買賣力來研判持股續抱還是出場 ](https://www.xq.com.tw/videoteach/用大戶買賣力來研判持股續抱還是出場/)
● [XQ手機版的大戶買賣力指標功能介紹 ](https://xstrader.net/xq手機版的大戶買賣力指標功能介紹/)

### **二、如何在XQ APP中開啟大戶買賣力指標 **
我們只要從單商品頁面中切換圖中的即時指標，就可以看到大戶買賣力的相關指標囉；除此之外我們也能直接在K線圖中的「副圖」區找到。 [
![](/wp-content/uploads/2021/10/1634191804133-1.jpg)
](/wp-content/uploads/2021/10/1634191804133-1.jpg)

### **三、用「大戶買賣力」讓交易變得更容易 **
金融市場中指標百百種，每一種都有它最適合的使用時機，對小編而言「 **大戶買賣力 **」常被當作「 **濾網 **」來使用，所以我們在進行每一筆交易之前最好都先確認過這個指標目前的狀態。 接下來的說明是小編個人的經驗分享，僅供參考： **（迷之音：為了更好的讓各位小夥伴們理解文章的說明，所以接下來的畫面使用「改版前」的畫面進行說明，但是並不影響操作的邏輯喔 ?） **

#### **① 散戶在買，大戶卻在賣 → 暗示當天最高點可能已經出現 **
容易發生在一段上漲行情的末段或一段下跌行情的開始；從指標中我們可能會發現散戶的買量在漸增，這時主力有可能仍在買，但買量大幅減少而且在漸減，或者主力直接由買轉賣。 [
![](/wp-content/uploads/2021/09/1630477345251.jpg)
](/wp-content/uploads/2021/09/1630477345251.jpg)**◆ 手上有單的小夥伴們請保持警惕，看是要先減碼還是獲利了結 ****◆ 手上沒單的小夥伴們哪怕手再癢都建議放棄本次的進場機會，股市中少賠就是多賺 **

#### **② 大戶在買，散戶卻在賣 → 暗示一段行情可能即將發動 **
容易發生在一段上漲行情的開始，從指標中我們可能會發現主力買量漸增或由賣轉買，而散戶賣量可能持平。 [
![](/wp-content/uploads/2021/09/1630477521435.jpg)
](/wp-content/uploads/2021/09/1630477521435.jpg)**◆ 手上有單的小夥伴們可以考慮待股價突破壓力後做加碼的動作 ****◆ 手上沒單的小夥伴們可以考慮小額進場試試水溫，即便錯過最佳買點仍然可以考慮嘗試 **

#### **③ 大戶在買，散戶也在買 → 相對穩健的進場機會 **
容易發生在一段上漲行情的中段，或者剛突破某個關鍵壓力，從指標中我們可能會發現主力和散戶同步量增。 [
![](/wp-content/uploads/2021/09/1630477667947.jpg)
](/wp-content/uploads/2021/09/1630477667947.jpg)**◆ 手上有單的小夥伴們可以考慮逢低進行加碼，只要拉回不破支撐都是相對穩健的買點 ****◆ 手上無單的小夥伴們可以考慮用比較大的金額進場，但切記嚴守停損 **

#### **④ 散戶在賣，大戶也在賣 → 保持觀望或考慮做空 **
這種狀況除非做空，不然我相信各位小夥伴們應該也不敢輕易動作吧？所以如果看到這樣的狀態就果斷放棄吧，休息是為了走更遠的路? [
![](/wp-content/uploads/2021/09/1630477781199.jpg)
](/wp-content/uploads/2021/09/1630477781199.jpg)今天就先講到這裡，簡單為大家做個小結論 : 「大戶買賣力」這項指標能有效的輔助我們進行交易決策，不論進場或出場它都能提供可靠的參考依據；雖然凡是無絕對，大戶買賣力也不是萬能，但透過這項指標能幫助我們確認自己與大戶站在同一邊，長期下來獲利的可能性也相對較高。 **最重要的是 … 現在XQ APP也支援大戶買賣力，這意味著不論你走到哪裡都能和大戶站在一起，趕快拿起手機打開「大戶買賣力」吧 **? [

#####


---

# 個股資訊

Source: https://www.xq.com.tw/lesson/xqapp/isi/

還記得剛開始進入股市的那年，小編苦心鑽研各種技術分析… 天真的我以為：「只要把技術分析學好了，成為賭神那是指日可待！」 然而「現實」總是和「限量」一樣殘酷，即便小編使盡洪荒之力仍無法穩定獲利 熬過七七四十九個漫長的夜，夢中終於一道金光湧現，於是恍然大悟： **原來…盤後功課跟盤中進出場一樣重要 **但是弱弱的我很快就發現問題： **盤後資訊猶如漫天星辰，我該研究些什麼？我又該如何研究？這些數據它們的意義又是什麼？ **如果你目前的階段和當時的小編一樣不知所措… 那麼接下來我將會和你分享自己當時 **苦研九九八十一天的盤後小小心得 **透過這個方式我們能在10秒內完成盤後的分析，一起看下去唄 ? 還是要呼籲一下：還沒下載XQ手機版的小夥伴們趕緊下載R ～ [
![](/wp-content/uploads/2021/12/006.jpg)
](/wp-content/uploads/2021/12/006.jpg)開始之前小編必須和大家分享最近更新的實用功能： 現在我們可以將常用的盤後資訊頁儲存起來囉 ～ 這意味著我們在做每天盤後功課的效率將大幅提升，看完這篇文章後別忘了將小編分享的頁面設定為「常用」喔 ? [
![](/wp-content/uploads/2021/12/007.jpg)
](/wp-content/uploads/2021/12/007.jpg)除此之外，XQ很貼心的將籌碼和財務中幾個比較需要經常關注的數據整理為一個頁面，在近期中更是強化了視覺化的數據表現，這意味著我們能在最短的時間內完成每天的盤後功課 ? [
![](/wp-content/uploads/2021/12/008.jpg)
](/wp-content/uploads/2021/12/008.jpg)介紹完更新的內容後就讓我們一起解讀盤後數據吧 ～ 仍然免不了還是要先來個免責聲明： **接下來小編的分享純屬個人經驗，僅供參考喔！ **

### **一、三大法人買賣超 ****— ****跟隨法人準沒錯，但前提是要跟對人 **
三大法人買賣超的重要性相信即便是剛入市的小夥伴們也非常清楚，所以這邊就不再說明囉～ 實戰中如果三大法人的動向一致，基本上沒有太多懸念，但是如果三大法人動向不一致的時候我們又該跟誰走呢？ 

#### **① 短線看自營，波段看投信，長線看外資 **
****

#### **② 大型股看自外資，中型股看投信，小型股看自營 **
****上面這種兩做法都是基於三大法人的投資特性做為依據… 外資由於財力雄厚，在股市中 **風險承受的能力較高 **，對一個身價數十億的土豪而言短期震盪上上下下個幾百萬真的不痛不癢，只要產業有前景且公司體質佳， **長線佈局 **才是土豪們的唯一解答，更何況外資通常是右手現貨左手期貨嘴巴還咬著選擇權避險， **進場位置的好壞並不重要 **。 投信追求的是 **績效的表現 **，漲的要比大盤多，跌的要比大盤少；所以對於選股的能力有較高的要求，砸大把銀兩養了一群研究員只為了找到市場中那些 **有潛力而且目前被估低的股票 **，同時礙於配息的壓力，買進的股票也不能放太久，所以大多以 **波段 **做為他們主要的操作方式。 自營商大概是失眠比例最高的一群人，因為他們追求的是 **絕對報酬 **，不論漲跌他們都必須賺錢，否則下個月可能就要回家種田；由於手中的資金相對前面兩者來的低，為了極大化資金的運用率，他們以中小型股做為主要標的，同時在 **不能賠錢 **的前提下，所以他們幾乎有賺就跑，對於 **進場位置的要求相當嚴格 **。 [
![](/wp-content/uploads/2021/12/009.jpg)
](/wp-content/uploads/2021/12/009.jpg)

### **二、融資融券 ****— ****觀察散戶動向，提前烙跑就看它 **
過去不少前輩們以此數據做為市場中的「反指標」，畢竟散戶大部分都是賠錢的嘛 ? 但是如果我們持續有在關注股市的變化，不難發現現在的散戶相較於從前已經聰明不少，反指標的效果已經不是那麼明顯了，所以現在既不能反著看又不能順著看那到底要怎麼看？ 

#### **① 資券餘額與股價呈反方向變動是訊號 **
******融資餘額下降，融券餘額上升，股價上升： **散戶一致不看好的股票但價格卻持續上漲，意味著背後可能有主力在支撐，後續常伴隨著一波漲幅，這時候我們可以考慮小額買進試水溫。 **融資餘額上升，融券餘額下降，股價下降： **散戶一致看好的股票但價格卻持續下跌，意味著可能有一些我們不知道的利空消息，如果我們手上剛好有持股建議開始分批出場囉。 [
![](/wp-content/uploads/2021/12/10.jpg)
](/wp-content/uploads/2021/12/10.jpg)

#### **② 融資使用率–像天堂的懸崖 **
融資使用率逐步上升對股價拉抬有著正面顯著的效果，實務上我們也經常能看到那些高使用率的個股價格屢創新高飆不停，但是我們要清楚的是… **融資使用率在高檔，代表欲追價的散戶多半已經進場，這時候我們再去追可能也晚了 **；再者融資是需要利息的且利率還不低，這意味著大部分融資買進的都是以短線為主，聰明的小夥伴們看到這裡想必就明白了… 沒錯～ **隨時有可能崩阿～這是天堂也是懸崖 ****R ****！ **實務上如果某檔股票的融資使用率超過60%我們就要非常留意囉～ 

#### **③ 券資比維持高檔，可能暗藏機會 **
相信不少小夥伴對券資比的觀點是「與股價成反方向運動」，畢竟龐大的融券餘額從理論上的確不利股價上漲，但這是從散戶的觀點來推測，如果今天我們是主力那可能就不是這麼一回事了～ 融券賣出有強制回補的機制，所以今天主力若要拉抬難度也會相對容易，簡單來說只要我們看到某檔股 **票 ****券資比維持在高檔不退（超過60%），而股價仍持續上漲，或是沒有持續下殺 **，那麼不妨考慮是不是小賭一把看有沒有軋空機會。 [
![](/wp-content/uploads/2021/12/11.jpg)
](/wp-content/uploads/2021/12/11.jpg)

### **三、買賣家數差 ****— ****洞察主力意圖的好用指標 **
「買賣家數差」常和「主力買賣超」一起使用， **前者幫助我們觀察籌碼的集中度，後者幫助我們觀察主力的買賣方向 **。 主力買賣超比較廣為人知，所以小編不再多做說明，買賣家數差的公式為：「當天買進這檔股票的券商數 – 當天賣出這檔股票的券商數」 當這個指標的數字為正，代表籌碼分散，反之負數則為集中；所以我們如果觀察到某檔股票連續幾天的 **買 ****賣超為正，而買賣家數差為負，且兩者有持續擴大的跡象 **，那麼我們就可以考慮進場囉 ～ 好啦今天的課就上到這裡，小編這麼努力分享寫了這麼多， **如果你們還不趕快下載 ****[XQ APP ](https://utm.to/4s7r96)****那真的是太對不起小編了喔 **～ 下課（噹噹噹）！ [

#####


---

# 今日財經

Source: https://www.xq.com.tw/lesson/xqapp/newsapp/

繼上回推出「為您推薦」新聞，獲得廣大迴響及使用者愛用後，我們為投資人再度推出個股新聞訂閱及焦點專題功能。 

### **個股新聞訂閱 **
有投資股票的人，就會知道，當自選股名單越加越多時，每天要追蹤的個股新聞，就會越來越多，且要從各媒體平台，把個股的新聞全部看完一遍更是花時間。有鑑於此，結合國內一流財經媒體的今日財經APP，推出「個股新聞訂閱」功能，一個平台，一個點擊，就可以看完您所有關心的股票的新聞。 

#### 進入首頁「為您推薦」，即可看到「個股追蹤」，還沒有訂閱個股的話，點擊「立即前往」即可新增個股清單。提醒一下，要使用「個股追蹤」功能的話要先登入之後才能使用喔。 
[
![](/wp-content/uploads/2020/08/001_為您_個股追蹤空值-473x1024.png)
](/wp-content/uploads/2020/08/001_為您_個股追蹤空值.png)

#### 輸入股號或股名，可以找出符合的股票 
[
![](/wp-content/uploads/2020/08/002_輸入股票-473x1024.png)
](/wp-content/uploads/2020/08/002_輸入股票.png)

#### 可以新增台、美、港、中、日、韓等六個市場的股票 
[
![](/wp-content/uploads/2020/08/002_六大市場-473x1024.jpg)
](/wp-content/uploads/2020/08/002_六大市場.jpg)

#### 成功訂閱後，再次進入首頁，「為您推薦」的「個股追蹤」畫面就會出現了 
[
![](/wp-content/uploads/2020/08/001_個股追蹤-473x1024.png)
](/wp-content/uploads/2020/08/001_個股追蹤.png)

#### 點「更多」後可以瀏覽訂閱個股的全部新聞。在這裡您也可以篩選單一檔個股，或者編輯訂閱個股清單。 
[
![](/wp-content/uploads/2020/08/002_個股訂閱_篩選功能-975x1024.png)
](/wp-content/uploads/2020/08/002_個股訂閱_篩選功能.png)

### 

### **焦點專題 **
怎麼找出投資題材，進而佈局投資呢？今日財經APP，背後有一群專業的財經媒體團隊，為各位整理出目前市場投資的最新動向：什麼題材最夯？什麼科技是未來趨勢？每個投資話題的相關個股有哪些？這些資料在「焦點專題」內都可以找到。 

#### 由首頁為您推薦，或是DJ新聞的焦點，都可以進入「焦點專題」 
[
![](/wp-content/uploads/2020/08/003_專題入口-1001x1024.png)
](/wp-content/uploads/2020/08/003_專題入口.png)

#### 

#### 在四月底，我們推出了「道別中國製造，盤點上市櫃電子/傳產供應鏈遷徙動向」專題，整理出告別大陸製造，產業重新佈局的方向。 
[
![](/wp-content/uploads/2020/08/003_單一專題-1024x524.png)
](/wp-content/uploads/2020/08/003_單一專題.png)

#### 七月時，我們推出了「後疫情暑期商機最亮五大族群」專題，整理出解封+振興券，影響觀光、百貨超商、戶外運動、生醫、遊戲等五大族群的投資商機，大家可以參考。 
[
![](/wp-content/uploads/2020/08/003_單一專題_疫情-1000x1024.png)
](/wp-content/uploads/2020/08/003_單一專題_疫情.png)

#### 如果您還沒有安裝【今日財經App】的話，趕快點擊連結? [開始下載 ](https://utm.to/4s4p8k)喔！ 
[
![](/wp-content/uploads/2020/08/下載.png)
](/wp-content/uploads/2020/08/下載.png)[

#####


---

# XQ獨家快速下單

Source: https://www.xq.com.tw/lesson/xqapp/quicktrade/

常常覺得透過手機「盯盤」和「下單」是一件很麻煩的事… 每次好不容易抓到絕佳的進場機會，卻需要來回切換不同頁面才能完成「確認」和「下單」的動作！ 對於中長線的操作倒也不痛不癢。 但是對於幾個Tick就能決定成敗的短線或極短線操作來說 … 那是一個痛呀！因為 **快市來臨時的機會往往在毫秒之間 **所以今天我們又要來跟各位小夥伴們分享好消息啦！ XQ手機版本次新增了「快速下單」這個功能： 俗話說 **「天下武功唯快不破」 **；這個功能顧名思義就是「快」，到底有多快就讓我們一起看下去唄 ? 老樣子，還沒上車的小夥伴們趕緊囉！ [
![](/wp-content/uploads/2021/11/1638254624255.jpg)
](/wp-content/uploads/2021/11/1638254624255.jpg)

### 

### **一、瀏覽商品的同時完成下單動作 **
光看標題想必各位小夥伴們已經驚艷了兩秒對吧？因為市面上還沒有哪個下單平台做到呢 ～ 在XQ手機版中，不論我們在哪一個頁面瀏覽商品，我們都能啟動「快速下單」功能： 

#### **● 當我們在自選或行情頁中瀏覽商品的時候 **
只要點擊「商品名稱」或右側金錢的icon，就能夠開啟快速下單的面板，開啟快速下單面板的同時，我們仍然能在上方區塊進行滑動。 這意味著我們可以查價和下單同步進行，豪不謙虛的說…這個功能在實務中真的超方便！ 絕對是用過了就回不去的那種 ? [
![](/wp-content/uploads/2021/12/0001-1.jpg)
](/wp-content/uploads/2021/12/0001-1.jpg)

#### **● 當我們在單商品頁瀏覽的時候 **
****這個頁面所涵蓋的訊息非常多，尤其當我們在K線圖上進行分析的時候，每個數字每個點位都是細節，頁面切來切去真的很容易讓人失去耐心。 我們同樣可以點擊右側金錢的icon或點選「價格」就開啟快速下單面板，這樣就能夠在一個頁面中實現 **「分析」和「下單」同步進行 **的操作囉 ～ 不過這裡要特別提醒的是，要記得將「系統設定 - 快速下單設定 - 點價開啟快速下單」開啟呦！ [
![](/wp-content/uploads/2021/12/002.jpg)
](/wp-content/uploads/2021/12/002.jpg)

#### **● 當我們在選擇權 T 字報價瀏覽的時候 **
****小編每次在看 T 字報價時常常都會頭昏眼光，尤其是在使用畫面相對較小的APP時更是如此。 除了上下滑動還要左右滑動，同時還要切換下單畫面，經常這樣的操作長期下來真的頗累 這次的快速下單功能同樣支援選擇權的 T 字報價呦 ? **[
![](/wp-content/uploads/2021/12/003.jpg)
](/wp-content/uploads/2021/12/003.jpg)**

### **二、除了下單還能同步改量、改價和刪單 **
如果只提供下單的功能那就太樸實無華且枯燥了，快速下單面板還可以同步支援刪單、，改量和改價的操作一樣可以在這個面板中快速完成 ～ [
![](/wp-content/uploads/2021/12/004.jpg)
](/wp-content/uploads/2021/12/004.jpg)

### **三、別忘了躲在最後一頁的快捷功能 **
我們將快速下單面板滑到最右邊的那一頁可以看到我們熟悉的「快捷按鈕」，這次改版中我們將原先的連結按鈕調整為「商品走勢」、「技術分析」、「閃電下單」和「加入自選」，就是要讓各位小夥伴們更精準更快速的完成下單任務！ [
![](/wp-content/uploads/2021/12/005.jpg)
](/wp-content/uploads/2021/12/005.jpg)

### **四、操作小訣竅 **
最後簡單說明一下快速下單的「手勢操作」；於面板中拖曳向上滑動可以開啟「完整下單及委託頁」，向下則可關閉快速下單面板，左右滑動可於不同面板分頁進行切換。 好拉～今天的介紹就到這裡囉！ 趕快跟著小編一起打開XQ手機板感受快速下單的便利吧 ? 

#### **溫馨提醒：XQ APP 實單交易功能支援【Android】系統，不支援 【iOS 】喔！ **
[

#####


---

# XQ獨家成交明細介紹

Source: https://www.xq.com.tw/lesson/xqapp/std/

**XQ APP ****的成交明細進化啦！ **現在在XQ APP 也能看到即時的 **大小單明細 **和 **成交分佈 **，這意味著我們透過手機進行當沖又增加了強大的新武器?！ 這篇文章我們將和你分享：如何利用全新的交易明細提升我們的交易勝率！ ****還沒快下載XQ APP的小夥伴們趕緊上車囉！ [
![](/wp-content/uploads/2021/09/1631585102199.jpg)
](/wp-content/uploads/2021/09/1631585102199.jpg)如果我們希望提升自己的交易勝率，那麼我們需要從三個面向進行優化： 

#### ① 商品的選擇：在魚群很少的池中釣魚，即便技術再好也是枉然 

#### ② 進場點的選擇：即便在魚群很多的池中釣魚，魚餌放的時機不對也不容易有魚上鉤 

#### ③ 出場點的選擇：魚兒上鉤了，但收線的時機不對魚又溜走了 
所以要提升勝率，以上三點那是缺一不可 ～ 如果你又剛好只能用手機在玩當沖，在資訊相對有限的情況下要同時解決上面三個問題還真的不容易，不過現在… 全新的成交明細就能一定程度解決這些問題囉? 

### **一、透過成交明細中的「大戶買賣比」和「單別分析」找到對的商品 **
相信大家都能認同「有主力在買的商品比較容易漲」對吧？！ 所以我們只要確認這檔商品… ● 主力成交量一定水準 或 成交量相對過去較高 ● 主力買賣方向一致 那麼我們就可以判定交易這檔商品要賺到錢的機率相對較高，實務上我們只要觀察 **「分佈」 **頁面就能完成確認的動作囉 ～ **① 大戶買賣比： **這個指標可以告訴我們今天主力進行買進或賣出的力道，同時也也意味著今天主力 多空方向是否一致。 **② 單別分析： **這個指標反應出今天整體的成交分布，我們可以關注「特大單」以及「大單」的買賣 差額占比，如果買賣雙方的差額占比相當懸殊，那也代表主力多空方向基本一致。 我們以今天的金寶為例： 大戶買賣比分別為 **買進 89.45% **和 **賣出10.55% **；特大單與大單的買賣差額分別為 **46.64 **%和 **3.91% **從大戶買賣比 和 特大單的買賣差額來看，今天的金寶做多賺錢的機率會高於做空不少，果不其然最終成功以紅K做收 ? [
![](/wp-content/uploads/2021/10/1635323812323.jpg)
](/wp-content/uploads/2021/10/1635323812323.jpg)

### **二、透過成交明細中的「大單追蹤」俐落進場 **
**「看對不一定賺錢，看錯幾乎都賠錢」 **絕對是每個當沖人共同的心聲，在漲跌空間相對有限的環境下對於進場點的精準度要求真的比較高，所以作為當沖小達人的我們必須在夾縫中求生存。 這時候我們就可以利用 **「大單追蹤」 **來操作，如果我們發現 **「特大單」 **和 **「大單」 **瞬間大量敲入，那麼我們就可以考慮跟上（視內外盤成交決定多空方向）；但是這邊要提醒各位小夥伴的是… 如果我們僅以此做為進場依據， **長期下來其實勝率並不會提升多少 **，所以我們還需要搭配其他 **「條件」 **作為進場依據。 個人會搭配「支撐壓力」進行操作，例如： 若價格在「支撐」線附近瞬間湧進買進力道（外盤成交）那麼我就會考慮多單進場；若壓力線的突破伴隨著大量買進力道，那麼我也會考慮多單進場。 [
![](/wp-content/uploads/2021/10/1635323933713.jpg)
](/wp-content/uploads/2021/10/1635323933713.jpg)

### **三、透過成交明細中的「大戶單」瀟灑出場 **
雖然做當沖的小夥伴們多數習慣是「賺夠就跑」，但俗話說： **「懂進場是徒弟，懂出場是師父」 **也不是沒有道理，即便是當沖我們仍然要盡可能進好賺滿，才對得起我們的手續費你們說對不對？ 這時候分佈中的 **「大戶單」 **就派上用場了，如果今天盤勢符合我們預期且我們正在持續獲利中，突然間我們發現 **近15分鐘的「大戶單」買賣的比例已然悄悄接近 **，或大戶單已經的買賣比例已經翻轉，代表接下來價格很有可能是「盤整」或「漲跌幅度縮小」，此時此刻我們盡量不要戀戰， **考慮先出場獲利一波吧！ **[
![](/wp-content/uploads/2021/10/111.jpg)
](/wp-content/uploads/2021/10/111.jpg)做當沖千萬要記住：「電腦上的數字都是假的，銀行帳戶的數字才是真的！」 好拉 ～ 今天課就先上到這裡，相信從今以後再也不會有小夥伴們存在「手機很難做當沖」的迷思了對不對 ? **趕緊打開 [XQ APP ](https://utm.to/4s7r96)迎接我們的當沖新武器吧 ～ 下課！（噹噹噹?） **[

#####


---

# 贏家選股與回測報表

Source: https://www.xq.com.tw/lesson/xqapp/winstockapp/

這篇文章我們會告訴您該怎麼解讀 XQ APP【回測報表】中的各項數據，也會分享一些實務中的小技巧，看完這篇文章後您將有能力找出那些「藏在細節裡的魔鬼」！ 還沒下載XQ APP的小夥伴們趕緊上車囉！ [
![](/wp-content/uploads/2021/08/QR-Code-1.jpg)
](/wp-content/uploads/2021/08/QR-Code-1.jpg)

#### **傳送門 ****? **[**XQ桌機版教學 **](https://www.xq.com.tw/learn/advanced/winstockpc/)

### **一、回測規則說明 **
回測系統將會於每日收盤時篩選出所有滿足策略條件的，個股並且於隔日開盤價進場交易，出場則會根據所設定之參數進行交易。 所有交易均未包含交易成本，報酬率則以「還原價格」做為計算基礎。 

### **二、回測參數設定 **
我們可以設定每次回測的 **進場方向、進場條件、出場條件 **、 **持倉時間 以及 回測期間： ****● 進場條件： **決定本次回測的進場方向 **● 出場條件： **「停利」和「停損」百分比是以進場價作為基準計算，舉個例子：假設我以500元的成本購買一張台積電，停利和停損各設為5%，那麼當台積電漲到525元時系統將判定停利出場，反之跌到475時停損出場。 **● 持倉時間： **以「日」作為基準，假設我設定為「持有1日」，那麼系統將會在買進當天收盤時判定出場。 當我們設定好這 3 個參數後，系統將會以「優先滿足條件」的參數進行判定；同樣舉上面的例子：假設今天我以 500 元的成本買進台積電，參數我設定為停利 5%、停損 5%、持有 1 日，今天最高價未達 525 元，最低價未達 475 元，那麼今天收盤時系統將會自動出場（滿足「持有1日」的條件）。 **● 回測期間： **回測週期最多可以回推3年，基準值為回測當日；舉個例子：假設我2021.7.15進行回測，週期設定為1年，那麼系統將會從2020.7.15開始計算。 

### **三、解讀回測報表 **
**● 交易次數： **每檔股票「成功出場的動作」都視為「一次」交易 **實務中「交易次數」越高的策略／條件代表越容易滿足進場條件，適合做為一個策略的「主要條件」。 ****● 勝率： **獲利的交易次數／交易次數 **勝率是報表中最重要的指標，勝率高低意味著該策略／條件的「穩定度」；實務中若停損和停利相同的情況下，那麼隨著交易次數的增加「勝率」會趨近於50%，所以如果今天我們的交易次數高達上萬次，若勝率卻能高於55%，那麼該策略／條件就能被我們視為「相當穩定」。 ****● 總報酬率： **投資組合在回測區間的平均加總，舉個例子，這組策略 … 第一天只出場1檔股票，報酬率為 5%，那麼第一天的平均報酬率為5% 第二天出場2檔股票，報酬率分別為 5%及 10%，那麼第二天的平均報酬率則為7.5% 第三天出場3檔股票，報酬率分別為 5%、10%和 -5%，那麼第三天的平均報酬率為3.3% 所以截至第三天的總報酬率為：（1+5%）\*（1+7.5%）\*（1+3.3%）-1 = 16.6% **新手投資人常會將「總報酬率」視為最重要的「主要指標」，但是在XQ贏家選股的回測系統中，總報酬率只能視為「次要指標」；因為回測系統會對所有滿足條件的個股進行交易，然而實務中我們我們不可能每一檔都進行交易，且每檔個股的習性都不相同，所以我們其實不需要太執著總報酬率的高低。 ****實務中「總報酬率」較常用來與「交易次數」及「勝率」進行交叉比對，從中發現可能的問題。 ****● 平均報酬率： **每筆交易平均的報酬率，公式為：總報酬率 / 交易次數 **由於贏家選股的回測機制是交易所有滿足條件的個股，按照上面的公式來看，平均報酬率常態將趨近於0，如果某策略／條件的平均報酬率能達0.01就算相當優異的表現了。 ****● 最大獲利率 : **在所有獲利的交易中，獲利最高的報酬率 **實務中「最大獲利率」比較常用於個股的回測，且主要用於設計策略時的「暴力測試」，目的是抓出策略在回測區間的獲利極大值。 ********● 最大連續獲利率 : **每一段總報酬率連續增加的區段並計算中間的差值為「連續獲利率」 1/1日商品的總報酬率為 5% 1/2日商品的總報酬率為 4% 1/3日商品的總報酬率為 5% 1/4日商品的總報酬率為 7% 1/5日商品的總報酬率為 6% 則上述區間內連續上升的區段為1/2日至1/4日，而1/2日和1/4日的總報酬率差異值為 3% (7% - 4%)，所以連續獲利率就是3%；而將回測區間中計算出所有的連續獲利率後取出最大值，就是「最大連續獲利率%」 **實務中「最大連續獲利率」主要用於個股「交易策略」的設計，用來判斷某交易策略在極端行情時把握獲利的能力。 ****● 最大虧損率 : **在所有虧損的交易中，損失最高的報酬率 **實務中「最大虧損率」比較常用於個股的回測，且主要用於設計策略時的「暴力測試」，目的是抓出策略在回測區間的虧損極大值。 ******● 最大連續虧損率 : 每一段總報酬率%連續減少的區段並計算中間的差值為「連續虧損率」 1/1日商品的總報酬率為 5% 1/2日商品的總報酬率為 6% 1/3日商品的總報酬率為 5% 1/4日商品的總報酬率為 2% 1/5日商品的總報酬率為6% 則上述區間內連續下降的區段為1/2日至1/4日，而1/2日和1/4日的總報酬率差異值為-4% (2% - 6%)，所以連續虧損率為 -4%；而將回測區間中計算出所有的連續虧損率後取出最小值，就是「最大連續虧損率%」 **實務中「連續最大虧損率」主要用於個股「交易策略」的設計，用來判斷某交易策略在極端行情時風險的承受能力。 **今天的說明就到這裡囉 ～ 相信透過這篇文章大家已經會解讀回測報表了，其實回測報表不止能幫助我們驗證策略的可靠度，也能幫助我們透過這些數據設計新的策略，趕快打開【XQ贏家選股】試著解讀看看吧?！ [

#####


---

# 【XQ回測說明】回測成交價搓合

Source: https://www.xq.com.tw/lesson/xsat/%E3%80%90xq%E5%9B%9E%E6%B8%AC%E8%AA%AA%E6%98%8E%E3%80%91%E5%9B%9E%E6%B8%AC%E6%88%90%E4%BA%A4%E5%83%B9%E6%90%93%E5%90%88/

[上一篇 ](https://www.xq.com.tw/lesson/xsat/【xq回測說明】回測成交價搓合/)我們提到了XQ回測中的報酬率算法在策略雷達、選股中心、自動交易上各產品的差異， 而這篇我們主要會著重在「 **回測報告中」的進出場成交價是如何搓合的 **。 

## **現況 **
回測中的進出場成交價，對於回測績效有不小程度的影響，最主要的影響在於：「這筆交易，是會先到達停利條件，還是先停損條件」而決定這二者的先後順序，現階段採用了以下兩種作法，主要依 **執行頻率之下，是否有更細小的頻率 **來分類： 

- **有更細小的資料時，使用更精確的資料決定 **例如：執行的頻率是"日"頻率，而我們的歷史資料有最小"1分鐘K線"的資料，這時就用依據"1分K鐘"來確定股價變化的順序。 
- **沒有更細小的資料時，使用K棒的相對關係決定 **例如：執行頻率是1分K，而這已經是我們提供最小的資料頻率時，我們會利用收盤價和高/低價之間的關係，決定這根K棒是O-H-L-C還是O-L-H-C，我們稱這個為 **模擬逐筆洗價 **。 
然而這個 **模擬逐筆洗價的做法， **可能會導致在回測時會出現一些不合理的交易，例如：買進時的成交價，可能買在當日的最低價。為什麼會發生這種情況呢？ 前面提到，在模擬逐筆洗價時，我們會將一根K棒拆解成O,H,L,C四筆tick，也就是分四次洗價。這裡為了方便說明，我們以O-H-L-C(開盤-最高-最低-收盤)的洗價狀況來模擬：若你有注意到就會發現，當我們在H(最高價)洗價，並送出委託，之後就會成交在這根K棒的最低價L。 

## **改善 **
我們發現這個問題之後，也提供了一些改善的方式。在選股中心及策略雷達時，你可以選擇成交「 **當期收盤價」 **。 [
![](/wp-content/uploads/2022/11/當期收盤價.png)
](/wp-content/uploads/2022/11/當期收盤價.png)在自動交易時，可以選擇 **「 ****觸發即判斷成交」 **。啟用這些選項後，同樣的狀況，你的成交價會在H、而不是神奇的成交在最低價L。 [
![](/wp-content/uploads/2022/11/觸發即判斷.png)
](/wp-content/uploads/2022/11/觸發即判斷.png)(改版中針對目前線上環境的回測成交邏輯作調整 (10/25)，以下文章會說明調整的內容) 

## **回測成交邏輯調整說明 **

### **修改1分鐘頻率逐筆洗價時的成交判斷 **
執行回測時如果挑選的回測頻率是1分K，同時勾選模擬逐筆洗價的話，目前系統的作法如下: 假設這一分K的時間是09:01，這一分K的資料是 O 、 H 、 L 、 C 以及 V， 而且在這一分鐘內，H比L先發生的話，那麼洗價順序如下: 編號 時間 Open High Low Close Volume 1 09:01:00 O O O O 1/4 V 2 09:01:15 O H O H 1/4 V 3 09:01:30 O H L L 1/4 V 4 09:01:45 O H L C 1/4 V 可以想像成，如果系統在這一分鐘內，依序收到了四個成交價，間隔是15秒，這四個價格分別是O，H，L，C，那麼在收到成交時，依照當時的狀態所組出來的K棒，就是上面這個表格內每一筆的樣態。 那麼接下來假設，腳本在編號1的這根K棒洗價時，呼叫了SetPosition(10，Close)的話，那麼系統會採用以下的方式來撮合這一筆委託: 

- 委託的價格是 O (也就是編號1這一根K棒洗價的Close)，委託的數量是10 
- 接下來依照市場價格，判斷是否會成交。判斷成交的邏輯如下(買進的情況) 

---
如果是市價單的話，則產生成交，最大的可成交數量為當根Bar 1/4 的成交量。 如果是限價單的話，則當委託價大於等於成交價的時候，以成交價產生成交，最大的可成交數量為當根Bar 1/4 的成交量。 
---

- 所以這一筆委託會依序比對跟 H (產生編號2這一筆K棒的價格)， L (產生編號3這一筆K棒的價格)，以及 C (產生編號4這一筆K棒的價格)的關係，直到完全成交，或是腳本內更改Position為止 
這樣子的撮合方式雖然簡單，可是由於一分K只取樣O，H，L，C四個價格，當分K內價格變化比較大的時候， 常常會出現買進時成交價格低於委託價格的情形，導致回測報告的績效過於樂觀 。 為了修正這個問題，在這次調整 (10/25) 時，我們修改委託撮合的邏輯如下: 
---
如果是市價單的話，則產生成交，最大的可成交數量為當根Bar 1/4 的成交量。 如果是限價單的話，會分成兩種情況： 

- 委託價大於等於委託當下的價格的話，則成交在當下的價格。 
- 若委託價小於委託當下的價格，但大於下次洗價之間的最低價的話，則成交在委託價。 
最大的可成交數量為當根Bar 1/4 的成交量。 
---
用來撮合的資料改用模擬的K棒，而這個模擬K棒則由連續的兩個價格來組成。 以上面資料為範例，在如果是在編號1的K棒洗價完成後送出委託的話，那接下來用來撮合的模擬K棒資料依序如下: 撮合K編號 Open High Low Close Volume 1 O H O H 1/4 V 2 H H L L 1/4 V 3 L C L C 1/4 V 4 O O O O 1/4 V 

- 雖然K棒只取樣四個價格，可是 *如果實際市場的成交資料很密的話 *，那我們可以假設送出委託當時，市場最新的成交價應該是 O ，然後慢慢的拉高變成 H ，所以就用 O/H/O/H 這樣子的模擬K棒來撮合 
- 上表內第四筆資料( 紅字 )代表的是下一分鐘的1/4根K棒 

### **修改委託送出後判斷是否成交的時間點 **
目前的回測作法，會依照K棒的洗價設定(多久跑一根K棒)來決定委託送出後什麼時候要判斷成交. 舉例而言，如果K棒是5分K，沒有勾選模擬逐筆洗價，那又假設090000這跟Bar洗價，此時腳本呼叫了SetPosition(10，Close)，那麼系統會採用以下邏輯來判斷這一筆委託是否成交: 

- 這一筆委託是要買進10張，委託價格是090000這一筆5分K的Close, 
- 因為是5分K，所以系統會在洗090500這一根5分K時判斷這一筆委託是否成交，請注意因為XS的K棒是標示這個K棒區段的開始時間，所以090500的5分K涵蓋的資料範圍是09:05:00 ~ 09:09:59秒, 
- 判斷成交的邏輯如下(買進的情況下): 

---
如果是市價的話，則成交在開盤價。最大的可成交數量為當根Bar的成交量。 如果是限價單，委託價大於等於開盤價的話，則成交在開盤價。最大的可成交數量為當根Bar的成交量。 如果是限價單，委託價小於等於開盤價，但大於等於最低價的話，則成交在委託價。最大的可成交數量為當根Bar 
---

- 依照上面的邏輯，系統會拿090000這根Bar的Close (假設為100)，跟090500這一根5分K的價位來比對，如果委託價100 >= K棒的開盤價的話，那我們認定會成交在K棒的開盤價，如果委託價100 >= K棒的最低價的話，那就成交在100元，如果委託鑑100 < K棒的最低價的話，表示委託價格太低了，所以不會成交 
- 成交的數量，依照委託數量(10張)跟這根K棒的成交量來判斷，最多只會成交當根K棒的成交量 
- 如果還有未成交數量的話，則會等到洗091000這一根5分K時繼續判斷 
可是，我們思考如果在實際市場上，我在09:05:00秒時，送出了一筆買進10張的委託的話，那會發生什麼事情呢 ? 交易所應該會在收到任何一筆賣出的委託單時，就會試著來跟我的這一張委託單撮合。 ( *為了簡化起見，我們不考慮先前就已經掛出的賣單委託，也不考慮撮合排隊的邏輯 *) 如果是依照目前回測撮合的邏輯，這一整筆委託，必須遞延到09:10:00時才會判斷是否成交，而且 只會產生一個成交價， 可是實際交易時，只要有符合的賣出價格的話，我的委託可能就會成交，而且可能會產生多筆成交。 所以系統就調整成在腳本送出委託之後，馬上使用 商品之後的成交資料 來判斷這一筆委託是否成交，與腳本的洗價設定無關。 目前回測系統所提供的 商品成交資料 ，就是上面提及1分K的四筆小K棒。 所以修改後的回測成交判定會變成使用者如果是跑5分K，在090000洗價時送出委託，接下來第一次可能成交時間會是09:05:00，接下來是09:05:15，09:05:30等，用來撮合的K棒資料與1分K模擬逐筆洗價的資料是一致的。 

### **總結 **
我們都希望回測時得到的結果，可以跟把時間倒回到那一天時一模一樣。這一次的這兩個調整，主要是撮合邏輯的調整，希望可以讓回測的結果更加 *真實 *。 感謝大家對XS的支持，我們會繼續朝這個方向努力。 若您有任何的想法或是建議，歡迎可以mail到我們客服信箱： [XQservice@XQ.com.tw ](mailto:XQservice@XQ.com.tw)[

#####


---

# 【XQ回測說明】總報酬率算法

Source: https://www.xq.com.tw/lesson/xsat/%E3%80%90xq%E5%9B%9E%E6%B8%AC%E8%AA%AA%E6%98%8E%E3%80%91%E7%B8%BD%E5%A0%B1%E9%85%AC%E7%8E%87%E7%AE%97%E6%B3%95/

### **摘要 **
時常有用戶詢問XQ回測中的報酬率到底是怎麼計算的呢？ 此篇文章會著重於說明， **XQ回測在各產品(選股中心、策略雷達與自動交易)上的差別 **， 以及我們開發的初衷及用途，期望能夠幫助在股海上奔波的各位。 

### **選股中心 ****、策略雷達、自動交易回測差異 **
XQ的回測主要可以分成二種： **一種沒有考慮資金，一種有考慮資金 **。 

#### **沒考慮資金的：策略雷達/選股中心回測 **
這二種腳本都是以是否 **觸發條件來判斷進出場 **，沒有部位大小的差別，也沒有資金的觀念。回測報告提供的總報酬率為時間加權報酬率，是一種不考慮資金、僅考慮交易時機的報酬率計算方式，主要是在幫助戰友們， **判斷整個投資策略的有效性 **。 

#### **有考慮資金的：自動交易 **
利用 **交易語法控制部位進出場，可以有部位大小的變化 **，回測報告提供的總報酬率為考量使用資金後的最大投入報酬率。回測報告的數值可以幫助戰友們， **知道真正投入資本後，可以得到的預期報酬率 **。 

### **加入有考慮資金回測的用意 **
為什麼會有資金的差別呢？因為一開始做的策略雷達、選股中心都只有 **符合/不符合（或說觸發/未觸發）的概念 **，主要是專注衡量策略本身的 **有效性 **，而先不考慮交易實務上會面臨的部位管理。 那如何使回測進一步考慮交易實務上的部位管理？後來開發的 **自動交易語法 **能夠做到這點，也才能夠導入資金的觀念。其實無論回測方法是否考慮資金，我們想呈現的皆是合理的回測數值。 這邊要請大家先想一下，回測報告的用途是： 1. 跑出漂亮的績效數字 2. 做為正式交易前的參考 我們覺得答案是2，所有的回測，最終都是為了交易賺錢。所以我們一直在努力合理化績效數字。接下來我們會跟大家一一說明，尚未考慮資金回測與有考慮資金回測的差別。 

### **投資組合回測 vs 單一商品回測 **
首先，總報酬率當中「尚未考慮資金」的時間加權報酬率與「有考慮資金」的最大投入報酬率，差異都是 **發生在投資組合(多商品)回測時加總報酬率計算方式 **。若是單一商品、單一數量的簡化情況，二者報酬率的計算方式是沒有區別的。 許多人，包含我們在內，剛開始使用回測工具皆是針對單一商品。 若只交易一種期貨商品就沒此區別，甚至可以說，交易期貨的人是達到一定程度之後，才會開始思考同時交易多商品的配置問題。但交易股票完全不一樣，較少人會只專門研究某一檔股票，交易股票天生就自帶一籃子股票的概念。而 **XQ的強項就是股票分析 **，自然的我們一開始設想的 **回測標的就是整個投資組合 **，雖然明知道這邊的難度很高、陷阱很多，我們也只能硬著頭皮上了。 

### **時間加權報酬率 **
單一商品的投資報酬率大家都會算，算起來也不會有什麼大問題。但一籃子商品的投資報酬率要怎麼算，就有點難度了。我們的第一版是傻傻的把每個商品的報酬率直接加總，簡單粗暴。但產品上線後，馬上發現代誌不是憨人想的那麼簡單，因為我們發現用XQ回測怎麼那麼容易找到聖盃。 在這行打滾久了之後，看到愈漂亮的報酬率、愈漂亮的績效曲線，心中有的絕對不是狂喜，而是恐懼，這中間一定有問題。問題出在哪呢？答案就出在我們直接把所有商品的報酬率加總變成總報酬率。這樣子只要一些簡單的小停損、大停利的策略，很容易就把整個報酬率往上衝高。因為直接加總這些報酬率其實是假設了使用者會有「無窮大」的資金，可以同時交易非常多的商品，這很明顯是不合理的。 經過一番研究，我們發現學理上其實可以利用 **「時間加權報酬率」 **來解決這個問題。原理是這樣的，假設你有一筆固定的錢，同時投資商品可以無限細分（不一定是1張，或1股），總之每次有訊號產生的時候，我們會 **平均分散這筆資金到所有的訊號上 **。 這就很像 **每個策略實際上是一個基金 **，基金的持股是由策略訊號所決定，平均分散到每次產生的訊號。調整之後， **策略每日的總報酬，會等於每天持有商品的報酬平均， **每天都會依照策略訊號下的持有商品重新再平衡 ****。這就是各位現在看到的報酬率，雖然很難讓各位利用excel重新計算驗證，但調整後的報酬率就不會再有 **報酬率無限疊加的問題 **。 

### **最大投入報酬率 **
後來，我們推進產品，提供了交易語法。在開發的過程中，我們就很小心的避免之前碰到的 **無窮資金問題 **。但是讓使用者 **自行設定資金 **，在外面分享策略的時候，過大或過小都會扭曲總報酬率的數值，我們想找一個不會被使用者設定所影響，又能客觀評估策略的報酬率計算方式。 最終我們提供的是 **最大投入報酬率。 ****最大投入報酬率=淨利/最大投入金額 **，隨著整個策略執行，只要實際使用到的資金規模變大，最大投入金額就會愈大。評估淨利的基礎會隨著你的策略交易狀況調整，如此就能在 **比較不同策略時有一個可以客觀評估總報酬率的標準 **。 

### **總結 & 下一步 **
其實工具在手，使用上端看個人的運用各有巧妙。現在我們了解到，XQ的回測主要有二種：一種沒有考慮資金，一種有考慮資金。那這兩者用途又分別是什麼？ 

#### **沒考慮資金的：策略雷達/選股中心回測 **
大部份的使用者們皆是大範圍甚至全商品的在回測，策略雷達與選股中心在我們產品的定位上，也是作為「交易的輔助」。 因此策略雷達與選股中心最主要回測的用意在於，回測後個別的策略有效性，以及策略間報酬率的比較。 

#### **有考慮資金的：自動交易 **
自動交易的最終目的是為了串接下單，因此大部份的人會先篩選過指定商品再回測，不太會去使用全市場商品跑回測，這時有考慮資金計算的「最大投入報酬率」，其評估就顯得更有意義，而這個「最大投入報酬率」的數字用意，是可以拿來評估實際執行後的期望報酬率 **。 **

#### **下一步 **
在自動交易上線後，我們的確發現報酬率的計算上， **「最大投入報酬率」 **對使用者而言是比較好理解的數值。未來我們會利用介面設定的方式，讓策略雷達及選股中心的回測也能有最大投入報酬率的評估方式。 如果我們計算報酬率的方式，不符合您的需求，需要自行計算的朋友，也可以直接使用我們回測報告的「匯出」功能，將回測報告匯出成xlsx。其中的「交易分析」包含了完整的進出場明細，稍加調整後應該可以得出您需要的報表。 另外若對於我們報酬率算法或回測有任何的想法或是建議，歡迎可以mail到我們客服信箱： [XQservice@XQ.com.tw ](mailto:XQservice@XQ.com.tw)[

#####


---

# 庫存異動時自動同步數值

Source: https://www.xq.com.tw/lesson/xsat/%E5%BA%AB%E5%AD%98%E7%95%B0%E5%8B%95%E6%99%82%E8%87%AA%E5%8B%95%E5%90%8C%E6%AD%A5%E6%95%B8%E5%80%BC/

目前版本（v0.16.01）中，「庫存異動時自動同步」功能在部分情境下的處理仍持續改善中，未來將進一步提升同步的準確性與穩定性，提供更一致的操作體驗。以下為會遇到的相關情境說明。 

### **可能遇到的情境說明 **

#### **部分成交委託暫不觸發同步 **
當由他處（例如其他策略或手動下單）所送出的委託發生 **部分成交 **時，若仍有尚未成交的掛單，系統不會立即視為庫存異動，因此暫不會觸發同步機制。 

**※情境範例※ **
使用者對商品 A 手動下單 10 張，其中成交 5 張。此時策略不會啟動同步。當該筆委託 **完全成交 **或 **剩餘未成交部分被使用者手動取消 **後，系統將視為庫存異動並進行同步。 

#### **啟動策略時會包含部分成交庫存 **
當策略啟動時，若帳戶中已有來自他處（例如其他策略或手動下單）的部分成交委託，其已成交部分會納入策略庫存。 由於尚未完全成交的委託不會立即觸發同步，需待該筆委託完全成交或取消後，系統才會啟動同步流程。 若在原委託尚未結束前，另由他處新增其他委託，可能導致系統在同步判斷上的資料計算產生差異。 **因此，建議在原委託未完全成交或取消前，暫緩由他處送出新的委託，以利系統準確掌握庫存狀態。 **

**※情境範例※ **
使用者在策略啟動前就預先送出買入 10 張的限價單。 當策略啟動時，該筆委託已部分成交 5 張。因此，策略啟動後的庫存會顯示為 5 張。隨後，該筆預先掛出的委託又再成交了 2 張，此時策略的庫存不會立即變動，因為 **部分成交委託暫不觸發庫存同步 **的機制。 使用者判斷價格走勢已經向上但不想追高，故刪除了剩餘的 3 張委託。由於這筆預先掛入的委託至此已完全結束（部分成交並刪除剩餘張數），因此觸發庫存異動同步。系統會重啟該商品，並將該商品的初始庫存調整為 7 張（5 張 + 2 張），然後繼續運行。 

#### **庫存異動同步時，系統會自動處理未完成的策略委託 **
在進行庫存異動同步時，系統會檢查該商品是否仍有由策略本身送出但尚未完成的委託（包含未成交與部分成交的掛單）。若有，系統將先自動刪除這些委託，再執行同步作業，以確保策略所使用的庫存資料為最新狀態。 

**※情境範例※ **
策略針對目前已有庫存的 A 商品預掛停利單，但使用者判斷 A 商品走勢的方向即將轉變，故手動下單將庫存平倉。 當手動的委託完成時，系統偵測到 A 商品的庫存有異動並開始進行同步，此時策略會先將手上的 A 商品委託單（也就是預掛的停利單）刪除，接著再將 A 商品重啟。 

### **未來的改善方向 **
針對上述同步行為，開發團隊將分階段推出以下改善項目： 

#### **策略啟動時排除尚未完全成交之委託對庫存的影響 **
未來版本中，策略啟動時不會將帳戶中來自他處部分成交的部位納入策略庫存的計算，待該筆委託 **完全成交或取消後再進行同步 **，以確保庫存基準的一致性。 

#### **同步機制改善 - 無需重啟商品 **
同步機制將進一步改善為 **無需重新啟動商品策略 **即可完成庫存與成本資料的同步，減少執行中斷，提升策略的穩定性與整體效率。 [

#####


---

# 自動交易中心支援手動調整部位的功能

Source: https://www.xq.com.tw/lesson/xsat/%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E4%B8%AD%E5%BF%83%E6%94%AF%E6%8F%B4%E6%89%8B%E5%8B%95%E8%AA%BF%E6%95%B4%E9%83%A8%E4%BD%8D%E7%9A%84%E5%8A%9F%E8%83%BD/

目前自動交易必須在策略啟動之前先設定好商品的部位，一旦啟動之後部位只能依照策略的交易指令自動調整，無法手動控制。從上線以來，我們收到了很多客戶的建議，希望可以在策略啟動之後還可以手動調整部位，例如使用者可能用其他方式下單買進之後，希望自動交易可以接手處理出場的動作，或是使用者手動賣出之後，希望自動交易端可以自動更新到目前的實際部位。 在這次的改版內，自動交易增加了可以手動調整部位的功能，策略啟動之後可以調整商品的部位，也可以手動加入新的商品。希望藉由這個功能，讓自動交易可以更符合使用者的交易流程。 接下來小編將介紹各種手動調整部位的使用情境： 

### **手動進場後，透過自動交易執行停損停利 **
如果使用者想要手動下單，然後在買進之後，讓自動交易可以自動執行停損/停利的出場動作，那麼可以透過「庫存異動時自動加入執行」的這個選項來完成。 首先我們先設計一個停損停利的出場腳本，範例如下： 

```
//多單停損(%)
input: profit_percent(2, "停利(%)");
input: loss_percent(1.5, "停損(%)");
if Filled > 0 then begin
 { 依照成本價格設定停損/停利 } 
 if profit_percent > 0 and 
 Close >= FilledAvgPrice*(1+0.01*profit_percent) then begin
 { 停利 }
 SetPosition(0, label:=”停利出場”);
 end else if loss_percent > 0 and 
 Close <= FilledAvgPrice*(1-0.01*loss_percent) then begin 
 { 停損 }
 SetPosition(0, label:=”停損出場”);
 end;
end;
```

接下來我們幫這個腳本設定一個自動交易策略，執行商品選擇交易帳號的庫存，策略部位選擇依庫存，同時勾選「庫存異動時自動加入執行」這個新的選項。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B21_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B21_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)當我們這樣子設定之後，策略啟動時會自動抓取庫存內的商品，依照庫存部位開始執行，同時也會監控庫存的變化，當有新的商品加入庫存時，商品就會自動執行。 接下來策略啟動之後，如果我們從XQ下單，當委託成交時，而且成交的商品是之前庫存內沒有的商品的話，自動交易策略就會自動抓取成交的部位以及成交均價，同時開始執行這個商品。之後當這個商品的價格觸及停損/停利的價格時，自動交易策略就會自動執行出場的動作。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B21_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B21_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)幾點注意事項： 

- 你可以從任何管道下單，只要XQ可以收到委託回報/成交回報的話，這個功能就會正常運作。 
- [](#)當成交商品第一次出現在庫存內時，自動交易策略就會開始執行這個商品，之後如果你又手動買賣這個商品的話，因為商品已經開始執行了，自動交易策略就不會再執行這個商品了。如果你希望自動交易策略的部位可以依照你的手動交易自動調整的話，請參考下個章節。 
- 如果委託數量大於1的話，自動交易策略會等到委託單完全成交之後才會開始執行這個新的商品。 

### **手動加碼後，調整部位 **
在上個情境內手動進場的是先前並不存在於庫存內的商品，透過「庫存異動時自動加入執行」的選項可以讓自動交易策略自動執行這個庫存內的新商品。 那麼如果使用者手動進場的是目前就已經存在於庫存內的商品，可是使用者希望手動執行的交易在成交之後可以讓自動交易自動同步最新的部位的話，那麼我們要怎麼做呢？ 這樣子的情境，可以透過調整商品部位的方式來完成。 我們先手動加碼 1 口庫存內的台股指數商品，完全成交後，開啟策略執行中的商品監控頁，對台股指數商品點擊滑鼠右鍵，會出現「調整商品部位」選項。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B22_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B22_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)[](#)接下來點擊「調整商品部位」此時會出現「調整部位」視窗。你可以在這裡填入策略部位與策略均價，按下確定後，這檔商品的策略部位以及成交均價就會依照指定的數值重新調整。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B22_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B22_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)

### **手動加入新的執行商品 **
如果自動交易策略的商品是依照帳號庫存的話，那麼可以透過「庫存異動時自動加入執行」這個功能來讓策略自動監控庫存的商品異動，當庫存內有新的商品時，都會自動執行。 可是如果自動交易策略的執行商品不是依照帳號庫存的話，有沒有辦法在啟動之後，可以加入新的商品呢？ 答案是可以的，只要你從策略執行中的商品監控頁，在空白處點一下滑鼠右鍵，就會出現「新增執行商品」選項。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B23_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B23_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)點擊「新增執行商品」選項後，會彈出選擇商品視窗，此時你可以輸入想要加入執行的商品代碼或名稱。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B23_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B23_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)按下完成按鈕後，會出現「新增商品」視窗，此時你可以填入「策略部位」與「策略均價」，按下確認按鈕後，這個商品就會開始執行。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B23_C%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B23_C%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)到這裡為止，我們複習一遍調整執行商品/商品部位的各種方式： 

- 如果策略的執行商品是帳號的庫存商品的話，可以透過「庫存異動時自動加入執行」來確保自動交易策略會執行庫存內的所有商品。 
- 如果執行之後，使用者手動調整了商品的實際部位的話，可以透過「調整商品部位」的功能來修正策略內的部位。 
- [](#)如果執行之後，使用者想要加入新的商品的話，可以透過「新增執行商品」的功能來加入新的商品。 
上面這三個功能都可以在不停止策略的情形底下，手動的調整策略內的部位。 

### **同場加映：重新啟動已經停止的商品 **
自動交易策略啟動後，其中的某些商品可能會因為以下因素而停止執行： 

- 執行交易時因為發生錯誤，所以自動停止執行。 
- 使用者手動停止這檔商品的執行。 
在這次改版後，使用者也可以手動啟動已經停止執行的商品。 在底下的示範畫面內，我們先手動停止一檔商品，然後再啟動這檔商品，同時設定新的部位。 首先到策略執行中的商品監控頁，找到欲停止的單一商品列，點擊「停止」按鈕。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)此時會跳出「停止商品」視窗與「一併刪除委託」的核取方塊，這裡的委託是指由該策略送單出去的委託。選項設定完後，再按下確認，該單一商品就會停止執行。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_B%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)接下來，使用者找到欲重啟的商品列，點擊「重啟」按鈕，此時會出現「調整部位」視窗。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_C%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_C%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)填入想要設定的部位跟均價之後，按下確定按鈕，策略就會重新執行這個商品。 [
![](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_D%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)
](/wp-content/uploads/2022/08/%E5%8B%95%E6%85%8B221_D%E6%93%8D%E4%BD%9C%E4%BB%8B%E7%B4%B9.png)自動交易中心這次新增的功能，小編就介紹到這邊，大家可以參考上述章節使用看看，感謝大家耐心的收看，咱們下次見。 [

#####


---

# 自動交易排程與總覽介紹

Source: https://www.xq.com.tw/lesson/xsat/%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E6%8E%92%E7%A8%8B%E8%88%87%E7%B8%BD%E8%A6%BD%E4%BB%8B%E7%B4%B9/

2020年XQ開發了自動交易的新功能，實現了只要撰寫XS語法就可以達到自動交易的功能，再也不用害怕盤中離開一下，錯過了下單時刻，謝謝各位使用者支持與建議，這次我們為了達到更好的使用者體驗，優化自動交易功能，讓我們來一起看看這次優化了哪些功能。 

### **策略排程 **
為了讓策略能夠在指定的策略自動啟動與停止，我們可以在每個策略的右上角「排程」中設定策略啟動與停止的區間。若要刪除排程，也是點選「排程」，內有刪除排程的按鈕。 注意事項：需保持XQ與電腦開啟，此功能才能啟動與停止。 [](#)[
![](/wp-content/uploads/2022/07/策略排程.png)
](/wp-content/uploads/2022/07/策略排程.png)

### **執行總覽 **
只要策略中有設定「策略排程」或是當日有執行過的，點選「執行總覽」就會看到這些策略，在盤中能更方便掌握策略執行的狀況，以下小編將會分成四區來介紹。 [](#)

#### **A：執行總覽按鈕 **
點擊執行總覽後會開啟執行總覽頁，後面的數值為目前執行中策略的個數，以下圖為例，目前執行中的策略為2個。 [
![](/wp-content/uploads/2022/07/執行總覽.png)
](/wp-content/uploads/2022/07/執行總覽.png)[](#)

#### **B 篩選區： **

- 可篩選策略中的條件包含以下幾種： 

  - 帳號：選擇全部帳號或部分帳號 
  - 搜尋：依輸入文字篩選策略名稱 
  - 有部位：顯示有部位的策略(含策略與實際部位) 
  - 有排程：顯示有設定排程策略 
  - 獲利：只顯示損益>0的策略 
  - 虧損：只顯示損益<0的策略 
  - 多：顯示策略或實際部位>0商品的策略 
  - 空：顯示策略或實際部位<0商品的策略 
  - 全部停止：點擊後停止全部執行中的策略 

[
![](/wp-content/uploads/2022/07/B-篩選區.png)
](/wp-content/uploads/2022/07/B-篩選區.png)[](#)

#### **C總計區： **

- 顯示符合篩選條件的執行中策略總計值 

  - 損益：執行中策略的損益和 
  - 作多部位：執行中的策略實際作多部位及持倉金額加總 
  - 作空部位：執行中的策略實際作空部位及持倉金額加總 
  - 實際淨部位：作多部位+作空部位的數量及金額合計值 
  - 執行中：執行中策略個數 

[](#)[
![](/wp-content/uploads/2022/08/C-總計區2.png)
](/wp-content/uploads/2022/08/C-總計區2.png)

#### **D 內容區： **

- 調整欄位順序功能 

  - 目前提供共12個欄位包含：操作、策略名稱、策略部位、實際部位、損益、狀態、帳號、策略排程、策略部位(多)、策略部位(空)、實際部位(多)、實際部位(空)，預設值會將「動作及策略名稱」強制開啟，其餘欄位可按照大家的需求來調整順序 
  - 若想重新設定，也可點選「還原預設」來還原欄位預設值 

- 所有欄位支援排序 
[
![](/wp-content/uploads/2022/08/D-內容區3.png)
](/wp-content/uploads/2022/08/D-內容區3.png)[
![](/wp-content/uploads/2022/07/D-內容區2.png)
](/wp-content/uploads/2022/07/D-內容區2.png)

### **自動交易常見Q&A **

- **Q：設定排程後什麼時候開始啟動 **
- **A：設定排程後，等到下次符合啟動時間時就會自動執行這個策略例如：現在時間是08:00，排程設定8:30，那麼到當日的8:30，XQ就會自動啟動這個策略，若希望立即啟動策略，可以使用手動執行。 **

- **Q：一個策略可以使用多家券商下單？ **
- **A：目前僅支援一個策略使用單一券商，因此若要同一策略使用多家券商下單，需開啟多策略(可複製策略再調整執行券商) **

- **Q：遇到盤中電腦當機或是XQ壞掉怎麼辦？ **
- **A：若是有設定排程，馬上開啟XQ後若在排程時間內會自動開啟策略。 **

- **Q：自動交易交易券商有哪幾家？ **
- **A：可以 [參考此網頁 ](https://www.xq.com.tw/broker.aspx)**

- **Q：自動交易支援零股交易嗎？ **
- **A：目前尚未支援零股交易。 **
以上小編的自動交易總覽與排程介紹到此告一段落，預祝大家可以找出優質的交易策略，若是對自動交易或是有其他疑問可以到我們的 [官方討論區 ](https://forum.xq.com.tw/cat/xs使用問題/)或是私訊臉書詢問小編喔！ [

#####


---

# 自動交易與交易回測的錯誤代碼說明

Source: https://www.xq.com.tw/lesson/xsat/%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E8%88%87%E4%BA%A4%E6%98%93%E5%9B%9E%E6%B8%AC%E7%9A%84%E9%8C%AF%E8%AA%A4%E4%BB%A3%E7%A2%BC%E8%AA%AA%E6%98%8E/

大家好，XS 交易腳本編譯完成後，加入自動交易中心， 執行自動交易策略時，錯誤代碼與錯誤原因說明，列表如下： 錯誤代碼 錯誤原因說明 1000 腳本版本未匹配 1001 產生腳本物件失敗 1002 設定腳本參數失敗 1003 腳本 DLL 檔案不存在 1004 腳本使用欄位翻譯錯誤 1100 不支援的執行頻率 1101 取成交紀錄索引值超出限制 1102 不支援的語法 1200 商品不存在 1201 商品不支援歷史資料 1202 商品無法取得資訊 1203 商品通知回傳錯誤 K 棒狀態 1204 商品在選股回測階段發生錯誤 1300 回測逾時 1301 腳本執行 RaiseRunTimeError 語法 1302 系統行為異常 1303 腳本執行錯誤 1304 系統錯誤 1305 未知錯誤 1306 網路斷線過久 1307 手動停止運算 1400 資料長相不是預期狀態 1401 資料不足 1402 不支援的欄位或頻率 1403 沒有權限的欄位 1404 取資料時發生異常 1405 取得空值值 1500 交易模組通知錯誤 1501 委託由外部發生異動 回測交易腳本，與回測自動交易的策略，錯誤代碼與錯誤原因說明，列表如下： 錯誤代碼 錯誤原因說明 1 執行回測時發生異常 1000 腳本版本未匹配 1001 產生腳本物件失敗 1002 設定腳本參數失敗 1003 腳本 DLL 檔案不存在 1004 腳本使用欄位翻譯錯誤 1100 不支援的執行頻率 1101 取成交紀錄索引值超出限制 1102 不支援的語法 1200 商品不存在 1201 商品不支援歷史資料 1202 商品無法取得資訊 1203 商品通知回傳錯誤 K 棒狀態 1204 選股策略執行錯誤 1300 終止運算 1301 腳本執行 RaiseRunTimeError 語法 1302 系統行為異常 1303 腳本執行錯誤 1304 系統錯誤 1305 未知錯誤 1306 網路斷線過久 1400 資料長相不是預期狀態 1401 資料不足 1402 不支援的欄位或頻率 1403 沒有權限的欄位 1404 取資料時發生異常 1405 取得空值 1500 交易模組通知錯誤 1501 委託由外部發生異動 如果看了上述的說明，仍有疑問無法排除，請提供以下資訊，並mail至 [XQservice@XQ.com.tw ](XQservice@XQ.com.tw)，會有專人安排釐清，謝謝： 1. 問題描述。 2. 有問題的完整畫面截圖。 3. 自動交易策略匯出檔案，匯出時請勾選「包含選股策略」與「包含引用函數」 4. 交易腳本匯出檔案。 5. Log資料夾壓縮檔案，預設路徑：C:\SysJust\XQLite\LOG [

#####


---

# 自動交易語法介紹

Source: https://www.xq.com.tw/lesson/xsat/%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E8%AA%9E%E6%B3%95%E4%BB%8B%E7%B4%B9/

「自動交易」顧名思義就是交由電腦來監控目前的策略來做到自動停利停損、進場、出場等策略，但是到底如何開始呢？ 先前小編有介紹關於自動交易中心的功能介紹，若是還沒看過的戰友們，記得先去稍微看過才開始看本篇的相關介紹，以下提供傳送門。 

- **[如何建立自動交易策略 ](https://www.xq.com.tw/learn/xsat/strategy/)**
- **[自動交易策略參數總覽 ](https://www.xq.com.tw/learn/xsat/parameters/)**
- **[自動交易中心操作介紹 ](https://www.xq.com.tw/learn/xsat/guideline/)**
- **[自動交易結合手機監控 ](https://www.xq.com.tw/learn/xsat/appmonitor/)**
- **[自動交易回測功能 ](https://www.xq.com.tw/learn/xsat/backtest/)**
- **[自動交易排程與總覽介紹 ](https://www.xq.com.tw/learn/xsat/schedule/)**
本篇的重點會著重在於，「XS自動交易語法的撰寫」包含了以下幾點 

- [交易語法有哪些 ](#learn01)
- [position和filled有什麼差別 ](#learn02)

  - [如果只寫Filled可以嗎? ](#learn03)
  - [如果只寫Position可以嗎? ](#learn04)

- [進出場我到底怎麼寫 ](#learn05)

### [](#)

### **交易語法有哪些 **
我們先來看看全部的交易語法到底有哪些，在我們的 [Xshelp函數搜尋網 ](https://xshelp.xq.com.tw/XSHelp/lists?a=TRANSACTIONFUNC)內可以找到全部的交易語法，但是對於新手來說是不是有點多呢?小編這邊會介紹幾個常用的交易語法，強烈建議一定要先看懂這幾個函數。 

- [Position ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Position&group=TRANSACTIONFUNC)： 預期達到的目標部位，可以當作是策略下的委託單 
- [Filled ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Filled&group=TRANSACTIONFUNC)： 交易帳號的實際部位 
- [SetPosition ](https://xshelp.xq.com.tw/XSHelp/?HelpName=SetPosition&group=TRANSACTIONFUNC)： 預計交易策略建立的部位 
- [Market ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Market&group=TRANSACTIONFUNC)： 市價送單 
- [AddSpread ](https://xshelp.xq.com.tw/XSHelp/?HelpName=AddSpread&group=TRANSACTIONFUNC)： 調整委託單下單檔位 
[
![交易語法](/wp-content/uploads/2022/10/交易語法.png)
](/wp-content/uploads/2022/10/交易語法.png)[](#)

### **Position和Filled有什麼差別 **
稍微看過以上幾個必學的函數，常常會有這個疑問，若是要控制部位為什麼，是不是單寫Position或Filled就好呢? 這邊小編簡單用多單進場舉例，以下的程式碼代表意思： 當條件1成立後市價買進1部位，當達到條件2則賣出當下收盤+2檔的價位1部位。 

```
condition1 = getfield("Close") >= 10;
condition2 = getfield("Close") < 10;

if Position = 0 and filled = 0 and condition1 then begin
	SetPosition(1, MARKET);		               { 以市價買進 }
end;

if Position = 1 and filled = 1 and condition2 then begin
	SetPosition(0, addspread(close,+2));		{ 以收盤+2檔賣出 }
end;
```

---
在這邊我們看到進出場前 皆有判斷Position和Filled的部位 。 我們來實際模擬以上code進出場過程中Position 與 Filled部位的變動。 進場： 一開始起始部位 Position和Filled皆為0 ，但在 Condition1條件成立後 ， Position部位會變為1 ，並送出委託單，而這時Filled部位還是0，需等到 買進成交單打回來後 ，Filled部位才會變為1 **。 **[
![](/wp-content/uploads/2022/10/進場Position和Filled.png)
](/wp-content/uploads/2022/10/進場Position和Filled.png)
---
出場： 起始部位Position和Filled皆有進場的部位因此為1，但在賣出條件Condition2成立時，Position部位會先變為0，並送出賣出委託單，直到送出的委託單成交後，Filled部位才會變為0。 [
![](/wp-content/uploads/2022/10/出場Position和Filled.png)
](/wp-content/uploads/2022/10/出場Position和Filled.png)根據以上小編舉的Position和Filled大家看出差別了嗎？Position是 預期達到的目標部位，所以 當 條件成立後Positon就會開始變動 。而Filled則是實際成交後的部位。 我們也可以把 Position直接想成下的委託單，Filled則是實際的未實現庫存部位 。 
---
如果還是不懂，小編再舉一個例子： 我知道明天蘋果有特價，一顆20元，因此我預計明天去菜市場買3顆20元的蘋果，這時Position就會變為3，Filled=0，明天我實際將3顆蘋果買回家後，這時Filled= 3, Position = 3，而買到的價 是20元。 [](#)

### **如果只寫Filled可以嗎? **
當然可以!!!但是會發生什麼事情呢？因為尚未有Position來控制目標部位，因此在尚未成交之前會重複的傳入相同部位的不同價格，也就是下了委託單後， 若 條件再次成立但是委託單尚未成交，會在同一個委託書上「改價」 。 若是希望在每次條件成立時，都可以下到最新價格時，就可以單使用Filled來判斷進出場就好。 若是拿上面的買蘋果來舉例： 我想要買蘋果3顆，但是還沒預計什麼時候去買價格也不知道，因此價格會根據市場價格一直變動，直到我們實際買進的那天。 

```
if Filled = 0 and Condition1 then SetPosition(1);
if Filled = 1 and Condition2 then SetPosition(0);

```

## [](#)

### **如果只寫Position可以嗎? **
若是單只寫Positon判斷進出場的話，當進場條件condition1符合就會下買進委託單了，但如果買進委託沒有成交，且出場條件condition2符合條件時就會把原先 買進的那筆委託單刪單 ， 所以當進出場條件容易觸發時，且 買進委託尚未成交時會反覆出現買進委託，刪除委託的動作 ， 所以不建議只用Position判斷進出場 。 

```
if position = 0 and Condition1 then setposition(1);
if position = 1 and Condition2 then setposition(0);


```

### 

### 

### [](#)

### 

### 

### **總結 **
看了那麼多Positon和Filled已經霧灑灑了，我到底要該用什麼來撰寫呢？若不希望進出場的委託單一直更動的話， 小編建議Positon和Filled在進出場皆要判斷，也就是以下的例子，condition1 和 condition2 可以自行修改為進出場條件。 

```
condition1 = getfield("Close") >= 10; //進場條件
condition2 = getfield("Close") < 10; //出場條件

if Position = 0 and filled = 0 and condition1 then begin
	SetPosition(1, MARKET);		               { 以市價買進 }
end;


if Position = 1 and filled = 1 and condition2 then begin
	SetPosition(0, addspread(close,+2));		{ 以收盤+2檔賣出 }
end;

```

若是希望每次條件成立都是下到最新的價格，可以只使用Filled來做部位進出場的判斷。 

```
condition1 = getfield("Close") >= 10; //進場條件
condition2 = getfield("Close") < 10; //出場條件

if filled = 0 and condition1 then begin
	SetPosition(1, MARKET);		               { 以市價買進 }
end;


if filled = 1 and condition2 then begin               
	SetPosition(0, addspread(close,+2));	      { 以收盤+2檔賣出 }
```

[

#####


---

# 運用交易語法撰寫進場取得未平倉成本出場

Source: https://www.xq.com.tw/lesson/xsat/%E9%81%8B%E7%94%A8%E4%BA%A4%E6%98%93%E8%AA%9E%E6%B3%95%E6%92%B0%E5%AF%AB%E9%80%B2%E5%A0%B4%E5%8F%96%E5%BE%97%E6%9C%AA%E5%B9%B3%E5%80%89%E6%88%90%E6%9C%AC%E5%87%BA%E5%A0%B4/

交易語法上線後，大家都躍躍欲試想運用自己的策略來撰寫交易語法，猜想大家最常碰到的問題應該是怎麼撰寫自動進出場的交易動作語法，所以此篇文章將使用期貨與股票的兩個簡易案例，來介紹撰寫方向提供給大家參考。 

### **期貨商品範例 **

- 執行商品：台股指數近月(FITXN\*1) 
- 執行頻率：1 分鐘 
- 交易帳號：期-模擬交易(內建)-01 
- 其他自動交易策略設定：皆為預設 
- 進場條件：當「目前商品的『無』預期部位，且收盤價 - 開盤價 >= 上漲點數」則進場掛一筆「市價買進1口」的委託單。 
- 出場條件：當「目前商品的『有』預期部位，且商品目前的未平倉成本 - 收盤價 >= 跌破點數」則出場掛一筆「市價平倉持有口數」的委託單。 
期貨交易腳本語法的撰寫架構與說明如下： 

```
input:_GoalPrice(30,"上漲點數"),_StopLost(50,"跌破點數");
var:InCondition(false),OutCondition(false);

//僅支援分鐘
if barfreq <> "Min" then raiseRunTimeError("僅支援分鐘");

//InCondition為進場條件，當「收盤價 - 當日開盤價 >= 上漲點數」時，InCondition為True，否則為False。
InCondition = close - GetField("開盤價", "D") >= _GoalPrice;

//OutCondition為出場條件，當「商品目前的未平倉成本 - 收盤價 >= 跌破點數」時，OutCondition為True，否則為False。
OutCondition = filledAvgPrice - close >= _StopLost;

//當「目前商品的預期部位是0，且進場條件為Ture」則將目前商品的預期部位設為1，委託價格使用市價。
//也就是送出一筆「市價買進1口」的委託單。
if position = 0 and InCondition then setposition(1,market);

//當「目前商品的預期部位非0，且出場條件為Ture」則將目前商品的預期部位設為0，委託價格使用市價。
//也就是送出一筆「市價平倉持有口數」的委託單。
if position <> 0 and OutCondition then setposition(0,market);
```

### 

### **股票商品範例 **

- 執行商品：元大台灣50(0050) 
- 執行頻率：1 分鐘 
- 交易帳號：證-模擬交易(內建)-01 
- 其他自動交易策略設定：皆為預設 
- 進場條件：當「目前商品的『無』預期部位，且K棒為實體紅K（close > open）」則進場掛一筆「市價買進1口」的委託單。 
- 出場條件：當「目前商品的『有』預期部位，且商品的損益(%)達停損停利」則出場掛一筆「市價平倉持有口數」的委託單。 
股票交易腳本語法的撰寫架構與說明如下： 

```
input:_StopProfit(5,"停利X％"),_StopLost(5,"停損Y％");
var:plratio(0),InCondition(false),OutCondition(false);

//僅支援分鐘
if barfreq <> "Min" then raiseRunTimeError("僅支援分鐘");

//plratio為「計算損益(%)」
//請注意：因無庫存時「FilledAvgPrice」為0，此時會有分母為0計算有誤的狀況，故需要判斷當FilledAvgPrice非0時，運算損益。
//註：FilledAvgPrice是「商品目前的未平倉成本」
if FilledAvgPrice <> 0 then
 plratio = 100 * (Close - FilledAvgPrice) / FilledAvgPrice
else
 plratio = 0;

//InCondition為進場條件，當K棒為實體紅K「close > GetField("開盤價", "D")」則InCondition為True，否則為False。
InCondition = close > GetField("開盤價", "D");

//OutCondition為出場條件，當「損益(%)達停損停利」時，OutCondition為True，否則為False。
OutCondition = plratio >= _StopProfit or plratio <= -1 * _StopLost;

//當「目前商品的預期部位是0，且進場條件為Ture」則將目前商品的預期部位設為1，委託價格使用市價。
//也就是送出一筆「市價買進1張」的委託單。
if position = 0 and InCondition then setposition(1,market);

//當「目前商品的預期部位非0，且出場條件為Ture」則將目前商品的預期部位設為0，委託價格使用市價。
//也就是送出一筆「市價平倉持有張數」的委託單。
if position <> 0 and OutCondition then setposition(0,market);
```

[

#####


---

# 手機監控功能

Source: https://www.xq.com.tw/lesson/xsat/app/

[
![](/wp-content/uploads/2020/10/XSAT_06.png)
](/wp-content/uploads/2020/10/XSAT_06.png)透過XS自動交易的功能，你可以在「全球贏家」內串連券商完成全自動的交易。自動交易策略一旦啟動之後，你除了可以透過自動交易中心來進行監控之外，你也可以透過「XQ全球贏家App」來監控目前策略執行的狀態。 在底下的文章內，XQ小編將帶大家來完成手機上面的設定，讓你之後透過手機，隨時隨地都可以確認策略觸發的訊號，Let's gooooooo！ 

### **一、如何從App上面進入自動交易監控畫面 **
如果你還沒下載我們「XQ全球贏家APP」的話，幫我手機相機開啟掃描以下QRCode，才能開始以下步驟喔！ [
![](/wp-content/uploads/2016/12/push_01.png)
](/wp-content/uploads/2016/12/push_01.png)**進入全球贏家APP「自動交易監控」 **大家都下載好我們的「 **全球贏家APP」 **了，那我們開始囉！ 首先進入「 **全球贏家APP」 **首頁畫面後，你可以點擊功能捷徑來找到自動交易監控按鈕 如果你覺得每次這樣子點擊太麻煩的話，小編接下來教你怎麼把自動交易監控按鈕直接放在上頁的功能捷徑內。 [
![](/wp-content/uploads/2020/10/app_11.png)
](/wp-content/uploads/2020/10/app_11.png)進入自動交易監控畫面之後，你可能會看到空的畫面，這個表示你的桌機端尚未啟動任何有啟用交易帳號的自動交易策略。 不要緊張，繼續跟著小編的腳步~~ [
![](/wp-content/uploads/2020/10/XQM1_2.png)
](/wp-content/uploads/2020/10/XQM1_2.png)首先需要各位開啟你的電腦XQ全球贏家。 

#### **開啟XQ全球贏家桌機版，交易帳號 **
[
![](/wp-content/uploads/2020/10/XSAT_app.png)
](/wp-content/uploads/2020/10/XSAT_app.png)[
![](/wp-content/uploads/2020/10/XSAT_app2.png)
](/wp-content/uploads/2020/10/XSAT_app2.png)

#### **自動交易中心，新增自動交易策略，並開啟帳號設定 **
**[
![](/wp-content/uploads/2020/10/XSAT_app2-1.png)
](/wp-content/uploads/2020/10/XSAT_app2-1.png)****[
![](/wp-content/uploads/2020/10/XSAT_app3.png)
](/wp-content/uploads/2020/10/XSAT_app3.png)**

#### **啟動交易策略與開啟手機推播 **
[
![](/wp-content/uploads/2020/10/XSAT_app4.png)
](/wp-content/uploads/2020/10/XSAT_app4.png)

#### **成功啟動全球贏家APP「自動交易監控」 **
當我們從「 **全球贏家PC」 **啟動自動交易策略之後，我們就可以在手機APP的 **"自動交易監控" **畫面內，看到正在執行中的策略，以及策略的執行狀態。請注意喔，只有 **"啟用交易帳號" **的策略才會出現在手機的監控畫面內喔 **！ **從手機上除了可以看到策略的執行狀態之外，最重要的功能是當發生"緊急狀況"發生時，使用者可以透過手機就停止策略的執行。 停止策略的方式，則可分為停止「 **單個策略」 **or 「 **全部策略」。 **[
![](/wp-content/uploads/2020/10/XQM3_2.png)
](/wp-content/uploads/2020/10/XQM3_2.png)在之後的版本內，我們會陸續增加新的功能，讓大家從手機端可以看到更詳細的執行狀態，也請大家盡請期待^^ 

### **二、如何用手機看到自動交易策略的觸發訊號 **

#### **全球贏家APP接收自動交易的推播訊息 **
若是想於手機接收所有自動交易的推播訊息，需於「 **全球贏家APP」 **與「 **全球贏家PC」 **上做以下兩個步驟 

#### **1. 全球贏家APP「通知設定」啟用「自動交易」 **
點選APP首頁左上方「 **信箱圖示」 **→右上方「 **設定圖示」 **即可啟用手機APP自動交易推播 [
![](/wp-content/uploads/2020/10/XQM2_1.png)
](/wp-content/uploads/2020/10/XQM2_1.png)

#### **2. 全球贏家PC「自動交易中心」策略開啟推播 **
自動交易中心開啟→選擇要傳送到手機的策略→開啟推播 [
![](/wp-content/uploads/2020/10/XSAT_center12.png)
](/wp-content/uploads/2020/10/XSAT_center12.png)接下來我們馬上看看手機「XQ全球贏家APP」要如何看到「自動交易策略」觸發訊號 

#### **等待策略的觸發訊息 **
如果大家有按著小編的說明操作的話，自動交易中心應該已啟用「 **自動交易手機推播」 **並有「 **執行中的自動交易策略」 **了。 那我們現在一起登入XQ全球贏家APP首頁，等待電腦端的策略觸發！ 在自動交易策略中若是有發生「 **交易指令或是成交」 **，手機畫面上方會出現一則「推播」，如以下圖片。 [
![](/wp-content/uploads/2020/10/XQM5_1.png)
](/wp-content/uploads/2020/10/XQM5_1.png)

#### 切到「通知中心」介面 
在通知中心介面中，我們可以看到剛剛觸發的訊號卡片，卡片上會有自動交易成交的「 **策略名稱、策略多空方向，以及觸發商品的資訊(包含買賣價格、時間、成交數量)」 **點選APP首頁左上方「 **信箱圖示」 **即可進入至通知中心 [
![](/wp-content/uploads/2020/10/XQM4_1.png)
](/wp-content/uploads/2020/10/XQM4_1.png)到這裡大家了解XS自動交易手機監控的功能了嗎？ 希望用戶們經過XQ小編的簡單介紹可以清楚了解如何操作，小編在這裡祝大家投資順心，找到屬於自己的聖杯！ [

#####


---

# 自動交易語法：取得「交易帳號」使用說明

Source: https://www.xq.com.tw/lesson/xsat/at_id/

在這次改版當中，交易函數裡新增了可以取得目前策略執行時所使用的券商和帳號的功能。 如此一來便可以在交易腳本中限制使用的券商帳號，或是在模擬交易和實際交易下單時使用不同的交易邏輯。 舉例來說，使用者可能希望在模擬交易運作時用市價下單，這樣就可以觀察策略觸發進場的時間點是否為自己所希望的，但在實際交易時為了則會希望可以下限價單來避免滑價過大造成成本過高的問題。 以下會針對如何使用帳號相關的函數作說明，並簡單舉例。 

### **函數語法 **
我們是在「GetInfo」這個函數語法函數中，新增「AT\_EnableTrade」、「AT\_BID」、「AT\_AccType」、「AT\_AccType」這四個參數，讓大家可以藉由這四個參數來取得交易帳號的資訊 複製 

```
var: enableTrade(0), str_tsid(“”), acctype(0), str_aid(“”);
enableTrade = GetInfo(“AT_EnableTrade”);
str_tsid = GetInfo(“AT_BID”);
acctype = GetInfo(“AT_AccType”);
str_aid = GetInfo(“AT_AID”);
```

### **函數說明 **
在繼續往下閱讀前，有一件事情大家必須要了解，也就是這四個參數僅支援交易腳本。 GetInfo(“AT\_EnableTrade”) 將會回傳目前策略是否有啟動帳號，分成以下幾種狀況： 

- 如果是回測的話，回傳數值0。 
- 如果是即時的策略運作，但並沒有使用任何交易帳號的話，回傳數值0。 
- 如果是即時的策略運作，且有設定交易帳號，無論是模擬還是券商帳號都是回傳數值1。 
GetInfo(“AT\_BID”) 將會回傳券商的字串代碼。 需注意若目前策略沒有啟動帳號，或是在回測時的狀況下 (也就是GetInfo(“AT\_EnableTrade”)回傳0的狀況下)，此函數會回傳空白字串。 GetInfo(“AT\_AccType”) 將會回傳目前策略運作的業務類別。 

- 如果是證券的話，回傳數值1。 
- 如果是期貨的話，回傳數值2。 
- 如果是複委託的話，回傳數值3。 
- 若目前策略沒有啟動帳號，或是在回測時的狀況下 (也就是GetInfo(“AT\_EnableTrade”)回傳0的狀況下)，此函數會回傳 0。 
GetInfo(“AT\_AID”) 將會回傳目前策略運作的帳號。 這會是一個由券商代碼加上帳號組成的字串。 需注意若目前策略沒有啟動帳號，或是在回測的狀況下 (也就是GetInfo(“AT\_EnableTrade”)回傳0的狀況下)，此函數會回傳空白字串。 此字串有區分英文字母的大小寫，但XS字串比對預設是不區分大小寫的，因此在比對時可以使用 [StrCompare ](http://xshelp.xq.com.tw/XSHelp/?HelpName=StrCompare&group=STRINGFUNC)函數並將第三個參數設為False讓其區分大小寫。 

### **相關數值輸出示意圖 **
證券模擬帳號： [
![](/wp-content/uploads/2023/04/02-1024x648.png)
](/wp-content/uploads/2023/04/02.png)期權模擬帳號： [
![](/wp-content/uploads/2023/04/03-1024x642.png)
](/wp-content/uploads/2023/04/03.png)回測模擬帳號： [
![](/wp-content/uploads/2023/04/04-1024x330.png)
](/wp-content/uploads/2023/04/04.png)

### 

### 

### **腳本範例 **
**範例1： **下面是用布林通道當作進出場條件的簡單策略，當收盤價向上穿越布林通道下軌時買入，並在收盤價向上穿越20期移動平均時賣出。 當腳本運作在即時且設定券商為華南永昌證券的狀況下，下單進場時用觸發價加上2個Tick買進，出場時則用觸發價減2個Tick賣出，其他的狀況下則用市價賣出。 複製 

```
var: enableTrade(0), str_tsid("");
enableTrade = GetInfo("AT_EnableTrade");
str_tsid = GetInfo("AT_BID");
value1 = average(close, 20);
value2 = bollingerband(Close, 20, -2);
condition1 = close cross over value2 and position = 0;
condition2 = close cross over value1 and position > 0;
condition3 = enableTrade = 1 and str_tsid = "HNS";
if condition1 then begin
  if condition3 then setposition(1, addSpread(close, 2)) else setposition(1, market);
  end;
if condition2 then begin
  if condition3 then setposition(0, addSpread(close, -2)) else setposition(0, market);
  end;
```

**範例2： **若要確保該腳本只能執行在特定帳號上的話，可以加上帳號限制，讓其無法在使用其他帳號的情況下運作。 我們可以先把帳號判斷先撰寫成函數，這樣只要在交易腳本使用該函數，傳入所使用的 AT\_AID 就可以判斷是否為設定的帳號。 首先我們先撰寫「CheckAID」函式腳本 複製 

```
函數腳本 CheckAID:
input: _AID(string);
Condition1 = StrCompare(_AID, "SYSTRADE_SSJ00-TestAccount-01_1", False) = 0;
if condition1 then CheckAID = True else RaiseRunTimeError("帳號不符合");
```

再來，我們拿範例1的腳本當例子，來使用上面剛剛所新增的「CheckAID」函數 複製 

```
var: enableTrade(0), str_tsid(""), str_aid("");
enableTrade = GetInfo("AT_EnableTrade");
str_tsid = GetInfo("AT_BID");
str_aid = GetInfo("AT_AID");

CheckAID(“str_aid”);

value1 = average(close, 20);
value2 = bollingerband(Close, 20, -2);
condition1 = close cross over value2 and position = 0;
condition2 = close cross over value1 and position >0;
condition3 = enableTrade = 1 and str_tsid = "SYSTRADE";

if condition1 then begin
  if condition3 then setposition(1, addSpread(close, 2)) else setposition(1, market);
  end;
if condition2 then begin
  if condition3 then setposition(0, addSpread(close, -2)) else setposition(0, market);
  end;
```

如此一來，若策略使用的帳號與函數中設定的帳號不同的話，就會執行失敗並顯示帳號不符合的錯誤訊息。 以上就是這次針對取得交易帳號的腳本說明！ 

### **TSID 列表 **
**TSID ****說明 **SYSTRADE 內建的模擬交易帳號 SYSCAMPUS 

校園投資模擬競賽，可以從 AT\_AID 內判斷帳號的 GameID。 

假設 GameID 是 JUST123，使用者的身份證是 A01，那麼證券的 AT\_AID 會是 SJUST123-A01。 
TISC 群益金鼎 PSCAP 統一 HNS 華南永昌 WLS 國票 SINOAP 永豐金 TSS 台新 HONSEC 宏遠 TCB 合庫 MEGA 兆豐 LINK 元富 FUBONFAP 富邦 YUANTA 元大 KGIAP 凱基 CTS 中國信託 [

#####


---

# 自動交易回測功能

Source: https://www.xq.com.tw/lesson/xsat/backtest/

[
![](/wp-content/uploads/2020/10/XSAT_07.png)
](/wp-content/uploads/2020/10/XSAT_07.png)

### **前言 **
前陣子在機車行換輪胎與車行老闆閒聊股市投資心得，老闆說他小時候以為自己投資股票賺得錢比賠得多，後來深入了對帳單後才發現，其實他以前的賺賠是打平的，原因是他看對帳單，都是看到賺錢的，賠錢的沒去深入了解它。 後來仔細想想， [策略雷達回測 ](https://www.xq.com.tw/learn/sensor/backtest/)可能也有類似的窘境，回測勝率高與報酬率高的策略用戶有時候會懷疑是假聖杯，想要有更多的回測數據來評估策略的穩健性，故在自動交易回測我們祭出更多的回測策略因子，像是獲利因子與平均獲利虧損比，可以用來檢查高勝率策略的穩健度；也提供買進持有報酬率與大盤指數報酬率，方便做短線與主動投資者對照策略績效，希望能強化自動交易回測報告功能，加強投資者評估策略的效率。 

### 

### **目的 **
因應自動交易的語法，我們在自動交易中心可以做到的交易更加多元，譬如說可以做到翻單、加碼、減碼等部位控管的動作，故在自動交易回測設定增加「初始資金」參數設定，讓用戶使用本金來查看回測績效，並增加至 26 個回測報表數據，例如：獲利因子、平均獲利虧損比（賺賠比）...等等，釋出更多的策略因子，強化自動交易回測報表，以利讓用戶判斷策略回測績效表現。 策略雷達回測的總報酬率讓多數用戶不好解讀，所以自動交易回測報酬率改以「最大投入報酬率」呈現，以便讓新用戶較容易上手理解，舊用戶若用慣了時間加權報酬，也可以在介面切換時間加權報酬率曲線，或者在系統參數調整預設顯示時間加權報酬率曲線。我們也增加了買進持有(Buy&Hold)與大盤指數報酬率，讓短進短出、主動型投資的用戶方便對照績效表現。每筆交易的報酬率在股票商品會納入除權息再投資，在期貨商品則會去除換月價差影響，讓報酬率變得更為精確。不過，為了方便使用者於圖表上比對進出場點，我們在交易分析中顯示的進出場價仍然是回測頻率的點位，而非計算報酬所用的價格。 由於有用戶反映最大持倉報酬率無法精確的衡量不同交易策略的優劣，所以再度將其修改為「最大投入報酬率」來呈現。 回測報告畫面增加可切換成全部、做多與做空顯示回測報表上的數據，由於回測報表的數據變多，也有提供放大回測報表的功能，方便讓用戶一次看到所有的回測數據，曲線績效圖也增加「淨利」方便用戶視覺上閱覽盈虧績效表現。 [](#)本文將使用以下四個章節來做介紹： **與策略雷達回測差異性、自動交易回測項目說明、自動交易回測報告UI說明、XS自動交易執行回測入口 **。 

### **與策略雷達回測差異性 **
[
![](/wp-content/uploads/2020/10/220517_AT%E5%9B%9E%E6%B8%AC%E6%96%B0%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2020/10/220517_AT%E5%9B%9E%E6%B8%AC%E6%96%B0%E8%A8%AD%E5%AE%9A.png)

#### **回測參數設定差異 **

- 策略雷達回測在跑當沖策略時，往往在當日收盤前的清倉條件不好撰寫，故我們在自動交易回測增加「每日部位歸零」功能選項，方便當沖用戶使用此功能，輕鬆達到當日收盤前的清倉設定，無須在腳本撰寫語法判斷。 
- 策略雷達回測中的「資料讀取筆數」蠻多用戶不了解這項功能的文字意思，所以自動交易回測改成以「預先執行筆數」文字來表示，希望讓用戶了解是在開始回測日期前先跑預先執行筆數的資料運算。 
- [](#)在跑AT回測的過程中，條件通過在回測期間模擬成交會依照腳本撰寫的價格送模擬委託單，並在下一個回測洗價看是否會成交，若沒有特別撰寫，則會依照AT策略介面上的預設買進／賣出的價格設定送模擬委託單，這點在Sensor回測中無法做到。 
- **初始資金參數說明 **：自動交易回測增加「初始資金」參數供用戶填寫，可將投入的本金納入自動交易策略回測運算，並在自動交易回測報告呈現更多的數據，在下列的數據使用到百分比(%)呈現的都是有用到初始資金參數來運算，相關介紹可以參考「自動交易回測項目說明」 
- **「觸發即判斷成交」說明 **：自動交易回測新增「觸發即判斷成交」選項。來決定跑回測當下觸發條件的價格，是否要立即判斷成交。例如以下範例說明：交易回測跑 5 分鐘模擬逐筆洗價，日期是 2021/09/14 商品是永光(1711.TW) 腳本語法為 if position = 0 then setposition(1, Market); 

  - 關閉此項 

    - 在九點整這根5分鐘K棒，第一筆模擬逐筆 Tick 跑 if position = 0 then setposition(1, Market); 這段語法時，會在第一筆之後送出「價格＝市價／量＝1」買進委託，之後會在第二筆以「價格＝23.15」成交。 

  - 開啟此項 

    - 在九點整這根5分鐘K棒，第一筆模擬逐筆 Tick 跑 if position = 0 then setpostion(1, Market); 這段語法時，會送出委託並且以「價格＝23.00」立即成交。 [
![](/wp-content/uploads/2020/10/220517_%E8%A7%B8%E7%99%BC%E5%8D%B3%E5%88%A4%E6%96%B7%E6%88%90%E4%BA%A4%E8%AA%AA%E6%98%8E.png)
](/wp-content/uploads/2020/10/220517_%E8%A7%B8%E7%99%BC%E5%8D%B3%E5%88%A4%E6%96%B7%E6%88%90%E4%BA%A4%E8%AA%AA%E6%98%8E.png)

#### 回測報告畫面差異 
[
![](/wp-content/uploads/2020/10/01_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88.png)
](/wp-content/uploads/2020/10/01_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88.png)

- 自動交易回測數據共有 26 個項目，而 [策略雷達回測 ](https://www.xq.com.tw/lesson/sensor/%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E5%9B%9E%E6%B8%AC%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%B4%B9/)數據僅有 12 個項目，除了運用初始資金來計算出更多的策略因子外，我們也有加上「最大投入報酬率」、「買進持有報酬率」與「大盤指數報酬率」 

  - 最大投入報酬率，是淨利／最大投入金額，因為初始資金是由用戶自行設定，但我們在回測時並不會考慮觸發時資金是否足夠可以交易，在評估策略上可能會失真。所以提供最大投入金額及報酬率，讓客戶了解真的執行這個策略會需要多少資金及其真實的報酬率。同時，報酬率曲線圖也是以最大投入報酬率繪製。 
  - 買進持有報酬率（Buy & Hold）是比較策略績效的方式之一，讓短進短出的用戶，方便去比較長期持有報酬績效。例如，商品是06/01進場，07/31出場，但回測區間是 05/01 ~ 08/15，則買進報酬率是 05/01 ~ 08/15 所運算出來的數值。 
  - 大盤指數報酬，也是比較策略績效的方式之一，讓主動型投資的用戶，方便比較大盤績效。 

- 自動交易回測的策略，因為可以在語法上呈現翻單的撰寫，所以在自動交易回測報告上，有加上全部、做多與作空，切換三種操作方向的回測數據呈現，以便讓使用者了解操作方向的績效表現。 
- 自動交易回測報告新增了最大投入報酬率、時間加權報酬率與淨利曲線圖，並且在這三個曲線圖上標上創新高的藍點標記，以及增加最大區間虧損副圖，除了讓大家方便查看最大區間虧損數值外，也能從淨利曲線圖上了解創新高的點位在何處，強化績效曲線圖的呈現。 
- 自動交易回測數據，有百分比與金額呈現兩種方式，可以點選切換呈現，方便大家檢視回測數據。 
- 自動交易回測報酬率曲線圖，調整為最大投入報酬率與時間加權報酬率，兩種線圖供大家選擇呈現，而時間加權、買進持有與大盤指數報酬率，都在「+」Icon元件中，用戶可點選該元件疊加上述報酬率至曲線圖績效中對照比較。預設顯示最大投入報酬率來呈現的原因是，大家對於時間加權報酬率較不熟悉，故在自動交易回測改用最大持倉報酬來呈現，希望新用戶可以較好上手，舊用戶若用慣了時間加權報酬呈現，只要點選績效曲線圖上方的「時間加權報酬率」按鈕切換呈現，或者在系統參數調整預設顯示時間加權報酬率曲線即可。 
- [
![](/wp-content/uploads/2020/10/02_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E7%96%8A%E5%8A%A0%E6%8C%87%E6%A8%99.png)
](/wp-content/uploads/2020/10/02_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E7%96%8A%E5%8A%A0%E6%8C%87%E6%A8%99.png)
- [](#)[](#)自動交易回測新增「每日報表」頁面，方便用戶檢視每日統計的獲利、總獲利、最大投入金額與商品檔數數據，供用戶參考歸納出策略的績效在那些特定日子較弱勢，就能夠讓投資者考慮加上濾網，在績效不好的週期減少操作，或者把進場條件調整更嚴格。 [
![](/wp-content/uploads/2020/10/20210127_%E6%AF%8F%E6%97%A5%E5%A0%B1%E8%A1%A8.png)
](/wp-content/uploads/2020/10/20210127_%E6%AF%8F%E6%97%A5%E5%A0%B1%E8%A1%A8.png)
- 在「系統參數」可以設定自動交易回測報告的顯示預設設定，以利使用者在跑完自動交易回測報告後，直接預設顯示想查看的數值與報酬率曲線圖顯示的格式，就不用跑完後還要再調整格式設定，方便大家使用，目前可以調整的系統參數預設設定如下： 

  - 自動交易回測報告的表格數值預設顯示設定。 
  - 自動交易回測報告的報酬率曲線圖預設呈現設定。 
  - 自動交易回測報告「整體統計」頁面的報酬率曲線圖預設疊加參考指標設定。 [
![](/wp-content/uploads/2020/10/20210309_%E7%B3%BB%E7%B5%B1%E9%A0%90%E8%A8%AD-1.png)
](/wp-content/uploads/2020/10/20210309_%E7%B3%BB%E7%B5%B1%E9%A0%90%E8%A8%AD-1.png)

※註：在企業版的「系統參數」路徑為「上方主功能列 → 系統(S) → 設定(K) → 系統參數(P)」；在個人版的「系統參數」路徑為「上方主功能列 → 設定(S) → 我的設定(K) → 系統偏好設定(P)」 

### **自動交易回測項目說明 **
由於自動交易回測報表共 26 個數據與 策略雷達 回測報告共 12 個數據差異蠻多的，故以下將細部介紹 自動交易 回測報表數據的說明。此外自動交易回測報表上有顯示$與%兩種數據，$是以金額來計算，而%都是除以初始資金。 [](#)筆者喜歡直白的淨利數據，可以了解投入多少本金在這個策略上的收益為何。另外，獲利因子、平均獲利虧損比、買進持有報酬、大盤指數報酬，自動交易回測多了這四個策略因子，在評估回測績效表現時，又可以在更深入了解，這些數據在策略雷達回測上是無法被瞭解到的。 

- [](#)淨利 

  - 損益的加總就是淨利，用來判斷回測期間盈虧的數據，在下方也有呈現績效曲線圖，方便用戶審視績效。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- [](#)毛利 

  - 獲利的加總就是毛利，也就是回測期間的獲利表現。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 毛損 

  - 虧損的加總就是毛損，也就是回測期間的虧損表現。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 獲利因子 

  - 毛利/ABS(毛損)×SIGN(淨利)；ABS為絕對值；SIGN為數值的正負號。 

    - 僅有獲利、無虧損（分母為0）則獲利因子為「+0」 
    - 僅有虧損、無獲利（分子為0）則獲利因子為「-0」 
    - 無交易，則獲利因子為「n/a」 

  - 也就是總獲利金額／總虧損金額，可以搭配勝率檢視，假設策略勝率很高，每次都賺 1 元，總共賺了 9 次，但是賠 1 次，虧損 10 元，仍無用武之地。 
  - 一般認為，獲利因子大於 1.5 策略才算堪用。 

- [](#)最大持倉金額 

  - 也就是回測區間投入市場金額的最大值。 

- 總交易成本 

  - [](#)每筆交易的單筆手續費加總，對於操作短期的投資者而言，交易成本也是評估策略因子之一。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- **總交易次數 **

  - 交易次數的加總，此數據與策略雷達回測相同。 

- **獲利交易次數 **

  - 獲利交易次數的加總，此數據與策略雷達回測相同。 

- **虧損交易次數 **

  - 虧損交易次數，此數據與策略雷達回測相同。 

- [](#)勝率 

  - 獲利交易次數／總交易次數，此數據與策略雷達回測相同。 

- 平均交易 

  - [](#)淨利／總交易次數，取代了原本雷達回測的平均報酬率%，改以平均交易來呈現，原因是雷達回測的平均報酬率數據較難理解。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 平均獲利交易 

  - [](#)毛利／獲利交易次數，用來觀察每次獲利交易的平均值。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 平均虧損交易 

  - 虧損／獲利交易次數，用來觀察每次虧損交易的平均值。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 平均獲利虧損比 

  - [](#)ABS(平均獲利交易/平均虧損交易)；ABS為絕對值。 
  - 俗稱「賺賠比」交易要獲利的基本原則就是大賺小賠，此項數據可以用來衡量策略本身獲利的能力。 

- 最大獲利交易 

  - [](#)所有獲利金額>0(賺錢)的交易中，獲利金額最大(賺最多)就是最大獲利交易。 
  - 策略雷達回測為最大獲利率%(單筆)，在自動交易回測使用最大獲利交易來表示，原因是較容易解讀。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 最大虧損交易 

  - [](#)所有獲利金額<0(賠錢)的交易中，獲利金額最小(賠最多)就是最大虧損交易。 
  - 策略雷達回測為最大虧損率%(單筆)，在自動交易回測使用最大虧損交易來表示，原因是較容易解讀。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 最大區間獲利 

  - [](#)運用收盤價來計算，列出回測中每一段獲利(淨利>0)區間的累加淨利變化，取最大值。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 最大區間虧損 

  - 運用收盤價來計算，列出回測中每一段虧損(淨利<0)區間的累加淨利變化，取最小值。 
  - 代表從績效最高點拉回的平倉損益，如果回測區間承受不了最大區間虧損，那後面的獲利如浮雲，因為已被斷頭砍倉。 
  - 百分比(%)是除以「初始資金」參數後的數據。 

- 全部交易的平均持倉K線根數 

  - 此項數據，用來表述持有部位的平均期間為何，部位與資金需要投入的時間為何。 

- 獲利交易的平均持倉K線根數 

  - 此項數據，用來表述獲利交易持有部位的平均期間為何。 

- 虧損交易的平均持倉K線根數 

  - 此項數據，用來表述虧損交易持有部位的平均期間為何。 

- 回測K線根數 

  - 可以搭配買進持有報酬來觀察，回測K線根數用來評估買進持有報酬的持有期間為何。 

- 時間加權報酬率 

  - 去除資金因素後調整報酬率，可以較好評估進出場的有效性。 
  - 每一筆(次)交易的當期報酬率在當期所佔用的資金都是一樣的。 
  - 時間加權報酬$=累計時間加權報酬率×初始資金 
  - 股票會納入除權息再投資、期貨會去除換月價差影響。 

- 最大投入報酬率 

  - 最大投入報酬率=淨利/最大投入金額；最大投入報酬$=淨利 
  - 以回測區間內，真實會動用到的最大投入市場資金來計算報酬率。 
  - 自動交易回測的報酬率主線圖，改以最大投入報酬率來呈現，因為初始資金是由用戶自行設定，但我們在回測時並不會考慮觸發時資金是否可以交易，在評估策略上可能會失真。所以提供最大投入金額及報酬率，讓客戶了解真的執行這個策略會需要多少資金及其真實的報酬率。同時，報酬率曲線圖也是以最大投入報酬率繪製。 
  - 股票會納入除權息再投資、期貨會去除換月價差影響。 

- 買進持有報酬率 

  - 評估策略、比較績效用。不考慮進出場訊號，單純在回測區間內持有回測商品可獲得的報酬率。例如，商品是06/01進場，07/31出場，但回測區間是 05/01 ~ 0815，則買進報酬率是 05/01 ~ 08/15 所運算出來的數值。 
  - Buy&Hold 數據方便做短線的投資者對照，衡量短期策略績效表現，如果短期策略績效與買進持有差不多的話，那建議就單純買進持有就好。 
  - 股票會納入除權息再投資、期貨會去除換月價差影響。 

- [](#)大盤指數報酬率 

  - 評估策略、比較績效用，大盤在回測區間的報酬率，以加權報酬指數（TSETR.TW）計算的買進持有報酬率。 
  - 方便讓主動型投資者比對績效用，如果主動投資的績效沒有比大盤表現來的穩健，那建議投入ETF的懷抱，主動投資就是要完敗大盤才有感。 
  - 股票會納入除權息再投資、期貨會去除換月價差影響。 

### **自動交易回測報告UI說明 **
自動交易回測報告畫面，一樣是使用「整體統計」、「商品統計表」、「商品分析」、「交易分析」、「腳本資料」這五個頁面來呈現。除了腳本資料頁面沒有異動外，其他的四個頁面在自動交易回測都有做些微的調整，另外新增了「每日報表」頁面，以下將做細部的介紹。 

#### 整體統計 
[
![](/wp-content/uploads/2020/10/01_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88.png)
](/wp-content/uploads/2020/10/01_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E6%95%B4%E9%AB%94%E7%B5%B1%E8%A8%88.png)

- 整體統計頁面，在回測報表有新增「全部」、「做多」與「做空」三個切換按鈕以便讓用戶查看各個操作方向的績效表現。自動交易 回測能在一個策略做到翻單的策略，故增加此功能，方便用戶瀏覽各個方向的回測數據。 
- 自動交易回測數據，有百分比與金額呈現兩種方式，可以點選切換呈現，方便大家檢視回測數據。 
- 由於自動交易回測報表數據多達 26 個，以及最大區間虧損副圖，故增加放大回測報表數據與績效線圖的Tool，以便用戶一覽無遺回測數據與績效線圖。 
- 自動交易回測報告新增了最大投入報酬率、時間加權報酬率與淨利曲線圖，並且在這三個曲線圖上標上創新高的藍點標記，以及增加最大區間虧損副圖，除了讓大家方便查看最大區間虧損數值外，也能從淨利曲線圖上了解創新高的點位在何處，強化績效曲線圖的呈現。 [
![](/wp-content/uploads/2020/10/02_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E7%96%8A%E5%8A%A0%E6%8C%87%E6%A8%99.png)
](/wp-content/uploads/2020/10/02_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E7%96%8A%E5%8A%A0%E6%8C%87%E6%A8%99.png)
- 自動交易回測報酬率曲線圖，調整為最大投入報酬率與時間加權報酬率，兩種線圖供大家選擇呈現，而時間加權、買進持有與大盤指數報酬率，都在「+」Icon元件中，用戶可點選該元件疊加上述報酬率至曲線圖績效中對照比較。預設顯示最大投入報酬率來呈現的原因是，大家對於時間加權報酬率較不熟悉，故在自動交易回測改用最大持倉報酬來呈現，希望新用戶可以較好上手，舊用戶若用慣了時間加權報酬呈現，只要點選績效曲線圖上方的「時間加權報酬率」按鈕切換呈現，或者在系統參數調整預設顯示時間加權報酬率曲線即可。 

#### 每日報表 
[
![](/wp-content/uploads/2020/10/03_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E6%AF%8F%E6%97%A5%E5%A0%B1%E8%A1%A8.png)
](/wp-content/uploads/2020/10/03_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E6%AF%8F%E6%97%A5%E5%A0%B1%E8%A1%A8.png)

- 自動交易回測新增「每日報表」頁面，方便用戶檢視每日統計的獲利、總獲利、最大持倉金額與商品檔數數據，供用戶參考歸納出策略的績效在那些特定日子較弱勢，就能夠讓投資者考慮加上濾網，在績效不好的週期減少操作，或者把進場條件調整更嚴格。 

#### 商品統計表 
[
![](/wp-content/uploads/2020/10/20210127_%E5%95%86%E5%93%81%E7%B5%B1%E8%A8%88%E8%A1%A8.png)
](/wp-content/uploads/2020/10/20210127_%E5%95%86%E5%93%81%E7%B5%B1%E8%A8%88%E8%A1%A8.png)

- 在商品統計表中，同樣有新增「全部」、「做多」與「做空」三個切換按鈕以便讓用戶查看各個操作方向的績效表現。 
- 在商品統計表中，同樣有百分比與金額呈現兩種方式，可以點選切換呈現，方便大家檢視回測數據。 

#### 商品分析 
[
![](/wp-content/uploads/2020/10/04_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E5%95%86%E5%93%81%E5%88%86%E6%9E%90.png)
](/wp-content/uploads/2020/10/04_PPT_%E5%9B%9E%E6%B8%AC%E5%A0%B1%E5%91%8A%E5%95%86%E5%93%81%E5%88%86%E6%9E%90.png)

- 同樣在商品分析有新增「全部」、「做多」與「做空」三個切換按鈕以便讓用戶查看各個操作方向的績效表現。 
- 同樣在商品分析有百分比與金額呈現兩種方式，可以點選切換呈現，方便大家檢視回測數據。 
- 同樣在商品分析中，由於自動交易回測報表數據多達 26 個，以及最大區間虧損副圖，故增加放大回測報表數據與績效線圖的Tool，以便用戶一覽無遺回測數據與績效線圖。 
- 同樣在商品分析中，自動交易回測報告新增了最大投入報酬率、時間加權報酬率與淨利曲線圖，並且在這三個曲線圖上標上創新高的藍點標記，以及增加最大區間虧損副圖，除了讓大家方便查看最大區間虧損數值外，也能從淨利曲線圖上了解創新高的點位在何處，強化績效曲線圖的呈現。 
- 同樣在商品分析中，自動交易回測報酬率曲線圖，調整為最大投入報酬率與時間加權報酬率，兩種線圖供大家選擇呈現，而時間加權、買進持有與大盤指數報酬率，都在「+」Icon元件中，用戶可點選該元件疊加上述報酬率至曲線圖績效中對照比較。預設顯示最大投入報酬率來呈現的原因是，大家對於時間加權報酬率較不熟悉，故在自動交易回測改用最大投入報酬來呈現，希望新用戶可以較好上手，舊用戶若用慣了時間加權報酬呈現，只要點選績效曲線圖上方的「時間加權報酬率」按鈕切換呈現，或者在系統參數調整預設顯示時間加權報酬率曲線即可。 

#### 交易分析 
[
![](/wp-content/uploads/2020/10/20210127_%E4%BA%A4%E6%98%93%E5%88%86%E6%9E%90%E6%A8%99%E8%A8%BB.png)
](/wp-content/uploads/2020/10/20210127_%E4%BA%A4%E6%98%93%E5%88%86%E6%9E%90%E6%A8%99%E8%A8%BB.png)在交易分析頁面中，我們調整了進場與出場的標註圖示，以利讓大家檢閱各筆模擬成交回測的進出場位置，其中「#」編號為對應的交易序號，例如上圖的「#01」是序號 1 的進出場點位，而「#02」是序號 2 的進出場點位，而紅色與綠色數字為進出場的交易數量。由於模擬成交回測有加碼、減碼的交易語法，故在交易分析我們用「#」編號來標註對應的交易序號，就能知悉以下對應的進出場點位資訊： 

- 「紅框 #01、紅色數字 1」表示交易 1 序號進場買進 1 張。 
- [](#)「紅框 #02、紅色數字 1」表示交易 2 序號加碼買進 1 張。 
- 「綠框 #01、綠色數字 1」表示交易 1 序號減碼賣出 1 張。 
- 「綠框 #02、綠色數字 1」表示交易 2 序號出場賣出 1 張。 

### **XS自動交易執行回測入口 **
若要執行XS自動交易回測，有三個地方可以執行，分別是「XS自動交易中心工作區」、「XS自動交易中心目錄區」、「XScript編輯器」 

- 「XS自動交易中心工作區」右上角，點選回測即可執行回測 

![](/wp-content/uploads/2020/10/backtest_1.png)

- 「XS自動交易中心目錄區」，點選右鍵→回測，即可執行回測 
[
![](/wp-content/uploads/2020/10/backtest_1_1.png)
](/wp-content/uploads/2020/10/backtest_1_1.png)

- 從「XScript編輯器」中，開啟要執行回測的警示腳本，然後點選「回測」按鈕來執行回測 
[
![](/wp-content/uploads/2020/10/backtest_1_3.png)
](/wp-content/uploads/2020/10/backtest_1_3.png)以上說明到此告一段落，預祝大家可以使用模擬成交回測功能，找出優質的交易策略，早日取得交易聖杯！謝謝大家。 [

#####


---

# 如何建立自動交易策略

Source: https://www.xq.com.tw/lesson/xsat/bulid_own_xsat/

[
![](/wp-content/uploads/2020/10/XSAT_03.png)
](/wp-content/uploads/2020/10/XSAT_03.png)

### **編寫交易腳本 **
首先，在XS編譯器內，要設計自動交易時，腳本請選擇 **「交易」 **這個類型。 交易腳本的設計方式跟警示腳本非常的類似，支援的報價欄位、資料欄位也是一樣的，最主要的差異就是可以透過SetPosition這些語法來指示XS自動交易系統如何進行交易。 [
![](/wp-content/uploads/2020/10/如何建立自動交易策略1.png)
](/wp-content/uploads/2020/10/如何建立自動交易策略1.png)

### **自動交易策略 **
交易腳本編譯完畢之後，我們就可以建立一個 **「自動交易策略」 **來執行這個腳本。 建立自動交易策略的方式有兩種。 **第一種 **方式是直接在XS編輯器內，選擇交易腳本，然後按右鍵「加到自動交易」。 [
![](/wp-content/uploads/2020/10/如何建立自動交易策略3-1.png)
](/wp-content/uploads/2020/10/如何建立自動交易策略3-1.png)第二種方式則是開啟「自動交易中心」，然後點選 **「新增」 **按鈕，或是從右鍵選單內選擇「新增自動交易」 [
![](/wp-content/uploads/2020/10/如何5.png)
](/wp-content/uploads/2020/10/如何5.png)要建立一個自動交易策略時，必須填入以下設定： 執行商品 決定策略要執行哪些商品。 提供的選項包含： 

- 可以選擇一個或是多個商品 
- 可以選擇一個分類清單(例如我的某組自選股) 
- 可以選擇一個XS選股法，執行前會先執行這個選股法，符合選股法的商品就會執行這個腳本 
- 可以選擇帳號的庫存 
- 可以選擇從外部檔案匯入欲執行的商品 
[
![](/wp-content/uploads/2020/10/XSAT_執行商品2.png)
](/wp-content/uploads/2020/10/XSAT_執行商品2.png)[
![](/wp-content/uploads/2020/10/如何6.png)
](/wp-content/uploads/2020/10/如何6.png)

#### 執行頻率以及是否逐筆洗價 
選擇策略執行時所讀取的商品資料頻率，以及是每一根K棒執行一次，還是是價格有異動時就執行一次。 [
![](/wp-content/uploads/2020/10/如何16-改.png)
](/wp-content/uploads/2020/10/如何16-改.png)資料讀取範圍以及是否使用歷史資料計算策略部位 透過這些參數，可以指定策略讀取歷史資料的範圍，以及是不是要使用歷史資料來模擬算出策略的部位，例如一個均線交易策略，可以使用歷史資料來算出策略目前是處在進場或是出場的位置，然後再接續當日的即時資料進行波段交易。 請參考 [此篇文章 ](https://www.xq.com.tw/learn/xsat/parameters/)。 [
![](/wp-content/uploads/2020/10/如何18-改.png)
](/wp-content/uploads/2020/10/如何18-改.png)

#### 交易帳號，以及是否連結帳號庫存 
自動交易策略可以在不指定帳號的情形底下執行。此時策略執行時不會傳送委託單到券商端，而是靠著目前市場的即時行情來模擬策略的部位異動是否會成交。透過這樣子的設定方式，使用者可以在不啟動實單交易的情形下確認策略執行的邏輯是否符合預期。 [
![](/wp-content/uploads/2020/10/XSAT_帳號設定.png)
](/wp-content/uploads/2020/10/XSAT_帳號設定.png)或是，可以開啟帳號設定，指定證券或是期貨帳號，同時設定帳號的相關參數，之後XS自動交易執行時就會傳送真實的委託單到指定券商端。 更詳細的說明請參考 [此篇文章 ](https://www.xq.com.tw/learn/xsat/parameters/)。 [
![](/wp-content/uploads/2020/10/如何17-改.png)
](/wp-content/uploads/2020/10/如何17-改.png)

#### 交易安控 
XS自動交易提供了部位，進場次數，以及交易金額等安控選項。一旦啟動安控之後，如果交易指令的內容違反安控的話，XS自動交易將不會執行這一個交易指令。 [
![](/wp-content/uploads/2020/10/如何15.png)
](/wp-content/uploads/2020/10/如何15.png)

#### 進出場設定 
設定策略預設的買進價格以及賣出價格。腳本內的交易指令可以指定委託的價格，此時系統就會依照指定價格送單。如果交易指令內不指定價格的話，則會使用策略的預設買進/賣出價格來傳送委託。 使用者也可以決定萬一行情網路發生連線問題時，策略的執行會自動停止，還是等到行情連線恢復時繼續執行。 [
![](/wp-content/uploads/2020/10/如何19-改.png)
](/wp-content/uploads/2020/10/如何19-改.png)到此為止，我們簡單的說明了自動交易策略的一些主要參數。在 [下一篇文章 ](https://www.xq.com.tw/learn/xsat/parameters/)內我們會更詳細的介紹自動交易策略的所有參數以及執行交易時的行為。 另外關於自動交易中心的操作介面，也請大家參考 [自動交易中心操作界面 ](https://www.xq.com.tw/learn/xsat/guideline/)這一篇文章。 [

#####


---

# CancelAllOrders語法說明

Source: https://www.xq.com.tw/lesson/xsat/cancelallorders/

大家好，今天跟大家介紹一個XS自動交易的新語法：CancelAllOrders，目的是用來刪除委託單。 

## 設計目的 
在某些交易情境底下，使用者可能想要做的是取消目前尚未成交的委託，例如送出委託單之後如果等10分鐘沒有完全成交的話，就取消這一筆委託。 以目前的設計方式，如果想要刪除委託單的話，可以使用SetPosition的方式來完成： 
---

```
if Filled <> Position then begin
    SetPosition(Filled);
end;
```

---
可是，這個腳本執行時，可能會因為成交的先後順序而產生與預期不同的執行方式。 
---

```
if Condition1 and Position = 0 then begin
   // 進場
   SetPosition(2);
end else if Condition2 and Position = 2 and Position <> Filled then begin
   // 試著刪除委託
   SetPosition(Filled);
end;
```

---
假設腳本執行時，Condition1成立了，所以呼叫了SetPosition(2)。 接下來Condition2成立了，如果此時尚未成交(Filled = 0)，Position <> Filled，所以腳本接下來呼叫了SetPosition(0)。 當XS執行SetPosition(0)時，他會檢查目前委託單的成交狀況，此時應該有一筆買進2張的委託單，尚未成交，所以XS就會送出刪單的指令，當這一筆委託單被刪除之後，這時候就符合Position = 0的定義了。 可是，萬一刪除這筆委託單時，發現這筆委託單成交了1張，此時Filled的數值是1，可是腳本希望把Position設定成 0，所以接下來XS就會 送出賣出1張的委託單 ，讓部位變成0。 這個賣出的行為，可能不是使用者預期的，也許使用者會希望先刪除委託單，萬一成交的話，那也先留著看之後怎麼處理。為了讓使用者有更好的控制權，於是這一版我們就增加了CancelAllOrders的語法。 

## 語法說明 
CancelAllOrders的語法很簡單： 
---

```
CancelAllOrders()
CancelAllOrders(label:="指令標記")
```

---
當XS執行CancelAllOrders指令時，此時會依序做以下的動作： 

- 檢查目前的Filled跟Position是否有差異，如果沒有差異的話，就不需要執行。 
- 檢查目前委託單的狀態，如果委託單尚未完全成交的話，則送出刪單的指令。 
- 等待刪單指令執行完成後，依照實際成交情形，更新Filled以及Position的數值。 

## 執行邏輯以及Position的異動順序 
我們延伸先前的範例，把刪單的動作改成呼叫CancelAllOrders： 
---

```
if Condition1 and Position = 0 then begin
   // 進場
   SetPosition(2);
end else if Condition2 and Position = 2 and Position <> Filled then begin
   // 刪除委託
   CancelAllOrders();
end;
```

---
以下我們逐步來trace腳本的執行流程。 

### 時間點#1 
腳本剛開始執行時，Position = 0，Filled = 0。 

### 時間點#2 
假設接下來Condition1成立了，呼叫了SetPosition(2)。 XS跑完這一次洗價之後，會送出一筆買進2張的委託單，同時把Position改成2，Filled還是0。 

### 時間點#3 
假設過一陣子，這張委託單成交了一張，此時XS會更新Filled (=1)，下一次洗價時就會印出Position = 2 Filled = 1的訊息。 

### 時間點#4 
假設接下來Condition2成立了，這時候Position = 2，Filled = 1，Position <> Filled，所以呼叫了CancelAllOrders。 XS跑完這一次洗價之後，開始執行CancelAllOrders。執行CancelAllOrders的第一個動作，是檢查目前委託單的狀態。此時應該有一筆買進2張的委託單，成交了1張，所以XS接下來會送出刪單的動作。 

### 時間點#5 
假設刪單還沒有回報之前，又觸發了一次洗價。 請注意：這時候印出來的 Position的數值還是2，Filled的數值也還是1 。 也就是說，XS呼叫CancelAllOrders之後， 不會更改Position的數值 。會這樣子設計的原因，是因為刪單後的實際刪除數量必須等到執行完成時才會知道，所以無法事先知道刪單後的Position會是多少。 

### 時間點#6 
假設接下來交易主機端回傳了這次刪單的結果，有可能是： 

- 取消了1張，所以此時腳本的Position跟Filled都會變成1。 
- 多成交了1張，所以取消了0張，此時腳本的Position跟Filled都會變成2。 
這個時候，XS才會去更改Position跟Filled的數值。在下一次洗價時，腳本就會發現Position的數值跟Filled的數值是一樣的了。 如果要判斷刪單是否已經執行完成，一種作法，是在呼叫CancelAllOrders時設立一個旗標(State = 1)，然後檢查這個旗標以及Position = Filled (下方紅字處)，當兩者都成立時，就表示刪單已經執行完成了，接下來腳本就可以依照此時的Filled來決定接下來該怎麼運作。 
---

```
var: intrabarpersist State(0);
Print("Position=", NumToStr(Position, 0), "Filled=", NumToStr(Filled, 0));

if Condition1 and Position = 0 then begin
   // 進場
   SetPosition(2);
end else if Condition2 and Position = 2 and Position <> Filled then begin
   // 刪除委託
   CancelAllOrders();
   State = 1;
end else if State = 1 and Position = Filled then begin
   // 刪單完成了
end;
```

---

## CancelAllOrders執行期間不會進行部位異動 
當腳本呼叫CancelAllOrders後XS會送出了刪單，可是萬一在這一筆刪單的狀態還沒有完全確定之前，腳本又再次呼叫了SetPosition的話，那會發生什麼事情？ 為了確保委託單的執行順序，一旦XS開始執行CancelAllOrders，在委託單的刪除狀態完全確認之前，任何的SetPosition指令， 都不會被立即執行 。 會這樣子做的原因，是因為刪單還沒有執行完成之前，XS不知道實際的Filled，所以也不會知道該怎麼送出委託單來達到這個新的SetPosition的要求！ 如果在CancelAllOrders執行期間，腳本真的呼叫了SetPosition的話， 那麼XS會記住最後一次的SetPosition的數值，然後等到CancelAllOrders執行完成時，依照最新的Filled，再決定該如何執行這一次的SetPosition。 小編會建議有這樣子交易需求時，可以在腳本內設計自訂的旗標變數(例如上面範例腳本內的State變數)，另外搭配Position/Filled的數值比對，這樣子比較確定目前該執行什麼樣子的邏輯。 [

#####


---

# 「週期分析」說明

Source: https://www.xq.com.tw/lesson/xsat/cycle-analysis/

回測報告中，新增了以「日或以上」的頻率作基礎所產出的分析資訊。 可以由左方的頁籤中點選最下面的「週期分析」選項來閱覽。 [
![](/wp-content/uploads/2024/12/01-1-1024x556.png)
](/wp-content/uploads/2024/12/01-1.png)週期分析的左上角有頻率可以切換，提供 日 / 月 / 季 / 年 四個頻率。 使用者也可以切換數值呈現的模式，有金額和百分比。 [
![](/wp-content/uploads/2024/12/02-1-1024x556.png)
](/wp-content/uploads/2024/12/02-1.png)週期分析的上半部為表格，欄位和整體統計的雷同。 這裡的資訊和原本的回測報告最大的差異在於是用選定的頻率而非各筆交易資訊來運算。 舉例來說，當選擇日頻率時，會以每一日的獲利視為 1 筆交易作為分析依據。 若選擇月的話，則會以每個月的獲利視為 1 筆交易作為分析依據。 由於和整體統計使用每筆交易作分析依據不同，故區間分析計算出的數值會和整體統計有所差異。 至於下半部的部分，則是以柱狀圖呈現獲利的資訊，不同頻率彙整的方式有些差別。 圖型的右上角可以切換平均 / 總計。 [
![](/wp-content/uploads/2024/12/03-1-1024x559.png)
](/wp-content/uploads/2024/12/03-1.png)就以此圖為範例，這代表著回測區間中每個月的 31 號平均虧損 -7419 元。 
---

### **各欄位項目說明 **

#### **表格部分 **
在計算時皆以回測最後一日的最大投入金額 (也就是回測期間內所需準備的最低金額) 當作初始金額，避免因區間中投入金額增加導致百分比浮動的狀況。 **淨利 **($)：損益加總 (%)：損益加總 / 最後一期最大投入金額 \* 100% **毛利 **($)：獲利加總 (%)：獲利加總 / 最後一期最大投入金額 \* 100% **毛損 **($)：虧損加總 (%)：歸損加總 / 最後一期最大投入金額 \* 100% **獲利因子 **($ / %)：毛利 / 毛損，獲利時為正值，虧損時為負值。 **總交易 (日 / 月 / 季 / 年) 數 **($ / %)：回測期間經過的 (日 / 月 / 季 / 年) 數 **獲利交易 (日 / 月 / 季 / 年) 數 **($ / %)：回測期間內該 (日 / 月 / 季 / 年) 的損益為正值的數量 **虧損交易 (日 / 月 / 季 / 年) 數 **($ / %)：回測期間內該 (日 / 月 / 季 / 年) 的損益為正值的數量 **勝率 **($ / %)：獲利交易 (日 / 月 / 季 / 年) 數 / 總交易 (日 / 月 / 季 / 年) 數 **平均單 (日 / 月 / 季 / 年) 金額變動 **($)：淨利 ($) / 總交易 (日 / 月 / 季 / 年) 數 (%)：每 (日 / 月 / 季 / 年) 期報酬率的幾何平均 **平均單 (日 / 月 / 季 / 年) 獲利金額變動 **($)：毛利 ($) / 獲利交易 (日 / 月 / 季 / 年) 數 (%)：每 (日 / 月 / 季 / 年) 期獲利報酬率的幾何平均 **平均單 (日 / 月 / 季 / 年) 虧損金額變動 **($)：毛損 ($) / 虧損交易 (天 / 月 / 季 / 年) 數 (%)：每 (日 / 月 / 季 / 年) 期虧損報酬率的幾何平均 **平均單 (日 / 月 / 季 / 年) 獲利虧損金額比 **($ / %)：平均單 (日 / 月 / 季 / 年) 獲利金額變動 / 平均單 (日 / 月 / 季 / 年) 虧損金額變動 的絕對值 **最大單 (日 / 月 / 季 / 年) 獲利 **($)：單 (日 / 月 / 季 / 年) 獲利中的最大值 (%)：單 (日 / 月 / 季 / 年) 報酬率中獲利的最大值 當數值皆為虧損的時候則回傳 0 **最大單 (日 / 月 / 季 / 年) 虧損 **($)：單 (日 / 月 / 季 / 年) 虧損中的最大值 (%)：單 (日 / 月 / 季 / 年) 報酬率中虧損的最大值 當數值皆為獲利的時候則回傳 0 **最大區間獲利 **($)：連續的單 (日 / 月 / 季 / 年) 獲利的加總最大值 (%)：連續的單 (日 / 月 / 季 / 年) 獲利報酬率的累積值 (階乘) **最大區間虧損 **($)：連續的單 (日 / 月 / 季 / 年) 虧損的加總最大值 (%)：連續的單 (日 / 月 / 季 / 年) 虧損報酬率的累積值 (階乘) 

#### **圖表部分 **
單 (日 / 月 / 季 / 年) 報酬率：(當期帳戶金額 - 前一期帳戶金額) / 前一期帳戶金額 \* 100% 單 (日 / 月 / 季 / 年) 淨利 = 當期總獲利 - 前一期總獲利 **日頻率 **1 日 ~ 31 日 報酬率 (%) 總計 = Π(每月對應日報酬率 + 1) - 1 (%) 平均 = 總計 ^ (1 / 每月對應日數量) 獲利 ($) 總計 = 每月對應日淨利加總 ($) 平均 = 每月對應日淨利加總 / 每月對應日數量 星期一 ~ 星期五 報酬率 (%) 總計 = Π(每週對應日報酬率 + 1) - 1 (%) 平均 = 總計 ^ (1 / 每週對應日數量) 獲利 ($) 總計 = 每週對應日淨利加總 ($) 平均 = 每週對應日淨利加總 / 每週對應日數量 **月頻率 **1 ~ 12 月 報酬率 (%) 總計 = Π(每年對應月報酬率 + 1) - 1 (%) 平均 = 總計 ^ (1 / 每年對應月數量) 獲利 ($) 總計 = 每年對應月淨利加總 ($) 平均 = 每年對應月淨利加總 / 每年對應月數量 **季頻率 **Q1 ~ Q4 報酬率 (%) 總計 = Π(每年對應季報酬率 + 1) - 1 (%) 平均 = 總計 ^ (1 / 每年對應季數量) 獲利 ($) 總計 = 每年對應季淨利加總 ($) 平均 = 每年對應季淨利加總 / 每年對應季數量 [

#####


---

# 自動交易的基本觀念

Source: https://www.xq.com.tw/lesson/xsat/introduction/

[
![](/wp-content/uploads/2020/10/XSAT_02.png)
](/wp-content/uploads/2020/10/XSAT_02.png)

### **XS自動交易的簡介 **
XS自動交易的主要功能，是讓使用者可以設定欲交易的商品以及帳號，然後透過編寫腳本邏輯，來自動進行買進賣出的動作。透過交易相關的語法，使用者可以控制委託的買賣方向、委託數量、委託價格，也可以進一步的取得已經成交的數量及價格等完整的成交資訊，也就是說透過XS自動交易，使用者可以完成一個全自動化的交易流程。 在XS自動交易功能內，有三個主角，第一個是 **自動交易腳本 **，第二個是 **自動交易回測系統 **，第三個則是真正執行交易的 **自動交易中心 **。 就如同要設定XS策略雷達來做盤中即時警示時我們需要把何時要產生警示的邏輯寫在一個警示腳本內一樣，要設定XS自動交易時，我們也必須把交易的邏輯寫在一個 交易腳本 內，這個動作可以透過XS編輯器來完成。 設計好交易腳本之後，接下來我們可以進行回測。在回測的過程中，XS自動交易系統會以歷史資料來執行腳本，同時依照腳本內的指令進行交易的動作。這些交易的動作並不會送出委託單，而是會藉由歷史資料來判斷這些交易是否會成交，如果會的話成交價格以及成交數量又會是什麼。最後，透過這些成交的資料，回測系統可以告訴我們這個腳本的勝率、賺賠、報酬率等資訊。 如果接下來我們想要開始執行自動交易時，我們就需要設定這個自動交易執行時的相關參數，例如希望執行哪些商品，希望用什麼資料頻率來執行，希望用那個交易帳號來下單等。這一個動作則是透過「自動交易中心」這一個介面來做設定。 「自動交易中心」就如同「策略雷達」或是「選股中心」一樣，提供了執行XS自動交易功能的相關操作介面。在「自動交易中心」內，使用者可以設定很多個「自動交易策略」，每一個「自動交易策略」內可以指定要執行的交易腳本、商品、頻率、交易帳號等。一旦啟動「自動交易策略」，系統就會依照商品的資料來進行洗價以及交易的動作。 

### **語法內如何進行交易 **
在警示腳本內，當腳本呼叫ret=1時就可以產生觸發訊號；在選股腳本內，同樣的也是呼叫ret=1表示希望選到這檔商品，那麼在交易腳本內，如果想要進行交易的話，那該怎麼做呢？ 要瞭解如何進行自動交易，首先要先知道自動交易腳本內， [Position ](https://xshelp.xq.com.tw/api.aspx?a=Position&b=bif)(部位)的這個觀念。 所謂Position，指的是「這個商品的 目標部位」 ，也就是這個腳本預期持有的部位。Position是一個整數，可以大於0，等於0，或是小於0。當我們想要進行買進動作時，就透過「 交易指令」 把Position的數值變大，反之當我們想要進行賣出動作的話，就透過交易指令把Position的數值變小。當Position的數值被異動之後，XS自動交易系統就會依照策略所指定的參數，送出對應的委託單，如果這些委託單順利成交的話，這個商品的淨成交張數就會跟Position是一致的。 XS自動交易提供了不同的「交易語法」可以用來更改Position數值，其中最重要的就是 [SetPosition ](https://xshelp.xq.com.tw/api.aspx?a=SetPosition&b=bif)這個語法： 

```
SetPosition(目標部位)
SetPosition(目標部位，委託價格)

```

SetPosition函數的第一個參數是目標部位。第二個參數是進行此次交易的委託價格，如果不傳的話則會使用策略的預設買進/賣出價格。 接下來我們來看一些SetPosition的使用範例。 **範例#1 **

```
if Position = 0 then SetPosition(1);
```

如果目前的Position是0的話，買進1張，委託價格使用策略預設的買賣價格。執行之後Position會變成1。 **範例#2 **

```
if Position = 0 then SetPosition(1, Close);
```

如果目前的Position是0的話，買進1張，委託價格使用目前的收盤價(洗價時的最新收盤價)。 SetPosition的第二個參數是委託價格，可以傳入一個固定數值(例如100.0)，或是其他的數值運算(例如Close, Close+1.0, 等)。 **範例#3 **

```
if Position = 0 then SetPosition(-1);
```

如果目前的Position是0的話，賣出1張，委託價格使用策略的預設賣出價格。執行之後Position會變成-1。 **範例#4 **

```
if Position > 0 then SetPosition(0, MARKET);
```

如果目前的Position大於0的話，則用市價賣出所有多單的張數。MARKET是一個特殊的保留字，代表希望用市價交易。XS自動交易系統會依照帳號類型來決定市價單該如何傳送，如果是證券帳號的話，會傳送 市價 委託，如果是期貨帳號的話，則會傳送 範圍市價 委託。 除了SetPosition語法可以更改目標部位之外，另外XS自動交易還提供了 [Buy ](https://xshelp.xq.com.tw/api.aspx?a=Buy&b=bif)、 [Sell ](https://xshelp.xq.com.tw/api.aspx?a=Sell&b=bif)、 [Short ](https://xshelp.xq.com.tw/api.aspx?a=Short&b=bif)、 [Cover ](https://xshelp.xq.com.tw/api.aspx?a=Cover&b=bif)這四種語法。與SetPosition不同的是，這四種語法所傳入的數量是加碼/減碼的數量。不過不管是透過哪一種語法，這些交易指令最終的目的都是調整商品的目標部位。 當交易腳本呼叫SetPosition等語法之後，XS自動交易就會依照新的目標部位傳送買進或是賣出的委託，執行之後Position這個數值就會更改成新的目標部位。當這些委託單成交時，腳本就可以透過 [Filled ](https://xshelp.xq.com.tw/api.aspx?a=Filled&b=bif)這個欄位來取得目前成交的淨部位。 Filled欄位跟Position欄位一樣是一個整數，可以大於0，小於0，或是等於0。當自動交易策略開始執行時，Position的數值跟Filled的數值是一模一樣的。接下來當交易腳本呼叫SetPosition來更改目標Position時，Position會先改變，同時送出委託單，等到成交時，Filled的數值就會跟著更新。 關於Position跟Filled，還有兩個地方請讀者要務必注意： 第一：一個自動交易策略可能會執行多個商品，每個商品的Position/Filled都是互相獨立的。 第二：Position/Filled的數值是一個 相對的數值 ，與交易帳號這個商品的庫存部位未必是一樣的。例如我的交易帳號內可能有0050的庫存2張，可是XS自動交易策略提供多種設定策略部位的方式 [自動交易策略設定說明 ](https://www.xq.com.tw/learn/xsat/strategy/)，可以把Position設定從0開始，或是從2開始，甚至也可以設定成從1開始。 假設策略的Position設定從0開始，接下來的SetPosition(1)，指的是買進1張，如果成交的話，Filled也會是1，這兩個數值與帳號的庫存數值，就可能是不一樣的。 最後，我們來看一個完整的交易策略範例。 

```
Condition1 = Average(Close, 5) cross over Average(Close, 10);
Condition2 = Average(Close, 5) cross under Average(Close, 10);
if Position = 0 and Condition1 then SetPosition(1);
if Position = 1 and Condition2 then SetPosition(0);

```

在這個範例內，當短均線穿越長均線時，我們就買進1張，當短均線跌破長均線時，我們就把剛剛買到的那一張賣出。 更多的交易策略範例，可以參考XS編輯器內的系統範例腳本，也可以參考 [此篇 ](https://xstrader.net/xq交易語法專章/)文章喔！ [
![](/wp-content/uploads/2020/10/自動交易的基本觀念-.1.png)
](/wp-content/uploads/2020/10/自動交易的基本觀念-.1.png)瞭解SetPosition以及Position的觀念之後，接下來在下一篇文章「 [如何建立自動交易策略 ](https://www.xq.com.tw/learn/xsat/strategy/)」內我們將介紹如何設計自動交易腳本，以及自動交易策略。 [

#####


---

# 自動交易中心操作介紹

Source: https://www.xq.com.tw/lesson/xsat/xsat_center/

[
![](/wp-content/uploads/2020/10/XSAT_05.png)
](/wp-content/uploads/2020/10/XSAT_05.png)在這一篇文章內，我們將為您介紹 **「自動交易中心」 **這個新的介面的操作功能。 透過「自動交易中心」，您可以： 

- 建立自動交易策略 
- 以多層次目錄的方式管理您的自動交易策略資料庫 
- 執行自動交易策略，監控策略的執行狀態 
「自動交易中心」的介面分成以下幾個部分： 

- 工具列 
- 自動交易策略目錄區 
- 自動交易策略工作區 
[
![](/wp-content/uploads/2020/10/XSAT_center.png)
](/wp-content/uploads/2020/10/XSAT_center.png)

### **自動交易策略目錄區 **
在左邊的自動交易策略管理區內，使用者可以以「 **多層次目錄」 **的方式來管理自己的自動交易策略。 目錄操作的方式與策略雷達/選股中心類似，大部分的功能都可以透過右鍵選單來取得。 [
![](/wp-content/uploads/2020/10/XSAT_center2.png)
](/wp-content/uploads/2020/10/XSAT_center2.png)透過右鍵選單，你可以建立子目錄，在某個子目錄內建立策略。你也可以更改子目錄名稱，移動子目錄，更改策略名稱，移動策略，或是複製策略。在自動交易中心的目錄區內，同時也支援 **滑鼠拖曳(Drag & Drop) **的操作方式，讓你可以更方便的移動策略或是目錄。 目錄區也提供多選的功能，多選的操作方式與Windows檔案管理的操作方式一樣，點選策略時 **同時按Shift鍵或是Control鍵即可進行多選 **，方便一次移動/刪除多個策略。 除了自訂的子目錄之外，目錄區內提供一個「我的常用區」。你可以透過右鍵選單把常用的策略加到「我的常用」區，方便你快速瀏覽常用的策略。 

### **自動交易策略工作區 **
當你點擊目錄區的策略時，被點擊的策略就會自動開啟在右邊的工作區內。如果這個策略先前尚未開啟的話，工作區就會開啟一個獨立的Tab。 在每個Tab內，你可以看到策略的完整參數，依照參數內容，分成 **「腳本設定」 **以及 **「安控設定」 **兩個區塊。 如果希望調整參數的話，可以點選 **「編輯按鈕」 **或是滑鼠雙擊畫面進入編輯模式。 [
![](/wp-content/uploads/2020/11/XSAT_edit.png)
](/wp-content/uploads/2020/11/XSAT_edit.png)如果想要執行自動交易策略的話，請點擊 **「啟動策略」 **按鈕。策略啟動之後，可以透過 **「商品監控」 **區以及 **「執行紀錄」 **區來進行監控。 如果要停止執行的話，請點擊 **「停止執行」 **按鈕，停止策略時可以同時選擇「 **是否要刪除策略已經送出的未成交委託」 **。 [
![](/wp-content/uploads/2020/10/XSAT_center10.png)
](/wp-content/uploads/2020/10/XSAT_center10.png)已經啟動的策略，Tab的顏色是明顯的 **橘色 **。你也可以透過工具列上面的 **「執行中」 **按鈕來快速查閱已經啟動的策略。透過這個選單可以切換到執行中的策略，緊急時也可以一次停止所有執行中的策略。 [
![](/wp-content/uploads/2020/10/XSAT_center3_1.png)
](/wp-content/uploads/2020/10/XSAT_center3_1.png)除了工具列的「執行中」按鈕之外， **左側目錄區 **內也可以透過「執行中」這個標籤來找到目前正在執行的策略。 [
![](/wp-content/uploads/2020/10/XSAT_center4.png)
](/wp-content/uploads/2020/10/XSAT_center4.png)除了上述監控方式之外，使用者也可以透過XQ全球贏家手機App來進行自動交易策略的監控。詳細的操作方式請參考 [「手機監控功能」 ](https://www.xq.com.tw/learn/xsat/appmonitor/)介紹。 

### **商品監控畫面 **
自動交易策略啟動之後，可以在商品監控區內看到每個商品的執行情形，以及執行過程內所傳送的委託單 在這個畫面的上半部，可以看到每個商品的以下欄位： 

- 策略部位：顯示商品目前的Position數值 
- 實際部位：顯示商品目前的Filled數值，也就是成交的部位 
- 損益：商品的已實現損益加上未實現損益金額，數值計算時會依照策略指定帳號的交易成本設定來扣除交易的費用 
- 狀態：目前商品的執行狀態 
- 剩餘買進(賣出)委託：買進(賣出)委託內尚未成交的數量 
- 買進(賣出)成交：買進(賣出)的成交數量 
[
![](/wp-content/uploads/2020/11/圖片2-1.png)
](/wp-content/uploads/2020/11/圖片2-1.png)除了可以看到商品的執行狀態之外，在緊急狀態時，也可以點擊 **「停止」 **按鈕，終止這個商品的執行。 商品監控畫面的下方則可以看到策略送出的委託單內容。 可以點選 **「可刪改」 **按鈕，此時僅會顯示未完成成交的委託單。 如果這一筆委託單尚未完全成交的話，則可以透過 **「刪單」 **按鈕來刪除這一筆委託。 **請注意：如果委託被刪除的話，則這個商品也會自動停止執行。 **

### **執行紀錄畫面 **
[
![](/wp-content/uploads/2020/10/XSAT_center8.png)
](/wp-content/uploads/2020/10/XSAT_center8.png)策略啟動後，所有的執行紀錄都可以透過「執行紀錄」畫面來查閱。 「執行紀錄」畫面支援 **搜尋商品 **功能 **， **也可以透過 **紀錄類型 **選項來顯示不同類型的紀錄。 

- 交易：顯示與交易指令有關的紀錄，包含執行交易指令的動作，及成交紀錄 
- 警示：顯示 [Alert指令 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Alert&group=TRANSACTIONFUNC)所產生的紀錄 
- 列印：如果交易腳本呼叫 [Print指令 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Print&group=GENERALFUNC)，這些Print指令的內容除了會寫到指定的檔案內之外，也會出現在執行紀錄內 
- 錯誤：顯示執行時發生錯誤的相關紀錄 
除了可以看到此次執行的紀錄之外，使用者也可以透過 **日期選單 **切換到先前的執行紀錄。目前系統提供近 **10日的執行紀錄 **可供查閱，也可以匯出先前的執行紀錄。 [
![](/wp-content/uploads/2020/10/XSAT_center5.png)
](/wp-content/uploads/2020/10/XSAT_center5.png)

### **策略執行通知 **
自動交易策略啟動之後，使用者可以在XQ的 **「即時監控」 **畫面以及 **「警示提示」 **畫面內收到通知。 如果要收到自動交易相關通知的話，首先要修改 **「來源」設定 **，勾選 **「自動交易」 **這個選項。 [
![](/wp-content/uploads/2020/10/XSAT_center3_1-1.png)
](/wp-content/uploads/2020/10/XSAT_center3_1-1.png)
![](/wp-content/uploads/2020/10/XSAT_center7.png)
開啟自動交易來源之後，當發生以下情事時，「即時監控」畫面或是「警示提示」畫面就會收到相 **關事件的提示 **： 

- 交易指令成交時 
- 策略執行Alert指令時 
自動交易策略的通知除了可以傳送到XQ之外 **，也可以傳送到XQ全球贏家App內 **。 要把通知傳送到手機的話，首先必須 **先開啟策略推播的功能 **[
![](/wp-content/uploads/2020/10/XSAT_center12.png)
](/wp-content/uploads/2020/10/XSAT_center12.png)而APP內的通知設定，目前預設「 **已啟用自動交易通知」。可以透過通知設定來開關自動交易的通知。 **[
![](/wp-content/uploads/2020/11/通知中心.png)
](/wp-content/uploads/2020/11/通知中心.png)之後當自動交易策略產生通知時，手機端就會收到推播，也可以在手機的通知中心內看到完整的通知紀錄。 [
![](/wp-content/uploads/2020/11/通知中心2.png)
](/wp-content/uploads/2020/11/通知中心2.png)以上是關於自動交易中心的操作界面介紹。除了可以透過自動交易中心來監控策略之外，也可以透過XQ全球贏家App來監控策略，如果想要瞭解更多的話，請參考 [手機監控功能 ](https://www.xq.com.tw/learn/xsat/appmonitor/)這一篇文章。 [

#####


---

# 自動交易策略參數總覽

Source: https://www.xq.com.tw/lesson/xsat/xsat_overview/

## [
![](/wp-content/uploads/2020/10/XSAT_04.png)
](/wp-content/uploads/2020/10/XSAT_04.png)
在這一篇文章內，我們會用更詳細的篇幅來說明自動交易策略的所有參數，以及系統執行一個自動交易策略的流程，包含 

- [自動交易策略 ](#learn01)
- [執行商品範圍 ](#learn02)
- [資料讀取筆數設定 ](#learn03)
- [策略部位計算功能 ](#learn04)
- [交易帳號 ](#learn05)
- [交易帳號庫存部位整合 ](#learn06)
- [交易安控 ](#learn07)
- [交易異常處理 ](#learn08)
- [網路斷線處理 ](#learn09)
- [特殊交易情境處理方式 ](#learn10)

### **自動交易策略 **
**一個自動交易策略包含以下主要的參數： **

- 1. 要執行的自動交易腳本 
[
![](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_01.png)
](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_01.png)

- 2. 執行的商品，可以指定一個或是多個商品 
- 3. 策略執行的頻率 
- 4. 是否要啟動策略部位計算功能 
- 5. 策略的資料讀取筆數 
- 6. 是否要逐筆洗價 
[
![](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_02-1.png)
](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_02-1.png)

- 7. 是否要啟動交易帳號 
- 8. 連結的交易帳號 
- 9. 策略初始部位的設定 
[
![](/wp-content/uploads/2020/10/%E8%AD%89%E5%88%B8%E5%B8%B3%E8%99%9F.png)
](/wp-content/uploads/2020/10/%E8%AD%89%E5%88%B8%E5%B8%B3%E8%99%9F.png)

- 10. 交易安控設定 
[
![](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_04-1.png)
](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_04-1.png)

- 11. 進出場的價格設定 
[
![](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_05-1-1.png)
](/wp-content/uploads/2020/10/help_%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5_05-1-1.png)**當自動交易策略啟動時，系統會依照以下的邏輯來執行： **

- 根據執行商品範圍，以及交易帳號選項，決定要執行哪些商品， 
- 依照策略的資料讀取筆數，策略部位的計算起點，以及策略的頻率，來決定要讀取的歷史資料的範圍， 
- (選項)歷史資料讀取完畢之後，依照策略部位計算起點的設定，執行腳本來計算策略的歷史部位， 
- (選項)依照交易帳號內的所指定的初始部位設定，調整策略的初始部位， 
- 等待商品的即時資料，當即時資料更新時，執行腳本，如果有指定交易帳號的話，則依照交易帳號的設定決定如何送出委託 [](#)
在以下的章節內我們將一一說明每個步驟的處理方式。 

### **執行商品範圍 **
**自動交易策略提供以下設定商品範圍的方式： **

- 選擇一個或是多個商品 
- 選擇一個分類清單(例如我的某一組自選股) 
- 選擇一個XS選股法，執行前會先執行這個選股法，符合選股法的商品就會執行這個腳本 
- 選擇交易帳號的庫存 
- 選擇從外部檔案匯入欲執行的商品 
如果選擇自選股或是外部檔案的話，也可以勾選「自動執行新加入的商品」這個選項。 [](#)勾選這個選項之後，當自選股有新增商品，或是檔案內容異動後有新增商品的話，這些新增的商品也會自動加入執行的行列。 

### **資料讀取筆數設定 **
如同策略雷達的設定方式，使用者可以指定策略的資料讀取筆數。 策略啟動時，會依照資料讀取筆數讀取商品的歷史資料。 例如：資料讀取筆數設定是10的話，則會先讀取今日之前的10根K棒(不包含今日)，K棒的頻率依照策略的設定。 讀取完成之後，系統會從第一根歷史K棒開始執行，每一根K棒執行一次，總共執行10根K棒，如下圖： [
![](/wp-content/uploads/2020/10/help_%E8%B3%87%E6%96%99%E8%AE%80%E5%8F%96%E7%AD%86%E6%95%B8%E8%A8%AD%E5%AE%9A.png)
](/wp-content/uploads/2020/10/help_%E8%B3%87%E6%96%99%E8%AE%80%E5%8F%96%E7%AD%86%E6%95%B8%E8%A8%AD%E5%AE%9A.png)**請注意：資料讀取區間內，如果腳本呼叫了任何交易指令，系統都不會予以執行，執行紀錄內會看到錯誤的提示。 **[
![](/wp-content/uploads/2020/10/help10.png)
](/wp-content/uploads/2020/10/help10.png)由於這一個區間不會執行交易指令，所以如果腳本希望判斷這種情形的話，可以透過 [GetInfo函數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetInfo&group=GENERALFUNC)，傳入”TradeMode”參數： [](#)

```
1if GetInfo(“TradeMode”) = 0 then begin
2     {目前是在資料讀取區間, 不會進行交易}
3end;
```

### **策略部位計算功能 **
策略部位計算起點預設是關閉的(不指定)。策略在跑完資料讀取區間的K棒之後(期間不會執行任何交易指令)，商品的部位都會是0，接下來收到當日即時資料時就會開始執行交易指令，送出對應的委託。 [
![](/wp-content/uploads/2020/10/help1-1.png)
](/wp-content/uploads/2020/10/help1-1.png)

#### **使用者設計的是一「波段操作的策略」，而波段的週期可能超過1日： **
使用者可能會希望依照歷史資料來判斷目前這個時間點是處在已經進場的階段，或是尚未進場的階段。 如果有這樣子需求的話，那麼就可以開啟計算策略部位的功能。開啟時可以指定策略部位計算的起始日期， 例如：從2020年1月１日開始計算，或是指定策略部位從當日前N天開始計算。 [
![](/wp-content/uploads/2020/10/help2.png)
](/wp-content/uploads/2020/10/help2.png)[
![](/wp-content/uploads/2020/10/help3.png)
](/wp-content/uploads/2020/10/help3.png)一旦啟用策略部位計算功能後，策略讀取歷史資料的範圍變成： 

- 資料讀取筆數(多少筆K棒) 
- 策略部位計算範圍(多少天的K棒) 
[
![](/wp-content/uploads/2020/10/help4%E6%8B%B7%E8%B2%9D.jpg)
](/wp-content/uploads/2020/10/help4%E6%8B%B7%E8%B2%9D.jpg)歷史資料準備完成之後，系統會依照以下的邏輯執行腳本： 

#### **資料讀取區間 **
在資料讀取區間每一根K棒執行一次，期間交易指令不予執行。 

#### **策略部位計算區間 **
執行完資料讀取區之後，接著進入策略部位計算區間時，一開始的時候策略的部位是0(因為資料讀取區間不會執行交易指令)。接下來系統會依序執行策略部位計算區間的每一根K棒，期間每一次洗價時，如果腳本呼叫了交易指令的話，則會依照洗價時的K棒資料來模擬這個交易指令是否會成交。也就是說，在這一段區間內，交易指令會以模擬的方式來執行，Position會異動，Filled也會異動，可是不會送出任何委託。 當系統跑完策略部位計算區間後，此時就會依照執行完當時的部位，開始接續即時K棒的執行，之後的交易指令就會送出實際的委託。 策略部位計算區間的執行邏輯，是希望使用歷史資料來模擬腳本可能的成交情形，為了讓腳本執行的方式可以更貼切歷史資料的細部變化過程，所以如果策略勾選 **「逐筆洗價」 **，系統會採用以下的方式來模擬策略在歷史資料區間逐筆洗價的動作： 

- 如果執行頻率是1分K的話， **每一根K棒執行一次 **
- 如果是1分鐘以上的頻率的話(例如5分鐘，30分鐘，日線等)，則每一根K棒會執行多次，每一次以這根K棒內的每分鐘資料來模擬K棒在歷史時間內的變化。舉例而言，如果要跑09:00的5分K棒時， **系統總共會執行5次 **： 

  - 第一次：09:00這一分鐘的資料組成K棒來執行 
  - 第二次：09:00 + 09:01這兩分鐘的資料組成K棒來執行 
  - 第三次：09:00 + 09:01 + 09:02這三分鐘的資料組成K棒來執行 
  - 第四次：09:00 + 09:01 + 09:02 + 09:03這四分鐘資料組成K棒來執行 
  - 第五次：09:00 + 09:01 + 09:02 + 09:03 + 09:04這五分鐘資料組成K棒來執行 

#### **策略部位計算區間：模擬撮合邏輯 **
在策略部位計算區間內，如果腳本呼叫了交易指令的話，那系統會依照這次洗價之後的K棒資料來模擬這個交易指令是否會成交。底下用一個 **買進的範例來說明撮合的方式 **

- 假設策略執行頻率是1分鐘，然後在09:00這一次洗價時呼叫了SetPosition(5, 100.0) 
- 此時系統會模擬產生 **一筆買進5張，委託價=100.0元的委託 **，然後依照09:00之後的K棒資料來判斷這一筆委託單何時可以成交 
- **假設09:01的K棒的價格： **Open = 101, High = 102, Low = 101, Close = 101, V = 10因 **" ****買進委託的價格 < K棒的Low" **，所以系統會認定 **這一筆買進委託不會成交 **
- **假設09:02的K棒的價格： **Open = 101, High = 101, Low = 100, Close = 100, V = 2此時系統判斷 **" ****買進委託的價格 >= K棒的Low" **所以此時會 **產生一筆成交，成交價格為100，成交的數量是2 **(雖然買進委託的委託量是5，可是因為這一筆K棒的總成交量只有2，所以此次只會成交2張) 
- **假設09:03的K棒的價格： **Open = 99, High = 100, Low = 99, Close = 99, V = 10此時系統判斷 **" ****買進委託的價格 >= K棒的Open" **所以此時會 **產生一筆成交，成交價格為99，成交的數量是3 **(買進委託剩餘的委託量 = 3)， **這一筆買進委託此時會完全成交 **
以上的撮合的方式，是假設執行交易指令所產生的委託已經送到市場上等待撮合，所以如果接下來收到的K棒的價格範圍可以讓這一筆委託成交的話，那就依照K棒的成交量來決定成交的數量。 以下列出完整的撮合規格： 

- 假設買進價格 = P, 委託量 = V，在收到下一根K棒時，依照以下邏輯判斷成交方式： 

  - **如果 P 是市價： **產生一筆成交，成交價 = K棒的開盤價，成交量是Min(委託量，K棒的成交量) 
  - **如果 P >= K棒的開盤價： **產生一筆成交，成交價 = K棒的開盤價，成交量是Min(委託量，K棒的成交量) 
  - **如果 P >= K棒的最低價： **產生一筆成交，成交價 = P，成交量是Min(委託量，K棒的成交量) 
  - **如果還有剩餘的委託量 **：則等待下一根K棒再繼續判斷剩餘的數量是否成交 

- 假設賣出價格 = P, 委託量 = V，在收到下一根K棒時，依照以下邏輯判斷成交方式： 

  - **如果 P 是市價： **產生一筆成交，成交價 = K棒的開盤價，成交量是Min(委託量，K棒的成交量) 
  - **如果 P <= K棒的開盤價： **產生一筆成交，成交價 = K棒的開盤價，成交量是Min(委託量，K棒的成交量) 
  - **如果 P <= K棒的最高價： **產生一筆成交，成交價 = P，成交量是Min(委託量，K棒的成交量) 
  - **如果還有剩餘的委託量 **：則等待下一根K棒再繼續判斷剩餘的數量是否成交 

如果在交易指令尚未完全成交之前腳本又呼叫了新的交易指令的話，則尚未成交的部分就完全取消，然後依照策略目前的部位以及新的交易指令的目標部位計算出是否需要產生買進委託或是賣出委託。 

#### **開盤後才啟動的情形 **
如果自動交易策略是在開盤之後才被啟動，那麼歷史資料的執行流程如下： 

- 先執行資料讀取筆數區間，此時不會執行交易指令 
- 如果啟動策略部位計算功能 

  - 執行策略部位計算區間，此時會執行交易指令(使用上述撮合方式模擬成交) 
  - 執行開盤到目前為止的K棒，此時一樣會執行交易指令 
  - **請注意：如果策略勾選逐筆洗價，此時系統會用當日的Tick資料來模擬逐筆洗價的行為，每一秒鐘執行一次洗價 **

- 如果不啟動策略部位計算功能 

  - 執行開盤到目前為止的K棒，不會執行交易指令 [](#)

接下來系統開始執行即時的K棒，此時就會正常執行交易指令，也會送出委託。 **請注意：從開盤到策略啟動當時之間的資料的執行方式會依照是否啟動策略部位計算功能而異，使用上要特別注意。 **

### **交易帳號 **
每一個交易策略可以指定這個策略執行時要對應的交易帳號，目前共提供三種設定的方式 分別是： 

- 不設定交易帳號 
- 設定證券交易帳號 
- 設定期貨交易帳號 
[
![](/wp-content/uploads/2020/10/%E7%B4%B0%E7%AF%80%E9%A1%AF%E7%A4%BA-1024x818.png)
](/wp-content/uploads/2020/10/%E7%B4%B0%E7%AF%80%E9%A1%AF%E7%A4%BA.png)

### **不設定交易帳號 **
若策略不設定交易帳號，還是可以正常執行。在策略跑完資料讀取區間，以及策略部位計算區間之後，當策略收到即時行情洗價時，如果腳本呼叫了任何交易指令的話，則系統會 **以 ****當時的即時行情來判斷這個交易指令是否會成交 **。以下我們用範例來說明判斷成交的邏輯。 假設策略目前的部位是0，然後在09:01:00秒時呼叫了SetPosition(10, 100.0)，代表策略會送出一筆買進10張的委託，委託價格是100.0。 此時系統會檢視這個商品五檔委託簿的 **委賣 **資料(依照當時交易所揭示的行情)，如果有任何委賣價格 <= 100.0，則依照當時的委賣數量依序成交(從最低的委賣價開始成交)。 **範例#1: 產生一筆成交，價格=100.0，成交量=4，還有6張尚未成交 ****委買量 ****買進 ****賣出 ****委賣量 **5 99.5 100.0 4 4 99.0 100.5 10 3 98.5 101.0 15 2 98.0 101.5 20 10 97.5 102.0 21 **範例#2: 產生兩筆成交，第一筆成交價=99.5，成交量=7，第二筆成交價=100.0，成交量=3，全部成交 ****委買量 ****買進 ****賣出 ****委賣量 **6 99.0 99.5 7 5 98.5 100.0 4 4 98.0 100.5 10 3 97.5 101.0 15 2 97.0 101.5 20 **範例#3: 沒有任何成交，還有10張等待成交 ****委買量 ****買進 ****賣出 ****委賣量 **6 100.0 100.5 4 5 99.5 101.0 10 4 99.0 101.5 15 3 98.5 102.0 20 2 98.0 102.5 21 比對完五檔委託簿的資料之後，如果還有尚未成交部位的話，則 **依照之後收到的商品成交明細來判斷 **：如果收到了任何 **成交明細的成交價格 <= 委託價格 **的話，則產生一筆成交，成交量為Min(剩餘委託量，這一筆成交明細的單量)。 接續上面的範例#3，此時還有一筆買進委託，委託價格=100.0，委託數量=10等待成交。 以下是收到成交明細後的成交狀態範例： **時間 ****成交價 ****單量 ****成交狀態 **09:01:10 101.0 8 不成交 09:01:20 100.0 2 產生一筆成交成交價=100.0, 成交量=2 (剩餘8張) 09:01:30 99.5 3 產生一筆成交成交價=99.5, 成交量=3 (剩餘5張) 09:01:40 99.5 10 產生一筆成交成交價=99.5, 成交量=5 (全部成交，剩餘0張) 如果交易指令是賣出的話，則是比對五檔的 **委買 **資料，處理的邏輯與買進類似。 

### **設定交易帳號 **
如果使用者希望執行交易指令時會送出真實的委託單，可以在策略設定內選擇想要交易的帳號。 首先請先確定策略想要交易的帳號已經先 **透過XQ的交易帳號設定完成帳號登入的動作 **，而且也 **完成了相關的憑證設定。 **接著就可以從策略設定畫面內選擇這個帳號，完成連結的動作。 自動交易所支援的券商範圍有以下的限制： 

- 目前僅支援 **證券帳號、 ****期貨帳號。 **複委託帳號以及群組帳號尚未支援 
- 目前僅支援 **可以透過XQ全球贏家手機版交易的券商 **，以確保自動交易執行時可以透過手機做完整的監控以及管理 
目前支援自動交易的券商清單如連結介紹： [合作券商 ](https://www.xq.com.tw/broker.aspx)

### **設定證券交易帳號 **

#### **商品限制 **
如果策略指定證券交易帳號的話，則在啟動策略時系統會檢查策略的執行商品，如果其中有非證券類型的商品的話，則這些商品會被略過不予執行。 **選擇：現股交易/信用交易 ****選擇現股交易： **系統會依照這個帳號的現股庫存數量，以及買賣方向來決定委託單的內容。買進時會送出現股買進，賣出時會送出現股賣出或是現股先賣(當沖)。 **選擇信用交易： **系統會依照這個帳號的融資/融券庫存數量，以及買賣方向來決定委託單的內容。買進時可能會送出買進融券(回補)或是買進融資委託，賣出時可能會送出賣出融券或是賣出融資的委託。 **選擇：ROD/IOC ****(決定委託單的委託條件) **決定委託單送出的類型是ROD或是IOC。 由於IOC委託會有 **不成交則被自動取消的限制 **，所以當系統發現 **IOC委託被取消時，會自動修正策略的Position數值 **。 舉例：目前Position = 0，接下來執行了SetPosition(1)，策略選擇要用IOC來下單。 當策略執行到SetPosition(1)，系統會送出一筆買進1張的IOC委託單，同時下一次洗價時Position會被改成1。 **如果這一筆IOC委託成交： **下一次洗價時Filled會變成1。 [](#)**如果這一筆IOC委託沒有成交： **由於交易所會自動取消這一筆委託單，所以系統在收到取消通知之後，會自動把Position改成0。會自動調整Position是因為目前已經沒有有效的委託單，所以這個策略的Filled永遠不會變成1，也就會造成Position跟Filled永遠不會同步的情形。 **請注意：目前系統尚未支援FOK的委託條件。 **

#### **單邊的交易成本(%) **
[](#)系統會依照交易成本的設定來調整執行時所顯示的損益數值。使用者可以依照所選擇券商的交易費用填入對應的交易成本數值。 舉例來說，假設證券手續費折數為 3 折，手續費率為 0.1425 %；交易稅率為 0.3 %，則單邊交易費用約為 0.19 %＝((0.1425%\*0.3\*2)+0.3%)/2 [](#)

#### **交易回報等待時間 **
此項設定為當系統送出委託時，等待券商的委託回報時間有多長。若在設定的時間內都沒有收到券商端回覆的委託成功/失敗的回報，系統將會中斷此商品的自動交易運作。 舉例來說，如果將交易回報等待時間設為30秒，且系統在 12:30:00 時產生一筆買進委託送至券商的話，若自動交易中心在 12:30:30 以前都沒有收到券商回報此筆委託成功或是失敗的話，系統將會強制終止該商品的自動交易運作。 

#### **選擇：只可做多/只可做空/不限制 **
這一個選項是用來確保策略執行實單交易時帳號的 **實際庫存數量 **符合多空的設定。 假設策略選擇只可做多的話，那麼當策略執行時要送出賣出委託時，策略會檢視 **當時帳號的實際庫存數量 **，如果實際庫存數量小於欲賣出的數量時，則這一個交易指令不會送出(使用者可以從執行紀錄內看到錯誤的紀錄)。 [](#)同理，如果策略選擇只可做空的話，那麼當策略執行時要送出買進委託時，策略會檢視當時帳號的實際庫存數量，如果實際庫存的做空數量小於欲買進的數量時，則這一個交易指令不會送出。 

### 

### **交易帳號庫存部位整合 **
策略指定交易帳號之後，可以把交易帳號的庫存跟策略的部位做進一步的整合。 目前系統提供了以下三種設定方式： 

#### **選擇：依腳本計算 **
[
![](/wp-content/uploads/2020/10/help5.png)
](/wp-content/uploads/2020/10/help5.png)在這種模式底下，策略的部位可能是依照歷史資料計算而來的(如果啟動策略部位計算功能的話)，或是從0開始(如果不啟動策略部位計算功能的話)，與交易帳號的實際庫存沒有任何關係。 [](#)

#### **選擇：依庫存 **
[
![](/wp-content/uploads/2020/10/xsat_overview_%E4%BE%9D%E5%BA%AB%E5%AD%98.png)
](/wp-content/uploads/2020/10/xsat_overview_%E4%BE%9D%E5%BA%AB%E5%AD%98.png)如果選擇 **「依庫存」 **策略在執行完歷史資料區間之後，系統會依照當時帳號的庫存，自動調整策略的部位，以及策略的未平倉成本。 在這種模式底下，使用者通常不會啟動策略部位計算功能，而是讓系統依照庫存的數值來設定部位。 如果使用者希望利用自動交易策略來進行庫存的調整動作的話，則可以使用這種模式。 

#### 勾選：庫存異動時自動加入執行 
如果使用者想要手動下單，然後在買進之後，讓自動交易可以自動執行停損/停利的出場動作，那麼可以透過「庫存異動時自動加入執行」的這個選項來完成。 詳細說明請參考「 [自動交易中心支援手動調整部位的功能 ](https://www.xq.com.tw/learn/xsat/manually/)」此章節介紹 

#### **選擇：自訂數值 **
[
![](/wp-content/uploads/2020/10/help7.png)
](/wp-content/uploads/2020/10/help7.png)如果選擇 **「自訂數值」 **，在策略設定時，系統會先填入目前帳號庫存的數值以及未平倉成本。此時使用者可以做進一步的調整，包含調整庫存的數量，以及成本價格。當策略開始執行時，系統就會依此數值設定策略的部位，之後執行過程內如果成交的話，系統也會依照成交資料，自動調整部位數值以及未平倉成本。 [](#)如果使用者只是運用策略來交易這個帳號內商品的部分庫存的話，則可以使用這樣子的設定方式。 **請注意：為了讓使用者確認部位的數值，每次執行策略時，系統都會再次顯示目前的部位設定畫面，使用者當下還可以進行修改，確認之後才會執行策略。 [](#)**

### **交易安控 **
自動交易策略提供了以下的安控設定，使用者可以依照需求選擇需要開啟的項目： [
![](/wp-content/uploads/2020/10/%E5%9C%96%E7%89%874.png)
](/wp-content/uploads/2020/10/%E5%9C%96%E7%89%874.png)

#### **單一商品：每日進場金額上限 **
這個選項只有在 **指定了證券交易帳號時才可以啟用 **。主要用途是確保 **策略不會進行過多的買賣動作 **。 啟用了這個安控之後，每次策略要執行交易指令之前，會依照目前這個交易指令所需傳送的委託數量/價格，估算所需的交易金額額度，如果這個商品先前累計額度加上這一筆交易金額超過指定額度的話，則不會執行這一筆交易指令。 委託成交時，系統會依照實際成交價格重新計算已經使用的額度， **3.06.03/7.06.03 版本修改為「只計算買進部位」賣出平倉則不併入額度。 **策略重新執行時，委託額度會從零開始重算。如果策略持續執行，每個交易日結束後委託額度也會歸零重新計算。 **請注意：上述計算方式與券商計算額度的方式可能會有差異。 **

#### **單一商品：最大部位限制 **
啟用這個選項之後，如果交易指令的目標部位的絕對值如果超過這個限制的話，則這個交易指令不會執行。 舉例來說，如果單一商品最大部位設定為1，SetPosition(1)可以執行，SetPosition(-1)可以執行，SetPosition(2)不會執行，SetPosition(-2)也不會執行。 使用這個選項來確保單一商品的最大部位可以符合預期。 

#### **單一商品：每日最多進場次數 **
所謂進場次數，指的是" **策略的成交部位 ****進入多方，或是空方的次數" **。 舉例來說，策略一開始部位是0，呼叫了SetPosition(1)之後，如果成交的話，進入多方，進場次數為1。之後策略呼叫了SetPosition(2)，或是SetPosition(3)，甚至是在SetPosition(3)之後又呼叫了SetPosition(2)，只要策略的成交部位繼續維持在多方，進場次數都不會改變。 如果策略接下來呼叫了SetPosition(0)，在這一筆賣出指令完全成交之後，多方的狀態已經結束，之後的SetPosition(1)就會算成另外一次進場了。 這個安控的設計目的也是用來 **避免過多的交易 **，例如不斷的買進/賣出。 如果進場次數已經到達上限，之後的交易指令就不會執行。 **請注意：策略部位異動時如果沒有成交的話，並不會改變進場次數。 **

#### **策略整體：每日進場金額上限 **
與單一商品每日交易金額上限一樣，這個選項只有在 **指定證券交易帳號時才可以啟用 **。 策略整體的額度，就是這個策略內每個商品額度的加總。如果要執行某個交易指令之前發現這個交易指令所需額度加上目前已經使用的額度超過這個上限的話，則不會執行這個交易指令。 請注意：系統會累計這個策略當日每次執行時的交易金額，每個交易日結束，或是關閉XQ之後，都會重新歸零統計。 **\*3.6.3/7.6.3版本修改為「只計算買進部位」賣出平倉則不併入額度。 **

#### **策略整體：最大部位限制 **
策略整體部位的計算方式是： **每個執行商品的部位的絕對值的加總 **。 如果某個商品要更改目標部位時發現新的部位加上策略內其他商品目前部位的加總超過最大部位限制的話，則這個交易指令不會執行。 

#### **策略整體：最多持有商品限制 [](#)**
策略整體持有商品的計算方式：「 **統計策略內部位不是零的商品個數」 **。如果某個商品的交易指令會違背這個限制的話，則這個交易指令不會執行。 可以利用這個限制來" **控制可以進場的商品個數 **"。例如執行10個商品，每個商品都進行最多1張的交易時，可以把這個限制設定成3，來保證至多同時只會持有三個商品。 

### **交易異常處理 **
策略執行下單時可能會遇到各種不可預期的情形，例如交易網路延遲，券商交易主機服務阻塞等，為了確保策略執行的買賣邏輯，當遇到以下情形時，這個商品的執行會 **自動停止 **： 

- 送出委託單之後逾時沒有收到回應 [](#)
- 送出委託單之後券商交易主機回傳錯誤 
- 使用者透過其他管道手動調整策略所送出的委託單(例如刪單或是改量) 
請注意：如果策略內執行多個商品的話，只有上述發生問題的商品會停止執行，其他的商品還是會繼續執行。如果策略內所有的商品都停止的話，則策略也會停止執行。 

### 

### **網路斷線處理 **
策略執行期間如果遇到報價網路斷線的情形時，使用者可以透過策略設定來決定處理的方式。 [
![](/wp-content/uploads/2020/10/help9.png)
](/wp-content/uploads/2020/10/help9.png)**選擇「停止執行」： **當報價網路發生中斷時，策略就會停止執行。 [](#)**選擇「繼續執行」： **當報價網路發生中斷時，系統會嘗試重新連線，同時回補斷線期間的成交資料。當回補完成之後，系統會從斷線前的K棒繼續執行，期間回補的K棒也會執行，可是如果執行這些回補的K棒時有呼叫任何交易指令的話，這些指令會被忽略，不予以執行。 

### **特殊交易情境處理方式 **

#### **交易時段的檢查 **
系統要傳送委託之前，會檢查 **目前時間是否已經超過交易所可以接收委託的時間 **，如果超過的話，這一筆委託不會傳送。 例如：系統在收到台積電13:30:00的收盤價時會執行洗價的動作，此時如果呼叫了交易指令而需要傳委託的話，因為已經超過證券收盤時間，這一筆委託將不會傳送。 

#### **收盤後自動調整部位 **
在盤中執行時如果呼叫了SetPosition之後會送出委託，同時也會更改Position的數值。如果過了收盤之後還沒有收到成交的話，由於目前所有傳送的委託都只在當日有效，所以系統在收盤後會自動調整Position的數值，以便隔日執行時Position的數值跟Filled的數值是一致的。 舉例來說： 

- 一開始部位=0 
- 09:10時呼叫SetPosition(5)，呼叫後Position = 5，Filled = 0 
- 09:20時收到成交2張，此時Position = 5, Filled = 2 
- 到了13:30過後，都沒有收到成交，系統會把Position改成2(跟Filled一樣) 
- 隔日09:00繼續執行前，Position = 2, Filled = 2 
整日盤的期貨商品(例如 FITXN09.TF)有夜盤交易區間跟日盤交易區間。由於目前期交所在夜盤交易區間結束時也會自動取消未成交的委託，所以系統在夜盤交易區間結束時也會進行部位調整的動作。 

### **期貨商品換月處理 **
策略執行商品如果是「 **期貨連續月份商品」 **(例如 FITX\*1.TF)的話，實際交易時系統會以最近月份的期貨商品來執行委託。 策略執的商品如果是「 **期貨指定月份商品」 **(例如 FITX10.TF)的話，則在這個商品到期時策略會自動停止此商品。 [

#####


---

# 利用GetSymbolInfo函數計算選擇權的希臘字母Delta

Source: https://www.xq.com.tw/lesson/xspractice/%E5%88%A9%E7%94%A8getsymbolinfo%E5%87%BD%E6%95%B8%E8%A8%88%E7%AE%97%E9%81%B8%E6%93%87%E6%AC%8A%E7%9A%84%E5%B8%8C%E8%87%98%E5%AD%97%E6%AF%8Ddelta/

市場上投資工具五花八門，常見的就有股票、期貨、選擇權、權證等等。時至今日，選擇權和權證已經是很普遍使用的投資標的。評估一檔股票值不值得投資，我們會用基本面或技術面等條件篩選，利用XS都可以輕鬆做到。在投資選擇權時，用來評價選擇權風險就是所謂的希臘字母（Delta、Gamma、Theta、Vega、Rho）。這項功課，現在XS也能幫你完成。 我們以選擇權的Delta為例。打開 [BSDelta ](http://xshelp.xq.com.tw/api.aspx?a=BSDelta&b=sys)函數我們可以看到，在計算選擇權希臘字母時我們會需要以下資訊： 

- 買賣權 
- 標的價格 
- 履約價 
- 到期天數 
- 無風險利率 
- 持有成本 
- 波動率 
其中，買賣權、履約價、到期天數算是商品的基本資料，是固定的。在6.42版以前, XS沒有提供GetSymbolInfo函數的狀況下，我們會需要一點巧門來取得這些資訊。 

```
1買賣權=midstr(symbol,6,1); //利用商品名稱取得
2履約價=strtonum(midstr(symbol,7,strlen(symbol) - 9)); //利用商品名稱取得
3到期天數利用daystoexpirationtf函數，直接寫死找出每月第三個星期三
```

也就是因為這些規則是死的，利用商品名稱取得資訊的方式讓我們之前系統內建指標只能提供台指選專用的指標。更不要說碰到颱風或農曆春節導致結算日異動時，這個指標就會失真。 在有了GetSymbolInfo函數之後，這些資訊我們就可以直接使用。 

```
1買賣權=GetSymbolInfo("買賣權");
2履約價=GetSymbolInfo("履約價");
3到期天數=DateDiff(GetSymbolInfo("到期日"), Date) + 1;
```

所有的選擇權商品，XS都會提供這些商品基本資料，我們就可以寫出通用版的Delta指標，而不是僅限台指選專用。改寫後的腳本如下： 

```
1input: 
2     iRate100(2,"無風險利率%"),
3     iHV(20,"標的歷史波動率計算期間");
4 
5 variable:vStrikePrice(0),vVolity100(0),vTTMdays(0);
6 
7 if symboltype <> 5 then 
8     raiseruntimeerror("僅支援選擇權");
9     
10 if iHV > 0 then 
11     vVolity100 = HVolatility(getsymbolfield("Underlying","收盤價","D"),iHV)
12 else 
13     vVolity100 = 20;
14 
15 vStrikePrice = getsymbolinfo("履約價");
16 vTTMdays = DateDiff(GetSymbolInfo("到期日"), Date) + 1;
17 
18 value1 = bsdelta(leftstr(getsymbolinfo("買賣權"),1), //C表買權、P表賣權
19 getsymbolfield("Underlying","收盤價"), //標的價格
20 vStrikePrice, //履約價
21 vTTMdays, //到期天數
22 iRate100, //無風險利率
23 0, //持有成本
24 vVolity100); //波動率
25 
26 plot1(value1,"Delta");
```

計算Delta需要的所有參數，都是透過GetSymbolInfo取得系統資料，所以現在不止台指選可以用，其他電子選、金融選甚至是個股選擇權都可以使用這個Delta指標。 有沒有注意到在取得標的價格的地方我們是怎麼寫的？ 

```
1getsymbolfield("Underlying","收盤價");
```

是的，這次我們同時強化了GetSymbolField的功能，在商品欄的位置可以直接使用"Underlying"或"標的"動態取得標的商品。如此一來，不止是本篇文章說明的選擇權希臘字母可以計算，要自行計算期貨商品的價差值也是可行的。 以上是GetSymbolInfo的應用範例，GetSymbolInfo完整的支援項目清單請參考 [XSHelp說明 ](http://xshelp.xq.com.tw/api.aspx?a=GetSymbolInfo&b=bif)[

#####


---

# 利用InputKind函數製作跨頻率週期的選取介面

Source: https://www.xq.com.tw/lesson/xspractice/%E5%88%A9%E7%94%A8inputkind%E5%87%BD%E6%95%B8%E8%A3%BD%E4%BD%9C%E8%B7%A8%E9%A0%BB%E7%8E%87%E9%80%B1%E6%9C%9F%E7%9A%84%E9%81%B8%E5%8F%96%E4%BB%8B%E9%9D%A2/

使用XS撰寫完成策略後，在介面上輸入參數可能會輸入錯誤的數值，雖然執行後會秀出錯誤訊息告知，但時常會造成困擾，所以我們提供InputKind函數讓使用者可以在腳本內控制介面的行為，讓大家能在介面選擇輸入值，就能避免輸入錯誤的狀況發生。 我們以KD指標的跨頻率語法為例。打開 [xfMin\_stochastic ](http://xshelp.xq.com.tw/api.aspx?a=xfMin_stochastic&b=sys)函數我們可以看到，在計算有支援跨分鐘頻率的KD指標時我們會需要以下資訊： 

- 頻率 
- 資料期數 
- K值平滑期數 
- D值平滑期數 
- 輸出RSV值 
- 輸出K值 
- 輸出D值 
其中，指定的分鐘頻率僅支援1分鐘、5分鐘、10分鐘、15分鐘、30分鐘與60分鐘，以上6種分鐘頻率。在6.42版以前，XS沒有提供InputKind函數的狀況下，我們會使用input函數指定分鐘頻率，但是在介面可能會輸入到沒有支援的指定頻率，執行後發現此錯誤往往讓使用者覺得困擾。 在有了InputKind函數之後，我們就能將可支援的分鐘頻率，製作成選項顯示在介面上，讓使用者在這些選項中選擇，就能避免輸入錯誤的狀況發生。 以上是InputKind的應用範例，InputKind使用說明可以參考 [XSHelp說明 ](http://xshelp.xq.com.tw/api.aspx?a=inputkind)。改寫後的跨分鐘與日頻率KD指標腳本如下： 

```
 // 跨頻率KD指標，預設跨頻率為30分
 // 不支援大頻率跨小頻率，例如：
 // 不支援主頻率60分鐘，跨頻率計算30分鐘KD技術指標。
 //
 input:    Length(9, "天數"), RSVt(3, "RSVt權數"), Kt(3, "Kt權數"),
         FreqType("30", "跨頻率週期", inputkind:=dict(["1分鐘","1"],["5分鐘","5"],["10分鐘","10"],["15分鐘","15"],["30分鐘","30"],["60分鐘","60"],["日","D"],["還原日","AD"]));
 variable: rsv(0), k(0), _d(0);
 
 if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("此範例僅支援分鐘、日與還原日頻率");
 
 xfMin_stochastic(FreqType, Length, RSVt, Kt, rsv, k, _d);
 
 Plot1(k, "分鐘與日K(%)");
 Plot2(_d, "分鐘與日D(%)");
 
 // 防呆，大頻率跨小頻率時，在線圖秀不支援
 //
 switch (FreqType)
 begin
     case  "1":
         if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
         if barinterval <> 1 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於1分鐘");
         setplotlabel(1, "1分K(%)");
         setplotlabel(2, "1分D(%)");
 
     case  "5":
         if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
         if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於5分鐘");
         setplotlabel(1, "5分K(%)");
         setplotlabel(2, "5分D(%)");
 
     case "10":
         if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
         if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於10分鐘");
         setplotlabel(1, "10分K(%)");
         setplotlabel(2, "10分D(%)");
 
     case "15":
         if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
         if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於15分鐘");
         setplotlabel(1, "15分K(%)");
         setplotlabel(2, "15分D(%)");
         
     case "30":
         if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
         if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於30分鐘");
         setplotlabel(1, "30分K(%)");
         setplotlabel(2, "30分D(%)");
 
     case "60":
         if barfreq <> "Tick" and barfreq <> "Min" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
         if barinterval <> 1 and barinterval <> 2 and barinterval <> 3 and barinterval <> 5 and barinterval <> 10 and barinterval <> 15 and barinterval <> 20 and barinterval <> 30 and barinterval <> 45 and barinterval <> 60 then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於60分鐘");
         setplotlabel(1, "60分K(%)");
         setplotlabel(2, "60分D(%)");
     
     case "D":
         if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於日");
         setplotlabel(1, "日K(%)");
         setplotlabel(2, "日D(%)");
 
     case "AD":
         if barfreq <> "Tick" and barfreq <> "Min" and barfreq <> "D" and barfreq <> "AD" then raiseruntimeerror("不支援大頻率跨小頻率：主頻率大於還原日");
         setplotlabel(1, "還原日K(%)");
         setplotlabel(2, "還原日D(%)");        
 
 end;
```

[
![](/wp-content/uploads/2018/12/input_1-1.png)
](/wp-content/uploads/2018/12/input_1-1.png)[

#####


---

# 取得資料欄位時的「對位問題」

Source: https://www.xq.com.tw/lesson/xspractice/%E5%8F%96%E5%BE%97%E8%B3%87%E6%96%99%E6%AC%84%E4%BD%8D%E6%99%82%E7%9A%84%E3%80%8C%E5%B0%8D%E4%BD%8D%E5%95%8F%E9%A1%8C%E3%80%8D/

[
![](/wp-content/uploads/2023/10/画板-–-11.png)
](/wp-content/uploads/2023/10/画板-–-11.png)大家好，本文將為大家介紹「如何正確使用欄位資料」。 有鑑於您可能會經常遇到這類問題，所以我們將問題分為兩個部分： 

- 變數的對位方式 
- 資料欄位的對位方式 

---

## 變數的對位方式 
很多 XQ 的資深用戶，經常使用「 [**變數(Variable) **](https://xshelp.xq.com.tw/XSHelp/?HelpName=Variable&group=DECLARATION)」這個概念。 尤其是當我們想要進行 重複性較高的運算式 ****時，通常都會將資料欄位包入變數。 我們用以下情境來說明舉例： 用戶想要計算近 4 期的月營收平均，於是寫出下方 XS 代碼。 

```
// 計算 近 4 期的月營收平均
Value1 = GetField("月營收", "M");
Value2 = Average(Value1+Value1[1]+Value1[2]+Value1[3], 4);
```

但由於變數後方的中括號，其實是代表著不同頻率下的資料內容 

[
![](/wp-content/uploads/2023/10/螢幕擷取畫面-2023-10-11-152228.png)
](/wp-content/uploads/2023/10/螢幕擷取畫面-2023-10-11-152228.png)
於是，系統將這串 XS 代碼理解成： Value1 = 取得當期K棒日期之變數內容 = **GetField("月營收", "M") **Value1[1] = 取得前 1 期K棒日期之變數內容 = **GetField("月營收", "M") ****您沒有看錯，Value1 和 Value1[1] 都會取得相同的欄位資料！ **由於最新一期的月營收尚未公布，而用戶又誤將變數後方的中括號，當作是資料欄位的期數。 這時，如果在月營收尚未公布之前，就開始計算 T 日和 T+1 的月營收，用戶就會取得相同的資料，進而導致運算結果在某些時間點可能有誤。 ▼ 從下方 2023-06-30 的選股結果就可發現，由於台泥 5 月營收為 95.96 億元；4月營收為 91 億元。但時間到了2023-07-03 ，當期月營收和上一期月營收卻都變成 95.96 億元。這就是誤將變數中括號內的期數，誤作成資料欄位期數的結果。 [
![](/wp-content/uploads/2023/10/螢幕擷取畫面-2023-10-11-151138.png)
](/wp-content/uploads/2023/10/螢幕擷取畫面-2023-10-11-151138.png)[
![](/wp-content/uploads/2023/10/螢幕擷取畫面-2023-10-11-152534.png)
](/wp-content/uploads/2023/10/螢幕擷取畫面-2023-10-11-152534.png)因此，當我們在使用變數時， **要特別留意中括號的意義，以免造成運算結果錯誤唷 **！ 
---

## 資料欄位的對位方式 
那要如何正確地取得資料欄位呢？ 其實方法非常簡單，您只需在呼叫資料時，於 GetField 後方加上中括號與期數。 因為您只需要在資料取得時，直接在後方加上中括號。 系統就會根據您輸入的 **頻率 **與 **期數 **，自動判斷您想要取得的欄位資料究竟是第幾期？ GetField("月營收", " **Ｍ **") **[1] **= **上一期 月頻率 **的月營收 GetField("集保張數", " **W **") **[3] **= **前三期 周頻率 **的集保張數 ( 以此類推 ) 不知道這篇對資料欄位的對位問題的說明，是否有解答您過去遇到的困難呢？ XS 團隊會繼續優化相關語法功能與應用，陪伴投資人一同茁壯成長，成為您專研量化交易的最佳夥伴。 我們下次見！ [

#####


---

# 台股逐筆撮合的連續成交Tick序列

Source: https://www.xq.com.tw/lesson/xspractice/%E5%8F%B0%E8%82%A1%E9%80%90%E7%AD%86%E6%92%AE%E5%90%88%E7%9A%84%E7%A9%BF%E5%83%B9tick/

大家好。在上一篇文章「 [Tick欄位的應用 ](https://www.xq.com.tw/learn/xspractice/tick/)」，我們說明了如何從腳本內取得「Tick」頻率的欄位。在這一篇文章內我們要介紹台股逐筆撮合制度上線後所產生的另外一種成交方式，我們稱之為「連續成交序列」。 大家先看一下底下這張圖： [
![](/wp-content/uploads/2020/07/連續Tick_8111.png)
](/wp-content/uploads/2020/07/連續Tick_8111.png)注意到在12:51:04秒左右有三筆資料後面有標示星號，成交價分別是11.70元26張，11.75元51張，以及11.80元23張，可是這個星號是什麼意思呢？ 之所以會有這個星號，是因為這三筆成交是由同一筆買進委託所產生的，而這一筆買進委託的委託量是100張，而且委託價格是11.8元。當交易所收到這一筆委託時，因為當時最低的委賣價是11.70元，只有26張委賣量，所以這一筆委託先撮合出11.70元26張的成交之後，接著交易所繼續撮合次高的委賣價11.75元51張，最後再撮合11.80元的委賣23張(26 + 51 + 23 = 100張)。 底下是這筆成交發生之前委賣五檔委託簿的樣子，請注意委賣價格以及委賣數量。 [
![](/wp-content/uploads/2020/07/賣出委託部示意圖-300x258.png)
](/wp-content/uploads/2020/07/賣出委託部示意圖.png)當發生這種情形時，因為產生了三筆不同的成交，所以交易所會傳送出3筆連續的成交資料。可是如果我們去思考這次成交的買賣力道時，觀察的重點應該是 產生這一系列成交的這一筆委買單 ，所以在大單追蹤這個畫面內我們用星號把這幾筆成交資料的關係標示出來， 計算單別時也會把這三筆成交加總 ，來判斷這一筆的實際力道。 那麼這樣子的資訊，是不是可以從XS內得知呢？Yes，We Can。 

```
value1 = GetField("TickGroup", "Tick");

```

在Tick資料內有一個欄位叫做「TickGroup」，這個欄位是用來標示這一筆成交資料是怎麼撮合出來的，總共有5種可能的數值： 

- -1: 表示這一筆成交並不是逐筆撮合所產生的。例如開盤的第一筆成交，收盤的那一筆成交都會標示-1， 
- 0: 表示這一筆成交是逐筆撮合所產生的，只有撮出一筆， 
- 1: 表示這一筆成交是連續成交序列內的第一筆， 
- 2: 表示這一筆成交是連續成交序列內中間的任何一筆， 
- 3: 表示這一筆成交是連續成交序列內的最後一筆 
[
![](/wp-content/uploads/2020/06/Screen-Shot-2020-06-17-at-3.53.43-PM.png)
](/wp-content/uploads/2020/06/Screen-Shot-2020-06-17-at-3.53.43-PM.png)如果對照到上面大單分析的那張圖的話，7.70元的那一筆的TickGroup是1，7.71 元以及7.72元的那兩筆的TickGroup都是2, 7.74元的那一筆的TickGroup是3。在腳本內，就可以藉由TickGroup這個欄位，把連續成交序列的每一筆Tick找出來，然後計算這個連續成交序列的總成交量。 為了簡化讀取Tick資料的流程，7.02版新增了一個ReadTicks函數，可以協助我們自動把把連續成交序列合併統計，讓腳本的的邏輯可以更簡單。我們把上一篇文章「 [7.02-盤中即時資料欄位的應用 ](https://www.xq.com.tw/lesson/xspractice/盤中即時資料欄位的應用/)」內的篩選大單的腳本改用ReadTicks這個函數來重寫： 

```
input: filterMode(1, "篩選方式", inputkind:=dict(["買盤",1], ["賣盤",-1]));
input: filterVolume(100, "大單門檻");

var: intrabarpersist readtick_cookie(0);// ReadTicks內部使用, 每次呼叫時請照實傳入
array: tick_array[100, 11](0);		// 需要宣告一個2維陣列來儲存Tick資料
var: row_count(0), idx(0);

// 讀取Tick資料
row_count = ReadTicks(tick_array, readtick_cookie);
for idx = 1 to row_count begin
  if tick_array[idx, 5] = filterMode and tick_array[idx, 10] >= filterVolume then begin
    ret=1;
  end;
end;


```

要呼叫ReadTicks之前，我們要先準備一個二維的 [陣列 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Array&group=DECLARATION)(第5行的tick\_array)，一個二維陣列就像是一個Excel的表格，呼叫完ReadTicks之後，每一橫列會儲存一筆Tick資料，而這一筆Tick資料的每個欄位則會存在這個橫列的每一行裡面。 除了這個陣列之外，我們還需要準備一個變數(第4行的readtick\_cookie)，這個變數用來讓ReadTicks函數可以紀錄上次讀到的Tick資料位置。 接著每一次洗價時，我們就請ReadTicks函數讀取上次洗價到目前為止的所有Tick資料(第13行)，ReadTicks會回傳這次讀回的筆數(row\_count)，接著我們就用 [for迴圈 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=For&group=CONTROLFLOW)來檢視讀到的Tick資料。 ReadTicks讀回的Tick資料會存放在tick\_array內，最新的一筆是第一個橫列(row), 前一筆是第二個row，以下類推。每一個row內包含11個欄位(column)，內容分別是： 

- 第1個column是日期 
- 第2個column是時間 
- 第3個column是成交價 
- 第4個column是成交量 
- 第5個column是內外盤註記 
- 第6個column是這一筆Tick的編號(SeqNo) 
- 如果ReadTicks遇到多筆連續成交序列時，他會把這些Ticks都合併成1個row，第7個column存放的是這個連續成交序列總共有多少筆 
- 如果這是連續成交序列的話，第8個column存放的是這個連續成交序列的第一筆的位置，第9個column存放的則是這個連續成交序列最後一筆的位置 
- 第10個column存放的是這些連續成交序列的總成交量，如果這不是連續成交序列的話，這個column存放的則是這一筆的成交量(跟第四個column相同 
- 第11個column存放的是這些連續成交序列的總成交金額(元)，如果這不是連續成交序列的話，這個column存放的則是這一筆的成交金額 
所以透過ReadTicks之後，我們就可以很簡單的檢查這一筆資料是否符合我們要篩選的規則 

```
if tick_array[idx, 5] = filterMode and tick_array[idx, 10] >= filterVolume then ...

```

上面這個判斷式內，tick\_array[idx, 5]是內外盤註記，而tick\_array[idx, 10]則是這一筆成交的總量(或是連續成交序列的總量)！ 到這裡為止，我們已經跟大家說明了Tick資料的所有欄位以及應用的方式，大家如果有任何建議或是問題的話，麻煩到我們的臉書或是XS技術支援區留言。下次再見囉。 [

#####


---

# 哪些股票中長紅之後還會續漲？

Source: https://www.xq.com.tw/lesson/xspractice/%E5%93%AA%E4%BA%9B%E8%82%A1%E7%A5%A8%E4%B8%AD%E9%95%B7%E7%B4%85%E4%B9%8B%E5%BE%8C%E9%82%84%E6%9C%83%E7%BA%8C%E6%BC%B2%EF%BC%9F/

江湖走久了，高手看的自然較多，有一門派代有才人出，這門派的心法只有一個~追強勢股。 有的盤中追漲停，有的開盤追今天最強的，有的尾盤追第一根長紅棒，今天要跟大家分享的，就是如果您在尾盤追中長紅的股票，隔天怎麼判斷這檔股票會續強還是得快落跑。 下圖是前天漲幅超過3%且今天成交量超過1000張的股票： [
![20160309-01](/wp-content/uploads/2016/03/20160309-01.png)
](/wp-content/uploads/2016/03/20160309-01.png)從這張圖我們可以發現，前一天中長紅之後，隔天還能續強的，基本上大致有兩個共同的特色： 

- 成交量比前一日增加 
- 外盤追高的比例較高 
這兩點其實用市場常用的概念，就是在前一天拉高後，我們要觀察的就是： 

- 後續追高的意願強不強。 
- 拉上來之後，往下倒的力道大不大。 
基於這種觀察，我們可以透過XS的一個選股腳本，以及一個策略雷達腳本，組合成一個跨頻率的交易策略。 首先，我們可以先用日線找出前一日漲幅超過3%且成交量超過500張的股票。 我們可以寫一個選股腳本如下： 

```
1if close>=close[1]*1.03 and volume>500
2then ret=1;
```

如此一來，我們可以如下圖般，在選股中心新增一個選股叫前一日中長紅，然後加入排程，讓電腦每天幫我們找到符合條件的股票。 [
![20160309-02](/wp-content/uploads/2016/03/20160309-02.png)
](/wp-content/uploads/2016/03/20160309-02.png)然後接下來，我們要寫一個腳本，在盤中來確認那些股票成交量有比前一天高。 XS有一個估計量的報價欄位，我們可以利用這個欄位寫一個策略雷達來找出今天預估量會超過昨天成交量且外盤量比內盤量大的股票，寫法很簡單如下： 

```
1value1=q_InSize;//當日內盤量
2value2=q_OutSize;//當日外盤量
3if GetQuote("估計量") > volume[1]
4and value2>value1
5then ret=1;
```

接下來，我們來把選股腳本跟策略雷達串在一起。 請參考下圖： [
![20160309-03](/wp-content/uploads/2016/03/20160309-03.png)
](/wp-content/uploads/2016/03/20160309-03.png)我們透過選股中心，每天找出「前一日中長紅」的股票，然後新增一個策略雷達，用上面所寫的這個「預估量超過昨天成交量」這個腳本，然後在設定指定範圍時，按下最右方的選股，然後在「挑選選股策略」這個跳出來的視窗中，選擇「前一日中長紅」的股票，這樣就可以在盤中找出前一天中長紅，今天成交量會比昨天大且外盤量比內盤量大的股票了。 [

#####


---

# 商品清單功能

Source: https://www.xq.com.tw/lesson/xspractice/%E5%95%86%E5%93%81%E6%B8%85%E5%96%AE%E5%8A%9F%E8%83%BD/

目前 XS 語法可透過 GetSymbolField 取得不同商品的資料欄位，但在指定商品的狀況下僅能透過 Input 參數或直接輸入商品代號字串，當需要處理大量商品時，腳本撰寫會變得相對複雜 。 此次更新新增了商品清單功能，使用者可在 Input 參數中設定所需的商品清單，或透過新建立的 Group 語法獲取指定商品的成分股、期貨或可轉債等商品清單，並搭配 GetSymbolField 快速取得所需資訊。 

### **語法說明 **

#### **透過 Input 宣告清單 **

```
Input: myGroup(Group);
Var: _TF(False);

Value1 = GetSymbolField(myGroup[1], "Close", "D");
_TF = GetSymbolInfo(myGroup[1], "可放空");
```

上述範例使用 Input 語法宣告了一個清單 myGroup ，允許在指標或策略中設定所需的商品清單 。 myGroup 是一個陣列，存放清單中的商品代號，並可透過 [N] 來取得陣列中第 N 個商品代號 。 GetSymbolField 和 GetSymbolInfo 在這次修改中增加支援 Group 清單的功能 （ 需注意還是無法使用變數指定商品代碼 ） 。 從 Input 宣告的 Group 有四種方法可以設定清單 ： 

- 

  - **商品 **： 使用者自行輸入所需商品 
  - **組合 **： 使用者選擇所需的組合 （ 包含自選股 ） 
  - **選股 **： 使用者選擇一個選股中心策略 （ 選股中心策略不能選擇其他選股中心的策略 ） 
  - **檔案 **： 使用者選擇一個外部傳入的檔案 （ 支援 .txt 和 .csv ） 

[
![](/wp-content/uploads/2025/06/商品清單02.png)
](/wp-content/uploads/2025/06/商品清單02.png)[
![](/wp-content/uploads/2025/06/商品清單01.png)
](/wp-content/uploads/2025/06/商品清單01.png)以上四種設定方式與目前策略雷達和自動交易中心中設定執行商品的方式相同 。 

#### **透過 Group 宣告清單 **

```
Group: myGroup();
Var: _TF(False);

myGroup = GetSymbolGroup("TSE23.TW", "成分股");

Value1 = GetSymbolField(myGroup[1], "Close", "D");
_TF = GetSymbolInfo(myGroup[1], "可放空");
```

上述範例使用 Group 語法宣告了一個清單 myGroup ，接著再透過 GetSymbolGroup 來取得指定商品的成分股 。 GetSymbolGroup 可用來取得系統內建的商品清單 。 

- 

  - 第一個參數指定要取得清單的商品，例如範例中的 TSE23.TW 。 若未指定商品，則預設取得目前執行商品的清單 （ 前提是該清單存在 ） 。 
  - 第二個參數指定所需的清單類型，例如範例中的 成分股 ，此參數為必填 。 

以下為支援的清單類型 ： **清單類型 ****支援商品 ****說明 ****成分股 **Component 指數商品、細產業商品 回傳指數 ／ 細產業指數的成分股清單。 支援台灣市場。 指數的範圍為交易所公佈的類股指數，以及XQ所編制的細產業指數 (包含族群)，例如TSE11.TW。 不包含TSE.TW、OTC.TW這種全市場的指數。 **權證 **Warrant 股票 回傳此商品的所有權證商品。 支援台股。 **股期／期貨 **Future 指數 ／ 股票 回傳此商品的所有期貨。 支援台灣市場。 **可轉債 **CB 股票 回傳此商品的所有可轉債商品。 支援台股。 **選擇權 **Option 指數 ／ 股票 回傳此商品的所有選擇權。 支援台灣市場。 (註： 在走勢圖 ／ 技術線圖上的商品名稱點擊右鍵，可確認該商品支援的相關清單類型 ) 

#### **指標腳本的清單選單 **

```
Input:cb_id("", inputKind:=SymbolGroup("CB"), quickedit:=true);
value1 = GetSymbolField(cb_id, "Close");
value2 = GetSymbolField(cb_id, "Volume");
plot1(value1, "CB走勢");
plot2(value2, "CB成交量");
```

在指標腳本中，若希望使用者能在介面上直接選擇所需的清單商品，可以在 Input 宣告時一併傳入清單類型 。 這樣一來，在技術分析頁面中，使用者即可透過選單快速切換執行商品對應的清單類型 。 例如上述範例中，若執行商品對應到多個可轉債，使用者便能透過選單切換，輕鬆繪製可轉債的價格與成交量 。 

### **搭配清單使用的函數 **

```
Value1 = GroupSize(myGroup);
```

GroupSize 會回傳商品清單包含的數量 。 可以此數值避免取用到超出陣列範圍的資料而導致錯誤 。 

### **使用範例 **

#### **盤中漲幅排行 [警示腳本] **

```
input: _S(group, "排行股票");
Array: rankRT[2000, 2](-9999);

SetTotalBar(10);

value1 = GroupSize(_S);

//將清單的 商品代碼 以及 漲跌幅 的數值放入陣列中
for value2 = 1 to value1 begin
value3 = 100 * (getsymbolField(_S[value2], "Close", default := 0)
- getsymbolField(_S[value2], "參考價", "D", default := 0))
/ getsymbolField(_S[value2], "參考價", "D", default := 1);
rankRT[value2, 1] = strtonum(leftStr(_S[value2], 4));
rankRT[value2, 2] = value3;
end;

//將陣列依據漲跌幅排序後印出
Array_Sort2d(rankRT, 1, value1, 2, false);
print("==========漲跌幅前10==========");
print("日期時間：", numtostr(datetime, 0));
for value2 = 1 to 10 begin
print(text("排名", numtostr(value2, 0), "商品: "),
text(numtostr(rankRT[value2, 1], 0), ".TW"),
" / 漲跌幅: ", rankRT[value2, 2]);
end;
print("==============================");

if symbol = text(numtostr(rankRT[1, 1], 0), ".TW") then ret = 1;
```

上述腳本中宣告了一個清單 （ 設定為需要盤中即時排序的商品 ） 和陣列，並將清單內的商品代號和漲跌幅存入陣列後進行排序 。 

#### **指數成分股的營收加總 [指標腳本] **

```
group: _symbolGroup();
var: _sum(0), _num(0);

_symbolGroup = GetSymbolGroup("成分股");
value1 = GroupSize(_symbolGroup);

_sum = 0;
_num = 0;
for value2 = 1 to value1 begin
if CheckSymbolField(_symbolGroup[value2], "月營收", "M") then begin
_sum += GetSymbolField(_symbolGroup[value2], "月營收", "M");
_num += 1;
end;
end;

plot1(_sum);
SetPlotLabel(1, "成分股月營收");
plot2(_num);
SetPlotLabel(2, "有月營收家數");
plot3(value1);
SetPlotLabel(3, "成分股家數");
```

使用者可將執行商品設為指數商品 （ 如 TSE23.TW ） ，並透過 \_symbolGroup 取得該指數對應的成分股清單 。 接著使用 CheckSymbolField 判斷指定成分股的月營收欄位是否存在，加總月營收和計算有資料的成分股數量，最後將其畫出 。 

#### **對應選擇權的成交金額加總 [指標腳本] **

```
group: _list();
var: _uSum(0), _dSum(0), _count(0), _cp("");

_list = getsymbolgroup("選擇權");

_uSum = 0; //買權加總
_dSum = 0; //賣權加總
_count = 0;
for value1 = 1 to groupSize(_list) begin
if getsymbolField(_list[value1], "Date", "Tick", default:= 0) = getfield("Date", default:= -999999) then begin
_cp = getsymbolinfo(_list[value1], "買賣權");
if _cp = "CALL" then _uSum += getsymbolField(_list[value1], "Close", "Tick", default:=0) * getsymbolField(_list[value1], "Volume", "Tick", default:=0) * 2000;
if _cp = "PUT" then _dSum += getsymbolField(_list[value1], "Close", "Tick", default:=0) * getsymbolField(_list[value1], "Volume", "Tick", default:=0) * 2000;
end;
end;

plot1(_uSum, "近一筆買權權利金加總金額");
plot2(_dSum, "近一筆賣權權利金加總金額");
```

這個腳本會加總執行商品該日最近一筆買進權利金的交易金額 （ 買權賣權分開加總 ） ，並將這些總額繪製出來 。 透過觀察這個總額的變化，可以推測市場對該執行商品價格漲跌的看法，就像「以權追股」的功能一樣 。 如果想要根據成交量判斷是否有大額交易，或者只加總最近一段時間的成交金額，可以在腳本中的 For 迴圈部分進行修改 。 [

#####


---

# 如何使用函數取得商品的實際庫存數量

Source: https://www.xq.com.tw/lesson/xspractice/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B8%E5%8F%96%E5%BE%97%E5%95%86%E5%93%81%E7%9A%84%E5%AF%A6%E9%9A%9B%E5%BA%AB%E5%AD%98%E6%95%B8%E9%87%8F/

XQ 提供讓交易腳本可以取得對應商品實際庫存的函數，讓使用者可以依據實際庫存來對策略的交易邏輯作限制。 以下是文章主軸： [**一、函數語法 **](#anchor01)[**二、函數說明 **](#anchor02)[**三、使用範例 **](#anchor03)[](#)

### **一、函數語法 **

```
Value1 = FilledAtBroker;
```

### **二、函數說明 **
此函數會回傳對應商品的實際庫存數量，而這個數值會是正、負的整數或 0。 該數值會隨策略設定的現股、資券而有所不同。 舉例來說，若帳戶中只有 1 張 2330 台積電現股多單的話，將策略設定為現股時 FilledAtBroker 會回傳 1，但若將策略設定為資券的話 FilledAtBroker 則會回傳 0。 其運作方式和原本的 Filled 相同，會在腳本當次洗價運算前確定數值。 所以若腳本在運算中因為委託單成交導致實際庫存變動，FilledAtBroker 還是會維持在洗價前確定的數值。 FilledAtBroker 本身對下單不會有影響，交易委託是由 Position、Filled 以及 SetPosition 等交易函數的數值來決定。 舉例來說: 用戶的腳本在運算前 Position = 2, Filled = 2, FilledAtBroker = 5。 運算中腳本觸發了 SetPosition(0, market) 的指令，在腳本運算結束後，系統會依據 Position = 0 和 Filled = 2 判斷下出2張市價賣單，和 FilledAtBroker 沒有關係。 需注意該數值和策略庫存 (Filled) 或策略部位 (Position) 不一定會相同，且會受到其他執行中的策略和手動交易的影響。 [](#)

### **三、使用範例 **
**範例(一) 所有策略所能持有的單一商品數量限制 **目前自動交易策略中的交易安控只能夠針對策略內的商品作控制，但當用戶同時啟動多個策略的時候，就沒辦法針對所有策略交易某個商品的數量作控管。 舉例來說，在有10個策略，而希望這些策略持有A商品不超過10筆的情況下，雖然可以將個別策略的最大部位限制設為1確保最多持有不會超過10筆，但會導致要10個策略都符合進場條件時才會有10個部位，而非個別策略可以決定加碼減碼。 在這種情況下，可以使用 FilledAtBroker 的數值來作管控，就可以控制複數策略同時進場的數量。 腳本範例： 

```
input: filledUpLimit(10, "最大買進數量"), filledDownLimit(-10, "最大放空數量");

condition1 = close cross over average(close, 10) and filled <= 0;
condition2 = close cross under average(close, 10) and filled >= 0;

if condition1 and (FilledAtBroker + 3) <= filledUpLimit then setposition(3, market);
if condition2 and (FilledAtBroker - 3) >= filledDownLimit then setposition(-3, market);
```

只要同時在所有運作中的策略加上此項限制，就可以在買進/放空時確認交易的數量是否會超過設定的上下限，避免多策略交易時超過所能接受的單一商品數量。 **範例(二) 確保所有庫存可以在指定條件下出場 **當有多個策略在同時運作，且本人也會看盤下單的情況下，在符合某些條件要將手上持有的部位全部平倉時，可以使用此欄位來達成讓所有庫存在滿足特定條件下全部出場。 舉例來說，若希望收盤前可以將手上的部位清空的話，可以使用以下範例來作處理。 腳本範例： 

```
if currenttime >= 132400 and Position = Filled and FilledAtBroker <> 0 then setposition(Position-FilledAtBroker, market);
```

這樣就能夠讓用戶在 13:24 以後洗價運算時判斷讓該策略以市價單出場執行商品目前所有的庫存，避免想當沖卻不小心留倉的狀況。 [

#####


---

# 探討變數序列的觀念：幾天前黃金交叉商品為例

Source: https://www.xq.com.tw/lesson/xspractice/%E5%A6%82%E4%BD%95%E6%89%BE%E5%87%BA%E5%B9%BE%E5%A4%A9%E5%89%8D%E9%BB%83%E9%87%91%E4%BA%A4%E5%8F%89%E7%9A%84%E5%95%86%E5%93%81%EF%BC%9A%E6%8E%A2%E8%A8%8E%E8%AE%8A%E6%95%B8%E5%BA%8F%E5%88%97%E7%9A%84/

有朋友問到，系統內有提供很多找出均線黃金交叉，MACD黃金交叉的腳本，可是這些腳本好像都是要找 **現在 **黃金交叉的商品。那如果我想要找的是 **幾天前 **黃金交叉的商品，那XS辦得到嗎？今天就在這一篇文章內跟大家介紹如何做到這樣子的功能。 首先我們來看一下均線黃金交叉的腳本： 

```
input: Shortlength(5, "短期均線期數");
input: Longlength(20, "長期均線期數");

Value1 = Average(Close,Shortlength);
Value2 = Average(Close,Longlength);

If Value1 cross over Value2 then ret = 1;

```

在這個腳本我們先計算短期的均線數字，把他存在Value1裡面，再計算長期的均線數字，把他存在Value2裡面，然後判斷Value1是否向上穿越(cross over)Value2，如果是的話則觸發。 從這段腳本內，我們只有看到Value1, Value2這兩個數字，他們代表的就是最新的短期均線跟長期均線的數值。可是，大家應該也知道，XS腳本在執行時是從左往右一根一根執行的，而這裡最重要的觀念是，在執行的過程內， **每一根K棒執行時所計算過的數值，都是有存下來的。 **

[
![ValueSeries](/wp-content/uploads/2016/03/ValueSeries.png)
](/wp-content/uploads/2016/03/ValueSeries.png)
要存取這些在之前K棒所算過的數值的方式，就跟存取前一根K棒的價格的方式一樣，是採用[1]的方式來取得。所以，如果要找到前一期黃金交叉的商品的話，只需要把判斷向上穿越的程式碼從Value1改成Value1[1]就可以了。 

```
input: Shortlength(5, "短期均線期數");
input: Longlength(20, "長期均線期數");

Value1 = Average(Close,Shortlength);
Value2 = Average(Close,Longlength);

If Value1[1] cross over Value2[1] then ret = 1;

```

這樣子是不是很簡單呢？ 最後跟大家做個整理：在腳本內的每一個計算後的數值，例如Value1, Value2，或是其他你自己命名的變數， 其實都是像Open，High，Low，Close一樣是一個 **時間序列 **。而這個變數的前一筆的數值，就是腳本在上一根K棒執行時所產生的數值。 再來看一個例子： 

```
Value1 = Close - Close[1];
if Value1 > 0 And Value1[1] > 0 And Value1[2] > 0 then ret=1;

```

大家可以看得出這個腳本要找的是什麼商品了嗎？就祝大家作多的股票都跟這個腳本一樣，連續上漲三天喔！！ [

#####


---

# 如何運用函數繪製填色區塊

Source: https://www.xq.com.tw/lesson/xspractice/%E5%A6%82%E4%BD%95%E9%81%8B%E7%94%A8%E5%87%BD%E6%95%B8%E7%B9%AA%E8%A3%BD%E5%A1%AB%E8%89%B2%E5%8D%80%E5%A1%8A/

XQ 提供了能夠在線圖上指定區域填色的功能，例如 KD 指標的超買超賣區間，讓使用者能夠更簡單的辨識指標間的範圍。 以下是文章目錄： [一、函數語法 ](#anchor01)[二、函數說明 ](#anchor02)[三、函數的運作方式 ](#anchor03)[四、簡單範例：KD 的超買超賣區塊填色 ](#anchor04)[](#)
---

### **一、函數語法 **

```
PlotFill(序列編號, vFrom, vTo)
PlotFill(序列編號, vFrom, vTo, "序列名稱")end;
```

### **二、函數說明 **
[](#)第一個參數是設定序列編號，會是 1~999 的數值，與目前 Plot 的序列編號相同。 第二個和第三個參數分別是當根 K 棒要填色的開始和結束點。 第四個參數是設定序列的名稱，為選填的參數。若沒有設定的話預設會是 " Plot "+序列編號。 

### 

### **三、函數的運作方式 **
在第一次執行 (K棒X1) PlotFill(1, Y1\_U, Y1\_D) 時，此函數會在 Y1\_U 到 Y1\_D 間畫出一條垂直的直線，此時並不會有填色的效果。 [
![](/wp-content/uploads/2024/04/image2-92x300.png)
](/wp-content/uploads/2024/04/image2.png)在第二次執行 (K棒X2) PlotFill(1, Y2\_U, Y2\_D) 時，且與兩次執行間沒有使用 NoPlot(1) 的狀況下，此時系統會將上次 (X1) 與此次 (X2) 的開始點 (Y1\_U和Y2\_U) 以及結束點 (Y1\_D和Y2\_D) 之間用直線連起來，搭配上 Y1\_U, Y1\_D 和 Y2\_U, Y2\_D 兩條垂直線，四條線連起來的區塊A填色。 [
![](/wp-content/uploads/2024/04/image1-184x300.png)
](/wp-content/uploads/2024/04/image1.png)在第三次執行 (K棒X3) PlotFill(1, Y3\_U, Y3\_D) 時，且與第二次執行間沒有使用 NoPlot(1) 的狀況下，系統會將 Y2\_U, Y3\_U 和 Y2\_D, Y3\_D 連接，搭配上 Y2\_U, Y2\_D 和 Y3\_U, Y3\_D 兩條垂直線的區塊B填色。 [
![](/wp-content/uploads/2024/04/image3-249x300.png)
](/wp-content/uploads/2024/04/image3.png)如果兩次呼叫此函數間有希望不塗色的部份的話，可以在區間內呼叫 NoPlot 函數來取消填色。 需注意開始點和結束點的順序，會影響畫出的區塊。 舉例來說： [
![](/wp-content/uploads/2024/04/image4-300x103.png)
](/wp-content/uploads/2024/04/image4.png)左圖第一次執行是 PlotFill(1, 100, 200)，第二次執行是 PlotFill(1, 100, 200)。 [](#)右圖第一次執行是是 PlotFill(1, 100, 200)，第二次執行是 PlotFill(1, 200, 100)。 可以看到因為第二次的開始結束點交換了，導致填塞區塊也跟著交錯。 [](#)此外 PlotFill 在查價視窗中不會顯示任何數值，只有單純的填色效果。 若需要知道填色區塊邊緣的數值的話，可以搭配其他的繪圖函數來做使用。 

### 

### **四、簡單範例：KD 的超買超賣區塊填色 **

```
//計算KD指標，並將KD的超買超賣區間填色
input: Length(9, "天數"), RSVt(3, "RSVt權數"), Kt(3, "Kt權數");
input: OverBought(80, "超買"), OverSold(20, "超賣");

variable: rsv(0), k(0), _d(0);

Stochastic(Length, RSVt, Kt, rsv, k, _d);

Plot1(k, "K(%)");
Plot2(_d, "D(%)");

//當K值在超買線以上時
if k > OverBought then begin
//將由超買線開始到K值結束的區間填色
PlotFill(3, OverBought, k);
NoPlot(4);
//當K值在超賣線以下時
end else if k < OverSold then begin
//將由超賣線開始到K值結束的區間填色
PlotFill(4, OverSold, k);
NoPlot(3);
end else begin
//當K值位於中間時，不要填色
NoPlot(3);
NoPlot(4);
end;
```

[

#####


---

# 如何運用Print指令來抓程式的臭蟲

Source: https://www.xq.com.tw/lesson/xspractice/%E5%A6%82%E4%BD%95%E9%81%8B%E7%94%A8print%E6%8C%87%E4%BB%A4%E4%BE%86%E6%8A%93%E7%A8%8B%E5%BC%8F%E7%9A%84%E8%87%AD%E8%9F%B2/

大家在寫腳本的時候，有沒有常常跟小編一樣，遇到跑出來的結果跟原先預期不一樣的情形？今天小編就要來跟大家介紹一個抓臭蟲(Bug)的工具：這個工具就叫做Print指令。Print指令除了可以用來抓臭蟲之外，他也可以幫我們把腳本中運算完的數據輸出成文字檔，方便我們把運算結果儲存下來或是再做其他的應用。 首先來介紹基本的語法： 

```
Value1 = Average(Close, 5);
Print("Date=", Date, "Close=", Close, "Value1", Value1);

```

在Print指令內，我們可以把想要印出來的欄位一股腦的寫在裡面，可以印出字串，也可以印出數值。 然後當腳本執行時，在XScript編輯器內的下方的「執行」視窗內，就可以即時看到印出來的數值。在這裡可以同時看到不同腳本執行時印出來的內容，商品欄位顯示的是指標目前的商品，或是策略雷達執行的商品，腳本就是 **有使用到Print指定的腳本名稱 **： [
![Print](/wp-content/uploads/2016/03/Print.png)
](/wp-content/uploads/2016/03/Print.png)有了這個指令之後，以後如果腳本跑出來的結果跟你想的不一樣的話，那就直接在腳本內加上Print指令，把想要看到的數值印出來就方便許多了！ Print的結果，除了在XScript編輯器內可以看到之外，另外在XS的安裝目錄底下也會產生檔案，檔案的路徑是在C:\SysJust\XQ2005\XS\Print底下，檔案的名稱，預設是 ***腳本名稱\_商品名稱.log: ***[
![PrintFolder](/wp-content/uploads/2016/03/PrintFolder.png)
](/wp-content/uploads/2016/03/PrintFolder.png)如果使用到Print的腳本很多的話，那這個目錄內就會越來越亂。有辦法控制Print產出的檔案的位置或是名稱嗎？ 

### **密技1：指定輸出檔案路徑 **
在Print指令的第一個參數位置，加上 [file ](http://xshelp.xq.com.tw/api.aspx?a=File&b=bif)(“檔案路徑")的參數，就可以指定print出來的檔案要放置的路徑。例如，我們想輸出成交價至C:\Print下，可以這樣寫： 

```
print(file("C:\print\"),date,symbol,close);

```

這個腳本輸出的檔案就會移到C:\Print下。 

### **密技2：指定輸出檔案名稱 **
不過，既然可以指定輸出檔案路徑，當然也可以指定輸出的檔案名稱。一樣是透過 [file ](http://xshelp.xq.com.tw/api.aspx?a=File&b=bif)這個參數來指定輸出的檔案名稱。 例如，我們想把檔案名稱改為“ ***商品代碼.log ***”，可以這樣寫： 

```
print(file("c:\Print\[Symbol].log"),date,symbol,close);

```

[
![PrintToFolder](/wp-content/uploads/2016/03/PrintToFolder.png)
](/wp-content/uploads/2016/03/PrintToFolder.png)有沒有注意到我們上一個範例怎麼指定商品代碼的？用[Symbol]。只要是在 [file ](http://xshelp.xq.com.tw/api.aspx?a=File&b=bif)裡面寫了[Symbol]的位置，在輸出的時候就會自動用當時的商品代碼來取代。另外，你也可以使用[ScriptName]、[Freq]或[Date]。這些特殊字串在指定路徑或檔名的時候都可以用，這樣子我們可以輸出的變化就很多了。 如果我們想按商品代碼來整理數據，可以這樣寫： 

```
print(file("C:\print\[Symbol]\"),date,symbol,close);

```

這樣子可以把不同腳本輸出的資料都集中到個別商品的目錄當中。 [
![PrintToSymbolFolder](/wp-content/uploads/2016/03/PrintToSymbolFolder.png)
](/wp-content/uploads/2016/03/PrintToSymbolFolder.png)或者是，我們想把所有數據都輸出到同一個檔案print.log中，可以這樣寫： 

```
print(file("C:\print\print.log"),date,symbol,close);

```

[
![PrintToSameFile](/wp-content/uploads/2016/03/PrintToSameFile.png)
](/wp-content/uploads/2016/03/PrintToSameFile.png)有了這些功能，我們就可以控制檔案輸出的位置，不管是要把執行結果存下來，或是跟其他程式共用檔案，都可以輕易的辦到。 小編要在這裡告訴大家一個好消息，在XQ操盤高手 2.40 改版中，Print指令已可在回測與選股中心使用！由於回測與選股中心Print指令是從雲端上運行，故使用此功能跑回測時，執行回測的時間會較久一些，此特性請大家注意一下囉！ 回測或選股腳本撰寫好Print指令後，在回測設定畫面下方記得勾選「啟動腳本內Print指令」 [
![](/wp-content/uploads/2018/07/V640改_XS語法應用_如何運用Print指令來抓程式的臭蟲_回測.png)
](/wp-content/uploads/2018/07/V640改_XS語法應用_如何運用Print指令來抓程式的臭蟲_回測.png)在選股中心畫面右上角記得勾選「啟動腳本內Print指令」，即可在執行回測或選股策略後，將所需要檢查的數據輸出，方便查找問題的原因。 [
![](/wp-content/uploads/2018/07/V640改_XS語法應用_如何運用Print指令來抓程式的臭蟲_選股.png)
](/wp-content/uploads/2018/07/V640改_XS語法應用_如何運用Print指令來抓程式的臭蟲_選股.png)希望從此之後，大家都可以鎮定的面對臭蟲，Happy Coding and Happy Hunting。 [

#####


---

# 強勢股整理結束

Source: https://www.xq.com.tw/lesson/xspractice/%E5%BC%B7%E5%8B%A2%E8%82%A1%E6%95%B4%E7%90%86%E7%B5%90%E6%9D%9F/

作為一個操作者，我們對那些來不及上車的強勢股，也往往有莫可奈何的心情。 這樣的心情，如果用波浪理論來解釋，那就是在初昇段來不及參與之後，希望在主昇段發動前夕，來得及坐上車。 [
![20160310-01](/xstrader-content/uploads/2015/10/1017011.png)
](/wp-content/uploads/2016/03/20160310-01.png)為了尋找這一類的股票，我試著寫一個腳本，這個腳本有三個步驟： 1. 尋找特定日期以來漲幅最大，走勢最強的股票 2. 這樣的股票，從這段時間以來的最高點到前一日的收盤，已修正一定的幅度 3. 今天盤中該個股明顯走強 在要寫這個腳本時，首先得先找出某特定日到最新的收盤價，一共是幾根Bar。這個函數就叫做 [GetBarOffset ](http://xshelp.xq.com.tw/index.aspx?HelpName=GetBarOffset&group=DATERELFUNC)。使用的方法是傳入某個日期，這個函數就會回傳從現在到該日期共隔了幾根Bar。 

```
1Value1 = GetBarOffset(20151014);
```

如果今天是2015年10月15日，那上面的程式執行時Value1就會是1，代表是前一根bar。 有了這個函數，我就來寫出上面所提到的這個腳本： 

```
input: stardate(20150824);
input:ratio(30);
input:ratio1(7);
input:ratio2(2);
setinputname(1,"輸入上漲起始日");
setinputname(2,"輸入上漲最低幅度");
setinputname(3,"輸入最小拉回幅度");
setinputname(4,"今日最低漲幅");
setfirstbardate(stardate);
value1=getbaroffset(stardate);//找出輸入的日期是在第幾根bar
value2=highest(high[1],value1+1);//找出這一波的最高點

condition1=false;
condition2=false;

if value2>=close[value1]*(1+ratio/100)//計算波段漲幅有沒有符合要求
then condition1=true;

if value2>=close[1]*(1+ratio1/100)//計算拉回的幅度夠不夠要求
then condition2=true;

if nthhighestbar(1,high,10)>=5//從最高點到今天超過五根bar
then begin
if condition1 and condition2 and close>=close[1]*(1+ratio2/100)
then ret=1;
end;
```

在解釋這個腳本之前，我們先來看一下大盤最近的走勢： [
![20160310-02](/xstrader-content/uploads/2015/10/1017021.png)
](/wp-content/uploads/2016/03/20160310-02.png)所以我上面寫的這個腳本，就是找出符合下面四個條件的股票： 1. 從8/24日以來，到最高點漲幅超過30%的股票 2. 從最高點到前一個交易日的低點修正幅度超過7% 3. 今天收盤比前一天收盤漲超過2% 4. 從高點拉回整理超過五天。 這樣的腳本要尋找的，就是整理結束後的強勢股。 下面這張圖就是這個腳本今天跑出來的股票： [
![20160310-03](/xstrader-content/uploads/2015/10/101501.png)
](/wp-content/uploads/2016/03/20160310-03.png)當然不是每檔股票都會在初昇段之後就一定有主昇段，也不見得每檔股票都是休息了幾天後就開始再往上攻，不過這個策略的好處是，對於那些從特定日期以來走勢很強的股票，一旦整理結束，我們在第一時間就會收到電腦的通知，這樣的好處是我不必一直盯著強勢股等拉回結束。 這個腳本可以名列我的私房腳本第二名，介紹給大家，至於日期及漲幅，拉回幅度，這些參數就請大家自己調整囉！ [

#####


---

# 排行語法

Source: https://www.xq.com.tw/lesson/xspractice/%E6%8E%92%E8%A1%8C%E8%AA%9E%E6%B3%95/

「排行語法」讓使用者可直接在選股腳本中撰寫排行條件，無需額外撰寫函數腳本，並可靈活運用不同的排行名次作為篩選條件。 

### **語法 **

#### **基礎範例 **

```
rank myRank begin
Value1 = Average(Close, 10);
retval = (Close - Value1);
end;

if myRank.pos <= 100 then ret = 1;
OutputField1(myRank.value);
```

上面範例中，使用了 rank 宣告了 myRank 的物件，並將收盤價和移動平均線的差距來當作排行的條件。 接著透過呼叫 myRank 物件的 pos 屬性，將前一百名的商品篩選出，並使用 OutputField 將符合條件商品的收盤價和移動平均線差距輸出。 rank 語法只支援選股腳本，其他的腳本都無法使用。 每個排行透過 rank 函數宣告排行物件，並在 begin 到 end 區塊內撰寫排行條件所需的計算數值，最後透過 retval 回傳作為排行依據的數值，預設為由大到小。 當 rank 物件運算完成後，即可使用其屬性來進行排序與篩選等相關操作。 以下為 rank 物件支援的屬性： **屬性名稱 ****說明 **pos 排行名次，整數，從 1 開始，1 是第一名。 range 排行 %，等於 pos / <參與排行商品數> \* 100。這是一個實數 (有小數點)，數值範圍介於 0 ~ 100 之間，越小排名越前面。 pr Percentile Rank %。 PR = (N - pos) / (N - 1) \* 100 。這是一個實數，數值範圍介於 100 ~ 0 之間，第一名是 100， PR95 表示是 95% 之前。 count 參與排行的商品個數。這個數值對任何一檔商品而言都是固定的。 value rank object 的回傳數值，也就是 retval 的回傳數值。 avgvalue 所有商品 rank.value 的平均值。 可以使用這個數值來決定目前商品是否是在平均值以上或是平均值以下。 這個數值對任何一檔商品而言都是固定的。 medvalue 所有商品 rank.value 的中位數 (median value)。 可以使用這個數值來決定目前商品是否是在中位數以上或是中位數以下。 這個數值對任何一檔商品而言都是固定的。 minvalue 所有商品內rank.value的最小值 maxvalue 所有商品內rank.value的最大值 Q1 把所有商品的rank.value，依照由小到大排序後前25%位置所對應的數值。 Q3 把所有商品的rank.value，依照由小到大排序後前75%位置所對應的數值。 isvalid 布林值。 False的話代表這檔商品沒有加入排行。 可能的情形是沒有指定retval或是執行時發生錯誤。 

### **rank ****語法的注意點 **
**一、同個腳本當中可以有多個 rank 物件，但每個物件的名稱不能和彼此、腳本中變數以及參數重複。 **(X) 錯誤的案例： 

```
var: myRank(0);
rank myRank begin
Value1 = Average(Close, 10);
retval = (Close - Value1);
end;
```

(O) 正確的案例： 

```
rank myRank1 begin
retval = Close;
end;
rank myRank2 begin
retval = Volume;
end;
```

---
**二、rank 物件不能夠放在任何的條件或是 begin … end 之間，需要放在最上面一層。 **(X) 錯誤的案例： 

```
if close > open then begin
rank myRank begin
Value1 = Average(Close, 10);
retval = (Close - Value1);
end;
end;
```

- 

  - 排行的結果是一個序列。 

```
rank myRank begin
retval = Close;
end;
if myRank.pos[1] <> myRank.pos then ret = 1;
//篩選出前期排行與當期排行不同的商品
```

---
**三、rank 排行預設為大到小，但可以透過 desc 和 asc 來設定是大到小還是小到大。 **

```
//大到小
rank myRank1 desc begin
retval = Close;
end;

//小到大
rank myRank2 asc begin
retval = Close;
end;
```

---
**四、rank 物件內是獨立空間，無法傳入腳本他處的參數和變數。 **

- 

  - rank 物件使用的變數需另行在 rank 區間內宣告 (亦可使用內建的 Value1 等變數)。 
  - 變數即使有相同的名字，但不會互相影響 (內建變數亦相同)。 

(X) 錯誤的案例： 

```
//錯誤訊息要特別註明
Input: len(10);
rank myRank begin
Value1 = Average(Close, len);
retval = (Close - Value1);
end;
```

(O) 正確的案例： 

```
//編譯時禁止 rank 內宣告相同名稱的變數
var: _price(0);
_price = Open;
rank myRank begin
var: _price(0);
_price = Average(Close, 10);
retval = (Close - _price);
end;
// rank 物件內 _price 會是 10 期收盤價移動平均值，物件外的 _price 會是開盤價
```

---
**五、rank 內雖然不能夠使用外部的參數變數，但可以使用前面其他 rank ****運算出來的結果。 **舉例來說，在 Alpha 101 的因子內，有些因子會需要針對某些排行結果再做另外一次排行。 其中 Alpha 13＝-1 \* rank(covariance(rank(close), rank(volume), 5))，這個因子的邏輯是： 

- 

  - 

    - 首先統計過去 5 日每一日 close 在母體內排名以及每一日 volume 在母體內的排名。 
    - 如果這 5 日的排名正相關的話 (>1)，那就賣出這檔股票，如果是負相關的話 (<-1)，那就買進這檔股票。 

注意到這個因子必須針對過去 5 日的排行數值的運算結果 (covariance) 再做一次排行。以下是模擬 Alpha 13 的腳本範例： 

```
//收盤價排行

rank rank_close begin
retval = close;
end;

//成交量排行

rank rank_volume begin
retval = volume;
end;

//上述兩個排行的相關性

rank rank_alpha_13 begin
retval = Covariance(rank_close.pr, rank_volume.pr, 5);
end;
ret = 1;

OutputField1(rank_alpha_13.value, "相關性");
```

[

#####


---

# 盤中即時資料欄位的應用

Source: https://www.xq.com.tw/lesson/xspractice/%E7%9B%A4%E4%B8%AD%E5%8D%B3%E6%99%82%E8%B3%87%E6%96%99%E6%AC%84%E4%BD%8D%E7%9A%84%E6%87%89%E7%94%A8/

在這一篇文章內我們會跟大家介紹另外一個7.02/3.02版所新增的XS功能：「盤中即時資料欄位」。 什麼叫做「盤中即時資料欄位」呢？在7.02/3.02之前的版本，資料欄位(例如內盤量，外盤量，外資買賣超，等)所支援的最快更新頻率都是日頻率，也就是說如果你的自訂指標或是策略雷達是執行分鐘頻率的話，你還是只能抓到昨日的數值，沒辦法抓到更精細的欄位，例如9:01分的數值，9:02的數值等。 以外資買賣超這種一天才公布一次的欄位而言，受限於資料來源，XS沒辦法提供分鐘頻率的數值。可是如內盤量，外盤量這種是以成交明細所統計出來的資料欄位，從7.02/3.02版開始，你就可以抓到每分鐘的數值了。因為這些資料欄位的數值可以在盤中即時抓到，即時更新，所以我們稱這些欄位為「盤中即時資料欄位」，換句話說，所謂「盤中即時資料欄位」指的是 支援分鐘頻率的資料欄位 。 從腳本內要怎麼樣取得這些欄位呢？一樣是透過GetField的語法： 

```
value1 = GetField("內盤量", "1"); // 取得1分鐘頻率的數值
value2 = GetField("內盤量", "2"); // 取得2分鐘頻率的數值
value3 = GetField("內盤量", "5"); // 取得5分鐘頻率的數值
value4 = GetField("內盤量");      // 不指定頻率: 依照目前執行的頻率

```

語法上最大的差異是頻率欄位可以直接傳入預期的分鐘頻率(只要是XQ目前有支援的分鐘頻率都可以使用)。如果雷達/指標是執行分鐘頻率的話也可以不指定頻率，執行時會依照執行的頻率來抓取對應的數值。 透過IDE的插入欄位功能也可以選到常用的分鐘頻率： [
![](/wp-content/uploads/2020/06/7.02-IDE插入欄位.png)
](/wp-content/uploads/2020/06/7.02-IDE插入欄位.png)這些「盤中即時資料欄位」所支援的最小頻率都是1分鐘。如果你使用的是比較大的頻率的話(例如5分鐘頻率)，那腳本所抓到的數值就會依照這個欄位的定義來決定。計算的方式有兩種： 

- 累積值：例如「內盤量」欄位，5分鐘頻率所抓到的「內盤量」就是這5分鐘內每一個1分鐘「內盤量」的累積數值， 
- 期末值：例如「均價」欄位，5分鐘頻率所抓到的「均價」就是最後1分鐘的「均價」數值 
底下列出7.02版所支援的「盤中即時資料欄位」，如果想要了解欄位的詳細內容的話，請點選每個欄位名稱的連結。 欄位名稱 說明 [成交金額 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E6%88%90%E4%BA%A4%E9%87%91%E9%A1%8D%28%E5%85%83%29&group=TOFTEN)當分鐘的成交金額 [均價 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E5%9D%87%E5%83%B9&group=TOFTEN)開盤到目前為止的成交均價 [內盤量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%85%A7%E7%9B%A4%E9%87%8F&group=TOFTEN)/ [外盤量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%A4%96%E7%9B%A4%E9%87%8F&group=TOFTEN)當分鐘的內盤成交量/外盤成交量 [上漲量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E4%B8%8A%E6%BC%B2%E9%87%8F&group=TVOLUME)/ [下跌量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E4%B8%8B%E8%B7%8C%E9%87%8F&group=TVOLUME)當分鐘的上漲成交量/下跌成交量 [估計量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E4%BC%B0%E8%A8%88%E9%87%8F&group=TOFTEN)到目前為止的當日估計量 [量比 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E9%87%8F%E6%AF%94&group=TVOLUME)估計量 / 昨日整日的成交量 [總成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B8%BD%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [內盤成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%85%A7%E7%9B%A4%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [外盤成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%A4%96%E7%9B%A4%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)當分鐘的成交筆數/以內盤成交的成交筆數/以外盤成交的成交筆數 [買進特大單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%8F&group=TVOLUME)/ [買進大單量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E8%B2%B7%E9%80%B2%E5%A4%A7%E5%96%AE%E9%87%8F&group=TVOLUME)/ [買進中單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E4%B8%AD%E5%96%AE%E9%87%8F&group=TVOLUME)/ [買進小單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%B0%8F%E5%96%AE%E9%87%8F&group=TVOLUME)依照單筆交易金額分級，統計當分鐘以外盤成交的特大單/大單/中單/小單的成交量(張數) [賣出特大單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%8F&group=TVOLUME)/ [賣出大單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%A4%A7%E5%96%AE%E9%87%8F&group=TVOLUME)/ [賣出中單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E4%B8%AD%E5%96%AE%E9%87%8F&group=TVOLUME)/ [賣出小單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%B0%8F%E5%96%AE%E9%87%8F&group=TVOLUME)依照單筆交易金額分級，統計當分鐘以內盤成交的特大單/大單/中單/小單的成交量(張數) [買進特大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)/ [買進大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)/ [買進中單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E4%B8%AD%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)/ [買進小單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%B0%8F%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)依照單筆交易金額分級，統計當分鐘以外盤成交的特大單/大單/中單/小單的成交金額(元) [賣出特大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)/ [賣出大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)/ [賣出中單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E4%B8%AD%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)/ [賣出小單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%B0%8F%E5%96%AE%E9%87%91%E9%A1%8D&group=TVOLUME)依照單筆交易金額分級，統計當分鐘以內盤成交的特大單/大單/中單/小單的成交金額(元) [買進特大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E7%89%B9%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [買進大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [買進中單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E4%B8%AD%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [買進小單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%B0%8F%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)依照單筆交易金額分級，統計當分鐘以外盤成交的特大單/大單/中單/小單的成交筆數 [賣出特大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E7%89%B9%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [賣出大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/賣 [出中單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E4%B8%AD%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)/ [賣出小單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%B0%8F%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=TVOLUME)依照單筆交易金額分級，統計當分鐘以內盤成交的特大單/大單/中單/小單的成交筆數 [累計委買 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E8%A8%88%E5%A7%94%E8%B2%B7&group=TVOLUME)/ [累計委賣 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E8%A8%88%E5%A7%94%E8%B3%A3&group=TVOLUME)/ [累委買筆 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E5%A7%94%E8%B2%B7%E7%AD%86&group=TVOLUME)/ [累委賣筆 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E5%A7%94%E8%B3%A3%E7%AD%86&group=TVOLUME)由交易所公布，開盤到目前的累計委買委賣張數(口數)，以及累計委買委賣筆數 [累買成筆 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E8%B2%B7%E6%88%90%E7%AD%86&group=TVOLUME)/ [累賣成筆 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E8%B3%A3%E6%88%90%E7%AD%86&group=TVOLUME)由交易所公布，開盤到目前的以委買成交的筆數以及以委賣成交的筆數，支援期貨／選擇權 [累計成交 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E8%A8%88%E6%88%90%E4%BA%A4&group=TVOLUME)/ [累成交筆 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%B4%AF%E6%88%90%E4%BA%A4%E7%AD%86&group=TVOLUME)由交易所公布，開盤到目前的累計成交數量以及成交筆數 [漲停家數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E6%BC%B2%E5%81%9C%E5%AE%B6%E6%95%B8&group=TMARKET)/ [跌停家數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B7%8C%E5%81%9C%E5%AE%B6%E6%95%B8&group=TMARKET)/ [上漲家數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E4%B8%8A%E6%BC%B2%E5%AE%B6%E6%95%B8&group=TMARKET)/ [下跌家數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E4%B8%8B%E8%B7%8C%E5%AE%B6%E6%95%B8&group=TMARKET)目前最新成交價是漲停/跌停/上漲/下跌的家數統計 [內盤家數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%85%A7%E7%9B%A4%E5%AE%B6%E6%95%B8&group=TMARKET)/ [外盤家數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%A4%96%E7%9B%A4%E5%AE%B6%E6%95%B8&group=TMARKET)當分鐘的內盤家數/外盤家數 [基差 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E5%9F%BA%E5%B7%AE&group=TPRICE)當分鐘現貨價格與期貨價格之間的差額 [Delta ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=Delta&group=TOPTION)/ [Gamma ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=Gamma&group=TOPTION)/ [Theta ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=Theta&group=TOPTION)/ [Vega ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=Vega&group=TOPTION)/ [RHO ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=RHO&group=TOPTION)權證/選擇權的希臘數字 [理論價 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E7%90%86%E8%AB%96%E5%83%B9&group=TOPTION)目前最新的理論價格 [波動率 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E6%B3%A2%E5%8B%95%E7%8E%87&group=TOPTION)當分鐘的波動率 [隱含波動率 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E9%9A%B1%E5%90%AB%E6%B3%A2%E5%8B%95%E7%8E%87&group=TOPTION)當分鐘的隱含波動率 [買權成交量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E6%AC%8A%E6%88%90%E4%BA%A4%E9%87%8F&group=TOPTION)/ [賣權成交量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E6%AC%8A%E6%88%90%E4%BA%A4%E9%87%8F&group=TOPTION)開盤到現在的買權/賣權成交量總和。夜盤商品不納入計算。 看完欄位清單之後，那我們就使用這些欄位來做幾個簡單的應用。 首先開啟IDE，新增一個指標腳本，取名為「當日賺賠」，輸入以下的程式碼： 

```
value1 = GetField("均價");
value2 = weightedclose - value1;

plot1(value2, "賺賠");

```

開啟技術分析圖，切換到5分鐘頻率，然後加入這個指標，顯示方式改成正負柱狀圖，你會看到類似下方的畫面。 [
![](/wp-content/uploads/2020/06/7.02-當日賺賠指標.png)
](/wp-content/uploads/2020/06/7.02-當日賺賠指標.png)在這個指標內所繪製的是當根K棒的加權平均價(WeightedClose)減去當日均價的數值。這個數值如果是正的，表示到目前為止，今天進場的人大多是賺錢的。你也可以試看看切換不同的分鐘頻率。 「即時資料欄位」除了可以在自訂指標內使用之外，當然也可以在雷達內使用。接下來新增一個警示腳本，取名為「特大單買盤進場」，然後輸入以下的程式碼： 

```
value1 = GetField("買進特大單量", "1") - GetField("賣出特大單量", "1"); 
if value1 > 0 then ret=1;

```

把這個腳本加到策略雷達內，選擇1分鐘頻率，勾選逐筆洗價，K棒內單次觸發，指定你想要監控的商品，開始執行後如果當分鐘特大單是買超的話，策略雷達就會產生警示，提醒你這檔商品可能有大戶要開始進場了。 到這裡對於「即時資料欄位」這個新的功能是否有更清楚了呢？小編在這裡做個整理：「即時資料欄位」是盤中會即時更新的資料序列，主要的應用情境是分鐘頻率，支援自訂指標以及策略雷達（並不支援選股）。至於回測的功能，我們還在努力開發中，等可以使用時會盡快讓大家知道。 下一篇文章「 [Tick欄位的應用 ](https://www.xq.com.tw/lesson/xspractice/tick欄位的應用/‎)」我們將會為你介紹另外一個功能，有興趣的同學可以繼續看下去！ [

#####


---

# 私房交易策略之：強勢股整理結束

Source: https://www.xq.com.tw/lesson/xspractice/%E7%A7%81%E6%88%BF%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5%E4%B9%8B%E5%BC%B7%E5%8B%A2%E8%82%A1%E6%95%B4%E7%90%86%E7%B5%90%E6%9D%9F/

[
![私房交易策略之：強勢股整理結束@2x](/wp-content/uploads/2016/03/08.-私房交易策略之：強勢股整理結束@2x.png)
](/wp-content/uploads/2016/03/08.-私房交易策略之：強勢股整理結束@2x.png)作為一個操作者，我們對那些來不及上車的強勢股，也往往有莫可奈何的心情， 這樣的心情，如果用波浪理論來解釋，那就是在初昇段來不及參與之後，希望在主昇段發動前夕，來得及坐上車。 [
![20160310-01](/xstrader-content/uploads/2015/10/1017011.png)
](/wp-content/uploads/2016/03/20160310-01.png)為了尋找這一類的股票，我試著寫一個腳本，這個腳本有三個步驟 1.尋找特定日期以來漲幅最大，走勢最強的股票 2.這樣的股票，從這段時間以來的最高點到前一日的收盤，已修正一定的幅度 3.今天盤中該個股明顯走強。 在要寫這個腳本時，首先得先找出某特定日到最新的收盤價，一共是幾根Bar。這個函數就叫做 [GetBarOffset ](http://xshelp.xq.com.tw/index.aspx?HelpName=GetBarOffset&group=DATERELFUNC)。使用的方法是傳入某個日期，這個函數就會回傳從現在到該日期共隔了幾根Bar。 

```
Value1 = GetBarOffset(20151014);

```

如果今天是2015年10月15日，那上面的程式執行時Value1就會是1，代表是前一根bar。 有了這個函數，我就來寫出上面所提到的這個腳本 

```
input: stardate(20150824);
input:ratio(30);
input:ratio1(7);
input:ratio2(2);
setinputname(1,"輸入上漲起始日");
setinputname(2,"輸入上漲最低幅度");
setinputname(3,"輸入最小拉回幅度");
setinputname(4,"今日最低漲幅");
setfirstbardate(stardate);
value1=getbaroffset(stardate);//找出輸入的日期是在第幾根bar
value2=highest(high[1],value1+1);//找出這一波的最高點

condition1=false;
condition2=false;

if value2>=close[value1]*(1+ratio/100)//計算波段漲幅有沒有符合要求
then condition1=true;

if value2>=close[1]*(1+ratio1/100)//計算拉回的幅度夠不夠要求
then condition2=true;

if nthhighestbar(1,high,10)>=5//從最高點到今天超過五根bar
then begin
if condition1 and condition2 and close>=close[1]*(1+ratio2/100)
then ret=1;
end;
```

在解釋這個腳本之前，我們先來看一下大盤最近的走勢 [
![20160310-02](/xstrader-content/uploads/2015/10/1017021.png)
](/wp-content/uploads/2016/03/20160310-02.png)所以我上面寫的這個腳本，就是找出符合下面四個條件的股票 1.從8/24日以來，到最高點漲幅超過30%的股票 2.從最高點到前一個交易日的低點修正幅度超過7% 3.今天收盤比前一天收盤漲超過2% 4.從高點拉回整理超過五天。 這樣的腳本要尋找的，就是整理結束後的強勢股。 下面這張圖就是這個腳本今天跑出來的股票 [
![20160310-03](/xstrader-content/uploads/2015/10/101501.png)
](/wp-content/uploads/2016/03/20160310-03.png)當然不是每檔股票都會在初昇段之後就一定有主昇段，也不見得每檔股票都是休息了幾天後就開始再往上攻，不過這個策略的好處是，對於那些從特定日期以來走勢很強的股票，一旦整理結束，我們在第一時間就會收到電腦的通知，這樣的好處是我不必一直盯著強勢股等拉回結束。 這個腳本可以名列我的私房腳本第二名，介紹給大家，至於日期及漲幅，拉回幅度，這些參數就請大家自己調整囉! [

#####


---

# 處置開始日期＆處置結束日期

Source: https://www.xq.com.tw/lesson/xspractice/%E8%99%95%E7%BD%AE%E9%96%8B%E5%A7%8B%E6%97%A5%E6%9C%9F%EF%BC%86%E8%99%95%E7%BD%AE%E7%B5%90%E6%9D%9F%E6%97%A5%E6%9C%9F/

GetField("處置開始日期")、GetField("處置結束日期")這兩種資料在「資料欄位」與「選股欄位」都有建置，且所有腳本類型都有支援。 在7.12.01/3.12.01當中，新增了一個系統指標叫【處置期間】，根據這兩個欄位所建立。 可以在技術分析畫面上，點選右鍵→指標設定→新增主圖疊圖，查找系統／主圖指標／處置期間。 [
![](/wp-content/uploads/2023/10/1-1.png)
](/wp-content/uploads/2023/10/1-1.png)新增後就會如下圖所顯示，在開始處置的前一日(5/17)，即可取得即將開始處置的開始日期與結束日期(5/18~5/31)，另外以黃色小點標記受處置的期間在線圖底部。但是在5/22時又公告延長了處置的結束日期至6/7，所以處置期間的標記會延續到6/7處置結束為止。 [
![](/wp-content/uploads/2023/10/2-1.png)
](/wp-content/uploads/2023/10/2-1.png)同時也可以於上圖中看到，在5/18~6/7之後，到8月底之前，分別又進入過三次處置期間。 以下提供目前的範例腳本，供參考或修改成自訂指標： 

```
if BarFreq <> "d" and BarFreq <> "ad" then raiseruntimeerror("僅支援日與還原日頻率");

value1 = GetField("處置開始日期");
value2 = GetField("處置結束日期");
value3 = getField("Date");
if value1 = 0 then raiseruntimeerror("無處置的歷史紀錄");

//用點顯示處置區間
if value3 >= value1 and value3 <= value2 then plot1(value1,"處置中") //尚在處置中
else if value3 < value2[1] and value3 > value1[1] then plot1(value1,"處置中") //尚在處置中，但處置結束日期被更新
else noplot(1);

//用來顯示處置相關的日期數值
if value1 <> value1[1] or (value3 >= value1 and value3 <= value2) then begin
   plot3(value1,"開始日期");
   plot4(value2,"結束日期");
end else begin
   noplot(3);
   noplot(4);
end;
```

---
我們也可以在選股中心，利用這兩個欄位建置選股腳本，篩選出處置相關的策略，請參考以下範例： 1. 處置中 

```
settotalBar(5);
value1 = GetField("處置開始日期");
if value1 = 0 then return;

value2 = GetField("處置結束日期");
value3 = getField("Date");

if value3 >= value1 and value3 <= value2 then begin
   ret = 1;
   outputField1(value1,"處置開始日期");
   outputField2(value2,"處置結束日期");
end
else if value3 < value2[1] and value3 > value1[1] then begin
   ret = 1;
   outputField1(value1[1],"處置開始日期");
   outputField2(value2,"處置結束日期");
end else return;
```

以此腳本直接回測看看近10年，回測設定： [
![](/wp-content/uploads/2023/10/3.png)
](/wp-content/uploads/2023/10/3.png)回測結果： [
![](/wp-content/uploads/2023/10/4.png)
](/wp-content/uploads/2023/10/4.png)得到一個看似績效很好的回測報告，不過處置中的股票，不是想成交就能馬上成交的。 這只能說明在過去十年，在持有十天、無停利損的前提下，處置期間的股價表現趨勢。 2.明天進入處置 

```
settotalBar(3);
value1 = GetField("處置開始日期");
if value1 = 0 then return;

value2 = GetField("處置結束日期");
value3 = getField("Date");

if value1 <> value1[1] and value3 > value2[1] then ret = 1 else return;

outputField1(value1,"處置開始日期");
outputField2(value2,"處置結束日期");
```

以此腳本直接回測看看近10年，回測設定： [
![](/wp-content/uploads/2023/10/5.png)
](/wp-content/uploads/2023/10/5.png)回測結果： [
![](/wp-content/uploads/2023/10/6.png)
](/wp-content/uploads/2023/10/6.png)看起來比範例1來的實際一點，但是即便今天知道明天要進入處置，明天一樣不是想成交就能馬上成交的。 3.所以小幫手嘗試增加一個產業類別的濾網，把執行商品範圍限縮到【電子全部】： 編輯策略的畫面如下，請記得範圍要使用自訂，設成電子全部，與其花時間想破頭要增加哪種技術面或基本面濾網，直接用產業類別當濾網也可以。 [
![](/wp-content/uploads/2023/10/7.png)
](/wp-content/uploads/2023/10/7.png)[
![](/wp-content/uploads/2023/10/8.png)
](/wp-content/uploads/2023/10/8.png)用跟上方一樣的回測設定試試： [
![](/wp-content/uploads/2023/10/9.png)
](/wp-content/uploads/2023/10/9.png)回測結果： [
![](/wp-content/uploads/2023/10/10.png)
](/wp-content/uploads/2023/10/10.png)看起來得到比範例1績效更好的報表，但要先扛得住最大單筆虧損率、最大連續虧損率才有意義，如果把資金配置考慮進來，以及考慮更多實際操作時會面臨的狀況，報酬率一定會稀釋非常多。 那就請各位再按自身條件做調整與嘗試了，謝謝~ [

#####


---

# 計算區間漲跌幅的自訂函數

Source: https://www.xq.com.tw/lesson/xspractice/%E8%A8%88%E7%AE%97%E5%8D%80%E9%96%93%E6%BC%B2%E8%B7%8C%E5%B9%85%E7%9A%84%E8%87%AA%E8%A8%82%E5%87%BD%E6%95%B8/

在今天這一篇文章內要來跟大家說明一下 **函數 **的用途，什麼是函數，怎麼寫一個函數，以及如何在其他的腳本內運用自訂函數。 在設計XS的腳本時，可能會遇到一些在其他腳本內 **也會引用到的邏輯 **，例如我可能在好幾種選股法內都會想要檢查某個區間的漲跌幅，或者我可能在策略雷達內也想要依照某個區間的漲跌幅來做篩選。當腦袋裡面有這樣子常用的邏輯出現時，我們就可以試著把這段邏輯寫成一個XS的自訂函數，然後在不同的腳本內去引用這個函數，以後如果這個邏輯有需要調整的話，就只需要修改自訂函數的內容，不需要每個腳本都還要去調整。 撰寫自訂函數的方式跟撰寫腳本沒有很大的差別。首先從XScript編輯器內，點選檔案/新增，這時候要記得要選函數這個選項，然後輸入一個名稱， **這個名稱必須是英文的 **。另外在此時也要決定這個函數做完之後要回傳什麼樣子的資料給使用函數的腳本。 以計算區間漲跌幅這個函數而言，我們希望算出來的數值就是漲跌幅，所以我們就選擇「數值」，表示這是一個數字。其他的選項還包含字串，或是邏輯值(True/False)。 [
![0401_1](/wp-content/uploads/2016/03/0401_1-1.png)
](/wp-content/uploads/2016/03/0401_1-1.png)設定好了之後，按確認，接下來就跟寫其他腳本一樣可以開始寫函數了。 

```
 
 input:price(numeric);
 input:startday(numeric);
 input:endday(numeric);

 value1=getbaroffset(startday);
 value2=getbaroffset(endday);

 value3=(price[value2]/price[value1])-1 ;
 rangechange=value3*100;

```

有幾個撰寫自訂函數腳本時，要稍加留意之處： 

- 自訂函數的名稱一定要是英文的， 
- 在訂定函數內有一個特殊的變數，他的名字就是這個函數的英文名稱。如果計算完成之後要把數值回傳的話，必須把數值傳給這個變數。注意看上面這個例子內的這一行裡面的rangechange就是這個函數的名字，所以這一行表示這個函數算完之後的回傳值就是value3 \* 100： 

```
rangechange=value3*100;

```

- 自訂函數一樣可以使用input語法來設定參數。可是參數名稱後面括號後不能直接打預設值，而是要寫這個參數的資料格式：如果是數值的話，就寫Numeric，如果是字串的話，就寫String，如果是邏輯值的話，就寫TrueFalse。其他還有更複雜的傳遞格式，就容我們在其他文章內再為大家介紹。 [](/xstrader-content/uploads/2016/02/函數的參數格式.png)
有了這個函數，要寫區間漲跌幅的選股腳本就容易多了: 

```
input:startday(20150702,"區間起始日");
input:endday(20151002,"區間結束日");
input:ratio(10,"最低漲幅");

value1=rangechange(close,startday,endday);
if value1>=ratio
then ret=1;
 
value2=GetField("最新股本");
value3=GetField("月營收年增率","M");
value4=GetField("股價淨值比","D");
outputfield(1,value1,1,"區間漲跌幅");
outputfield(2,value2,0,"股本(億)");
outputfield(3,value3,1,"月營收年增率");
outputfield(4,value4,1,"股價淨值比");


```

除了計算區間漲跌幅之外，在這個腳本內我們也使用了outputfield的方式，把我們想要觀察的欄位都印出來，方便一起檢視。 根據這個選股腳本，從今年一月三日到昨天，漲幅超過三成的股票如下: [
![20160310c-02](/wp-content/uploads/2016/03/20160310c-02.png)
](/wp-content/uploads/2016/03/20160310c-02.png)一共35檔股票，從這些檔位中可以發現： 1. 股本除了中鴻144億之外，全部都在40億以下，30億以上的也只有鎧勝及揚智兩家。 2. 接近三分之二的股票月營收年增率有兩位數成長 3. 其中一半股價淨值比在二以下。 有了區間漲跌幅這個自訂函數，以及outputfield這個輸出特定資料欄位的語法，我們可以很快的挑出特定區間漲幅或跌幅超過一定比例的股票，並且以我們希望呈現的欄位，加以排序。這對我們在作功課時，有不少的幫助。 [

#####


---

# SetBackBar指定頻率設定資料筆數

Source: https://www.xq.com.tw/lesson/xspractice/%E8%A8%AD%E7%BD%AE%E6%8C%87%E5%AE%9A%E9%A0%BB%E7%8E%87%E5%BC%95%E7%94%A8%E7%AD%86%E6%95%B8%E7%9A%84%E6%87%89%E7%94%A8/

舊版在撰寫GetField指定跨大頻率的運算條件，例如以下範例交易腳本語法 

```
//交易策略執行頻率請設定5分鐘
//
//進場條件
//收盤價在20日均線之上
//且 5 分鐘K棒突破過去三根K棒最高價
//
//出場條件
//收盤價在20日均線之下
//且 5 分鐘K棒跌破過去三根K棒最高價
input:Davglength(20,"日均線期數"), Hlength(3, "近N根5分K棒最高價");

settotalBar(Davglength*54);

condition1 = close > average(GetField("收盤價", "D"),Davglength);
condition2 = close cross Above highest(high[1], Hlength);
condition11= close < average(GetField("收盤價", "D"),Davglength);
condition21= close cross under highest(high[1], Hlength);

if condition1 and condition2 and filled = 0 then
setposition(1,market);

if condition11 and condition21 and filled <> 0 then 
setposition(0,market);
```

上述範例在跑台股商品時，因為要用5分K棒組成日K棒來運算範例的20日均線數值，所以資料筆數需要設定到54(一天54根5分K)×20(均線期數)＝1080筆，也就是使用settotalBar(Davglength\*54)這行語法或者在介面上設定足夠的資料筆數，才能成功執行交易或雷達策略。 如果資料筆數設定不足，會因為GetField指定日頻率資料筆數不足夠的關係，導致雷達或交易策略在洗價時發生錯誤，有關資料筆數的說明可以參考 [資料讀取範圍與腳本執行的關係 ](https://www.xq.com.tw/lesson/xspractice/資料讀取範圍與腳本執行的關係/)此篇文章說明。 在v7.06.01版本中，此範例可以使用 setbackbar(20,"D"); 直接將GetField指定頻率的資料引用筆數設定充足，主頻率5分K只要設定三筆即可執行成功交易或雷達策略，如下範例交易腳本語法 

```
//交易策略執行頻率請設定５分鐘
//
//進場條件
//收盤價在20日均線之上
//且 5 分鐘K棒突破過去三根K棒最高價
//
//出場條件
//收盤價在20日均線之下
//且 5 分鐘K棒跌破過去三根K棒最高價
input:Davglength(20,"日均線期數"), Hlength(3, "近N根5分K棒最高價");
settotalBar(Hlength);
setbarBack(Davglength,"D"); // 在 v7.06 版本添加 setbackbar 指定頻率調整資料引用筆數

condition1 = close > average(GetField("收盤價", "D"),Davglength);
condition2 = close cross Above highest(high[1], Hlength);
condition11= close < average(GetField("收盤價", "D"),Davglength);
condition21= close cross under highest(high[1], Hlength);

if condition1 and condition2 and filled = 0 then
setposition(1,market);

if condition11 and condition21 and filled <> 0 then 
setposition(0,market);
```

有了setbackbar指定頻率設定資料引用筆數後，在此範例使用 setbarBack(Davglength,"D"); 來調整日頻率資料的引用筆數，就可以讓使用者簡便設定足夠的資料引用筆數，排除GetField指定頻率多期數運算時需要設定龐大資料筆數的困擾。 另外資料準備速度方面 ，可以發現運用 SetBackBar設定指定頻率資料引用筆數比SetTotalBar方式還要快速 ，如下圖執行紀錄比較結果 。值得注意的是，這張圖是單一商品與5分跨20日均線運算結果，若是多商品與跨更多日均線的運算，則資料準備速度差異會更大。 [
![](/wp-content/uploads/2021/08/螢幕快照-2021-08-09-上午11.27.04.png)
](/wp-content/uploads/2021/08/螢幕快照-2021-08-09-上午11.27.04.png)以上是Setbackbar指定頻率設定引用筆數相關應用介紹，有了Setbackbar指定頻率設定資料用筆數功能後，就能取代SetTotalBar設定龐大的資料筆數，加快交易策略或者雷達策略的資料準備運行速度，感謝大家的收看，咱們下次再會。 [

#####


---

# SetTotalBar資料讀取範圍與腳本執行的關係

Source: https://www.xq.com.tw/lesson/xspractice/%E8%B3%87%E6%96%99%E8%AE%80%E5%8F%96%E7%AF%84%E5%9C%8D%E8%88%87%E8%85%B3%E6%9C%AC%E5%9F%B7%E8%A1%8C%E7%9A%84%E9%97%9C%E4%BF%82/

當你在設定XS警示時，有沒有注意到有一個設定資料讀取範圍的參數，可以從這裡選擇筆數或是起始日期。這個參數的用意到底是什麼呢？在這一篇文章內就讓我們來為大家說明。 [
![警示資料讀取範圍設定](/wp-content/uploads/2016/03/SensorTB.png)
](/wp-content/uploads/2016/03/SensorTB.png)在 [XS語法入門 ](https://www.xq.com.tw/learn/xscript/xs/)內，我們有提到XS執行時的觀念是類似K線圖一樣，由左往右一筆一筆的執行。 [
![BarSequence](/wp-content/uploads/2016/01/BarSequence.png)
](/wp-content/uploads/2016/01/BarSequence.png)而資料讀取範圍的這個參數，就是用來設定 **腳本要從哪裡開始執行起 **。如果你指定10筆的話，那系統就會提供 **最近10筆的K棒 **，然後從這10筆的第一根K棒(編號1)開始往右執行： [
![TB_1](/wp-content/uploads/2016/03/TB_1.png)
](/wp-content/uploads/2016/03/TB_1.png)在上圖內藍色這個區塊就是資料讀取範圍，這個數值的定義根據不同腳本類型而異： **腳本類型 ****資料讀取範圍 **指標 指標總共要畫多少筆K棒，不包含當日即時的K棒範圍。 預設值是商品的全部資料長度。 警示 警示腳本要先執行多少筆之後開始進行即時的洗價以及是否要觸發。請注意這個範圍不包含當日即時的K棒。預設值是200。假設資料讀取範圍是10的話，那警示腳本會先執行當日之前的10根K棒，接下來執行當日即時的K棒，接下來等待收到即時資料後在執行時才會判斷是否要觸發。 選股 選股腳本要執行多少筆之後才判斷最後一根K棒是否觸發。 預設值是10。假設資料讀取範圍是10的話，則表示選股腳本總共要跑10筆資料，同時判斷第10筆資料是否ret=1。 那我們設定資料讀取範圍時，到底該用什麼樣子的數值才對呢？這個問題沒有一個標準答案，必須依照腳本的內容來判斷。有一些指標，例如EMA均線，或是MACD指標，由於計算時會不斷的引用前一筆計算的數值做累計的平均，像這樣子的腳本，就會需要一個比較大的資料讀取筆數。反之，如果一個腳本內只會使用到最近固定期別的數字的話，那資料讀取筆數就不用設的很大。 資料讀取參數除了可以指定最近筆數之外，也可以指定一個固定的起始日期，這樣子可以方便使用者有更精準的控制。另外如果實際上這個商品並沒有那麼多筆資料的話，系統就會自動調整資料讀取筆數，以商品有的資料為基準。 

### **最大引用範圍 **
執行腳本時，除了資料讀取筆數這個參數會影響腳本執行的筆數之外，另外由於腳本內常常需要讀取之前的資料來做計算，例如要計算3日收盤價平均值時，會引用到上一根K棒的收盤價以及上上一根K棒的收盤價： 

```
1Value1 = (Close + Close[1] + Close[2]) / 3;
```

**所以在腳本要執行之前，系統除了要準備資料讀取範圍內的K棒資料之外，另外也需要往前多準備一些K棒資料： **[
![TB_2](/wp-content/uploads/2016/03/TB_2.png)
](/wp-content/uploads/2016/03/TB_2.png)在上面圖示內，資料讀取範圍左邊的這一個黃色區塊，就叫做 **最大引用範圍 **。這個範圍的目的是為了讓腳本可以正確的參考到 **目前執行的這根K棒往前的資料 **。同樣的，這個範圍的大小，會跟腳本內會參考到幾期前的資料有關。系統在開始執行時會提供一個預設值，如果在執行過程內腳本參考到了範圍之外的資料而發生錯誤的話，系統還是會繼續執行，改由下一根K棒開始重新計算。 在下面這張圖內，假如腳本的內容是 

```
1Value1 = Close - Close[5]; {計算５日漲幅}
```

由於最大引用筆數只有4筆，所以腳本要去讀取Close[5]的時候會發生錯誤。這時候系統就會重新調整執行的範圍，從發生錯誤的下一筆開始重新執行。 [
![TB_3-1](/wp-content/uploads/2016/03/TB_3-1.png)
](/wp-content/uploads/2016/03/TB_3-1.png)***發生錯誤之後系統自動重新調整最大引用範圍 ***[
![TB_4](/wp-content/uploads/2016/03/TB_4.png)
](/wp-content/uploads/2016/03/TB_4.png)注意到系統會往右一筆 **重新執行 **，讓最大引用範圍變大，這樣子一來，執行的筆數會變少，可是就不會發生錯誤了。由於系統執行時會自動處理這種情形，使用者在大部分的情形底下可以完全忽略最大引用範圍這個參數。可是如果腳本的引用範圍很大的話，那則可以從腳本內透過函數的呼叫來告訴系統這個參數，已減少執行時發生錯誤的機會。這部分在底下會有範例說明。 講完了基本的觀念之後，接下來我們來看不同類型的腳本的設定方式。 

### **XS自訂指標 **
在技術分析圖形上面放入XS自訂指標時，目前系統預設指標腳本的資料讀取筆數就是 **這個商品的全部歷史資料 **，技術分析的設定畫面上也就不提供指定資料讀取範圍的參數，你只要把指標放到技術分析圖上面就對了！！ 針對特殊的情境，可以在屬性設定的視窗，直接指定計算資料的長度或起始日。 [
![IndicatorTB](/wp-content/uploads/2016/03/IndicatorTB.png)
](/wp-content/uploads/2016/03/IndicatorTB.png)或是可以透過以下的函數從腳本內控制指標資料的長度： 

```
1SetTotalBar(300);
```

如果在指標腳本內引用SetTotalBar(300)的話，那這個指標就只會畫最新的300筆資料(不包含當日即時的資料)。如果你希望可以從某個指定日期開始畫圖，可以使用這一版新提供的SetFirstBarDate函數： 

```
1SetFirstBarDate(20150101);
```

這樣子的話指標就會從20150101日開始畫圖。 至於最大引用範圍這個參數，系統會根據使用者指定的資料範圍來推算一個預設值。使用者也在腳本內透過SetBackBar這個函數來做控制： 

```
1SetBackBar(50);
```

另外還有一個 SetBarBack函數，他的用途跟SetBackBar是一模一樣的。 

### **XS策略雷達 **
設定警示畫面內可以指定資料讀取筆數或是第一筆資料的日期： [
![警示資料讀取範圍設定](/wp-content/uploads/2016/03/SensorTB.png)
](/wp-content/uploads/2016/03/SensorTB.png)進階的使用者也可以從腳本內直接透過 SetTotalBar 或是 SetFirstBarDate 這兩個函數來控制資料讀取筆數。同樣的，在腳本內也可以透過 SetBackBar函數來控制最大引用筆數。 

### **XS選股 **
設定選股策略時可以指定資料讀取筆數或是第一筆資料的日期： [
![選股腳本資料讀取範圍](/wp-content/uploads/2016/03/FilterTB.png)
](/wp-content/uploads/2016/03/FilterTB.png)進階的使用者也可以從腳本內直接透過 SetTotalBar 或是 SetFirstBarDate 這兩個函數來控制資料讀取筆數。 至於最大引用筆數這個參數，在XS選股系統內由於執行時已經事先讀取了全部的資料，所以使用者不需要再做設定。 以上為大家介紹了資料讀取筆數的觀念，以及設定的方式。相關的函數請參考 [函數說明文件 ](http://xshelp.xq.com.tw/index.aspx?HelpName=SetTotalBar&group=GENERALFUNC)。有任何問題或是建議的話，也歡迎您隨時跟我們說喔。 [

#####


---

# 選股中心創掛牌新高與大單欄位的應用

Source: https://www.xq.com.tw/lesson/xspractice/%E9%81%B8%E8%82%A1%E4%B8%AD%E5%BF%83%E5%89%B5%E6%8E%9B%E7%89%8C%E6%96%B0%E9%AB%98%E8%88%87%E5%A4%A7%E5%96%AE%E6%AC%84%E4%BD%8D%E7%9A%84%E6%87%89%E7%94%A8/

大家好，在7.05.05與3.05.05版本，選股中心新增以下兩個項目，在本文中將為大家做介紹： [](#)

- [創公司掛牌新高的選股條件與語法應用 ](#learn01)
- [大單相關的選股條件與語法應用 ](#learn02)

## 

### **創公司掛牌新高的選股條件與語法應用 **
先前常常收到客戶反應，想要篩選出「月營收創歷史新高」 這樣子的公司，可是礙於不知道這家公司歷史以來到底有多少期資料， 所以無法辦到。 針對這個需求，在這次的版本中，我們針對「月營收」與「 每股稅後淨利(元)」的這兩個欄位時，提供了「 創公司掛牌後新高」的內建條件。請參考下圖。 [
![](/wp-content/uploads/2021/06/20210622_start.png)
](/wp-content/uploads/2021/06/20210622_start.png)「創公司掛牌後新高」的判斷方式，是透過這次改版新增的 [GetFieldStartOffset ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetFieldStartOffset&group=GENERALFUNC)語法。這個語法可以讓你抓到這個欄位第一筆的位置， 知道這個欄位總共有多少筆之後， 腳本就可以很容易的判斷目前最新一期數值到底是不是新高了。 如果除了「月營收」跟「每股稅後淨利(元)」之外， 你想要運用在其他欄位的話，可以參考以下的寫法： 

```
value1 = GetFieldStartOffset("月營收", "M");
if value1 = 0 then begin 
 ret = 1; // 只有1期, 就當成創新高了吧
 outputField1(GetField("月營收", "M"),"月營收");
end else if value1 > 0 then begin
 // 算出前N期的最大值
 value2 = Highest(GetField("月營收", "M")[1], value1);
 if GetField("月營收", "M") > value2 then ret = 1;
 outputField1(GetField("月營收", "M"),"月營收");
end;
```

請注意： [GetFieldStartOffset ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetFieldStartOffset&group=GENERALFUNC)目前僅支援選股腳本。 另外 [GetFieldStartOffset ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetFieldStartOffset&group=GENERALFUNC)所定義的第一筆資料 的位置，是依照公司上市櫃日期所決定的，不包含興櫃期間的資料。 [](#)

## 

### **大單相關的選股條件與語法應用 **
在7.02/3.02版時，我們推出了大單相關的欄位(包含買進大單量， 賣出大單量等)，當時這些欄位僅能在策略雷達/自動交易端使用。 在這個版本內，XS選股也同步支援這些欄位。 在XS選股中心內， 新增條件時可以直接找到這些欄位以及相關條件直接使用。 [
![](/wp-content/uploads/2021/06/20210622_選股規則.png)
](/wp-content/uploads/2021/06/20210622_選股規則.png)當然，你也可以從選股腳本內直接使用這些欄位。 以下是一個腳本範例，用來篩選大戶買超的股票， 大戶的定義是（買進特大單＋買進大單）－（賣出特大單＋賣出大單）＞ 0的股票。 

```
value801 = GetField("買進特大單量", "D") + GetField("買進大單量", "D");
value802 = GetField("賣出特大單量", "D") + GetField("賣出大單量", "D");
value888 = value801 - value802;
//大單買超 = (買進特大單+買進大單)-(賣出特大單+賣出大單) > 0
if value888 > 0 then ret = 1;
outputField1(value888,"大單買超由大到小排名",order:=1);
```

[
![](/wp-content/uploads/2021/06/20210624_大單買超.png)
](/wp-content/uploads/2021/06/20210624_大單買超.png)以下這張表格，是此次新增的選股欄位與說明表格，詳細的介紹可點選連結查閱，有了這些選股欄位，投資人就能在盤前先做功課，運用選股中心篩選出來的結果，觀察近期大戶資金布局在何處，搶得先機。 選股欄位名稱 說明 [內盤成交次數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E5%85%A7%E7%9B%A4%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FILTER)/ [外盤成交次數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E5%A4%96%E7%9B%A4%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FILTER)當日的成交筆數/以內盤成交的成交筆數/以外盤成交的成交筆數 [買進特大單量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E8%B2%B7%E9%80%B2%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%8F&group=FVOLUME)/ [買進大單量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E8%B2%B7%E9%80%B2%E5%A4%A7%E5%96%AE%E9%87%8F&group=FVOLUME)/ [買進中單量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E8%B2%B7%E9%80%B2%E4%B8%AD%E5%96%AE%E9%87%8F&group=FVOLUME)/ [買進小單量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E8%B2%B7%E9%80%B2%E5%B0%8F%E5%96%AE%E9%87%8F&group=FVOLUME)依照單筆交易金額分級，統計當日以外盤成交的特大單/大單/中單/小單的成交量(張數) [賣出特大單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%8F&group=FVOLUME)/ [賣出大單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%A4%A7%E5%96%AE%E9%87%8F&group=FVOLUME)/ [賣出中單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E4%B8%AD%E5%96%AE%E9%87%8F&group=FVOLUME)/ [賣出小單量 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%B0%8F%E5%96%AE%E9%87%8F&group=FVOLUME)依照單筆交易金額分級，統計當日以內盤成交的特大單/大單/中單/小單的成交量(張數) [買進特大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)/ [買進大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)/ [買進中單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E4%B8%AD%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)/ [買進小單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%B0%8F%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)依照單筆交易金額分級，統計當日以外盤成交的特大單/大單/中單/小單的成交金額(元) [賣出特大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E7%89%B9%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)/ [賣出大單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%A4%A7%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)/ [賣出中單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E4%B8%AD%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)/ [賣出小單金額 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%B0%8F%E5%96%AE%E9%87%91%E9%A1%8D&group=FVOLUME)依照單筆交易金額分級，統計當日以內盤成交的特大單/大單/中單/小單的成交金額(元) [買進特大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E7%89%B9%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)/ [買進大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)/ [買進中單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E4%B8%AD%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)/ [買進小單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B2%B7%E9%80%B2%E5%B0%8F%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)依照單筆交易金額分級，統計當日以外盤成交的特大單/大單/中單/小單的成交筆數 [賣出特大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E7%89%B9%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)/ [賣出大單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%A4%A7%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)/ [賣出中單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E4%B8%AD%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)/ [賣出小單成交次數 ](https://xshelp.xq.com.tw/XSHelp/index?HelpName=%E8%B3%A3%E5%87%BA%E5%B0%8F%E5%96%AE%E6%88%90%E4%BA%A4%E6%AC%A1%E6%95%B8&group=FVOLUME)依照單筆交易金額分級，統計當日以內盤成交的特大單/大單/中單/小單的成交筆數 

以上就是在 7.05.05 / 3.05.05 版本新增的XS選股相關欄位與語法應用，感謝大家的聆聽，XS團隊會持續規劃增強相關語法功能與應用，陪伴投資人一同茁壯成長，希望能助投資人一臂之力，以利使用者在投資道路上更加順心。 
[

#####


---

# 選股欄位放大鏡：談OutputField跟GetFieldDate這兩個函數

Source: https://www.xq.com.tw/lesson/xspractice/%E9%81%B8%E8%82%A1%E6%AC%84%E4%BD%8D%E6%94%BE%E5%A4%A7%E9%8F%A1%EF%BC%9A%E8%AB%87outputfield%E8%B7%9Fgetfielddate%E9%80%99%E5%85%A9%E5%80%8B%E5%87%BD%E6%95%B8/

在 [


---

# 那些股票中長紅之後還會續漲?

Source: https://www.xq.com.tw/lesson/xspractice/%E9%82%A3%E4%BA%9B%E8%82%A1%E7%A5%A8%E4%B8%AD%E9%95%B7%E7%B4%85%E4%B9%8B%E5%BE%8C%E9%82%84%E6%9C%83%E7%BA%8C%E6%BC%B2/

[
![那些股票中長紅之後還會續漲](/wp-content/uploads/2016/03/06.-那些股票中長紅之後還會續漲@2x.png)
](/wp-content/uploads/2016/03/06.-那些股票中長紅之後還會續漲@2x.png)江湖走久了，高手看的自然較多，有一門派代有才人出，這門派的心法只有一個~追強勢股。 有的盤中追漲停，有的開盤追今天最強的，有的尾盤追第一根長紅棒，今天要跟大家分享的，就是如果您在尾盤追中長紅的股票，隔天怎麼判斷這檔股票會續強還是得快落跑。 下圖是前天漲幅超過3%且今天成交量超過1000張的股票 [
![20160309-01](/wp-content/uploads/2016/03/20160309-01.png)
](/wp-content/uploads/2016/03/20160309-01.png)從這張圖我們可以發現，前一天中長紅之後，隔天還能續強的，基本上大致有兩個共同的特色 

- 成交量比前一日增加 
- 外盤追高的比例較高 
這兩點其實用市場常用的概念，就是在前一天拉高後，我們要觀察的就是: 

- 後續追高的意願強不強。 
- 拉上來之後，往下倒的力道大不大。 
基於這種觀察，我們可以透過XS的一個選股腳本，以及一個策略雷達腳本，組合成一個跨頻率的交易策略。 首先，我們可以先用日線找出前一日漲幅超過3%且成交量超過500張的股票 我們可以寫一個選股腳本如下: 

```
if close>=close[1]*1.03 and volume>500
then ret=1;

```

如此一來，我們可以如下圖般，在選股中心新增一個選股叫前一日中長紅，然後加入排程，讓電腦每天幫我們找到符合條件的股票。 [
![20160309-02](/wp-content/uploads/2016/03/20160309-02.png)
](/wp-content/uploads/2016/03/20160309-02.png)然後接下來，我們要寫一個腳本，在盤中來確認那些股票成交量有比前一天高， XS有一個 估計量 的 報價欄位 ，我們可以利用這個欄位寫一個策略雷達來找出 今天預估量會超過昨天成交量且外盤量比內盤量大的股票 ，寫法很簡單如下： 

```
value1=q_InSize;//當日內盤量
value2=q_OutSize;//當日外盤量
if GetQuote("估計量") > volume[1]
and value2>value1
then ret=1;
```

接下來，我們來把選股腳本跟策略雷達串在一起 請參考下圖 [
![20160309-03](/wp-content/uploads/2016/03/20160309-03.png)
](/wp-content/uploads/2016/03/20160309-03.png)[](/xstrader-content/uploads/2015/07/070703.png)我們透過選股中心，每天找出"前一日中長紅"的股票，然後新增一個策略雷達，用上面所寫的這個"預估量超過昨天成交量"這個腳本，然後在設定指定範圍時，按下最右方的選股，然後在"挑選選股策略"這個跳出來的視窗中，選擇"前一日中長紅"的股票，這樣就可以在盤中找出前一天中長紅，今天成交量會比昨天大且外盤量比內盤量大的股票了。 [

#####


---

# 關於背離的寫法

Source: https://www.xq.com.tw/lesson/xspractice/%E9%97%9C%E6%96%BC%E8%83%8C%E9%9B%A2%E7%9A%84%E5%AF%AB%E6%B3%95/

有讀者問到，XS有沒有辦法判斷指標是否背離。今天這一篇文章內就來跟大家探討背離的寫法。 首先，XS內建函數中有一個叫作線性回歸斜率(linearregslope)，如果您在腳本編輯器中按F1，會跳到函數的說明頁，您輸入linearregslope按enter，會看到以下的說明： [
![20160310-01](/wp-content/uploads/2016/03/20160310b-01.png)
](/wp-content/uploads/2016/03/20160310-01.png)什麼是線性迴歸呢？ [
![20160310-02](/wp-content/uploads/2016/03/20160310b-02.png)
](/wp-content/uploads/2016/03/20160310-02.png)就像上圖一樣，我們找出一條線， 這條線距離所有要計算的價位最近，就是所謂的線性迴歸，透過線性迴歸，我們可以找出價位群體的方向，這條線的斜率就是linearregslope。 當數據呈現上昇分佈時，線性迴歸的斜率是正的，下降分佈時，線性迴歸的斜率是負的。 小編運用這個原理，寫出以下的背離函數： 

```
input:price(numericsimple),index1(numericsimple),length(numericsimple);
if length<5
then raiseruntimeerror("計算期別請超過五期");

value1=linearregslope(price,length);
value2=linearregslope(index1,length);

if value1>0 and value2<0
then deviate=-1
else
　　if value1<0 and value2>0
　　then deviate=1
　　else
　　　　deviate=0;

```

透過這個函數，我們就可以比較兩個數列，看看他們是否出現背離的情況，這個函數的寫法是當第一個值下跌而第二個值上昇時，函數的回傳值是 1 ，相反的則是-1 ，若兩個值同方向則是傳回0。 假設我們想找出收盤價下跌，但跟10日RSI上昇的股票，我們就可以運用這個函數，寫出下面這樣的腳本： 

```
value1=rsi(close,10);
if deviate(close,value1,10)=1
then ret=1;
```

有了這個函數，我們就可以隨時把兩個時間序列拿出來檢定是否有背離的現象了。 今天就為大家介紹到此，有任何建議的話歡迎隨時跟我們講喔。下次見。 [

#####


---

# 集保相關欄位調整

Source: https://www.xq.com.tw/lesson/xspractice/%E9%9B%86%E4%BF%9D%E7%9B%B8%E9%97%9C%E6%AC%84%E4%BD%8D%E8%AA%BF%E6%95%B4/

XQ 針對集保中心每週收盤後所提供的股東統計資料欄位，包含大戶持股比例/人數、散戶持股比例/人數等選股欄位進行調整。 以下我們會說明調整的原因，調整後的行為，以及如何事先調整腳本來因應此次的修改。 

### **1. 調整原因 **
集保中心會定期公佈每檔股票當週的各級股東的人數，張數，比例等數字。這些欄位包含”大戶持股比例”, “大戶持股人數”, “大戶持股張數”, “散戶持股比例”, “散戶持股人數”, “散戶持股張數”, “總持股人數”, “集保張數”, 以及 “集保張數佔發行張數百分比”等。 例如以下的選股腳本: 

```
value1 = GetField(“大戶持股比例”, “W”, param:=1000); // 千張大戶持股比例
```

這些欄位資訊一般都是在星期六上午公佈當週的持股統計，所以如果是執行選股的話，通常要在星期六/日才有辦法取得該週的資料。 由於目前XS是把這些欄位標示成週頻率，每一週一筆，所以在使用歷史資料進行回測時，只要回測運算的那根K棒位於同一週的話，腳本就可以看到這一筆資料，產生了偷看到 未來資料 的問題。 例如以下的選股腳本： 

```
value1 = GetField("大戶持股人數", "W", param:=1000);

value2 = GetField("大戶持股人數", "W", param:=1000)[1];

condition1 = value1 > value2;

if condition1 then ret=1;

Print(

  FormatDate("yyyy/MM/dd", Date), 

  NumToStr(value1, 0), NumToStr(value2, 0), condition1);
```

如果回測的區間是2023/06/05 ~ 2023/06/21，執行商品為00878.TW的話，那麼目前XS跑出來的資料是這樣子的： 
---
2023/06/05 125 122 TRUE 2023/06/06 125 122 TRUE 2023/06/07 125 122 TRUE 2023/06/08 125 122 TRUE 2023/06/09 125 122 TRUE 2023/06/12 124 125 FALSE 2023/06/13 124 125 FALSE 2023/06/14 124 125 FALSE 2023/06/15 124 125 FALSE 2023/06/16 124 125 FALSE 2023/06/19 123 124 FALSE 2023/06/20 123 124 FALSE 2023/06/21 123 124 FALSE 
---
在6/5日這一天，XS就認為當週的千張大戶股東人數比上一週增加。可是事實是這樣子嗎？ [
![](/wp-content/uploads/2023/07/集保相關欄位調整01-235x300.png)
](/wp-content/uploads/2023/07/集保相關欄位調整01.png)從股權分散表的圖看起來，6/5日到6/9日那一週千張大戶人數是125人，的確是比上一週增加的，可是如果我們時間回推到6/5日那一週，因為交易所是 在週末才公佈當週的大戶持股人數 ，所以6/5日，6/6日這幾天，使用者是沒有辦法知道這件事情的！使用者必須等到6/9日收盤後(星期五)，通常要等到6/10日(星期六)時如果執行選股的話，才會知道這件事情。 也就是說目前XS回測的結果，會讓使用者提前知道當週收盤後才會發生的事情，那麼回測的績效就會產生偏差。 目前為了解決這樣子的問題，有用戶很聰明的在腳本內加入了以下的判斷方式： 

```
var: sameweek(0);

if GetInfo("FilterMode") = 1 then  

    sameweek = 0 

else

    sameweek = 1; 

value1 = GetField("大戶持股人數", "W", param:=1000)[sameweek];

value2 = GetField("大戶持股人數", "W", param:=1000)[sameweek+1];

condition1 = value1 > value2;

if condition1 then ret=1;

Print(

  FormatDate("yyyy/MM/dd", Date), 

  NumToStr(value1, 0), NumToStr(value2, 0), condition1);


```

在紅字的部分，腳本內利用 GetInfo("FilterMode") 來判斷目前是跑選股，還是跑選股回測/回溯，如果是跑回測/回溯的話，那麼抓取大戶持股資料時，就往前偏一期，也就是說不抓當週的資料，改抓上一週的資料。 這樣子跑出來的資料是長這個樣子的： 
---
2023/06/05 122 129 FALSE 2023/06/06 122 129 FALSE 2023/06/07 122 129 FALSE 2023/06/08 122 129 FALSE 2023/06/09 122 129 FALSE 2023/06/12 125 122 TRUE 2023/06/13 125 122 TRUE 2023/06/14 125 122 TRUE 2023/06/15 125 122 TRUE 2023/06/16 125 122 TRUE 2023/06/19 124 125 FALSE 2023/06/20 124 125 FALSE 2023/06/21 124 125 FALSE 
---
在6/5日到6/8日之間，這時候腳本就不認為千張大戶股東人數增加(正確)。 可是，6/9日那一天也不認為有增加，腳本要等到6/12日(星期一)才會認為真的增加了。 這代表著，使用者要等到星期一下午收盤時(因為這是執行選股，每日收盤後資料才會異動)才會發現千張大戶股東人數增加了，可是事實上，因為資料是星期五收盤後就公佈了，所以星期一開盤前市場上的人就都已經知道這件事情了!! 也就是說透過自行偏移一期的方式，雖然可以解決提前偷看資料的問題，可是也產生了訊號延後到星期一收盤後才會產生的問題。 

### **2. 調整方式 **
為了讓腳本抓取資料的期別可以跟事實一致，在新版的環境內(預計2023/7月中旬上線)，XS選股中心會改成 依照集保公布的日期來決定腳本可以看到的資料期別 ，不管是跑選股，選股回溯，或是選股回測，都不會發生取到未來資料的狀況。簡單來說，只要使用 GetField("大戶持股比例", "W")， 系統就會自行判斷在當下的那個時間點腳本應該要看到的大戶持股比例資料，使用者再也不需要在腳本內自行決定是否需要抓取當期值還是前期值。 以下是第一版的腳本，在新版環境內看到的數值： 
---
2023/06/05 122 129 FALSE 2023/06/06 122 129 FALSE 2023/06/07 122 129 FALSE 2023/06/08 122 129 FALSE 2023/06/09 125 122 TRUE 2023/06/12 125 122 TRUE 2023/06/13 125 122 TRUE 2023/06/14 125 122 TRUE 2023/06/15 125 122 TRUE 2023/06/16 124 125 FALSE 2023/06/19 124 125 FALSE 2023/06/20 124 125 FALSE 2023/06/21 123 124 FALSE 
---
注意到在6/5日到6/8日，此時抓到的是上一週的數值，所以千張持股人數不會增加。可是6/9日(星期五)這一天，抓到的會是當週收盤後所公佈的更新數值(125人)，所以從選股的角度而言，星期五收盤後就會觸發這個條件，用戶可以在星期一開盤時進場。 

### **3. 腳本因應方式 **
**(1)依照新舊版環境決定是否要抓取前期值 **如果您原先的選股腳本並沒有針對現行集保欄位會偷看到答案做任何處理的話，那麼您的腳本無須做任何修改。 可是如果您已經使用類似GetInfo(“FilterMode”)的機制來判斷是否要抓當期或是前一期的資料，那麼我們建議您可以先做這樣子的修改，避免系統上線時抓錯資料。 

```
var: sameweek(0);

if GetInfo("TDCC_Mode") = 0 then begin

    if GetInfo("FilterMode") = 1 then  

        sameweek = 0 

    else

        sameweek = 1; 

end;

value1 = GetField("大戶持股人數", "W", param:=1000)[sameweek];

value2 = GetField("大戶持股人數", "W", param:=1000)[sameweek+1];

condition1 = value1 > value2;

if condition1 then ret=1;

Print(

  FormatDate("yyyy/MM/dd", Date), 

  NumToStr(value1, 0), NumToStr(value2, 0), condition1);
```

請注意上面腳本內紅字的調整。 GetInfo(“TDCC\_Mode”) 是為了這次調整新增的判斷方式：如果您的程式是執行在目前的環境的話，會回傳0，如果您的程式是 執行在調整後的環境的話，則會回傳1 。 所以上面程式碼的意思就是，如果是跑在舊的環境的話，那就在回測／回溯時抓前一期的資料，可是如果是跑在新的環境的話，那就不需要特別處理，直接抓取大戶持股人數即可。 之後等到新環境上線之後，您就可以移除這些邏輯，改成最直覺的寫法即可。 **(2) 請使用GetField來抓取前期值[1] **我們發現有很多客戶會使用以下的寫法來比對當期欄位數值跟前期欄位數值，例如以下的腳本： 

```
value1 = GetField("大戶持股人數", "W", param:=1000);

if value1 > value1[1] then ret=1;
```

```

```

這樣子的寫法在這 次改版後可能會產生問題。 由於之後系統在執行 GetField("大戶持股人數", "W", param:=1000)時，會依照實際資料是否公佈來決定腳本會看到的大戶持股人數的欄位，例如如果今天是星期四的話，那這時候就會抓到上一週末所公佈的數值，如果是星期五的話，就會抓到當週公佈的數值。 上面的腳本如果是跑日頻率的話： 

- 如果今天是星期四，value1是上一週的大戶持股人數， 
- 上一根K棒是星期三，value1也是上一週的大戶持股人數， 
- value1 = value1[1]，都抓到同一期的資料，不會觸發 
上面的腳本如果是跑週頻率的話，也會有問題喔： 

- 如果今天是星期四，value1是上一週的大戶持股人數， 
- 上一根(週)K棒是上星期五，value1也是上一週的大戶持股人數， 
- value1 = value1[1]，都抓到同一期的資料，不會觸發 
基本上，當欄位是依照資料實際公佈日來決定數值時，腳本內使用value1[1]的方式，都很容易會產生問題。相關的議題我們會再另外一篇文章內說明。 要避開這樣子的問題，請務必使用GetField(..)[1]這樣子的方式來抓取前期數值，例如： 

```
// 使用這樣子的寫法
//
if GetField("大戶持股人數", "W", param:=1000) > 
   GetField("大戶持股人數", "W", param:=1000)[1] then ret=1;
```

```
// 不要這樣子寫
//
value1 = GetField("大戶持股人數", "W", param:=1000);
if value1 > value1[1] then ret=1;


```

---

```

```

```
// 使用這樣子的寫法
//
if trueall(
   GetField("大戶持股人數", "W", param:=1000) > 
   GetField("大戶持股人數", "W", param:=1000)[1], 3) then ret=1;


```

```
// 不要這樣子寫
//
value1 = GetField("大戶持股人數", "W", param:=1000);
if trueall(value1 > value1[1], 3) then ret=1;


```

---

```
// 使用這樣子的寫法
// 
if LinearReg(GetField("大戶持股人數", "W", param:=1000), 5) > 0 
then ret=1;


```

```
// 不要這樣子寫(LinearReg會抓取前期序列數值)
//
value1 = GetField("大戶持股人數", "W", param:=1000);
if LinearReg(value1, 5) > 0 then ret=1;
```

[

#####


---

# GetField 預設值

Source: https://www.xq.com.tw/lesson/xspractice/getfield-%E9%A0%90%E8%A8%AD%E5%80%BC/

使用者在取得資料欄位時，有時會遇到資料尚未更新或欄位缺失的情況，這可能導致回測或執行時發生錯誤。 為避免此類問題，GetField 欄位新增了預設值參數，當資料缺失時，可回傳指定的預設值，確保策略順利執行。 除了預設值以外，還有其他函數可用來判斷欄位是否可用以及欄位名稱等參數是否正確。 

### **語法說明 **

#### **default **

```
Value1 = GetField("大戶持股比例", "W", default := 0); 
Value2 = GetSymbolField("2330.TW", "大戶持股比例", "W", default := Value2[1]);
```

GetField / GetSymbolField 在傳入參數時，現在可額外加上 default 參數。 此參數可以是固定數值 （ 如上方範例 0 ） 或是變數 （ 如上方範例 Value2[1] ）。 當欄位資訊輸入正確時，以下情境支援預設值： 

- 資料尚未更新。 
- 資料中間有空值。 
- 資料讀取範圍內沒有資料。 
- 資料序列為空。 例如： 從未發生不定期欄位事件的商品。 
以下情境則不支援預設值： 

- 取未來值。 
- 回測頻率為 1 分鐘逐筆洗價取 Tick 或是分鐘頻率資料欄位，因無法對位故會發生錯誤。 
- 不支援的商品 ／ 頻率。 
- 回測範圍內沒有發生過不定期欄位的事件。 （ 會回最新一筆 ） 

#### **CheckField **

```
CheckField("外盤量", "D");
CheckSymbolField("TSE.TW", "外盤量");
```

CheckField / CheckSymbolField 會依據傳入的商品代碼、欄位和頻率來判斷該資料是否能夠取用，回傳 True / False 。 

#### **IsSupportField **

```
IsSupportField("月營收", "M");
IsSupportSymbolField("TSE.TW", "月營收");
```

IsSupportField / IsSupportSymbolField 可根據傳入的商品代碼、欄位和頻率，判斷指定的欄位是否存在，回傳 True / False 。 需注意此函數並不會判斷對應 K 棒上是否有資料，只會判斷欄位是否存在。 因此，可能會發生函數回傳 True ，但該根 K 棒上沒有資料的情況。 [

#####


---

# Tick欄位的應用

Source: https://www.xq.com.tw/lesson/xspractice/tick%E6%AC%84%E4%BD%8D%E7%9A%84%E6%87%89%E7%94%A8/

在上一篇文章「 [盤中即時資料欄位的應用 ](https://www.xq.com.tw/learn/xspractice/realtime/)」，我們介紹了如何在腳本內引用「即時資料欄位」來繪製指標或是執行警示，在這一篇文章內我們將為大家介紹另外一種盤中會即時更新的資料: Tick資料。 什麼是Tick資料呢？Tick資料簡單的來說，就是每一筆成交資料。 [
![](/wp-content/uploads/2020/06/7.02-Tick成交明細.png)
](/wp-content/uploads/2020/06/7.02-Tick成交明細.png)從7.02版開始，你可以從腳本內取得每一筆成交資料的詳細資料，除了成交時間，成交價格，成交單量之外，還可以取得這一筆成交資料的內外盤標記(這一筆是外盤成交，還是內盤成交呢？)。以下是Tick資料所支援的所有欄位，以及從腳本內讀取資料的範例： 

```
value1 = GetField("Date", "Tick");   // 成交日期，例如20200611 (2020年6月11日)
value2 = GetField("Time", "Tick");   // 成交時間，例如103011 (10點30分11秒)
value3 = GetField("Close", "Tick");  // 成交價格
value4 = GetField("Volume", "Tick"); // 成交單量
value5 = GetField("BidAskFlag", "Tick"); // 內外盤標記: 1代表外盤成交(紅色), -1代表內盤成交(綠色), 0代表中立
value6 = GetField("BidPrice", "Tick"); // 買進價格
value7 = GetField("AskPrice", "Tick"); // 賣出價格
value8 = GetField("SeqNo", "Tick");  // 資料編號, 每個交易日從1開始編制, 第一筆是1, 第二筆是2, 以下類推

value22 = GetField("Close", "Tick")[1]; // 前一筆成交價格
value23 = GetField("Close", "Tick")[2]; // 前兩筆成交價格
```

透過Tick資料，我們從腳本內就可以更掌握目前的行情資料。我們來看一個大單篩選的警示範例，假如我們希望商品出現單筆成交量大於100張的成交時就通知我們的話，可以用底下這個警示腳本來完成： 

```
input: filterMode(1, "篩選方式", inputkind:=dict(["買盤",1], ["賣盤",-1]));
input: filterVolume(100, "大單門檻");

value1 = GetField("Time", "Tick"); // 時間
value2 = GetField("Close", "Tick"); // 價格
value3 = GetField("Volume", "Tick"); // 單量
value4 = GetField("BidAskFlag", "Tick"); // 外盤=1, 內盤=-1

if value4 = filterMode and value3 >= filterVolume then ret=1;

```

我們把這個腳本加到策略雷達內，選擇1分鐘頻率，勾選逐筆洗價，同時指定要篩選的參數，例如filterMode選擇買盤，filterVolume選擇100，這樣子就完成了。 [
![](/wp-content/uploads/2020/06/7.02-策略雷達大單篩選設定.png)
](/wp-content/uploads/2020/06/7.02-策略雷達大單篩選設定.png)*Tips: 上面這個腳本有使用到inputKind這個語法，讓參數設定時可以用選單的方式來挑選。有興趣的同學可以參考 [inputKind的說明 ](https://xshelp.xq.com.tw/XSHelp?HelpName=inputkind&group=DECLARATION)。 *

## 

### **Tick欄位 v.s. 報價欄位 **
在XS腳本內，你也可以透過 [報價欄位 ](https://xshelp.xq.com.tw/XSHelp/lists?a=QOFTEN)來取得盤中的行情欄位，例如 [q\_Last ](https://xshelp.xq.com.tw/XSHelp/?HelpName=成交&group=QPRICE)可以取得最新一筆成交價格， [q\_TickVolume ](https://xshelp.xq.com.tw/XSHelp/?HelpName=單量&group=QQUANTITY)可以取得最新一筆成交單量，也可以透過 [q\_BidAskFlag ](https://xshelp.xq.com.tw/XSHelp/?HelpName=內外盤&group=QPRICE)來取得最新一筆成交的內盤外盤註記。 那在這個腳本內為何不使用報價欄位，而要使用Tick欄位呢？ 要說明這個問題時請大家先看底下這張圖： [
![](/wp-content/uploads/2020/07/Tick說明_0708-1024x679.png)
](/wp-content/uploads/2020/07/Tick說明_0708.png)從上面這張圖內我們可以觀察到XS洗價的執行方式： 

- 啟動逐筆洗價時，當系統收到成交資料時就會觸發K棒的洗價， 
- 一般而言每收到一筆成交就會觸發一次K棒的洗價，請注意上圖內的洗價時間是示意資料，實際洗價時間會因為電腦CPU，指定的洗價速度等因素而有差異， 
- 可是如果快市的話，就有可能不是每一筆Tick都觸發一次洗價，而是好幾筆Tick才觸發一次洗價 ，例如在上面這張圖內, Tick編號#3跟Tick編號#4兩筆資料的間隔時間很短，所以觸發洗價時已經收到兩筆Tick了(編號#3跟編號#4)， 
- 報價欄位所回傳的是目前最新的行情，在上面這個情形時就是編號#4的數值，所以大部分的時候報價欄位的數值會等於最新一筆Tick的資料， 
- 可是有可能在電腦洗價時又收到了更多的成交資料，此時報價欄位會更新，q\_Last就不一定會跟洗價時K棒的Close是一樣的數值，例如在上面這張圖內，執行第四次洗價時如收到了編號#6的Tick的話, q\_Last會被更新成編號#6的資料，此時就會跟第四次洗價時所抓到的價格不一樣， 
- 如果在洗價時去抓取Tick資料的話，則系統會保證 此時抓到的Tick資料跟洗價當時的K棒內容是一致的 。例如第四次洗價時抓到的Tick會是編號#5的Tick，縱使洗價當時編號#6的Tick已經收到了， 
- 腳本可以在洗價當時透過讀取Tick資料的方式來抓到兩次洗價之間的所有Ticks：例如在第四次洗價時抓到的Tick是編號#5的Tick，此時腳本可以再抓取「前一筆」Tick，就會抓到編號#4的Tick， 
K棒洗價的速度可以透過系統的設定功能來指定，如果調整成最快的話約是125ms會執行一次洗價，如果調整成最慢的話則是每1秒執行一次洗價，使用者可以依照腳本複雜度，CPU的等級等來決定合適的數值。 [
![](/wp-content/uploads/2020/06/7.02-系統參數.png)
](/wp-content/uploads/2020/06/7.02-系統參數.png)

### 

### **如何抓到每一筆Tick資料 **
雖然在快市時不一定可以每次收到成交資料時就執行洗價，可是我們還是可以利用以下的技巧來抓到 上一次洗價到這一次洗價之間的所有Tick資料 ： 

- 每一筆Tick資料有一個「SeqNo」的欄位，這個欄位代表的是這一筆Tick是這個交易日的第幾筆，每個交易日會重新從1開始編制， 
- Tick資料跟1分K, 5分K一樣，都是一個序列，可以使用[1]，[2]的語法來取得前一筆的數值 
所以如果我們在腳本內記住這一次洗價時的SeqNo的數值，然後在下一次洗價時比對當時的SeqNo，就可以知道這兩次洗價之間相隔幾筆Tick，然後透過[n]的方式就可以把這些Tick資料都讀出來。例如上一次洗價時SeqNo是3，而這一次洗價時SeqNo是5，那麼這兩次之間就隔了兩筆Tick，所以腳本只要讀取當時的Tick，跟前一筆Tick資料(共兩筆)，就可以清楚知道兩次洗價之間市場的變化了。 我們把大單篩選的腳本改用這樣子的方式來撰寫。觸發的邏輯改成是如果兩次洗價之間出現了任何一筆大單的話，都顯示警示。 

```
input: filterMode(1, "篩選方式", inputkind:=dict(["買盤",1], ["賣盤",-1]));
input: filterVolume(100, "大單門檻");

var: intrabarpersist last_seqno(0);	// 上次洗價時最後一筆Tick的SeqNo
var: curr_seqno(0);			// 這次洗價時最後一筆Tick的SeqNo

if Date <> CurrentDate then return;	// 只跑今日的資料

curr_seqno = GetField("SeqNo", "Tick");	// 最新一筆Tick編號

if last_seqno = 0 then last_seqno = curr_seqno - 1; // 第一次洗價時只洗當時那一筆

var: seq_no(0), offset(0);
seq_no = curr_seqno;
offset = 0;
while seq_no > last_seqno begin

  // 讀取Tick資料
  value1 = GetField("Time", "Tick")[offset];			
  value2 = GetField("Close", "Tick")[offset];			
  value3 = GetField("Volume", "Tick")[offset];			
  value4 = GetField("BidAskFlag", "Tick")[offset];		
			
  if value4 = filterMode and value3 >= filterVolume then begin
    ret=1;
  end;

  seq_no = seq_no - 1;
  offset = offset + 1;
end;

last_seqno = curr_seqno;



```

上面這個腳本比較長一點，所以我們花點篇幅說明處理的方式: 

- 第3行內宣告了last\_seqno這個變數，這個變數是用來儲存上一次洗價時所對應的SeqNo，由於我們採用逐筆洗價方式，所以必須宣告成 [intrabarpersist ](https://xshelp.xq.com.tw/XSHelp?HelpName=IntraBarPersist&group=DECLARATION)，才可以讓這個變數的數值在同一根bar內可以正常更新， 
- 每一次洗價時腳本會抓取當時的SeqNo (第9行)，然後把這個數值存在curr\_seqno這個變數內， 
- 腳本內使用 [while ](https://xshelp.xq.com.tw/XSHelp/?HelpName=While&group=CONTROLFLOW)語法，來跑過curr\_seqno到last\_seqno之間的所有資料(第16行開始)， 

  - 假如last\_seqno是3，而curr\_seqno是5的話，那這兩次洗價之間總共有2筆Tick資料，編號分別是4跟5(3的那一筆上一次已經讀過了)， 
  - 腳本內宣告了offset這個變數(第13行)，用來控制往前讀取的位置，一開始offset = 0(第15行)， 
  - 進入while loop後，第一次讀到的是GetField("Close", "Tick")[0](第19~22行)，也就是編號5的這一筆， 
  - 每跑一次loop，offset會加1(第29行)，表示下一次我們會往前再讀一筆， 
  - 第二次while loop讀到的是GetField("Close", "Tick")[1], 也就是編號4的這一筆， 
  - 我們用seq\_no這個變數來控制while loop的次數，seq\_no一開始是curr\_seqno(第14行)， 也就是5， 每一次loop seq\_no會減1(第28行)（因為我們是往前讀）， 
  - 這個while loop總共跑了2次：第一次seq\_no = 5，第二次=4，第二次跑完之後seq\_no變成3， 此時就跳出loop了， 
  - 全部跑完之後，要記得更新last\_seqno (第32行) 

這次的介紹到這裡先告個段落，在下一篇文章「 [台股逐筆撮合的連續成交Tick序列 ](https://www.xq.com.tw/learn/xspractice/tickseq/)」，我們會再介紹台股逐筆撮合制度所產生的另外一種資料，也會跟大家介紹系統內建的ReadTicks函數，透過這個函數來簡化讀取Tick資料的流程。 下次再見囉。 [

#####


---

# XQ 18.01 版本 XS 重點功能：美股盤前盤後、函數彈性與編輯器優化

Source: https://www.xq.com.tw/lesson/xspractice/xq1801ver/

在 XQ 全球贏家 .18.01 版本中，XS 語法與功能迎來了多項實用更新。本次更新重點包含「美股盤前盤後交易時段支援」、「函數腳本傳遞商品代碼的靈活運用」，以及「編輯器編譯警告功能」。 
本文將帶您快速掌握這些新功能的應用方式與注意事項。 

## 1. 支援美股盤前與盤後交易時段 
美國股市的正常交易時間是在美東時間的 09:30 ~ 16:00 之間，但除此之外，還有所謂的 **盤前交易 （ 04:00 ~ 09:30 ） **與 **盤後交易 （ 16:00 ~ 20:00 ） **。 在 .18.01 版本中，XQ 提供了 **「美股支援盤前 / 盤後時段」 **的選項，讓使用者可以取得並運用這段時間的資訊。目前支援此功能的模組包括：技術線圖、策略雷達以及自動交易策略。 

### 設定方式 

- **技術線圖 **： 使用者可以點選線圖上方頻率旁的 **時鐘圖示 **選項，來切換「正常交易區段」以及「包含盤前盤後的交易區段」。 
[
![](/wp-content/uploads/2025/12/01.png)
](/wp-content/uploads/2025/12/01.png)[
![](/wp-content/uploads/2025/12/02.png)
](/wp-content/uploads/2025/12/02.png)

- **策略雷達 / 自動交易策略 / 回測 **： 在設定介面中，使用者可以在 **設定頻率 **處，勾選是否要啟動「美股支援盤前盤後時段」。 
**策略雷達 **[
![](/wp-content/uploads/2025/12/03.png)
](/wp-content/uploads/2025/12/03.png)**自動交易策略 **[
![](/wp-content/uploads/2025/12/04.png)
](/wp-content/uploads/2025/12/04.png)**回測 **[
![](/wp-content/uploads/2025/12/05.png)
](/wp-content/uploads/2025/12/05.png)

### 注意事項 

> 

- **委託限制 **：美股盤前盤後時段的交易規則和一般交易時段不太相同，特別需要注意的是，此時段 **僅能使用限價單 **進行委託。 
- **頻率限制 **：美股盤前盤後的資訊 **只提供在分鐘頻率上 **。日頻率的資料不包含盤前盤後時段的資訊，因此若執行頻率設定為「日」，將無法勾選此選項。 

## 2. 商品清單與函數的運用 
在 .18.01 版本中，函數腳本的彈性大幅提升，現在可以透過 `input `的方式來取得商品代碼。這意味著： 

- 可以在執行腳本中使用 `Group `函式取得一組商品清單，然後將此清單中的每個商品單獨傳入函數中，以取得該商品所需的資訊。 
- 可以直接在執行腳本中傳入「固定」或透過 `Input `輸入的商品代碼進函數，然後在函數中取得與該代碼相關的詳細清單及資訊。 

### 應用情境 A ：函數中抓取傳入商品的資訊 
舉例來說，我們撰寫一個函數 `\_getIdOpen `，用來回傳傳入商品的當日開盤價： 

```
input: _id(string);

retval = GetSymbolField(_id, "Open", "D");
```

**支援的使用方式： **

- **固定商品 **

```
value1 = _getIdOpen("2330.TW");
```

- **執行商品 **

```
value1 = _getIdOpen(symbol);
```

- **input 傳入的商品 **

```
input: _id("2330.TW");
value1 = _getIdOpen(_id);
```

- **input 清單中的商品 **

```
input: myGroup(Group);
value1 = _getIdOpen(myGroup[1]);
```

- **group 清單中的商品 **

```
group: myGroup();
myGroup = GetSymbolGroup("TSE23.TW", "成分股");
value1 = _getIdOpen(myGroup[1]);
```

### 應用情境 B ：函數中抓取被傳入商品的清單 
舉例來說，我們撰寫一個函數 `\_getGroupVolumeSum `，用來回傳「傳入商品」其成分股的成交量加總： 

```
input: _id(string);
group: myGroup();
var: _sum(0);

myGroup = GetSymbolGroup(_id, "成分股");

_sum = 0;
for value1 = 1 to GroupSize(myGroup) begin
_sum += GetSymbolField(myGroup[value1], "Volume", "D", default := 0);
end;

retval = _sum;

在以下的情況是可以使用的:
固定商品
value1 = _getGroupVolumeSum("TSE23.TW");
執行商品
value1 = _getGroupVolumeSum(symbol);
input 傳入的商品
input: _id("TSE23.TW");
value1 = _getGroupVolumeSum(_id);
```

**支援的使用方式： **

- **固定商品 **

```
value1 = _getGroupVolumeSum("TSE23.TW");
```

- **執行商品 **

```
value1 = _getGroupVolumeSum(symbol);
```

- **input 傳入的商品 **

```
input: _id("TSE23.TW");
value1 = _getGroupVolumeSum(_id);
```

## 3. XS 編輯器支援警告功能 
為了幫助使用者撰寫更穩健的腳本，在腳本編譯結束時，除了原本的「編譯成功 / 失敗」訊息外，現在還會加上 **「警告項目」 **。使用者可以藉由切換到 **編譯結果 **頁面來確認相關訊息。 

- **警告的意義 **：警告訊息 **不會影響編譯結果 **（ 腳本仍可執行 ） ，而是提示腳本中所撰寫的內容可能會發生運算結果錯誤的部分、目前已無效，以及未來會被移除的語法。 
- **建議做法 **：使用者可以依據警告內容來改善腳本，避免未來發生可能的錯誤。 
[

#####


---

# XS函數「isfirstcall」說明

Source: https://www.xq.com.tw/lesson/xspractice/xs%E5%87%BD%E6%95%B8%E3%80%8Cisfirstcall%E3%80%8D%E8%AA%AA%E6%98%8E/

isfirstcall 能迅速解決腳本撰寫的負擔，它最重要的作用就是：在特定事件下的第一次觸發。 這麼說可能有些抽象，舉凡變數重置、在 K 棒內限制觸發次數等等，都是腳本撰寫上常會用到的邏輯。 如果你曾經遇過「實際執行腳本時，並不如想像中在達成條件後僅觸發一次，而是瘋狂觸發」、「每次都要為了限制觸發，而花不少時間空間設計腳本」或是「明明條件沒有符合，卻還是觸發了(因為沒有重置條件 or 變數)」，那 isfirstcall 能解決很多這方面的困擾。 isfirstcall 要傳入字串形式的事件代碼，回 true / false，以下便來說明幾種 isfirstcall 目前支援的使用情境。 
---

### **一、isfirstcall(" ")：此次執行的第一次洗價 **
只會 true 一次，後續洗價維持 false。 會用到這個事件，通常是為了在腳本啟動後，處理需要引用的資料或變數，而且只需要在一開始執行一次，之後不再需要。 只在第一次洗價時判斷條件，之後都不需再次判斷。 

- 不用 isfirstcall 的寫法： 

```
{先宣告變數_firstTime，來限制觸發一次}
var:_firstTime(0);
condition1 = ……;
if _firstTime = 0 then begin
	if condition1 then …… ;
	_firstTime = 1; //第一次洗價後_firstTime就會持續=1，此後不會再=0了
end;

```

- isfirstcall(" ") 的寫法： 

```
condition1 = ……;
if isfirstcall(" ") then condition1 then ……;

```

### **二、isfirstcall("Bar")：此根 Bar 的第一次洗價 **
換 Bar 就會更新為 true 一次，其餘洗價維持 false。 這些應該是 XS 玩家最常用到的情境了： **(一) 逐筆洗價時，援引「上一根 Bar 最後一次的洗價結果」，做 Bar 內單次觸發 **

- 不用 isfirstcall 的寫法： 

```
{宣告一個intrabarpersist性質的變數_Bar，來限制Bar內觸發一次}
var: intrabarpersist _Bar(0);

condition1 = ......;
if _Bar <> currentbar then begin 
	if  condition1[1] then  ......; 
	_Bar = currentbar;   //更新 _Bar的數值
end;

```

- isfirstcall("Bar") 的寫法： 

```
condition1 = ......;
if isfirstcall("Bar") and condition1[1] then ......;

```

**(二) Bar 內 N 次觸發，使用最新洗價的結果來判斷 **

- 不用 isfirstcall 的寫法： 

```
input:N(3,"限制觸發次數");
var: intrabarpersist _Bar(0), intraBarPersist counts(0);

{將累積觸發次數counts，在Bar內第一次洗價時歸0}
if _Bar <> currentbar then begin 
	counts = 0;
	_Bar = currentbar;
end;

{Bar內最多累積N次觸發}
condition1 = ......;
if condition1 and counts < N then begin
	......;
	counts += 1;
end;

```

- isfirstcall ("Bar") 的寫法： 

```
input:N(3,"限制觸發次數");
var:intraBarPersist counts(0);

{將累積觸發次數counts，在Bar內第一次洗價時歸0}
if isfirstcall("Bar") then counts = 0;

{Bar內最多累積N次觸發}
if condition1 and counts < N then begin
	......;
	counts += 1;
end;

```

### **三、isfirstcall("Date")：此交易日的第一次洗價 **
依照執行商品的交易日來決定何時換日，例如： 

- 股票會在 09:00 時換日 
- 期貨(一般)會在 08:45 時換日 
- 期貨(全日)會在 15:00 時換日 
換交易日就會更新為 true 一次，其餘洗價維持 false。 所以會根據執行商品的交易日更新時間，來決定第一次洗價的時機，會與單純用 date<>date[1] 來判斷 00:00 時換日，有所不同。 **隔日沖開盤出場 **

- 若是股票、期貨(一般)，不用 isfirstcall 的寫法： 

```
if date<>date[1] and Position > 0 then
	SetPosition(0, label:="換日開盤清倉");

```

- 若是期貨(全日)，不用 isfirstcall 的寫法(通用於全部商品)： 

```
{用isSessionFirstBar來鎖定交易日的第一根Bar，再加上單根Bar內限制觸發一次的邏輯}
var:intraBarPersist _Bar;

if isSessionFirstBar and _Bar <> currentBar and Position > 0 then begin
	SetPosition(0, label:="換日開盤清倉");
	_Bar = currentBar;
end;


```

- isfirstcall("Date") 的寫法(通用於全部商品)： 

```
if IsFirstCall("Date") and Position > 0 then
SetPosition(0, label:="換日開盤清倉");

```

### **四、isfirstcall("Realtime")：進入即時洗價區間的第一次洗價 **
從資料歷史區間轉進即時區間後，就會更新為 true 一次，其餘洗價維持 false。 如題，只有在即時洗價區間才會成立，洗價區間分為歷史與即時，歷史洗價區間就是所謂「資料讀取筆數(totalbar)」或「自動交易的策略部位計算」的範圍；即時洗價區間則是在資料讀取完成後，進入盤中即時行情的範圍。 **策略進入即時洗價後 N 分鐘，停止策略 **

- 不用 isfirstcall 的寫法： 

```
input:N(60,"幾分鐘後停止策略");
var:_firstTime(0), _startTime(0);

if _firstTime = 0 then begin
    _startTime = currentTime;
    _firstTime = 1;
end;

if currentTime >= TimeAdd(_startTime,"MM",N) then 
	raiseRunTimeError("時間到停止策略");

```

- isfirstcall("Date") 的寫法： 

```
input:N(60,"幾分鐘後停止策略");
var: _startTime(0);

if isfirstcall("Realtime") then _startTime = currentTime;

if currentTime >= TimeAdd(_startTime,"MM",N) then 
	raiseRunTimeError("時間到停止策略");

```

### **五、isfirstcall("RealBar")：此交易日進入即時洗價區間，首次產生成交事件後的第一次洗價 **
當腳本從歷史資料區間進入即時洗價區間，並且在當日首次產生成交事件後，第一次洗價時，isfirstcall("RealBar") 會回傳 true，之後的洗價都回傳 false。 isfirstcall("Realtime") 在進入即時洗價區間就會成立，而 isfirstcall("RealBar") 則需要額外等待當日第一筆成交事件發生後才會觸發。在多數情況下，兩者觸發時機接近。 兩者在特殊情境下的差異： 在某些市場狀況下，進入即時區間後，不一定立即有成交事件發生，例如： 

- 市場暫緩開盤： 因故市場延遲開盤，進入即時區間後可能沒有成交。 
- 開盤後暫無成交： 在極端清淡的行情下，開盤後可能短時間內沒有成交產生。 
在這些情境中， isfirstcall("Realtime") 會直接在進入即時區間時回傳 true，而 isfirstcall("RealBar") 則會持續等待，直到當日第一筆成交事件出現才回傳 true。 此事件適用於需要確保在市場實際開始交易並有成交量產生後，才執行特定操作的策略，例如： 

- 等待開盤後第一筆成交出現，才開始判斷進場條件： 避免在市場尚未正式開始交易 (例如暫緩開盤或無成交) 時，就提前觸發進場訊號。 
- 確認有成交量後，才啟動需要成交量數據的指標計算： 確保指標計算的數據基礎是建立在實際成交之上。 

### **補充：isfirstcall 的底層邏輯 **
isfirstcall 不會受到 if…else… 等流程函數限制，它的作法是讀取當次洗價，是否為事件定義的第一次洗價：若是則為 true；若不是，那就會維持 false 直到事件再次更新。 舉 isfirstcall(" ") 為例，只有此次執行的第一次洗價為 true，若腳本設定的資料讀取筆數 (settotalbar)<>0，或是交易策略有設定歷史策略部位計算，那 isfirstcall(" ") 就會在歷史區間的第一根 Bar 為 true，之後都會維持 false 的狀態。 不會因為在盤中啟動腳本，才在即時區間的第一次洗價為 true，即時區間的第一次洗價要使用 isfirstcall("Realtime")。 另外，若是用 if… 等流程函數將 isfirstcall 包住，導致避開事件定義的第一次洗價，那之後即使通過流程函數並第一次呼叫 isfirstcall，那也會是 false。 第一段所謂「事件再次更新」的意思是，例如 isfirstcall("Bar") 在進到新的 Bar 時、isfirstcall("Date") 在跨到新的交易日時、isfirstcall("Realtime") 每次從歷史區間跨到即時區間時，會重新為 true 一次。 [

#####


---

# XS在可轉債的應用

Source: https://www.xq.com.tw/lesson/xspractice/xs%E5%9C%A8%E5%8F%AF%E8%BD%89%E5%82%B5%E7%9A%84%E6%87%89%E7%94%A8/

XS已增添支援可轉債商品的功能，現在可以使用 XS 選股中心與 XS 指標，透過可轉債商品的特徵，來尋找未來可能上漲的可轉債標的股。 可轉債是允許持有者，按照轉換價格將債券轉換為公司的普通股，如果債券到期時，沒有轉換為股票，則公司須以現金買回債權，償還持有者。 策略想法是，可轉債快到期時，若公司沒有足夠資金償還給持有者，公司可能會拉抬股價超過轉換價格，希望讓持有者手中的可轉債，轉換成股票，這樣公司就不用以資金償還給債權人。 所以我們可以撰寫以下 3 個 XS 選股條件，篩選出可能會被公司派拉抬的股票名單。 

- 近期內快到期 
- 可轉債剩餘張數有一定數量 
- 標的股價尚未到達轉換價格 
XS選股腳本的範例語法如下： 

```
input:_Length(120, "可轉債N天內到期"),_Vol(0 ,"可轉債剩餘張數大於X");


//value1 = 已轉換比例
if GetSymbolInfo("發行張數") <> 0 then
value1 = 1 - GetField("CB剩餘張數", "W") / GetSymbolInfo("發行張數");


condition1 = DateDiff(GetSymbolInfo("到期日"),Date) <= _Length;//N天內可轉債到期 condition2 = GetField("CB剩餘張數", "W") > _Vol;//可轉債剩餘張數


//標的股價尚未到達轉換價格 → 股票轉換價差(%) < 0
condition3 = (GetSymbolField("Underlying", "收盤價") - GetField("轉換價格")) / GetField("轉換價格") * 100 < 0;


ret = condition1 and condition2 and condition3;


outputField1(DateDiff(GetSymbolInfo("到期日"),Date),"N天內可轉債到期");
outputField2(GetSymbolInfo("到期日"),"可轉債到期日");
outputField3(value1 * 100,"已轉換比例");
outputField4(GetField("CB剩餘張數", "W"),"可轉債剩餘張數");
outputField5(GetSymbolInfo("發行張數"),"發行張數(張)");
outputField6((GetSymbolField("Underlying", "收盤價") - GetField("轉換價格")) / GetField("轉換價格") * 100 ,"股票轉換價差(%)");
outputField7(GetField("轉換價格"),"轉換價格");
outputField8( GetSymbolField("Underlying", "收盤價"),"標的股價");
outputField9( getsymbolFieldDate("Underlying", "收盤價"),"標的股價更新時間");
```

在 XS 選股腳本編譯成功，加入選股後，記得在商品範圍選擇「台股可轉債(系統)」 [
![](/wp-content/uploads/2024/05/可轉債01.png)
](/wp-content/uploads/2024/05/可轉債01.png)完成後，若有購買選股模組，建議設定每日自動執行，方便在自選股商品檢視每日篩選的結果。 [
![](/wp-content/uploads/2024/05/可轉債02.png)
](/wp-content/uploads/2024/05/可轉債02.png)最後，再用這些股票，搭配技術分析頁面做功課，決定要購入哪些股票，期待未來股價會因為可轉債到期而上漲。 下圖面向螢幕左邊的報價組合頁面，可以設定商品組合為「每日自動選股清單」。 [
![](/wp-content/uploads/2024/05/可轉債03.png)
](/wp-content/uploads/2024/05/可轉債03.png)除此之外，在 7.13.01 / 3.13.01 版本中，XS 指標與選股中心有新增一些可轉債相關的XS指標與選股條件如下兩個表格，希望幫助初學 XS 的使用者，可以用系統內建的可轉債 XS 指標與 XS 選股條件，進行分析： 指標名稱 支援頻率 說明 股東人數 日以上的頻率 可轉債是每個月更新一次。 CB轉換溢價率 全部 轉換溢價率(%)＝（可轉債市場價格－轉換價格）÷轉換價格×100 比率大於零時，為溢價率；比率小於零時，為折價率。 CB剩餘張數 日以上的頻率 目前流通在外的可轉債張數（就是還沒有轉換的）每週更新。 選股欄位 選股條件 轉換價格 轉換價格大於X 轉換價格 轉換價格小於X 轉換價格 標的股價大於轉換價格X%、小於N% CB剩餘張數 連續N週CB剩餘張數減少 CB剩餘張數 連續N週CB剩餘張數減少X%以上 以上是XS支援可轉債的應用介紹，若大家有任何的心得與建議，也歡迎來信至 XQservice@XQ.com.tw 回饋分享。 [

#####


---

# XS指標 / 策略雷達 / 自動交易：支援選股欄位

Source: https://www.xq.com.tw/lesson/xspractice/xs%E6%8C%87%E6%A8%99-%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94-%E8%87%AA%E5%8B%95%E4%BA%A4%E6%98%93%EF%BC%9A%E6%94%AF%E6%8F%B4%E9%81%B8%E8%82%A1%E6%AC%84%E4%BD%8D/

### **前言 **
過去有許多用戶，提出希望能在自訂的 **指標 / 策略雷達 / 自動交易 **腳本中，用 GetField 取得 **財報等選股欄位 **，在 15.01 版之後這個需求可以達成。 需要特別注意的是，過去選股欄位僅能使用在選股腳本上，也就是應用在選股中心。 如果要在指標、策略雷達、自動交易腳本使用選股欄位，無論是即時或回測的情境，都需要先具備使用選股欄位的權限。 [
![](/wp-content/uploads/2024/12/3.png)
](/wp-content/uploads/2024/12/3.png)

### **欄位種類說明 **
先複習一下不同 [XS 欄位種類 ](https://xshelp.xq.com.tw/XSHelp/)與不同產品間，在此次調整前的使用情境： **1. 報價欄位： **僅能使用盤中更新資料，支援策略雷達 / 自動交易腳本；無不同頻率的歷史資料，故不可回測。 **2. 資料欄位： **盤中、盤後更新資料皆能使用，支援指標 / 策略雷達 / 自動交易腳本；可以回測。 **3. 選股欄位： **僅能使用盤後更新資料，僅支援選股腳本；可以回測。 這次最主要的調整如下： **3. 選股欄位： **僅能使用盤後更新資料，支援 **選股 / 指標 / 策略雷達 / 自動交易 **腳本；可以回測。 

### **使用情境 **
以下用指標來舉例，用法與 GetField 取得資料欄位的方式完全一樣，只是需要特別注意的是對位的方式。 在指標、策略雷達、自動交易使用選股欄位時，一律使用「 **絕對對位 **」(按資料期別的日期對位)；在選股中心使用選股欄位時，則使用「 **公布日對位 **」(按資料可被 XS 取得的日期對位)。 詳情可參考： [SetAlign ](https://xshelp.xq.com.tw/XSHelp/?HelpName=SetAlign&group=GENERALFUNC)**先就預設的「絕對對位」，提供一個說明範例： **

```
//預設為「絕對對位」：SetAlign("營收財報", 0);
plot1(GetField("營業利益率","q"));
```

可以看到下方直接 plot 出季頻率的 "營業利益率"，由於 2024/Q4 的資料尚未公布，所以在 Q4 範圍的K棒下，"營業利益率" 都是沒有值 (N/A) 的狀態； 最新公布的 2024/Q3 資料，則會標記在 Q3 資料期別的K棒下，也就是［7 月初 ~ 9 月底］。 [
![](/wp-content/uploads/2024/12/1-1024x724.png)
](/wp-content/uploads/2024/12/1.png)若是改成「 **公布日對位 **」呢？ 

```
//公布日對位
SetAlign("營收財報", 1);
plot1(GetField("營業利益率","q"));
```

可以看到資料會被標記在可被 XS 取得的日期區間，例如上圖「 **絕對對位 **」時最新的雖然是 2024/Q3 的資料，但是在下圖「 **公布日對位 **」時會標記在 2024/11/04 以後的 K 棒下。 對照選股中心可取得 2024/Q3 的 "營業利益率"，最早是在 11/01 的盤後，因此在指標就會從下一個交易日也就是 11/04 的K棒開始標記。 不能標記在 11/01 的K棒是因為，11/01 盤中無法取得照理來說盤後才能取得的資料。 [
![](/wp-content/uploads/2024/12/2-1024x722.png)
](/wp-content/uploads/2024/12/2.png)所以我們也可以這樣理解： 「 **公布日對位 **」等同於回到K棒時間的當時能取得的資料，這是如果想避免發生使用「 **絕對對位 **」時，會偷看到未來資料的問題，在使用上可以斟酌使用 SetAlign 做調整。 偷看到未來資料的意思是說，本來在 11/01 盤後才能知道的資料，在絕對對位時，會因為資料期別的緣故，在 07/01 就能取得 以上用指標來當範例說明，同樣在策略雷達與自動交易也適用。 [

#####


---

# XS美股新增欄位列表

Source: https://www.xq.com.tw/lesson/xspractice/xs%E7%BE%8E%E8%82%A1%E6%96%B0%E5%A2%9E%E6%AC%84%E4%BD%8D%E5%88%97%E8%A1%A8/

[
![](/wp-content/uploads/2023/10/1752x600-03_支援美國市場的XS選股欄位@2x.png)
](/wp-content/uploads/2023/10/1752x600-03_支援美國市場的XS選股欄位@2x.png)7.12.01 / 3.12.01 版本，新增支援 **美國市場 **的 XS 欄位列表，分為「選股、資料、商品資訊欄位」以表格的方式呈列， 支援美國市場的選股欄位，此次有 71 個如下表： 欄位分類 選股欄位名稱 可用頻率 支援商品 常用、價格 [本益比 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=本益比&group=FOFTEN)日 美(股票) 常用、價格 [股價淨值比 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=股價淨值比&group=FOFTEN)日 美(股票) 常用、基本 [殖利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=殖利率&group=FOFTEN)日 美(股票)、美(特別股)、美(ETF) 常用、財務 [營業毛利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營業毛利率&group=FOFTEN)季、年 美(股票) 常用、財務 [股東權益報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=股東權益報酬率&group=FOFTEN)季、年 美(股票) 常用、財務 [每股稅後淨利(元) ](https://xshelp.xq.com.tw/XSHelp/?HelpName=每股稅後淨利(元)&group=FOFTEN)季、年 美(股票) 價格 [貝他值 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=貝他值&group=FPRICE)日 美(ETF) 價格 [SHARPE ](https://xshelp.xq.com.tw/XSHelp/?HelpName=SHARPE&group=FPRICE)日 美(ETF) 價格 [Treynor ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Treynor&group=FPRICE)日 美(ETF) 價格 [Jensen ](https://xshelp.xq.com.tw/XSHelp/?HelpName=Jensen&group=FPRICE)日 美(ETF) 價格 [1年標準差 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=1年標準差&group=FPRICE)日 美(ETF) 價格 [3年標準差 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=3年標準差&group=FPRICE)日 美(ETF) 價格 [5年標準差 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=5年標準差&group=FPRICE)日 美(ETF) 價格 [10年標準差 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=10年標準差&group=FPRICE)日 美(ETF) 籌碼 [ETF規模 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=ETF規模&group=FCHIP)月 美(ETF) 籌碼 [機構持股 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=機構持股&group=FCHIP)季 美(股票) 籌碼 [機構持股比重 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=機構持股比重&group=FCHIP)季 美(股票) 籌碼 [內部人持股異動 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=內部人持股異動&group=FCHIP)日、週、月 美(股票) 籌碼 [內部人持股 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=內部人持股&group=FCHIP)日、週、月 美(股票) 基本 [投資建議評級 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=投資建議評級&group=FBASIC)最新 美(股票) 基本 [員工人數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=員工人數&group=FBASIC)季、年 美(股票) 基本 [現金股利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=現金股利&group=FBASIC)年 美(股票)、美(特別股)、美(ETF) 基本 [公司成立日期 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=公司成立日期&group=FBASIC)最新 美(ETF) 基本 [總市值(元) ](https://xshelp.xq.com.tw/XSHelp/?HelpName=總市值(元)&group=FBASIC)日 美(股票) 財務 [流動資產 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=流動資產&group=FFINANCE)季、年 美(股票) 財務 [長期投資 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=長期投資&group=FFINANCE)季、年 美(股票) 財務 [固定資產 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=固定資產&group=FFINANCE)季、年 美(股票) 財務 [無形資產 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=無形資產&group=FFINANCE)季、年 美(股票) 財務 [資產總額 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=資產總額&group=FFINANCE)季、年 美(股票) 財務 [流動負債 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=流動負債&group=FFINANCE)季、年 美(股票) 財務 [負債總額 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=負債總額&group=FFINANCE)季、年 美(股票) 財務 [普通股股本 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=普通股股本&group=FFINANCE)季、年 美(股票) 財務 [股東權益總額 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=股東權益總額&group=FFINANCE)季、年 美(股票) 財務 [營業收入淨額 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營業收入淨額&group=FFINANCE)季、年 美(股票) 財務 [營業成本 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營業成本&group=FFINANCE)季、年 美(股票) 財務 [營業毛利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營業毛利&group=FFINANCE)季、年 美(股票) 財務 [營業利益 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營業利益&group=FFINANCE)季、年 美(股票) 財務 [稅前淨利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=稅前淨利&group=FFINANCE)季、年 美(股票) 財務 [本期稅後淨利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=本期稅後淨利&group=FFINANCE)季、年 美(股票) 財務 [加權平均股數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=加權平均股數&group=FFINANCE)季、年 美(股票) 財務 [稅前息前折舊前淨利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=稅前息前折舊前淨利&group=FFINANCE)季、年 美(股票) 財務 [營業利益率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營業利益率&group=FFINANCE)季、年 美(股票) 財務 [稅前淨利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=稅前淨利率&group=FFINANCE)季、年 美(股票) 財務 [稅後淨利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=稅後淨利率&group=FFINANCE)季、年 美(股票) 財務 [每股淨值(元) ](https://xshelp.xq.com.tw/XSHelp/?HelpName=每股淨值(元)&group=FFINANCE)季、年 美(股票) 財務 [資產報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=資產報酬率&group=FFINANCE)季、年 美(股票) 財務 [流動比率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=流動比率&group=FFINANCE)季、年 美(股票) 財務 [速動比率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=速動比率&group=FFINANCE)季、年 美(股票) 財務 [負債比率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=負債比率&group=FFINANCE)季、年 美(股票) 財務 [投資活動之現金流量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=投資活動之現金流量&group=FFINANCE)季、年 美(股票) 財務 [來自營運之現金流量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=來自營運之現金流量&group=FFINANCE)季、年 美(股票) 財務 [理財活動之現金流量 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=理財活動之現金流量&group=FFINANCE)季、年 美(股票) 財務 [自由現金流量營收比 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=自由現金流量營收比&group=FFINANCE)季、年 美(股票) 財務 [營運資金 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=營運資金&group=FFINANCE)季、年 美(股票) 財務 [當期財報截止日 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=當期財報截止日&group=FFINANCE)季、年 美(股票) 財務 [總流通在外股數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=總流通在外股數&group=FFINANCE)季、年 美(股票) 財務 [EPS預估值 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=EPS預估值&group=FFINANCE)季 美(股票) 財務 [EPS法說公佈值 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=EPS法說公佈值&group=FFINANCE)季 美(股票) 財務 [稀釋後每股淨利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=稀釋後每股淨利&group=FFINANCE)季、年 美(股票) 財務 [年報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=年報酬率&group=FFINANCE)最新 美(ETF) 財務 [1年年化報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=1年年化報酬率&group=FFINANCE)日 年報酬率 財務 [3年年化報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=3年年化報酬率&group=FFINANCE)日 年報酬率 財務 [5年年化報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=5年年化報酬率&group=FFINANCE)日 年報酬率 財務 [10年年化報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=10年年化報酬率&group=FFINANCE)日 年報酬率 事件日期 [除權日期 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=除權日期&group=FEVENT)最新 美(股票) 事件日期 [除息日期 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=除息日期&group=FEVENT)最新 美(股票) 事件日期 [股利年度 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=股利年度&group=FEVENT)年 美(股票)、美(ETF) 事件日期 [除權年度 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=除權年度&group=FEVENT)最新 美(股票) 事件日期 [除息年度 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=除息年度&group=FEVENT)最新 美(股票) 事件日期 [除息值 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=除息值&group=FEVENT)最新 美(股票) 事件日期 [除權值 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=除權值&group=FEVENT)最新 美(股票) 支援美國市場的資料欄位，此次有 9 個如下表： 欄位分類 資料欄位名稱 可用頻率 支援商品 量能 [總成交次數 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=總成交次數&group=TVOLUME)分鐘、日 美(股票) 籌碼 [機構持股 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=機構持股&group=TCHIP)季 美(股票) 籌碼 [內部人持股異動 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=內部人持股異動&group=TCHIP)日、週、月 美(股票) 籌碼 [內部人持股 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=內部人持股&group=TCHIP)日、週、月 美(股票) 籌碼 [機構持股比重 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=機構持股比重&group=TCHIP)季 美(股票) 基本 [本益比 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=本益比&group=TBASIC)日 美(股票) 基本 [殖利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=殖利率&group=TBASIC)日 美(股票)、美(特別股)、美(ETF) 基本 [投資建議評級 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=投資建議評級&group=TBASIC)最新 美(股票) 支援美國市場的商品資訊欄位，此次有 7 個如下表： 商品資訊欄位名稱 可用頻率 支援商品 [交易所 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(股票) [ETF分類 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(ETF) [到期日 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(特別股) [票面利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(特別股) [面額 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(特別股) [ETD ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(特別股) [第一個回購日 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=GetSymbolInfo&group=FIELDFUNC)最新 美(特別股) 以上是「美股新增欄位列表」為付費功能，整理成表格的方式，讓大家可以快速審視有哪些欄位有支援美國市場，希望有幫助到大家，感謝大家耐心的收看?? 延伸運用： 

- [XS美股欄位的使用介紹 ](https://www.xq.com.tw/lesson/xspractice/xs美股欄位的使用介紹/)
- [進一步了解美股分析模組 ](https://www.xq.com.tw/usmarketanalysis/)
[

#####


---

# XS美股欄位的使用介紹

Source: https://www.xq.com.tw/lesson/xspractice/xs%E7%BE%8E%E8%82%A1%E6%AC%84%E4%BD%8D%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%B4%B9/

[
![](/wp-content/uploads/2023/10/1752x600-03_常見XS美股欄位運用@2x.png)
](/wp-content/uploads/2023/10/1752x600-03_常見XS美股欄位運用@2x.png)在 7.12.01 / 3.12.01 版本（簡稱 \*.12.01）XS 將新增 71 個美股選股欄位與 9 個美股資料欄位，讓大家可以獲取更多美股資訊，進行更多元的投資策略佈局。 大家可以參考「 [美股新增欄位列表 ](https://www.xq.com.tw/lesson/xspractice/xs%E7%BE%8E%E8%82%A1%E6%96%B0%E5%A2%9E%E6%AC%84%E4%BD%8D%E5%88%97%E8%A1%A8/)」文章介紹在 \*.12.01 總共新增了哪些美股的選股 / 資料欄位。 而此篇文章介紹用 XS 取得「基本面／財報／籌碼」這三種分類，常見的美股欄位資訊，希望大家看過此篇文章，能得到一些靈感，來構築投資美股的決勝策略。 

## 基本面欄位 
美股基本面的XS選股欄位，在 \*.12.01 版本有 

- [殖利率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E6%AE%96%E5%88%A9%E7%8E%87&group=FOFTEN)
- [總市值(元) ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E7%B8%BD%E5%B8%82%E5%80%BC%28%E5%85%83%29&group=FBASIC)
- [現金股利 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E7%8F%BE%E9%87%91%E8%82%A1%E5%88%A9&group=FBASIC)
我們可以使用「殖利率」選股欄位，製作美股市場的「殖利率」排行榜。 並用「現金股利」檢視美股的配息數值，再用「總市值(元)」來檢視美股商品的價值大小，如下圖 [
![](/wp-content/uploads/2023/10/_殖利率排行-e1698389185364.png)
](/wp-content/uploads/2023/10/美股_殖利率排行.png)接下來將一步一步指導大家如何做出美股「殖利率」排行榜。 第一步：在 XS 編輯器，新增「\_YieldRank」函數腳本，程式碼如下 

```
Retval = GetField("殖利率", "D");
```

第二步：在 XS 編輯器，新增「殖利率相關資訊」選股腳本，程式碼如下 

```
Ret = 1;
outputField1(GetField("殖利率", "D"),"殖利率");
outputField2(GetFielddate("殖利率", "D"),"殖利率資料日期");
outputField3(GetField("現金股利", "Y"),"現金股利");
outputField4(GetFielddate("現金股利", "Y"),"現金股利資料日期");
outputField5(GetField("總市值(元)", "D"),"總市值(元)");
outputField6(GetFielddate("總市值(元)", "D"),"總市值(元)資料日期");
```

第三步：在選股中心，新增「標普500\_殖利率排行」策略，並參考下 圖 ，依以下指示操作。 [
![](/wp-content/uploads/2023/10/_殖利率排行_UI-e1698389203277.png)
](/wp-content/uploads/2023/10/美股_殖利率排行_UI.png)

- 1. 市場別：請設定為「美股」 
- 2. 範圍：請設定為「標普 500 (系統)」 
- 3. 自訂排行條件：請加入「美股殖利率排行榜」 

  - a. 挑選名次「100」名 

- 4. 選股腳本：請加入「殖利率相關資訊」 
- 5. 按下「完成」即完成「標普500\_殖利率排行榜」 
在玲瑯滿目的美股商品中，投資者銀彈有限的情況下，僅能針對幾檔美股商品進行投資時，不妨可以試試看製作排行榜來當作參考依據。 上述分享「標普500\_殖利率排行榜」就是其中一種濾網來做篩選，提供給大家參考。 

## 財報欄位 
美股財報的選股欄位，在 \*.12.01 版本，共新增 71 個美股的 XS 選股欄位，也有新增相關的內建選股條件，方便大家直接加入使用。 接下來，將用「股東權益報酬率」這個有支援美股的選股欄位，製作「美股普通股\_巴菲特概念股」選股策略，如下 圖 ，來為大家做介紹 [
![](/wp-content/uploads/2023/10/_巴菲特概念股-e1698389215799.png)
](/wp-content/uploads/2023/10/美股普通股_巴菲特概念股.png)該策略的選股條件是參考選股中心→系統→價值投資→927.巴菲特概念股： 

- 年\_連續 10 年股東權益報酬率大於 8 % 
- 年\_連續 3 年股東權益報酬率大於 15 % 
- 日\_收盤價大於近 60 日平均 
這次直接透過內建的選股條件來製作，不用到選股腳本進行撰寫，請參考下 圖 ，依指示操作。 [
![](/wp-content/uploads/2023/10/美股普通股_巴菲特概念股_UI.png)
](/wp-content/uploads/2023/10/美股普通股_巴菲特概念股_UI.png)

- 1. 在選股中心新增「美股普通股\_巴菲特概念股」策略 
- 2. 市場別：請設定為「美股」 
- 3. 範圍：請設定為「美股普通股(全部)」 
- 4. 選股條件：請加入以下三個條件 

  - a. 年\_連續 10 年股東權益報酬率都大於 8 % 
  - b. 年\_連續 3 年股東權益報酬率都大於 15 % 
  - c. 日\_收盤價大於近 60 日平均 

- 5. 按下「完成」即完成「美股普通股\_巴菲特概念股」選股策略 
巴菲特的選股心法，其中一個就是針對「 [股東權益報酬率 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E8%82%A1%E6%9D%B1%E6%AC%8A%E7%9B%8A%E5%A0%B1%E9%85%AC%E7%8E%87&group=FOFTEN)」來當作濾網篩選出好標的， 而在選股條件，有些常見的條件，可以直接點選加入，無須再自行撰寫腳本， 上述的「美股普通股\_巴菲特概念股」選股策略，就是一個使用範例，供大家參考。 

## 籌碼欄位 
美股的籌碼欄位，在 \*.12.01 版本，新增 5 個美股的選股欄位，與 4 個美股的資料欄位。 美股市場的籌碼面資料中，比較常見的是「 [機構持股 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E6%A9%9F%E6%A7%8B%E6%8C%81%E8%82%A1&group=FCHIP)」與「 [機構持股比重 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E6%A9%9F%E6%A7%8B%E6%8C%81%E8%82%A1%E6%AF%94%E9%87%8D&group=FCHIP)」這種依美國證券交易委員會規定每季公告的「SEC Form 13F」數據。 在美股商品技術分析圖→技術分析設定→副圖設定→商品指標，就有內建指標「機構持股」可以點選使用，如下 圖 。 [
![](/wp-content/uploads/2023/10/-e1698389230871.png)
](/wp-content/uploads/2023/10/機構持股內建指標.png)這個內建指標，我們也可以透過 XS 自訂撰寫，使用美股的XS資料欄位「 [機構持股 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E6%A9%9F%E6%A7%8B%E6%8C%81%E8%82%A1&group=TCHIP)」與「 [機構持股比重 ](https://xshelp.xq.com.tw/XSHelp/?HelpName=%E6%A9%9F%E6%A7%8B%E6%8C%81%E8%82%A1%E6%AF%94%E9%87%8D&group=TCHIP)」透過 Plot1 繪圖 XS 語法，以及繪圖設定來製作「XS自訂指標\_機構持股」如下 圖 。 [
![](/wp-content/uploads/2023/10/_XS-e1698389247815.png)
](/wp-content/uploads/2023/10/機構持股比重_XS.png)「XS自訂指標\_機構持股」的程式碼，雖然圖上有說明，不過仍提供以下程式碼，方便大家複製貼上，動手操作。 

```
//因為繪圖設定→查價視窗→數值顯示→%，會自動 × 100，所以該數值要 / 100，才會在顯示正確 % 數值。
plot1(GetField("機構持股比重", "Q")/100,"比重",Checkbox:=1);
plot2(GetField("機構持股", "Q"),"數值",Checkbox:=0);
```

上述的XS自訂指標腳本的程式碼撰寫完成，並編譯成功後，請依照以下兩個步驟，進行繪圖設定，與加入副圖到技術分析圖中。 第一步：撰寫「XS自訂指標\_機構持股」指標腳本，請參考下 圖 ，依照指令進行。 [
![](/wp-content/uploads/2023/10/機構持股比重_繪圖設定.png)
](/wp-content/uploads/2023/10/機構持股比重_繪圖設定.png)

- 1. 在撰寫程式碼腳本處，右鍵選單→繪圖設定。 
- 2. 繪圖設定→繪圖樣式的「型式、樣式、顏色、座標軸」請依照圖示進行設定，並按下確定。 
- 3. 繪圖設定→查價視窗的「數值顯示、小數格式」請依照圖示進行設定，並按下確定。 
第二步：將「XS自訂指標\_機構持股」加入到技術分析圖中，如下圖 [
![](/wp-content/uploads/2023/10/_技術分析-e1698389259253.png)
](/wp-content/uploads/2023/10/機構持股比重_技術分析.png)

- 1. 回到XQ的美股商品技術分析圖→技術分析設定→副圖設定→搜尋「XS自訂指標\_機構持股」加入到副指標中，並按下完成。 
透過上述步驟，即完成「XS自訂指標\_機構持股」加入到美股商品分析技術圖中。 抽取幾個常見的美股基本面、財報、籌碼欄位，來為大家簡單介紹使用方式，以上皆為付費功能，需購買美股分析模組每月500元，方可完整體驗。 若大家使用後，有任何的心得與建議，也歡迎來信至 XQservice@XQ.com.tw 回饋分享， 感謝大家的收看，咱們下次見～ 延伸閱讀： 

- [XS美股欄位表 ](https://www.xq.com.tw/lesson/xspractice/xs%e7%be%8e%e8%82%a1%e6%96%b0%e5%a2%9e%e6%ac%84%e4%bd%8d%e5%88%97%e8%a1%a8/)
- [進一步了解美股分析模組 ](https://www.xq.com.tw/usmarketanalysis/)
[

#####


---

# XScript 編輯器已支援 *.xs 副檔名的檔案

Source: https://www.xq.com.tw/lesson/xspractice/xscript-%E7%B7%A8%E8%BC%AF%E5%99%A8%E5%B7%B2%E6%94%AF%E6%8F%B4-xs-%E5%89%AF%E6%AA%94%E5%90%8D%E7%9A%84%E6%AA%94%E6%A1%88/

在 XQ 7.14.01 / 3.14.01 版本的 XScript 編輯器，有提供開啟與儲存 \*.xs 副檔名的檔案功能，可以透過這個功能開啟 [XQ 全球贏家官方 GitHub ](https://github.com/sysjust-xq)提供的「 [量化積木條件腳本 ](https://github.com/sysjust-xq/XS_Blocks)、 [XScript編輯器系統腳本 ](https://github.com/sysjust-xq/XScript_Preset)、 [XQ選股中心的選股條件腳本 ](https://github.com/sysjust-xq/XQStrategy)」\*.xs 副檔名的檔案（按下 <> Code ▽ 找到 DownLoad ZIP 選項，點擊下載後解壓縮）就能在 XScript 編輯器中參考這些腳本集，來構思自己的交易策略靈感。 比方說，如果在量化積木，看到「可能被處置的股票」的條件很感興趣，想知道這個條件的 XS 程式碼，就可以透過「開啟 XS 檔案」功能，打開此條件的 \*.xs 檔案，在 XS 編輯器顯示此條件的 XS 程式碼，如下示意圖。 [
![](/wp-content/uploads/2024/09/00_開啟XS檔案介紹-1024x576.png)
](/wp-content/uploads/2024/09/00_開啟XS檔案介紹.png)那麼在哪裡才能找到量化積木條件腳本呢？大家可以從 [XQ 全球贏家官方 GitHub ](https://github.com/sysjust-xq)提供的 [量化積木條件腳本 ](https://github.com/sysjust-xq/XS_Blocks)下載壓縮檔（按下 <> Code ▽ 找到 DownLoad ZIP 選項，點擊下載後解壓縮）解壓縮後就能取得量化積木條件腳本的 \*.xs 檔案。 [
![](/wp-content/uploads/2024/09/00_下載解壓縮-1024x510.png)
](/wp-content/uploads/2024/09/00_下載解壓縮.png)除了可以開啟 \*.xs 檔案檢視外，也可以將自己的 XS 腳本，儲存成 \*.xs 檔案 [
![](/wp-content/uploads/2024/09/00_儲存成XS檔案-1024x722.png)
](/wp-content/uploads/2024/09/00_儲存成XS檔案.png)儲存成 \*.xs 檔案後，就可以透過其他方式開啟 \*.xs 檔案來檢視 XS 程式碼，下圖是透過記事本開啟 \*.xs 檔案來檢視 XS 程式碼， [
![](/wp-content/uploads/2024/09/00_記事本-1024x274.png)
](/wp-content/uploads/2024/09/00_記事本.png)推薦安裝 [VSCode ](https://code.visualstudio.com/)檢視程式碼，也建議安裝 [XS 程式碼的外掛 ](https://marketplace.visualstudio.com/items?itemName=sysjust-xq.xs)，VSCode 就能依照 XS 語法自動調整顯示的顏色，下圖是透過 VSCode 檢視 XS 程式碼， [
![](/wp-content/uploads/2024/09/00_檢視XS程式碼.png)
](/wp-content/uploads/2024/09/00_檢視XS程式碼.png)用 VSCode 檢視 \*.xs 檔案時，第一行有以下這行註解： {@type:sensor|@guid:c75d3c176ff446be90cd891b828e7f6d} 這是用來開啟 XS 檔案的時候，讓系統判斷要用什麼腳本類型開啟，以及要開啟哪個腳本 ID 

- type 是指腳本類型： 

  - indicator＝指標、filter＝選股、sensor＝警示、autotrade＝交易、function＝函數。 

- guid 是指這個腳本的 ID 
最後，如果大家透過 XS 編輯器開啟 \*.xs 檔案，與既存 XS 編輯器上的腳本重複（腳本的 ID 一樣代表重複）這時候會有一個選項詢問是否要覆蓋目前腳本，提供給大家決定是否要覆蓋。 [
![](/wp-content/uploads/2024/09/00_覆蓋目前腳本-1024x518.png)
](/wp-content/uploads/2024/09/00_覆蓋目前腳本.png)以上就是 XScript 編輯器支援開啟與儲存 \*.xs 檔案的功能介紹。 ※ 注意：「隱藏程式碼」的腳本是無法被儲存成 XS 檔案格式的。 [
![](/wp-content/uploads/2024/09/隱藏程式碼.png)
](/wp-content/uploads/2024/09/隱藏程式碼.png)[

#####


---

# XS語法入門

Source: https://www.xq.com.tw/lesson/xsscript/

[
![XS語法入門](/wp-content/uploads/2016/01/01_00.png)
](/wp-content/uploads/2016/01/01_00.png)股市資訊百百種，茫茫股海中要怎麼找到飆馬股？ 台股撮合頻率一路從20秒一撮調快到現在的5秒一撮，螢幕閃來閃去，用眼睛盯盤也太吃力！ 如果你也有這樣的困惑，就讓XS來幫助你吧！ 科技時代，就要用科技讓投資更有效率～ XS可以幫大家把研究功課自動化，例如，電腦自動篩選出符合條件的個股清單，到達買進或賣出訊號時自動提示。 我們只要專心研究好投資策略，電腦就幫你執行你的命令！ 在【XS語法入門】系列中，依序向大家介紹XS工具的使用方式， 希望可以事半功倍，讓投資決策更有效率！ [

#####


---

# 動手做做看(ㄧ) - XS編輯器介紹

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E3%84%A7-xs%E7%B7%A8%E8%BC%AF%E5%99%A8%E4%BB%8B%E7%B4%B9/

[
![3-02](/wp-content/uploads/2016/01/3-02.png)
](/wp-content/uploads/2016/01/3-02.png)在這個系列內我們會帶領大家逐步體驗XS的各種功能。在這個課程結束後，你將會學到如何自己設計指標，如何設計盤中即時的警示，以及如何使用XS語法來篩選好的投資標的。 在課程的第一堂，先教各位如何操作「XS編輯器」。 看完影片是不是覺得很簡單呢！請打開XQ，把今天學到的實際操作一次，會更有印象喔！ [

#####


---

# 動手做做看(七) - 如何挑選外資累計買超的股票後盤中結合策略雷達警示觸發

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E4%B8%83-%E5%A6%82%E4%BD%95%E6%8C%91%E9%81%B8%E5%A4%96%E8%B3%87%E7%B4%AF%E8%A8%88%E8%B2%B7%E8%B6%85%E7%9A%84%E8%82%A1%E7%A5%A8/

[
![3-08](/wp-content/uploads/2016/01/3-08.png)
](/wp-content/uploads/2016/01/3-08.png)在這一集內我們將會學習如何在腳本內使用股票基本面，籌碼面，財務面等非價位的欄位，同時也會學習到如何將選股策略與策略雷達一起搭配使用。 經由系列影片，學會了： 

- 建立自己的訂指標和調整參數 
- 使用策略雷達即時監控進出點 
- 使用選股中心篩選出口袋名單 
希望透過這樣子的機制， 投資者可以藉由XS語法的彈性以及資料的多樣性來建構出自己的投資心法，成為市場的贏家！ 若對內容還是有不清楚的地方，歡迎到 [技術支援 ](http://forum.xq.com.tw/cat/xs使用問題/)與我們互動～ [

#####


---

# 動手做做看(三) - 設定指標參數

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E4%B8%89-%E8%A8%AD%E5%AE%9A%E6%8C%87%E6%A8%99%E5%8F%83%E6%95%B8/

[
![3-04](/wp-content/uploads/2016/01/3-04.png)
](/wp-content/uploads/2016/01/3-04.png)在上一篇我們學到了如何寫一隻均線指標，然後把這個均線指標放到圖形上面。如果我們希望可以計算不同的天期，而且也希望這個天期可以每張圖都設定的不ㄧ樣的話，那該怎麼做呢 ? 重點複習： 

- 學會「Average」函數 
- 學會「Input」語法 
- 了解「變數」的概念 
大家是不是已經可以利用學習過的內容，設計出簡單的指標作運用了呢？ 看完教學影片後，打開XQ，試著自己練習寫一次，加油！ [

#####


---

# 動手做做看(二) - 建立XS指標

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E4%BA%8C-%E5%BB%BA%E7%AB%8B%E6%8C%87%E6%A8%99/

[
![3-03](/wp-content/uploads/2016/01/3-03.png)
](/wp-content/uploads/2016/01/3-03.png)在上一篇我們學會了操作「XS編輯器」，寫了一個測試指標，在今天的課程內，我們就要開始設計真正的指標了。 重點複習： 

- 學習「Plot」語法 
- 把自己設計的指標放到技術分析上 
試著自己重寫一次，多多練習，印象更深刻！ [

#####


---

# 動手做做看(五) - 股價突破均線時的通知

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E4%BA%94-%E8%82%A1%E5%83%B9%E7%AA%81%E7%A0%B4%E5%9D%87%E7%B7%9A%E6%99%82%E7%9A%84%E9%80%9A%E7%9F%A5/

[
![3-06](/wp-content/uploads/2016/01/3-06.png)
](/wp-content/uploads/2016/01/3-06.png)在


---

# 動手做做看(六) - 如何挑選股價突破均線的股票

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E5%85%AD-%E5%A6%82%E4%BD%95%E6%8C%91%E9%81%B8%E8%82%A1%E5%83%B9%E7%AA%81%E7%A0%B4%E5%9D%87%E7%B7%9A%E7%9A%84%E8%82%A1%E7%A5%A8/

[
![3-07](/wp-content/uploads/2016/01/3-07.png)
](/wp-content/uploads/2016/01/3-07.png)如果系統提供的條件不敷使用的話，這時候腳本條件就派上用場了！ 透過腳本條件，使用者可以使用XS語法來撰寫自己獨特的篩選股票的邏輯。 聽起來是不是很神奇呢？那就讓我們趕快來看看怎麼做吧！ [

#####


---

# 動手做做看(四) - XS策略雷達簡介

Source: https://www.xq.com.tw/lesson/xsscript/%E5%8B%95%E6%89%8B%E5%81%9A%E5%81%9A%E7%9C%8B%E5%9B%9B-xs%E7%AD%96%E7%95%A5%E9%9B%B7%E9%81%94%E7%B0%A1%E4%BB%8B/

[
![3-05](/wp-content/uploads/2016/01/3-05.png)
](/wp-content/uploads/2016/01/3-05.png)在前三篇我們學會了撰寫一支均線指標，把這個指標放到技術分析圖上面，同時可以從技術分析圖上面設定指標的計算期別，讓我們用各種不同的方式來觀察某一檔商品的走勢。 今天我們要來學一種不一樣的功能，它的名字就叫做【XS策略雷達】。策略雷達的工作原理跟指標類似：必須提供一個腳本，在指標的話我們稱為「指標腳本」，在策略雷達的話我們則稱為「警示腳本」。 重點複習： 

- XS警示運作概念 
- 撰寫警示腳本 
- 使用策略雷達 
策略雷達，可以幫我們在背景依照我們指定的腳本內容，即時的監控股票的價格變化。是個監控盤面變化的得力助手，請一定要學會使用喔！ [

#####


---

# 基本架構介紹：什麼是XS

Source: https://www.xq.com.tw/lesson/xsscript/%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%A7%8B%E4%BB%8B%E7%B4%B9/

[
![876x300_XS語法入門_01](/wp-content/uploads/2016/01/876x300_XS語法入門_01.png)
](/wp-content/uploads/2016/01/876x300_XS語法入門_01.png)什麼是XS呢 ? 簡單的來說， **XS是一套可以讓使用者利用簡單的指令，來告訴電腦如何根據商品的價位，例如開，高，低，收等資料做運算，邏輯判斷等動作，然後把執行後的結果利用圖形，訊號等介面通知使用者的系統 **。由於輸入的指令可以客製化，所以每個人都可以利用XS來設計出他自己的看盤/交易/選股的邏輯，不再受到傳統看盤軟體的限制，而且因為電腦可以快速的執行這些指令，所以使用者可以運用XS來執行多檔商品的即時篩選，掌握最佳的交易時機。 我們用K線圖來跟大家說明XS的運算方式： [
![Kchart](/wp-content/uploads/2016/01/Kchart.png)
](/wp-content/uploads/2016/01/Kchart.png)在K線圖裡面，可以清楚的看到商品的價格變化是一個時間序列，由歷史的資料往最新的日期一路的發展過來，所以XS的設計方式，就是讓使用者可以順著這個時間序列上面，在每一根K棒上面一一的運算他所指定的邏輯。 [
![BarSequence](/wp-content/uploads/2016/01/BarSequence.png)
](/wp-content/uploads/2016/01/BarSequence.png)我們把每一根K棒(bar)上面所要執行的邏輯，寫在一個「腳本」之內。每一個腳本內，包含了一行一行的XS指令。當我們把這個腳本送給XS時，XS就會依照商品的K棒序列開始執行這個腳本，執行時使用者就可以透過腳本裡面的XS指令來取得商品K棒的價格，以及其他資料，然後利用不同的XS指令來做出運算以及判斷。這些一行一行的XS指令，有各種不同的寫法，這些不同的寫法就稱為XS語法。 [
![XS語法架構](/wp-content/uploads/2016/01/XS語法架構.png)
](/wp-content/uploads/2016/01/XS語法架構.png)那在XS語法中，我們如何知道目前是在哪一根bar，而此時的價位又是如何呢 ? 在XS語法內，使用者可以使用以下幾個常用的英文字來取得目前這根bar的價格：Open代表開盤價，Close代表收盤價，High代表最高價，Low代表最低價，Date代表這根bar的日期，而Volume則代表這根bar的成交量。除了這幾個英文字之外，語法也提供一般的加減乘除等運算式，例如： 

```
High - Low

```

就是表示這根bar的振幅（最高價減最低價）。 由於在執行運算時我們常常會希望知道目前這根bar與先前bar的價位的比較，例如我們可能會想要知道這根bar的漲跌(也就是目前bar的收盤價減去前一根bar的收盤價)，所以在指令內可以使用中括號的方式來取得前幾根bar的數值。例如Close[1]表示前一根bar的收盤價，Open[2]表示前兩根bar的開盤價，所以K棒的漲跌就可以用以下的指令來表示： 

```
Close - Close[1]

```

[
![Bar序列](/wp-content/uploads/2016/01/BarSeries.png)
](/wp-content/uploads/2016/01/BarSeries.png)透過XS語法內的價格欄位，價格欄位的前期值，以及加減乘除等運算方式，我們可以把交易運算的邏輯鋪陳在XS腳本內，然後讓XS系統把這個邏輯一一的在我們指定的商品的每一根bar上面執行對應的計算跟判斷。透過這個機制，我們就可以研判商品的價格變化，繪製出我們想要的圖形，篩選出我們想要找的股票，讓XS系統在價格變化的關鍵點上立即通知我們，跳出警示，甚至送出交易指令！ 在以下的章節內，我們將會陸續跟大家介紹XS語法以及XS系統的各種功能，請大家繼續看下去。 [

#####
